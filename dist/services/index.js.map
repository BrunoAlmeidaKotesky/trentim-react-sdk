{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///(webpack)/buildin/module.js","webpack:///./src/services sync","webpack:///dist/F:/Projetos Individuais/ReactLibraries/trentim-react-sdk/src/services/BaseService.ts","webpack:///dist/F:/Projetos Individuais/ReactLibraries/trentim-react-sdk/src/services/index.ts","webpack:///external \"@pnp/sp\"","webpack:///external \"catch-decorator-ts\""],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","webpackPolyfill","deprecate","paths","children","webpackEmptyContext","req","e","Error","code","keys","resolve","id","injectedModules","requestClientFactory","baseItemsSelect","uniqueSelect","select","length","Set","concat","_this","this","registerCustomRequestClientFactory","loadModules","then","_","sp","sp_1","configure","headers","location","origin","BaseService","injectedModules_1","injectedModules_1_1","module_1","res","_c","console","log","_a","baseArr","filter","item","includes","identifier","_d","filters","_e","expand","_f","cache","_g","top","_h","orderBy","_j","getBy","lists","web","query","items","apply","_l","__spreadArray","_k","_b","column","ascending","undefined","_m","usingCaching","itemId","options","getItems","__assign","__read","listTitle","hash","getByTitle","add","getById","update","defaultSelect","orderTuple","getItemByIdSelect","baseItem","versions","listName","attachments","attachmentFiles","addMultiple","libraryUrl","folderUrl","content","chunkSize","getFolderByServerRelativeUrl","files","addChunked","data","percent","blockNumber","totalBlocks","fileAddRes","progressCallback","accumulatorPercent","realTotalPercentage","forEach","push","Promise","allSettled","map","f","idx","fileSize","individualPercentage","reduce","b","currentName","currentPercentage","result","percentage","currentUser","userInfo","site","getContextInfo","context","isExternal","LoginName","IsExternalUser","ProfilePic","SiteFullUrl","Email","all","file","Name","fileInfo","removeOData","_files","list","opt","_list","currentUserHasPermissions","permissionType","hasPermission","__decorate","DefaultCatch","err","error","File","require"],"mappings":"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","file":"services/index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/services/index.ts\");\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"./src/services sync recursive\";","import { DefaultCatch } from 'catch-decorator-ts';\r\nimport { sp, SPRest, registerCustomRequestClientFactory } from '@pnp/sp';\r\nimport type {AllTypes} from './IFakeImport';\r\nimport type { IRequestClient } from \"@pnp/common\";\r\nimport type { IItemAddResult, IItemUpdateResult } from \"@pnp/sp/items\";\r\nimport type { IFileAddResult, IFileInfo } from '@pnp/sp/files';\r\nimport type { IAttachmentFileInfo } from '@pnp/sp/attachments';\r\nimport type { ISPUser } from '../models/interfaces/ISPUser';\r\nimport type { PermissionKind } from '@pnp/sp/security';\r\nimport type { PnpModules, IBaseItemKey, IItemVersionInfo, ITypedHash, PreviousUnion, IQueryOptions } from './IBaseServiceConfig';\r\n\r\ndeclare const types: AllTypes;\r\nexport class BaseService {\r\n    public sp: SPRest;\r\n    constructor(public injectedModules: PnpModules[], private requestClientFactory?: () => IRequestClient) {\r\n        if(this.requestClientFactory) \r\n            registerCustomRequestClientFactory(this.requestClientFactory);\r\n        this.loadModules(this.injectedModules).then(_ => {\r\n            this.sp = sp.configure({ headers: { 'Origin': window.location.origin } }, window.location.origin);\r\n        });\r\n    }\r\n\r\n    private async loadModules(injectedModules: PnpModules[]): Promise<void> {\r\n        for (const module of injectedModules) {\r\n            const res = await import(module);\r\n            if (!res) {\r\n                console.log(`Module ${res?.default?.name} failed to load.`);\r\n            }\r\n        }\r\n    }\r\n\r\n    private baseItemsSelect: IBaseItemKey = ['Id', 'Title', 'Created', 'Modified'];\r\n    private uniqueSelect = (select: string[]) => {\r\n        if (!select?.length)\r\n            return [];\r\n        return [...new Set(select.concat(this.baseItemsSelect))];\r\n    }\r\n\r\n    public removeOData<T>(baseArr: T[]): T[] {\r\n        return baseArr?.filter(item => {\r\n            for (const key in item)\r\n                if (key?.includes('odata'))\r\n                    delete item[key];\r\n            return true;\r\n        });\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getItems<T>(identifier: string, { filters = null, expand = null, cache = null, top = null, orderBy = null, getBy = 'Title' }: IQueryOptions, ...select: string[]): Promise<T[]> {\r\n        if (!getBy)\r\n            getBy = 'Title';\r\n        const lists = this.sp.web.lists[`getBy${getBy}`](identifier);\r\n        const query = lists.items\r\n            .expand(...expand ?? [])\r\n            .select(...this.uniqueSelect(select) ?? [])\r\n            .filter(filters ?? `Id ne null`)\r\n            .orderBy(orderBy?.column ?? 'Id', orderBy?.ascending !== undefined ? orderBy.ascending : true)\r\n            .top(top || 9999999);\r\n        if (!cache)\r\n            return await query.get<T[]>();\r\n        return query.usingCaching(cache).get<T[]>();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getItem<T>(identifier: string, itemId: number, options: IQueryOptions, ...select: string[]): Promise<T> {\r\n        options = { ...options, getBy: options?.getBy ?? 'Title' }\r\n        const res = await this.getItems<T>(identifier, { ...options, filters: options?.filters ? `${options?.filters} and Id eq ${itemId}` : `Id eq ${itemId}` }, ...select);\r\n        if (res?.length > 0)\r\n            return res[0];\r\n        return null;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null })\r\n    public async saveItem<T>(listTitle: string, hash: ITypedHash<T>): Promise<IItemAddResult> {\r\n        return await this.sp.web.lists.getByTitle(listTitle).items.add(hash);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null })\r\n    public async updateItem<T>(listTitle: string, itemId: number, hash: ITypedHash<T>): Promise<IItemUpdateResult> {\r\n        return await this.sp.web.lists.getByTitle(listTitle).items.getById(itemId).update(hash);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    private async getItemByIdSelect(listTitle: string, getBy: 'Title' | 'Id' = 'Title', ...select: string[]) {\r\n        return this.sp.web.lists[`getBy${getBy}`](listTitle).items.select(...this.uniqueSelect(select)).top(9999999);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getPreviousVersions<T, R = PreviousUnion<T, IItemVersionInfo>[]>\r\n        (listTitle: string, itemId: number, { filters = null, expand = null, getBy = 'Title', orderBy }: Pick<IQueryOptions, 'filters' | 'expand' | 'getBy' | 'orderBy'>, ...select: string[]): Promise<R> {\r\n        const defaultSelect = ['IsCurrentVersion', 'Created', 'VersionId', 'VersionLabel', 'Modified'];\r\n        const orderTuple: [string, boolean] = orderBy ? [orderBy?.column, orderBy?.ascending || false] : ['Created', true];\r\n        const baseItem = await this.getItemByIdSelect(listTitle, getBy, ...select);\r\n        if (!filters) {\r\n            if (!expand)\r\n                return await baseItem.getById(itemId).versions.select(...select, ...defaultSelect)\r\n                    .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n            return await baseItem.expand(...expand).getById(itemId).versions.select(...select, ...defaultSelect).expand(...expand)\r\n                .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n        }\r\n        else {\r\n            if (!expand)\r\n                return await baseItem.getById(itemId).versions.filter(filters).select(...select, ...defaultSelect)\r\n                    .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n            return await baseItem.expand(...expand).getById(itemId).versions.select(...select, ...defaultSelect).filter(filters).expand(...expand)\r\n                .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n        }\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async deleteItem(listTitle: string, itemId: number) {\r\n        await this.sp.web.lists.getByTitle(listTitle).items.getById(itemId).delete();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return false; })\r\n    public async sendAttatchments(listName: string, itemId: number, attachments: IAttachmentFileInfo[]) {\r\n        await this.sp.web.lists.getByTitle(listName).items.getById(itemId).attachmentFiles.addMultiple(attachments);\r\n        return true;\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async addFileToLibrary(libraryUrl: string, folderUrl: string, content: File): Promise<IFileAddResult> {\r\n        const chunkSize = 40960;\r\n        const fileAddRes = await this.sp.web.getFolderByServerRelativeUrl(libraryUrl).files.addChunked(folderUrl, content, (data) => {\r\n            const percent = (data.blockNumber / data.totalBlocks);\r\n            console.log(percent);\r\n        }, true, chunkSize);\r\n        console.log(\"File upload succeded\");\r\n        return fileAddRes;\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async addMultipleFilesToLibrary(files: { name: string, content: File, libraryUrl: string }[], progressCallback?: (generalPorcentage: number, individual: { currentName: string, currentPercentage: number }) => void) {\r\n        type byte = 1000000;\r\n        const chunkSize: byte = 1000000;\r\n        const accumulatorPercent: number[] = [];\r\n        let realTotalPercentage: number = 0;\r\n        files.forEach(_ => accumulatorPercent.push(0));\r\n        const result = await Promise.allSettled(files.map((f, idx) => {\r\n            return this.sp.web.getFolderByServerRelativeUrl(f.libraryUrl).files.addChunked(f.name, f.content, (data) => {\r\n                const totalBlocks = data.fileSize <= chunkSize ? 1 : data.totalBlocks;\r\n                const individualPercentage = (data.blockNumber / totalBlocks);\r\n                if (accumulatorPercent[idx] < 1)\r\n                    accumulatorPercent[idx] = individualPercentage;\r\n                realTotalPercentage = (accumulatorPercent?.reduce((a, b) => a + b, 0) / files?.length);\r\n                if (progressCallback)\r\n                    progressCallback(realTotalPercentage, { currentName: f.name, currentPercentage: individualPercentage });\r\n            }, true, chunkSize);\r\n        }));\r\n        return {\r\n            result,\r\n            percentage: realTotalPercentage\r\n        };\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getItemAttachments(listTitle: string, itemId: number) {\r\n        return await this.sp.web.lists.getByTitle(listTitle).items.getById(itemId).attachmentFiles.get();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getCurrentUser(): Promise<ISPUser> {\r\n        const userInfo = await this.sp.web.currentUser.get() as ISPUser;\r\n        const context = await this.sp.site.getContextInfo();\r\n        const isExternal = userInfo.LoginName.includes(\"#ext#\");\r\n        userInfo.IsExternalUser = isExternal;\r\n        userInfo.ProfilePic = `${context.SiteFullUrl}/_layouts/15/userphoto.aspx?accountname=${userInfo?.Email}`;\r\n        return userInfo;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getFileItemData<T>(identifier: string, files: IFileInfo[], { expand = null, getBy = 'Id' }: IQueryOptions, ...select: string[]) {\r\n        const _files = await Promise.all(files?.map(async file => {\r\n            const fileInfo = await this.getItems<T>(identifier, { expand, filters: `FileLeafRef eq '${file?.Name}'`, getBy: getBy ?? 'Title' }, ...select);\r\n            if (fileInfo?.length >= 1)\r\n                return this.removeOData([{ ...file, data: this.removeOData(fileInfo)[0] }])[0];\r\n            return { ...file, data: null };\r\n        }));\r\n        return _files;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); })\r\n    public async hasItemPermission(list: string, itemId: number, opt: { getBy?: 'Id' | 'Title', permissionType: PermissionKind }) {\r\n        const getBy = opt?.getBy || 'Id';\r\n        const _list = this.sp.web.lists[`getBy${getBy}`](list);\r\n        const item = _list.items.getById(itemId);\r\n        const hasPermission = await item.currentUserHasPermissions(opt.permissionType);\r\n        return hasPermission;\r\n    }\r\n}","export {BaseService} from './BaseService';","module.exports = require(\"@pnp/sp\");","module.exports = require(\"catch-decorator-ts\");"],"sourceRoot":""}