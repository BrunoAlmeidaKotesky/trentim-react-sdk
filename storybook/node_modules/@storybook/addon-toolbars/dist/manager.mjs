import oe from"react";import{addons as B,types as re}from"@storybook/addons";import x from"react";import{useGlobalTypes as ee}from"@storybook/api";import{Separator as te}from"@storybook/components";import P,{useCallback as J}from"react";import{useGlobals as Q}from"@storybook/api";import{deprecate as V}from"@storybook/client-logger";import{WithTooltip as X,TooltipLinkList as Y}from"@storybook/components";import A from"react";import{Icons as R,IconButton as z}from"@storybook/components";var S=({active:o,title:t,icon:e,description:r,onClick:s})=>A.createElement(z,{active:o,title:r,onClick:s},e&&A.createElement(R,{icon:e}),t?`\xA0${t}`:null);import j,{useRef as E,useEffect as N,useCallback as h}from"react";import{useGlobals as U,useStorybookApi as _}from"@storybook/api";var $=["reset"],k=o=>o.filter(e=>!$.includes(e.type)).map(e=>e.value);var f="addon-toolbars";var M=async(o,t,e)=>{e&&e.next&&await o.setAddonShortcut(f,{label:e.next.label,defaultShortcut:e.next.keys,actionName:`${t}:next`,action:e.next.action}),e&&e.previous&&await o.setAddonShortcut(f,{label:e.previous.label,defaultShortcut:e.previous.keys,actionName:`${t}:previous`,action:e.previous.action}),e&&e.reset&&await o.setAddonShortcut(f,{label:e.reset.label,defaultShortcut:e.reset.keys,actionName:`${t}:reset`,action:e.reset.action})};var L=o=>e=>{let{id:r,toolbar:{items:s,shortcuts:p}}=e,d=_(),[I,a]=U(),i=E([]),n=I[r],m=h(()=>{a({[r]:""})},[a]),C=h(()=>{let l=i.current,y=l.indexOf(n),v=y===l.length-1?0:y+1,u=i.current[v];a({[r]:u})},[i,n,a]),b=h(()=>{let l=i.current,y=l.indexOf(n),T=y>-1?y:0,u=T===0?l.length-1:T-1,g=i.current[u];a({[r]:g})},[i,n,a]);return N(()=>{p&&M(d,r,{next:{...p.next,action:C},previous:{...p.previous,action:b},reset:{...p.reset,action:m}})},[d,r,p,C,b,m]),N(()=>{i.current=k(s)},[]),j.createElement(o,{cycleValues:i.current,...e})};var w=({currentValue:o,items:t})=>o!=null&&t.find(r=>r.value===o),D=({currentValue:o,items:t})=>{let e=w({currentValue:o,items:t});if(e)return e.icon},O=({currentValue:o,items:t})=>{let e=w({currentValue:o,items:t});if(e)return e.title};import q from"react";import{Icons as H}from"@storybook/components";var G=({left:o,right:t,title:e,value:r,icon:s,hideIcon:p,onClick:d,currentValue:I})=>{let a=s&&q.createElement(H,{style:{opacity:1},icon:s}),i=o||t||e,n={id:r||I,active:I===r,onClick:d};return o&&(n.left=o),t&&(n.right=t),e&&(n.title=e),s&&!p&&(i&&!t?n.right=a:i&&!o?n.left=a:i||(n.right=a)),n};var F=L(({id:o,name:t,description:e,toolbar:{icon:r,items:s,title:p,showName:d,preventDynamicIcon:I,dynamicTitle:a}})=>{let[i,n]=Q(),m=i[o],C=!!m,b=r,l=p;I||(b=D({currentValue:m,items:s})||b),d&&!l?(l=t,V("`showName` is deprecated as `name` will stop having dual purposes in the future. Please specify a `title` in `globalTypes` instead.")):!d&&!b&&!l&&(l=t,V(`Using the \`name\` "${t}" as toolbar title for backward compatibility. \`name\` will stop having dual purposes in the future. Please specify either a \`title\` or an \`icon\` in \`globalTypes\` instead.`)),a&&(l=O({currentValue:m,items:s})||l);let y=J(T=>{n({[o]:T})},[m,n]);return P.createElement(X,{placement:"top",trigger:"click",tooltip:({onHide:T})=>{let v=s.filter(({type:u})=>{let g=!0;return u==="reset"&&!m&&(g=!1),g}).map(u=>G({...u,currentValue:m,onClick:()=>{y(u.value),T()}}));return P.createElement(Y,{links:v})},closeOnClick:!0},P.createElement(S,{active:C,description:e||"",icon:b,title:l||""}))});var Z={type:"item",value:""},K=(o,t)=>({...t,name:t.name||o,description:t.description||o,toolbar:{...t.toolbar,items:t.toolbar.items.map(e=>{let r=typeof e=="string"?{value:e,title:e}:e;return r.type==="reset"&&t.toolbar.icon&&(r.icon=t.toolbar.icon,r.hideIcon=!0),{...Z,...r}})}});var W=()=>{let o=ee(),t=Object.keys(o).filter(e=>!!o[e].toolbar);return t.length?x.createElement(x.Fragment,null,x.createElement(te,null),t.map(e=>{let r=K(e,o[e]);return x.createElement(F,{key:e,id:e,...r})})):null};B.register(f,()=>B.add(f,{title:f,type:re.TOOL,match:()=>!0,render:()=>oe.createElement(W,null)}));
