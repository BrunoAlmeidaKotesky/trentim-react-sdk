"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const N=require("react"),n=require("./IconButton.34226127.js"),R=require("./Overlay.620ddc0e.js");require("react-dom");const Qe=e=>e&&typeof e=="object"&&"default"in e?e:{default:e};function Xe(e){if(e&&e.__esModule)return e;const r=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const a in e)if(a!=="default"){const t=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,t.get?t:{enumerable:!0,get:()=>e[a]})}}return r.default=e,Object.freeze(r)}const d=Xe(N),M=Qe(N);function Je(e){var r=d.useState(e),a=r[0],t=r[1],o=n.useConst(function(){return function(){t(!0)}}),s=n.useConst(function(){return function(){t(!1)}}),c=n.useConst(function(){return function(){t(function(u){return!u})}});return[a,{setTrue:o,setFalse:s,toggle:c}]}var et=function(e){var r=d.useRef(e);r.current=e,d.useEffect(function(){return function(){var a;(a=r.current)===null||a===void 0||a.call(r)}},[])},tt=n.memoizeFunction(function(e,r,a,t){var o,s,c,u,g,i,l,v,m,f,h,_,C,D,x=n.getStyles(e),k=n.getStyles$1(e),y=e.palette,A=e.semanticColors,U={left:4,top:4,bottom:4,right:4,border:"none"},j={root:[n.getFocusStyle(e,{inset:2,highContrastStyle:U,borderColor:"transparent"}),e.fonts.medium,{minWidth:"40px",backgroundColor:y.white,color:y.neutralPrimary,padding:"0 4px",border:"none",borderRadius:0,selectors:(o={},o[n.HighContrastSelector]={border:"none"},o)}],rootHovered:{backgroundColor:y.neutralLighter,color:y.neutralDark,selectors:(s={},s[n.HighContrastSelector]={color:"Highlight"},s["."+n.ButtonGlobalClassNames.msButtonIcon]={color:y.themeDarkAlt},s["."+n.ButtonGlobalClassNames.msButtonMenuIcon]={color:y.neutralPrimary},s)},rootPressed:{backgroundColor:y.neutralLight,color:y.neutralDark,selectors:(c={},c["."+n.ButtonGlobalClassNames.msButtonIcon]={color:y.themeDark},c["."+n.ButtonGlobalClassNames.msButtonMenuIcon]={color:y.neutralPrimary},c)},rootChecked:{backgroundColor:y.neutralLight,color:y.neutralDark,selectors:(u={},u["."+n.ButtonGlobalClassNames.msButtonIcon]={color:y.themeDark},u["."+n.ButtonGlobalClassNames.msButtonMenuIcon]={color:y.neutralPrimary},u)},rootCheckedHovered:{backgroundColor:y.neutralQuaternaryAlt,selectors:(g={},g["."+n.ButtonGlobalClassNames.msButtonIcon]={color:y.themeDark},g["."+n.ButtonGlobalClassNames.msButtonMenuIcon]={color:y.neutralPrimary},g)},rootExpanded:{backgroundColor:y.neutralLight,color:y.neutralDark,selectors:(i={},i["."+n.ButtonGlobalClassNames.msButtonIcon]={color:y.themeDark},i["."+n.ButtonGlobalClassNames.msButtonMenuIcon]={color:y.neutralPrimary},i)},rootExpandedHovered:{backgroundColor:y.neutralQuaternaryAlt},rootDisabled:{backgroundColor:y.white,selectors:(l={},l["."+n.ButtonGlobalClassNames.msButtonIcon]={color:A.disabledBodySubtext,selectors:(v={},v[n.HighContrastSelector]=n.__assign({color:"GrayText"},n.getHighContrastNoAdjustStyle()),v)},l[n.HighContrastSelector]=n.__assign({color:"GrayText",backgroundColor:"Window"},n.getHighContrastNoAdjustStyle()),l)},splitButtonContainer:{height:"100%",selectors:(m={},m[n.HighContrastSelector]={border:"none"},m)},splitButtonDividerDisabled:{selectors:(f={},f[n.HighContrastSelector]={backgroundColor:"Window"},f)},splitButtonDivider:{backgroundColor:y.neutralTertiaryAlt},splitButtonMenuButton:{backgroundColor:y.white,border:"none",borderTopRightRadius:"0",borderBottomRightRadius:"0",color:y.neutralSecondary,selectors:{":hover":{backgroundColor:y.neutralLighter,color:y.neutralDark,selectors:(h={},h[n.HighContrastSelector]={color:"Highlight"},h["."+n.ButtonGlobalClassNames.msButtonIcon]={color:y.neutralPrimary},h)},":active":{backgroundColor:y.neutralLight,selectors:(_={},_["."+n.ButtonGlobalClassNames.msButtonIcon]={color:y.neutralPrimary},_)}}},splitButtonMenuButtonDisabled:{backgroundColor:y.white,selectors:(C={},C[n.HighContrastSelector]=n.__assign({color:"GrayText",border:"none",backgroundColor:"Window"},n.getHighContrastNoAdjustStyle()),C)},splitButtonMenuButtonChecked:{backgroundColor:y.neutralLight,color:y.neutralDark,selectors:{":hover":{backgroundColor:y.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:y.neutralLight,color:y.black,selectors:{":hover":{backgroundColor:y.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:y.neutralPrimary},splitButtonMenuIconDisabled:{color:y.neutralTertiary},label:{fontWeight:"normal"},icon:{color:y.themePrimary},menuIcon:(D={color:y.neutralSecondary},D[n.HighContrastSelector]={color:"GrayText"},D)};return n.concatStyleSets(x,k,j,r)}),re=function(e){n.__extends(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.prototype.render=function(){var a=this.props,t=a.styles,o=a.theme;return d.createElement(n.BaseButton,n.__assign({},this.props,{variantClassName:"ms-Button--commandBar",styles:tt(o,t),onRenderDescription:n.nullRender}))},r=n.__decorate([n.customizable("CommandBarButton",["theme","styles"],!0)],r),r}(d.Component),ee;(function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"})(ee||(ee={}));var at=16,nt=function(){var e={};return{getCachedMeasurement:function(r){if(r&&r.cacheKey&&e.hasOwnProperty(r.cacheKey))return e[r.cacheKey]},addMeasurementToCache:function(r,a){r.cacheKey&&(e[r.cacheKey]=a)}}},ot=function(e){e===void 0&&(e=nt());var r=e,a;function t(l,v){var m=r.getCachedMeasurement(l);if(m!==void 0)return m;var f=v();return r.addMeasurementToCache(l,f),f}function o(l,v,m){for(var f=l,h=t(l,m);h>a;){var _=v(f);if(_===void 0)return{renderedData:f,resizeDirection:void 0,dataToMeasure:void 0};if(h=r.getCachedMeasurement(_),h===void 0)return{dataToMeasure:_,resizeDirection:"shrink"};f=_}return{renderedData:f,resizeDirection:void 0,dataToMeasure:void 0}}function s(l,v,m,f){for(var h=l,_=t(l,m);_<a;){var C=v(h);if(C===void 0)return{renderedData:h,resizeDirection:void 0,dataToMeasure:void 0};if(_=r.getCachedMeasurement(C),_===void 0)return{dataToMeasure:C};h=C}return n.__assign({resizeDirection:"shrink"},o(h,f,m))}function c(l,v,m,f){var h;return l>a?f?h={resizeDirection:"grow",dataToMeasure:f(m)}:h={resizeDirection:"shrink",dataToMeasure:v}:h={resizeDirection:"shrink",dataToMeasure:m},a=l,n.__assign(n.__assign({},h),{measureContainer:!1})}function u(l,v,m,f){if(!(f===void 0&&v.dataToMeasure===void 0)){if(f){if(a&&v.renderedData&&!v.dataToMeasure)return n.__assign(n.__assign({},v),c(f,l.data,v.renderedData,l.onGrowData));a=f}var h=n.__assign(n.__assign({},v),{measureContainer:!1});return v.dataToMeasure&&(v.resizeDirection==="grow"&&l.onGrowData?h=n.__assign(n.__assign({},h),s(v.dataToMeasure,l.onGrowData,m,l.onReduceData)):h=n.__assign(n.__assign({},h),o(v.dataToMeasure,l.onReduceData,m))),h}}function g(l){return!(!l||r.getCachedMeasurement(l)!==void 0)}function i(l){return{dataToMeasure:n.__assign({},l),resizeDirection:"grow",measureContainer:!0}}return{getNextState:u,shouldRenderDataForMeasurement:g,getInitialResizeGroupState:i}},rt=d.createContext({isMeasured:!1}),be={position:"fixed",visibility:"hidden"},st={position:"relative"},it="ResizeGroup";function lt(e,r){var a;switch(r.type){case"resizeData":return n.__assign({},r.value);case"dataToMeasure":return n.__assign(n.__assign({},e),{dataToMeasure:r.value,resizeDirection:"grow",measureContainer:!0});default:return n.__assign(n.__assign({},e),(a={},a[r.type]=r.value,a))}}function ut(e,r,a){var t=n.useConst(function(){return r.getInitialResizeGroupState(e.data)}),o=d.useReducer(lt,t),s=o[0],c=o[1];d.useEffect(function(){c({type:"dataToMeasure",value:e.data})},[e.data]);var u=d.useRef(t);u.current=n.__assign({},s);var g=d.useCallback(function(l){l&&c({type:"resizeData",value:l})},[]),i=d.useCallback(function(){a.current&&c({type:"measureContainer",value:!0})},[a]);return[u,g,i]}function dt(e,r){var a=n.useConst(ot),t=d.useRef(null),o=d.useRef(null),s=d.useRef(!1),c=n.useAsync(),u=ut(e,a,r),g=u[0],i=u[1],l=u[2];d.useEffect(function(){var h;g.current.renderedData&&(s.current=!0,(h=e.dataDidRender)===null||h===void 0||h.call(e,g.current.renderedData))}),d.useEffect(function(){c.requestAnimationFrame(function(){var h=void 0;if(g.current.measureContainer&&r.current){var _=r.current.getBoundingClientRect();h=e.direction===ee.vertical?_.height:_.width}var C=a.getNextState(e,g.current,function(){var D=s.current?o:t;return D.current?e.direction===ee.vertical?D.current.scrollHeight:D.current.scrollWidth:0},h);i(C)},r.current)});var v=n.useWindow();n.useOnEvent(v,"resize",c.debounce(l,at,{leading:!0}));var m=a.shouldRenderDataForMeasurement(g.current.dataToMeasure),f=!s.current&&m;return[g.current.dataToMeasure,g.current.renderedData,l,t,o,m,f]}function ct(e){process.env.NODE_ENV!=="production"&&n.useWarnings({name:it,props:e,deprecations:{styles:"className"}})}var mt={isMeasured:!0},Ie=d.forwardRef(function(e,r){var a=d.useRef(null),t=n.useMergedRefs(a,r),o=dt(e,a),s=o[0],c=o[1],u=o[2],g=o[3],i=o[4],l=o[5],v=o[6];d.useImperativeHandle(e.componentRef,function(){return{remeasure:u}},[u]),ct(e);var m=e.className,f=e.onRenderData,h=n.getNativeProps(e,n.divProperties,["data"]);return d.createElement("div",n.__assign({},h,{className:m,ref:t}),d.createElement("div",{style:st},l&&!v&&d.createElement("div",{style:be,ref:i},d.createElement(rt.Provider,{value:mt},f(s))),d.createElement("div",{ref:g,style:v?be:void 0,"data-automation-id":"visibleContent"},v?f(s):c&&f(c))))});Ie.displayName="ResizeGroupBase";var ft=Ie,De=function(e,r,a){for(var t=0,o=e;t<o.length;t++){var s=o[t],c=r.register(s,!0);a[c]=s}},Se=function(e,r){for(var a=0,t=Object.keys(r);a<t.length;a++){var o=t[a];e.unregister(r[o],o,!0),delete r[o]}},gt=function(e,r,a){var t=n.usePrevious(e);d.useEffect(function(){t&&(Se(a,t),De(r,a,e))}),d.useEffect(function(){return De(r,a,e),function(){Se(a,e)}},[])},Ne=function(e){var r=n.KeytipManager.getInstance(),a=e.className,t=e.overflowItems,o=e.keytipSequences,s=e.itemSubMenuProvider,c=e.onRenderOverflowButton,u=n.useConst({}),g=d.useCallback(function(m){if(s)return s(m);if(m.subMenuProps)return m.subMenuProps.items},[s]),i=d.useMemo(function(){var m=[],f=[];return o?t==null||t.forEach(function(h){var _,C=h.keytipProps;if(C){var D={content:C.content,keySequences:C.keySequences,disabled:C.disabled||!!(h.disabled||h.isDisabled),hasDynamicChildren:C.hasDynamicChildren,hasMenu:C.hasMenu};C.hasDynamicChildren||g(h)?(D.onExecute=r.menuExecute.bind(r,o,(_=h==null?void 0:h.keytipProps)===null||_===void 0?void 0:_.keySequences),D.hasOverflowSubMenu=!0):D.onExecute=C.onExecute,m.push(D);var x=n.__assign(n.__assign({},h),{keytipProps:n.__assign(n.__assign({},C),{overflowSetSequence:o})});f==null||f.push(x)}else f==null||f.push(h)}):f=t,{modifiedOverflowItems:f,keytipsToRegister:m}},[t,g,r,o]),l=i.modifiedOverflowItems,v=i.keytipsToRegister;return gt(u,v,r),d.createElement("div",{className:a},c(l))},vt=n.classNamesFunction(),ht="OverflowSet",yt=function(e,r){d.useImperativeHandle(e.componentRef,function(){return{focus:function(){var a=!1;return r.current&&(a=n.focusFirstChild(r.current)),a},focusElement:function(a){var t=!1;return a?(r.current&&n.elementContains(r.current,a)&&(a.focus(),t=document.activeElement===a),t):!1}}},[r])},ke=d.forwardRef(function(e,r){var a=d.useRef(null),t=n.useMergedRefs(a,r);yt(e,a);var o=e.items,s=e.overflowItems,c=e.className,u=e.styles,g=e.vertical,i=e.role,l=e.overflowSide,v=l===void 0?"end":l,m=e.onRenderItem,f=vt(u,{className:c,vertical:g}),h=!!s&&s.length>0;return d.createElement("div",n.__assign({},n.getNativeProps(e,n.divProperties),{role:i||"group","aria-orientation":i==="menubar"?g===!0?"vertical":"horizontal":void 0,className:f.root,ref:t}),v==="start"&&h&&d.createElement(Ne,n.__assign({},e,{className:f.overflowButton})),o&&o.map(function(_,C){return d.createElement("div",{className:f.item,key:_.key,role:"none"},m(_))}),v==="end"&&h&&d.createElement(Ne,n.__assign({},e,{className:f.overflowButton})))});ke.displayName=ht;var xe={flexShrink:0,display:"inherit"},_t=function(e){var r=e.className,a=e.vertical;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},a&&{flexDirection:"column"},r],item:["ms-OverflowSet-item",xe],overflowButton:["ms-OverflowSet-overflowButton",xe]}},Me=n.styled(ke,_t,void 0,{scope:"OverflowSet"}),pt=44,Ct=function(e){var r=e.className,a=e.theme,t=a.semanticColors;return{root:[a.fonts.medium,"ms-CommandBar",{display:"flex",backgroundColor:t.bodyBackground,padding:"0 14px 0 24px",height:pt},r],primarySet:["ms-CommandBar-primaryCommand",{flexGrow:"1",display:"flex",alignItems:"stretch"}],secondarySet:["ms-CommandBar-secondaryCommand",{flexShrink:"0",display:"flex",alignItems:"stretch"}]}},bt=n.memoizeFunction(function(e){var r={height:"100%"},a={whiteSpace:"nowrap"},t=e||{},o=t.root,s=t.label,c=n.__rest(t,["root","label"]);return n.__assign(n.__assign({},c),{root:o?[r,o]:r,label:s?[a,s]:a})}),Dt=n.classNamesFunction(),St=function(e){n.__extends(r,e);function r(a){var t=e.call(this,a)||this;return t._overflowSet=d.createRef(),t._resizeGroup=d.createRef(),t._onRenderData=function(o){var s=t.props,c=s.ariaLabel,u=s.primaryGroupAriaLabel,g=s.farItemsGroupAriaLabel,i=o.farItems&&o.farItems.length>0;return d.createElement(n.FocusZone,{className:n.css(t._classNames.root),direction:n.FocusZoneDirection.horizontal,role:"menubar","aria-label":c},d.createElement(Me,{role:i?"group":"none","aria-label":i?u:void 0,componentRef:t._overflowSet,className:n.css(t._classNames.primarySet),items:o.primaryItems,overflowItems:o.overflowItems.length?o.overflowItems:void 0,onRenderItem:t._onRenderItem,onRenderOverflowButton:t._onRenderOverflowButton}),i&&d.createElement(Me,{role:"group","aria-label":g,className:n.css(t._classNames.secondarySet),items:o.farItems,onRenderItem:t._onRenderItem,onRenderOverflowButton:n.nullRender}))},t._onRenderItem=function(o){if(o.onRender)return o.onRender(o,function(){});var s=o.text||o.name,c=n.__assign(n.__assign({allowDisabledFocus:!0,role:"menuitem"},o),{styles:bt(o.buttonStyles),className:n.css("ms-CommandBarItem-link",o.className),text:o.iconOnly?void 0:s,menuProps:o.subMenuProps,onClick:t._onButtonClick(o)});return o.iconOnly&&(s!==void 0||o.tooltipHostProps)?d.createElement(R.TooltipHost,n.__assign({role:"none",content:s,setAriaDescribedBy:!1},o.tooltipHostProps),t._commandButton(o,c)):t._commandButton(o,c)},t._commandButton=function(o,s){var c=t.props.buttonAs,u=o.commandBarButtonAs,g=re,i=g;return u&&(i=n.composeComponentAs(u,i)),c&&(i=n.composeComponentAs(c,i)),d.createElement(i,n.__assign({},s))},t._onRenderOverflowButton=function(o){var s=t.props.overflowButtonProps,c=s===void 0?{}:s,u=n.__spreadArray(n.__spreadArray([],c.menuProps?c.menuProps.items:[]),o),g=n.__assign(n.__assign({role:"menuitem"},c),{styles:n.__assign({menuIcon:{fontSize:"17px"}},c.styles),className:n.css("ms-CommandBar-overflowButton",c.className),menuProps:n.__assign(n.__assign({},c.menuProps),{items:u}),menuIconProps:n.__assign({iconName:"More"},c.menuIconProps)}),i=t.props.overflowButtonAs?n.composeComponentAs(t.props.overflowButtonAs,re):re;return d.createElement(i,n.__assign({},g))},t._onReduceData=function(o){var s=t.props,c=s.shiftOnReduce,u=s.onDataReduced,g=o.primaryItems,i=o.overflowItems,l=o.cacheKey,v=g[c?0:g.length-1];if(v!==void 0){v.renderedInOverflow=!0,i=n.__spreadArray([v],i),g=c?g.slice(1):g.slice(0,-1);var m=n.__assign(n.__assign({},o),{primaryItems:g,overflowItems:i});return l=t._computeCacheKey({primaryItems:g,overflow:i.length>0}),u&&u(v),m.cacheKey=l,m}},t._onGrowData=function(o){var s=t.props,c=s.shiftOnReduce,u=s.onDataGrown,g=o.minimumOverflowItems,i=o.primaryItems,l=o.overflowItems,v=o.cacheKey,m=l[0];if(m!==void 0&&l.length>g){m.renderedInOverflow=!1,l=l.slice(1),i=c?n.__spreadArray([m],i):n.__spreadArray(n.__spreadArray([],i),[m]);var f=n.__assign(n.__assign({},o),{primaryItems:i,overflowItems:l});return v=t._computeCacheKey({primaryItems:i,overflow:l.length>0}),u&&u(m),f.cacheKey=v,f}},n.initializeComponentRef(t),t}return r.prototype.render=function(){var a=this.props,t=a.items,o=a.overflowItems,s=a.farItems,c=a.styles,u=a.theme,g=a.dataDidRender,i=a.onReduceData,l=i===void 0?this._onReduceData:i,v=a.onGrowData,m=v===void 0?this._onGrowData:v,f=a.resizeGroupAs,h=f===void 0?ft:f,_={primaryItems:n.__spreadArray([],t),overflowItems:n.__spreadArray([],o),minimumOverflowItems:n.__spreadArray([],o).length,farItems:s,cacheKey:this._computeCacheKey({primaryItems:n.__spreadArray([],t),overflow:o&&o.length>0})};this._classNames=Dt(c,{theme:u});var C=n.getNativeProps(this.props,n.divProperties);return d.createElement(h,n.__assign({},C,{componentRef:this._resizeGroup,data:_,onReduceData:l,onGrowData:m,onRenderData:this._onRenderData,dataDidRender:g}))},r.prototype.focus=function(){var a=this._overflowSet.current;a&&a.focus()},r.prototype.remeasure=function(){this._resizeGroup.current&&this._resizeGroup.current.remeasure()},r.prototype._onButtonClick=function(a){return function(t){a.inactive||a.onClick&&a.onClick(t,a)}},r.prototype._computeCacheKey=function(a){var t=a.primaryItems,o=a.overflow,s=function(g,i){var l=i.cacheKey,v=l===void 0?i.key:l;return g+v},c=t&&t.reduce(s,""),u=o?"overflow":"";return[c,u].join("")},r.defaultProps={items:[],overflowItems:[]},r}(d.Component),we=n.styled(St,Ct,void 0,{scope:"CommandBar"}),F;(function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"})(F||(F={}));var Be=n.AnimationVariables.durationValue2,Nt={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},xt=function(e){var r,a=e.className,t=e.containerClassName,o=e.scrollableContentClassName,s=e.isOpen,c=e.isVisible,u=e.hasBeenOpened,g=e.modalRectangleTop,i=e.theme,l=e.topOffsetFixed,v=e.isModeless,m=e.layerClassName,f=e.isDefaultDragHandle,h=e.windowInnerHeight,_=i.palette,C=i.effects,D=i.fonts,x=n.getGlobalClassNames(Nt,i);return{root:[x.root,D.medium,{backgroundColor:"transparent",position:v?"absolute":"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity "+Be},l&&typeof g=="number"&&u&&{alignItems:"flex-start"},s&&x.isOpen,c&&{opacity:1,pointerEvents:"auto"},a],main:[x.main,{boxShadow:C.elevation64,borderRadius:C.roundedCorner2,backgroundColor:_.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:v?n.ZIndexes.Layer:void 0},l&&typeof g=="number"&&u&&{top:g},f&&{cursor:"move"},t],scrollableContent:[x.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(r={},r["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:h},r)},o],layer:v&&[m,x.layer,{position:"static",width:"unset",height:"unset"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:D.xLargePlus.fontSize,width:"24px"}}},Mt=n.memoizeFunction(function(e,r){return{root:n.mergeStyles(e,r&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),V={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},It=function(e){n.__extends(r,e);function r(a){var t=e.call(this,a)||this;return t._currentEventType=V.mouse,t._events=[],t._onMouseDown=function(o){var s=d.Children.only(t.props.children).props.onMouseDown;return s&&s(o),t._currentEventType=V.mouse,t._onDragStart(o)},t._onMouseUp=function(o){var s=d.Children.only(t.props.children).props.onMouseUp;return s&&s(o),t._currentEventType=V.mouse,t._onDragStop(o)},t._onTouchStart=function(o){var s=d.Children.only(t.props.children).props.onTouchStart;return s&&s(o),t._currentEventType=V.touch,t._onDragStart(o)},t._onTouchEnd=function(o){var s=d.Children.only(t.props.children).props.onTouchEnd;s&&s(o),t._currentEventType=V.touch,t._onDragStop(o)},t._onDragStart=function(o){if(typeof o.button=="number"&&o.button!==0)return!1;if(!(t.props.handleSelector&&!t._matchesSelector(o.target,t.props.handleSelector)||t.props.preventDragSelector&&t._matchesSelector(o.target,t.props.preventDragSelector))){t._touchId=t._getTouchId(o);var s=t._getControlPosition(o);if(s!==void 0){var c=t._createDragDataFromPosition(s);t.props.onStart&&t.props.onStart(o,c),t.setState({isDragging:!0,lastPosition:s}),t._events=[n.on(document.body,t._currentEventType.move,t._onDrag,!0),n.on(document.body,t._currentEventType.stop,t._onDragStop,!0)]}}},t._onDrag=function(o){o.type==="touchmove"&&o.preventDefault();var s=t._getControlPosition(o);if(!!s){var c=t._createUpdatedDragData(t._createDragDataFromPosition(s)),u=c.position;t.props.onDragChange&&t.props.onDragChange(o,c),t.setState({position:u,lastPosition:s})}},t._onDragStop=function(o){if(!!t.state.isDragging){var s=t._getControlPosition(o);if(!!s){var c=t._createDragDataFromPosition(s);t.setState({isDragging:!1,lastPosition:void 0}),t.props.onStop&&t.props.onStop(o,c),t.props.position&&t.setState({position:t.props.position}),t._events.forEach(function(u){return u()})}}},t.state={isDragging:!1,position:t.props.position||{x:0,y:0},lastPosition:void 0},t}return r.prototype.componentDidUpdate=function(a){this.props.position&&(!a.position||this.props.position!==a.position)&&this.setState({position:this.props.position})},r.prototype.componentWillUnmount=function(){this._events.forEach(function(a){return a()})},r.prototype.render=function(){var a=d.Children.only(this.props.children),t=a.props,o=this.props.position,s=this.state,c=s.position,u=s.isDragging,g=c.x,i=c.y;return o&&!u&&(g=o.x,i=o.y),d.cloneElement(a,{style:n.__assign(n.__assign({},t.style),{transform:"translate("+g+"px, "+i+"px)"}),className:Mt(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},r.prototype._getControlPosition=function(a){var t=this._getActiveTouch(a);if(!(this._touchId!==void 0&&!t)){var o=t||a;return{x:o.clientX,y:o.clientY}}},r.prototype._getActiveTouch=function(a){return a.targetTouches&&this._findTouchInTouchList(a.targetTouches)||a.changedTouches&&this._findTouchInTouchList(a.changedTouches)},r.prototype._getTouchId=function(a){var t=a.targetTouches&&a.targetTouches[0]||a.changedTouches&&a.changedTouches[0];if(t)return t.identifier},r.prototype._matchesSelector=function(a,t){if(!a||a===document.body)return!1;var o=a.matches||a.webkitMatchesSelector||a.msMatchesSelector;return o?o.call(a,t)||this._matchesSelector(a.parentElement,t):!1},r.prototype._findTouchInTouchList=function(a){if(this._touchId!==void 0){for(var t=0;t<a.length;t++)if(a[t].identifier===this._touchId)return a[t]}},r.prototype._createDragDataFromPosition=function(a){var t=this.state.lastPosition;return t===void 0?{delta:{x:0,y:0},lastPosition:a,position:a}:{delta:{x:a.x-t.x,y:a.y-t.y},lastPosition:t,position:a}},r.prototype._createUpdatedDragData=function(a){var t=this.state.position;return{position:{x:t.x+a.delta.x,y:t.y+a.delta.y},delta:a.delta,lastPosition:t}},r}(d.Component),$={x:0,y:0},kt={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:""},wt=n.classNamesFunction(),Bt=function(e){var r=10;return e.shiftKey?e.ctrlKey||(r=50):e.ctrlKey&&(r=1),r},Tt=function(e,r){d.useImperativeHandle(e.componentRef,function(){return{focus:function(){r.current&&r.current.focus()}}},[r])},Te=d.forwardRef(function(e,r){var a=n.getPropsWithDefaults(kt,e),t=a.allowTouchBodyScroll,o=a.className,s=a.children,c=a.containerClassName,u=a.scrollableContentClassName,g=a.elementToFocusOnDismiss,i=a.firstFocusableSelector,l=a.forceFocusInsideTrap,v=a.ignoreExternalFocusing,m=a.isBlocking,f=a.isAlert,h=a.isClickableOutsideFocusTrap,_=a.isDarkOverlay,C=a.onDismiss,D=a.layerProps,x=a.overlay,k=a.isOpen,y=a.titleAriaId,A=a.styles,U=a.subtitleAriaId,j=a.theme,Y=a.topOffsetFixed,te=a.responsiveMode,ae=a.onLayerDidMount,B=a.isModeless,I=a.dragOptions,w=a.onDismissed,q=a.enableAriaHiddenSiblings,Z=d.useRef(null),P=d.useRef(null),E=d.useRef(null),Q=n.useMergedRefs(Z,r),X=n.useResponsiveMode(Q),se=n.useId("ModalFocusTrapZone"),H=n.useWindow(),ie=R.useSetTimeout(),le=ie.setTimeout,Re=ie.clearTimeout,ue=d.useState(k),ne=ue[0],de=ue[1],ce=d.useState(k),Fe=ce[0],me=ce[1],fe=d.useState($),ge=fe[0],z=fe[1],ve=d.useState(),Ae=ve[0],He=ve[1],he=Je(!1),ye=he[0],_e=he[1],ze=_e.toggle,G=_e.setFalse,p=n.useConst(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:t,scrollableContent:null,lastSetCoordinates:$,events:new n.EventGroup({})}}),oe=(I||{}).keepInBounds,Ke=f!=null?f:m&&!B,Le=D===void 0?"":D.className,W=wt(A,{theme:j,className:o,containerClassName:c,scrollableContentClassName:u,isOpen:k,isVisible:Fe,hasBeenOpened:p.hasBeenOpened,modalRectangleTop:Ae,topOffsetFixed:Y,isModeless:B,layerClassName:Le,windowInnerHeight:H==null?void 0:H.innerHeight,isDefaultDragHandle:I&&!I.dragHandleSelector}),Ge=n.__assign(n.__assign({eventBubblingEnabled:!1},D),{onLayerDidMount:D&&D.onLayerDidMount?D.onLayerDidMount:ae,insertFirst:B,className:W.layer}),We=d.useCallback(function(S){S?p.allowTouchBodyScroll?n.allowOverscrollOnElement(S,p.events):n.allowScrollOnElement(S,p.events):p.events.off(p.scrollableContent),p.scrollableContent=S},[p]),$e=function(){var S=E.current,b=S==null?void 0:S.getBoundingClientRect();b&&(Y&&He(b.top),oe&&(p.minPosition={x:-b.left,y:-b.top},p.maxPosition={x:b.left,y:b.top}))},K=d.useCallback(function(S,b){var O=p.minPosition,L=p.maxPosition;return oe&&O&&L&&(b=Math.max(O[S],b),b=Math.min(L[S],b)),b},[oe,p]),pe=function(){var S;p.lastSetCoordinates=$,G(),p.isInKeyboardMoveMode=!1,de(!1),z($),(S=p.disposeOnKeyUp)===null||S===void 0||S.call(p),w==null||w()},Ue=d.useCallback(function(){G(),p.isInKeyboardMoveMode=!1},[p,G]),je=d.useCallback(function(S,b){z(function(O){return{x:K("x",O.x+b.delta.x),y:K("y",O.y+b.delta.y)}})},[K]),qe=d.useCallback(function(){P.current&&P.current.focus()},[]),Ze=function(){var S=function(b){if(b.altKey&&b.ctrlKey&&b.keyCode===n.KeyCodes.space){b.preventDefault(),b.stopPropagation();return}if(ye&&(b.altKey||b.keyCode===n.KeyCodes.escape)&&G(),p.isInKeyboardMoveMode&&(b.keyCode===n.KeyCodes.escape||b.keyCode===n.KeyCodes.enter)&&(p.isInKeyboardMoveMode=!1,b.preventDefault(),b.stopPropagation()),p.isInKeyboardMoveMode){var O=!0,L=Bt(b);switch(b.keyCode){case n.KeyCodes.escape:z(p.lastSetCoordinates);case n.KeyCodes.enter:{p.lastSetCoordinates=$;break}case n.KeyCodes.up:{z(function(T){return{x:T.x,y:K("y",T.y-L)}});break}case n.KeyCodes.down:{z(function(T){return{x:T.x,y:K("y",T.y+L)}});break}case n.KeyCodes.left:{z(function(T){return{x:K("x",T.x-L),y:T.y}});break}case n.KeyCodes.right:{z(function(T){return{x:K("x",T.x+L),y:T.y}});break}default:O=!1}O&&(b.preventDefault(),b.stopPropagation())}};p.lastSetCoordinates=ge,G(),p.isInKeyboardMoveMode=!0,p.events.on(H,"keydown",S,!0),p.disposeOnKeyDown=function(){p.events.off(H,"keydown",S,!0),p.disposeOnKeyDown=void 0}},Ve=function(){var S;p.lastSetCoordinates=$,p.isInKeyboardMoveMode=!1,(S=p.disposeOnKeyDown)===null||S===void 0||S.call(p)},Ye=function(){var S=function(b){b.altKey&&b.ctrlKey&&b.keyCode===n.KeyCodes.space&&n.elementContains(p.scrollableContent,b.target)&&(ze(),b.preventDefault(),b.stopPropagation())};p.disposeOnKeyUp||(p.events.on(H,"keyup",S,!0),p.disposeOnKeyUp=function(){p.events.off(H,"keyup",S,!0),p.disposeOnKeyUp=void 0})};d.useEffect(function(){Re(p.onModalCloseTimer),k&&(requestAnimationFrame(function(){return le($e,0)}),de(!0),I&&Ye(),p.hasBeenOpened=!0,me(!0)),!k&&ne&&(p.onModalCloseTimer=le(pe,parseFloat(Be)*1e3),me(!1))},[ne,k]),et(function(){p.events.dispose()}),Tt(a,P),Pt(a);var Ce=d.createElement(R.FocusTrapZone,{id:se,ref:E,componentRef:P,className:W.main,elementToFocusOnDismiss:g,isClickableOutsideFocusTrap:B||h||!m,ignoreExternalFocusing:v,forceFocusInsideTrap:B?!B:l,firstFocusableSelector:i,focusPreviouslyFocusedInnerElement:!0,onBlur:p.isInKeyboardMoveMode?Ve:void 0,enableAriaHiddenSiblings:q},I&&p.isInKeyboardMoveMode&&d.createElement("div",{className:W.keyboardMoveIconContainer},I.keyboardMoveIconProps?d.createElement(n.Icon,n.__assign({},I.keyboardMoveIconProps)):d.createElement(n.Icon,{iconName:"move",className:W.keyboardMoveIcon})),d.createElement("div",{ref:We,className:W.scrollableContent,"data-is-scrollable":!0},I&&ye&&d.createElement(I.menu,{items:[{key:"move",text:I.moveMenuItemText,onClick:Ze},{key:"close",text:I.closeMenuItemText,onClick:pe}],onDismiss:G,alignTargetEdge:!0,coverTarget:!0,directionalHint:n.DirectionalHint.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:p.scrollableContent}),s));return ne&&X>=(te||n.ResponsiveMode.small)&&d.createElement(n.Layer,n.__assign({ref:Q},Ge),d.createElement(n.Popup,{role:Ke?"alertdialog":"dialog","aria-modal":!B,ariaLabelledBy:y,ariaDescribedBy:U,onDismiss:C,shouldRestoreFocus:!v},d.createElement("div",{className:W.root,role:B?void 0:"document"},!B&&d.createElement(R.Overlay,n.__assign({"aria-hidden":!0,isDarkThemed:_,onClick:m?void 0:C,allowTouchBodyScroll:t},x)),I?d.createElement(It,{handleSelector:I.dragHandleSelector||"#"+se,preventDragSelector:"button",onStart:Ue,onDragChange:je,onStop:qe,position:ge},Ce):Ce)))||null});Te.displayName="Modal";function Pt(e){process.env.NODE_ENV!=="production"&&n.useWarnings({name:"Modal",props:e,deprecations:{onLayerDidMount:"layerProps.onLayerDidMount"}})}var Pe=n.styled(Te,xt,void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});Pe.displayName="Modal";var Et=n.classNamesFunction(),Ot=function(e){n.__extends(r,e);function r(a){var t=e.call(this,a)||this;return n.initializeComponentRef(t),t}return r.prototype.render=function(){var a=this.props,t=a.className,o=a.styles,s=a.theme;return this._classNames=Et(o,{theme:s,className:t}),d.createElement("div",{className:this._classNames.actions},d.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},r.prototype._renderChildrenAsActions=function(){var a=this;return d.Children.map(this.props.children,function(t){return t?d.createElement("span",{className:a._classNames.action},t):null})},r}(d.Component),Rt={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},Ft=function(e){var r=e.className,a=e.theme,t=n.getGlobalClassNames(Rt,a);return{actions:[t.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},r],action:[t.action,{margin:"0 4px"}],actionsRight:[t.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}},Ee=n.styled(Ot,Ft,void 0,{scope:"DialogFooter"}),At=n.classNamesFunction(),Ht=d.createElement(Ee,null).type,zt="DialogContent",Kt=function(e){n.__extends(r,e);function r(a){var t=e.call(this,a)||this;return n.initializeComponentRef(t),n.warnDeprecations(zt,a,{titleId:"titleProps.id"}),t}return r.prototype.render=function(){var a=this.props,t=a.showCloseButton,o=a.className,s=a.closeButtonAriaLabel,c=a.onDismiss,u=a.subTextId,g=a.subText,i=a.titleProps,l=i===void 0?{}:i,v=a.titleId,m=a.title,f=a.type,h=a.styles,_=a.theme,C=a.draggableHeaderClassName,D=At(h,{theme:_,className:o,isLargeHeader:f===F.largeHeader,isClose:f===F.close,draggableHeaderClassName:C}),x=this._groupChildren(),k;return g&&(k=d.createElement("p",{className:D.subText,id:u},g)),d.createElement("div",{className:D.content},d.createElement("div",{className:D.header},d.createElement("div",n.__assign({id:v,role:"heading","aria-level":1},l,{className:n.css(D.title,l.className)}),m),d.createElement("div",{className:D.topButton},this.props.topButtonsProps.map(function(y,A){return d.createElement(n.IconButton,n.__assign({key:y.uniqueId||A},y))}),(f===F.close||t&&f!==F.largeHeader)&&d.createElement(n.IconButton,{className:D.button,iconProps:{iconName:"Cancel"},ariaLabel:s,onClick:c}))),d.createElement("div",{className:D.inner},d.createElement("div",{className:D.innerContent},k,x.contents),x.footers))},r.prototype._groupChildren=function(){var a={footers:[],contents:[]};return d.Children.map(this.props.children,function(t){typeof t=="object"&&t!==null&&t.type===Ht?a.footers.push(t):a.contents.push(t)}),a},r.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},r=n.__decorate([n.withResponsiveMode],r),r}(d.Component),Lt={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},Gt=function(e){var r,a,t,o=e.className,s=e.theme,c=e.isLargeHeader,u=e.isClose,g=e.hidden,i=e.isMultiline,l=e.draggableHeaderClassName,v=s.palette,m=s.fonts,f=s.effects,h=s.semanticColors,_=n.getGlobalClassNames(Lt,s);return{content:[c&&[_.contentLgHeader,{borderTop:"4px solid "+v.themePrimary}],u&&_.close,{flexGrow:1,overflowY:"hidden"},o],subText:[_.subText,m.medium,{margin:"0 0 24px 0",color:h.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:n.FontWeights.regular}],header:[_.header,{position:"relative",width:"100%",boxSizing:"border-box"},u&&_.close,l&&[l,{cursor:"move"}]],button:[_.button,g&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:h.buttonText,fontSize:n.IconFontSizes.medium}}}],inner:[_.inner,{padding:"0 24px 24px",selectors:(r={},r["@media (min-width: "+n.ScreenWidthMinSmall+"px) and (max-width: "+n.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},r)}],innerContent:[_.content,{position:"relative",width:"100%"}],title:[_.title,m.xLarge,{color:h.bodyText,margin:"0",minHeight:m.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(a={},a["@media (min-width: "+n.ScreenWidthMinSmall+"px) and (max-width: "+n.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},a)},c&&{color:h.menuHeader},i&&{fontSize:m.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(t={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:h.buttonText},".ms-Dialog-button:hover":{color:h.buttonTextHovered,borderRadius:f.roundedCorner2}},t["@media (min-width: "+n.ScreenWidthMinSmall+"px) and (max-width: "+n.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},t)}]}},Wt=n.styled(Kt,Gt,void 0,{scope:"DialogContent"}),$t=n.classNamesFunction(),Ut={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},jt={type:F.normal,className:"",topButtonsProps:[]},qt=function(e){n.__extends(r,e);function r(a){var t=e.call(this,a)||this;return t._getSubTextId=function(){var o=t.props,s=o.ariaDescribedById,c=o.modalProps,u=o.dialogContentProps,g=o.subText,i=c&&c.subtitleAriaId||s;return i||(i=(u&&u.subText||g)&&t._defaultSubTextId),i},t._getTitleTextId=function(){var o=t.props,s=o.ariaLabelledById,c=o.modalProps,u=o.dialogContentProps,g=o.title,i=c&&c.titleAriaId||s;return i||(i=(u&&u.title||g)&&t._defaultTitleTextId),i},t._id=n.getId("Dialog"),t._defaultTitleTextId=t._id+"-title",t._defaultSubTextId=t._id+"-subText",process.env.NODE_ENV!=="production"&&n.warnDeprecations("Dialog",a,{isOpen:"hidden",type:"dialogContentProps.type",subText:"dialogContentProps.subText",contentClassName:"dialogContentProps.className",topButtonsProps:"dialogContentProps.topButtonsProps",className:"modalProps.className",isDarkOverlay:"modalProps.isDarkOverlay",isBlocking:"modalProps.isBlocking",containerClassName:"modalProps.containerClassName",onDismissed:"modalProps.onDismissed",onLayerDidMount:"modalProps.layerProps.onLayerDidMount",ariaDescribedById:"modalProps.subtitleAriaId",ariaLabelledById:"modalProps.titleAriaId"}),t}return r.prototype.render=function(){var a,t,o=this.props,s=o.className,c=o.containerClassName,u=o.contentClassName,g=o.elementToFocusOnDismiss,i=o.firstFocusableSelector,l=o.forceFocusInsideTrap,v=o.styles,m=o.hidden,f=o.ignoreExternalFocusing,h=o.isBlocking,_=o.isClickableOutsideFocusTrap,C=o.isDarkOverlay,D=o.isOpen,x=o.onDismiss,k=o.onDismissed,y=o.onLayerDidMount,A=o.responsiveMode,U=o.subText,j=o.theme,Y=o.title,te=o.topButtonsProps,ae=o.type,B=o.minWidth,I=o.maxWidth,w=o.modalProps,q=n.__assign({},w?w.layerProps:{onLayerDidMount:y});y&&!q.onLayerDidMount&&(q.onLayerDidMount=y);var Z,P;w&&w.dragOptions&&!w.dragOptions.dragHandleSelector?(Z="ms-Dialog-draggable-header",P=n.__assign(n.__assign({},w.dragOptions),{dragHandleSelector:"."+Z})):P=w&&w.dragOptions;var E=n.__assign(n.__assign(n.__assign(n.__assign({},Ut),{className:s,containerClassName:c,isBlocking:h,isDarkOverlay:C,onDismissed:k}),w),{layerProps:q,dragOptions:P}),Q=n.__assign(n.__assign(n.__assign({className:u,subText:U,title:Y,topButtonsProps:te,type:ae},jt),this.props.dialogContentProps),{draggableHeaderClassName:Z,titleProps:n.__assign({id:((a=this.props.dialogContentProps)===null||a===void 0?void 0:a.titleId)||this._defaultTitleTextId},(t=this.props.dialogContentProps)===null||t===void 0?void 0:t.titleProps)}),X=$t(v,{theme:j,className:E.className,containerClassName:E.containerClassName,hidden:m,dialogDefaultMinWidth:B,dialogDefaultMaxWidth:I});return d.createElement(Pe,n.__assign({elementToFocusOnDismiss:g,firstFocusableSelector:i,forceFocusInsideTrap:l,ignoreExternalFocusing:f,isClickableOutsideFocusTrap:_,responsiveMode:A},E,{isOpen:D!==void 0?D:!m,className:X.root,containerClassName:X.main,onDismiss:x||E.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),d.createElement(Wt,n.__assign({subTextId:this._defaultSubTextId,showCloseButton:E.isBlocking,onDismiss:x},Q),this.props.children))},r.defaultProps={hidden:!0},r=n.__decorate([n.withResponsiveMode],r),r}(d.Component),Zt={root:"ms-Dialog"},Vt=function(e){var r,a=e.className,t=e.containerClassName,o=e.dialogDefaultMinWidth,s=o===void 0?"288px":o,c=e.dialogDefaultMaxWidth,u=c===void 0?"340px":c,g=e.hidden,i=e.theme,l=n.getGlobalClassNames(Zt,i);return{root:[l.root,i.fonts.medium,a],main:[{width:s,outline:"3px solid transparent",selectors:(r={},r["@media (min-width: "+n.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:u,minWidth:s},r)},!g&&{display:"flex"},t]}},Oe=n.styled(qt,Vt,void 0,{scope:"Dialog"});Oe.displayName="Dialog";const Yt="_stickerCardContainer_5cqs9_1",Qt="_stickerCardItem_5cqs9_9",Xt="_cardItemStickerWrapper_5cqs9_17",Jt="_cardStickerWrapper_5cqs9_38",J={stickerCardContainer:Yt,stickerCardItem:Qt,cardItemStickerWrapper:Xt,cardStickerWrapper:Jt},ea=e=>{const r=N.useMemo(()=>"#333!important",[]),a=N.useMemo(()=>({root:{background:"0 0",backgroundColor:"transparent",color:r},icon:{color:r},labelDisabled:{color:r},rootHovered:{background:"0 0",backgroundColor:"transparent"},rootPressed:{background:"0 0",backgroundColor:"transparent"}}),[]),t=N.useCallback(()=>{const o=[{key:e.title,text:e.title,iconProps:{iconName:e.icon,color:r,styles:{root:{color:r}}},canCheck:!1,disabled:!0,buttonStyles:a}];return e!=null&&e.isEditModeEnabled&&o.push({key:"addSticker",text:e.addTitle,ariaLabel:e.addTitle,iconOnly:!0,iconProps:{iconName:"Add",style:{color:r}},buttonStyles:a,onClick:e.onAddSticker}),o},[e]);return M.default.createElement("div",{className:e==null?void 0:e.className,style:{backgroundColor:e.backgroundColor}},M.default.createElement(we,{styles:{root:{padding:"0 12px",background:"0 0",height:"40px"},primarySet:{justifyContent:"space-between"}},items:t()}))};function ta(e){const[r,a]=N.useState(e==null?void 0:e.stickers);N.useEffect(()=>a(e==null?void 0:e.stickers),[e.stickers]);const t=N.useCallback(u=>{a(r==null?void 0:r.filter(g=>{const i=g.id!==u.id;return!i&&(e==null?void 0:e.onBeforeDeleteSticker)&&e.onBeforeDeleteSticker(g),i}))},[r,e==null?void 0:e.onBeforeDeleteSticker]),o=N.useCallback(()=>{const u=(r==null?void 0:r.length)>0?r[(r==null?void 0:r.length)-1]:null;let g=1;u&&(g=u.order+1);let i={id:g,title:null,order:g,data:null,renderedOnce:!0};e!=null&&e.onBeforeAddSticker&&(i={...e.onBeforeAddSticker(i),renderedOnce:!0});const l=[...r,i];a(l),e!=null&&e.onStickerAdded&&e.onStickerAdded(l,(l==null?void 0:l.length)===1?0:(l==null?void 0:l.length)-1)},[r,e==null?void 0:e.onStickerAdded,e==null?void 0:e.onBeforeAddSticker]),s=N.useCallback(u=>{const g=r.map(i=>((i==null?void 0:i.id)===(u==null?void 0:u.id)&&(i=u,(e==null?void 0:e.onStickerChanged)&&(u==null?void 0:u.title)!==null&&(u==null?void 0:u.title)!==void 0&&e.onStickerChanged(i)),i));a(g)},[r,e==null?void 0:e.onStickerChanged]),c=N.useCallback((u,g)=>{const i=[...r],l=i.find(m=>(m==null?void 0:m.id)===(u==null?void 0:u.id));if(g==="up"){const m=i.find(f=>(f==null?void 0:f.order)===(u==null?void 0:u.order)-1);if(m){const f=m.order;m.order=u.order,l.order=f}}else{const m=i.find(f=>(f==null?void 0:f.order)===(u==null?void 0:u.order)+1);if(m){const f=m.order;m.order=u.order,l.order=f}}const v=[...i].sort((m,f)=>(m==null?void 0:m.order)-(f==null?void 0:f.order));a(v),e!=null&&e.onStickerOrderChanged&&e.onStickerOrderChanged(v,u)},[r,e==null?void 0:e.onStickerOrderChanged]);return{deleteSticker:t,updateSticker:s,addSticker:o,changeOrder:c,stickersState:r}}const aa=({sticker:e,onChange:r,onChangeOrder:a,onDelete:t,isEditEnabled:o,stickerBgColor:s,renderedNow:c,styles:u})=>{const[g,i]=N.useState(o?c:!1),[l,v]=N.useState(e),[m,f]=N.useState(!1);N.useEffect(()=>{v(e)},[e]),N.useEffect(()=>{r(l)},[l]),N.useEffect(()=>{var C;const _=document.documentElement;(C=_==null?void 0:_.style)==null||C.setProperty("--card-sticker-wrapper-bgcolor",s!=null?s:"#feffb7")},[s]);const h=N.useMemo(()=>o?[{key:"edit",text:"Editar",onClick:()=>i(!0),iconProps:{iconName:"Edit"}},{key:"up",text:"Mover para cima",onClick:()=>a(l,"up"),iconProps:{iconName:"SortUp"}},{key:"down",text:"Mover para baixo",onClick:()=>a(l,"down"),iconProps:{iconName:"SortDown"}},{key:"delete",text:"Deletar",onClick:()=>f(!0),iconProps:{iconName:"Delete"}}]:[],[o,m,g,l]);return M.default.createElement("div",{className:u.cardStickerWrapper},g?M.default.createElement(R.TextField,{autoFocus:!0,multiline:!0,rows:4,onChange:(_,C)=>v({...l,title:C}),value:l==null?void 0:l.title,onFocus:()=>{!g&&i(!0)},onBlur:()=>i(!1)}):M.default.createElement(M.default.Fragment,null,M.default.createElement(we,{styles:{root:{backgroundColor:"transparent",padding:0}},overflowButtonProps:{ariaLabel:"Mais a\xE7\xF5es",menuProps:{items:[],isBeakVisible:!0,beakWidth:20,gapSpace:10,directionalHint:n.DirectionalHint.topCenter,styles:{root:{background:"transparent"}}},menuIconProps:{iconName:"MoreVertical",styles:{root:{background:"transparent"}}},styles:{root:{backgroundColor:"transparent"}}},items:[],overflowItems:h,farItems:[],ariaLabel:"Use left and right arrow keys to navigate between commands"}),M.default.createElement(R.TextField,{className:"not-editable",multiline:!0,styles:{root:{backgroundColor:s!=null?s:"#feffb7"},fieldGroup:{backgroundColor:s!=null?s:"#feffb7"}},rows:4,value:l==null?void 0:l.title,readOnly:!0,borderless:!0}),M.default.createElement(Oe,{hidden:!m,onDismiss:()=>f(!1),dialogContentProps:{type:F.normal,title:"Deletar item",closeButtonAriaLabel:"Fechar",subText:"Tem certeza que deseja deletar esse item?"}},M.default.createElement(Ee,null,M.default.createElement(R.PrimaryButton,{text:"Sim",onClick:()=>{t(l),f(!1)}}),M.default.createElement(R.DefaultButton,{onClick:()=>f(!1),text:"N\xE3o"})))))},na=N.memo(aa);function oa(e){var u,g,i,l;N.useEffect(()=>{var m,f;const v=document.documentElement;(f=v==null?void 0:v.style)==null||f.setProperty("--sticker-card-item-bgcolor",(m=e==null?void 0:e.cardBgColor)!=null?m:"#fff")},[e.cardBgColor]);const{addSticker:r,changeOrder:a,deleteSticker:t,updateSticker:o,stickersState:s}=ta(e),c=N.useMemo(()=>e.headerProps,[e==null?void 0:e.headerProps]);return M.default.createElement("div",{className:`${J.stickerCardContainer} ${(u=e==null?void 0:e.classNames)==null?void 0:u.root}`},M.default.createElement("div",{className:`${J.stickerCardItem} ${(g=e==null?void 0:e.classNames)==null?void 0:g.rootFirstChild}`},M.default.createElement(ea,{className:(i=e==null?void 0:e.classNames)==null?void 0:i.header,isEditModeEnabled:e.isEditModeEnabled,onAddSticker:()=>{r()},...c}),M.default.createElement("div",{className:`${J.cardItemStickerWrapper} ${(l=e==null?void 0:e.classNames)==null?void 0:l.cardBodyWrapper}`},(s==null?void 0:s.length)>0?[...s].sort((v,m)=>(v==null?void 0:v.order)-(m==null?void 0:m.order)).map(v=>{var m;return M.default.createElement(na,{stickerClassName:(m=e==null?void 0:e.classNames)==null?void 0:m.cardStickerItem,stickerBgColor:e==null?void 0:e.stickerBgColor,sticker:v,styles:J,renderedNow:v.renderedOnce,key:v==null?void 0:v.id,isEditEnabled:e==null?void 0:e.isEditModeEnabled,onChange:o,onDelete:t,onChangeOrder:a})}):e.onNoItemsRender?e.onNoItemsRender():M.default.createElement("span",{style:{color:"#333"}},"No items"))))}exports.StickerCard=oa;
