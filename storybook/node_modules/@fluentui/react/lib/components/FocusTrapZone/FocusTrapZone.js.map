{"version":3,"file":"FocusTrapZone.js","sourceRoot":"../src/","sources":["components/FocusTrapZone/FocusTrapZone.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  elementContains,\n  getNativeProps,\n  divProperties,\n  getFirstTabbable,\n  getLastTabbable,\n  getNextElement,\n  focusAsync,\n  modalize,\n  on,\n} from '../../Utilities';\nimport { useId, useConst, useMergedRefs } from '@fluentui/react-hooks';\nimport { useDocument } from '../../WindowProvider';\nimport type { IRefObject } from '../../Utilities';\nimport type { IFocusTrapZoneProps, IFocusTrapZone } from './FocusTrapZone.types';\n\ninterface IFocusTrapZoneInternalState {\n  disposeFocusHandler: (() => void) | undefined;\n  disposeClickHandler: (() => void) | undefined;\n  previouslyFocusedElementOutsideTrapZone: HTMLElement | undefined;\n  previouslyFocusedElementInTrapZone: HTMLElement | undefined;\n  hasFocus: boolean;\n  unmodalize: (() => void) | undefined;\n}\n\nconst COMPONENT_NAME = 'FocusTrapZone';\n\nconst useComponentRef = (\n  componentRef: IRefObject<IFocusTrapZone> | undefined,\n  previouslyFocusedElement: HTMLElement | undefined,\n  focus: () => void,\n) => {\n  React.useImperativeHandle(\n    componentRef,\n    () => ({\n      get previouslyFocusedElement() {\n        return previouslyFocusedElement;\n      },\n      focus,\n    }),\n    [previouslyFocusedElement, focus],\n  );\n};\n\nexport const FocusTrapZone: React.FunctionComponent<IFocusTrapZoneProps> & {\n  focusStack: string[];\n} = React.forwardRef<HTMLElement, IFocusTrapZoneProps>((props, ref) => {\n  const root = React.useRef<HTMLDivElement>(null);\n  const firstBumper = React.useRef<HTMLDivElement>(null);\n  const lastBumper = React.useRef<HTMLDivElement>(null);\n  const mergedRootRef = useMergedRefs(root, ref) as React.Ref<HTMLDivElement>;\n  const id = useId(undefined, props.id);\n  const doc = useDocument();\n  const divProps = getNativeProps<React.HTMLAttributes<HTMLDivElement>>(props, divProperties);\n\n  const internalState = useConst<IFocusTrapZoneInternalState>(() => ({\n    previouslyFocusedElementOutsideTrapZone: undefined,\n    previouslyFocusedElementInTrapZone: undefined,\n    disposeFocusHandler: undefined,\n    disposeClickHandler: undefined,\n    hasFocus: false,\n    unmodalize: undefined,\n  }));\n\n  const {\n    ariaLabelledBy,\n    className,\n    children,\n    componentRef,\n    disabled,\n    disableFirstFocus = false,\n    disabled: currentDisabledValue = false,\n    elementToFocusOnDismiss,\n    forceFocusInsideTrap = true,\n    focusPreviouslyFocusedInnerElement,\n    // eslint-disable-next-line deprecation/deprecation\n    firstFocusableSelector,\n    firstFocusableTarget,\n    ignoreExternalFocusing,\n    isClickableOutsideFocusTrap = false,\n    onFocus,\n    onBlur,\n    onFocusCapture,\n    onBlurCapture,\n    enableAriaHiddenSiblings,\n  } = props;\n\n  const bumperProps = {\n    'aria-hidden': true,\n    style: {\n      pointerEvents: 'none',\n      position: 'fixed', // 'fixed' prevents browsers from scrolling to bumpers when viewport does not contain them\n    },\n    tabIndex: disabled ? -1 : 0, // make bumpers tabbable only when enabled\n    'data-is-visible': true,\n    'data-is-focus-trap-zone-bumper': true,\n  } as React.HTMLAttributes<HTMLDivElement>;\n\n  const focus = React.useCallback(() => {\n    if (\n      focusPreviouslyFocusedInnerElement &&\n      internalState.previouslyFocusedElementInTrapZone &&\n      elementContains(root.current, internalState.previouslyFocusedElementInTrapZone)\n    ) {\n      // focus on the last item that had focus in the zone before we left the zone\n      focusAsync(internalState.previouslyFocusedElementInTrapZone);\n      return;\n    }\n\n    const focusSelector =\n      typeof firstFocusableSelector === 'string'\n        ? firstFocusableSelector\n        : firstFocusableSelector && firstFocusableSelector();\n\n    let firstFocusableChild: HTMLElement | null = null;\n\n    if (root.current) {\n      if (typeof firstFocusableTarget === 'string') {\n        firstFocusableChild = root.current.querySelector(firstFocusableTarget);\n      } else if (firstFocusableTarget) {\n        firstFocusableChild = firstFocusableTarget(root.current);\n      } else if (focusSelector) {\n        firstFocusableChild = root.current.querySelector('.' + focusSelector);\n      }\n\n      // Fall back to first element if query selector did not match any elements.\n      if (!firstFocusableChild) {\n        firstFocusableChild = getNextElement(\n          root.current,\n          root.current.firstChild as HTMLElement,\n          false,\n          false,\n          false,\n          true,\n        );\n      }\n    }\n    if (firstFocusableChild) {\n      focusAsync(firstFocusableChild);\n    }\n  }, [firstFocusableSelector, firstFocusableTarget, focusPreviouslyFocusedInnerElement, internalState]);\n\n  const onBumperFocus = React.useCallback(\n    (isFirstBumper: boolean) => {\n      if (disabled) {\n        return;\n      }\n\n      const currentBumper = (isFirstBumper === internalState.hasFocus\n        ? lastBumper.current\n        : firstBumper.current) as HTMLElement;\n\n      if (root.current) {\n        const nextFocusable =\n          isFirstBumper === internalState.hasFocus\n            ? getLastTabbable(root.current, currentBumper, true, false)\n            : getFirstTabbable(root.current, currentBumper, true, false);\n\n        if (nextFocusable) {\n          if (nextFocusable === firstBumper.current || nextFocusable === lastBumper.current) {\n            // This can happen when FTZ contains no tabbable elements.\n            // focus will take care of finding a focusable element in FTZ.\n            focus();\n          } else {\n            nextFocusable.focus();\n          }\n        }\n      }\n    },\n    [disabled, focus, internalState],\n  );\n\n  const onRootBlurCapture = React.useCallback(\n    (ev: React.FocusEvent<HTMLDivElement>) => {\n      onBlurCapture?.(ev);\n      let relatedTarget = ev.relatedTarget;\n      if (ev.relatedTarget === null) {\n        // In IE11, due to lack of support, event.relatedTarget is always\n        // null making every onBlur call to be \"outside\" of the root\n        // even when it's not. Using document.activeElement is another way\n        // for us to be able to get what the relatedTarget without relying\n        // on the event\n        relatedTarget = doc!.activeElement as Element;\n      }\n      if (!elementContains(root.current, relatedTarget as HTMLElement)) {\n        internalState.hasFocus = false;\n      }\n    },\n    [doc, internalState, onBlurCapture],\n  );\n\n  const onRootFocusCapture = React.useCallback(\n    (ev: React.FocusEvent<HTMLDivElement>) => {\n      onFocusCapture?.(ev);\n\n      if (ev.target === firstBumper.current) {\n        onBumperFocus(true);\n      } else if (ev.target === lastBumper.current) {\n        onBumperFocus(false);\n      }\n\n      internalState.hasFocus = true;\n\n      if (ev.target !== ev.currentTarget && !(ev.target === firstBumper.current || ev.target === lastBumper.current)) {\n        // every time focus changes within the trap zone, remember the focused element so that\n        // it can be restored if focus leaves the pane and returns via keystroke (i.e. via a call to this.focus(true))\n        internalState.previouslyFocusedElementInTrapZone = ev.target as HTMLElement;\n      }\n    },\n    [onFocusCapture, internalState, onBumperFocus],\n  );\n\n  const returnFocusToInitiator = React.useCallback((): void => {\n    FocusTrapZone.focusStack = FocusTrapZone.focusStack.filter((value: any) => {\n      return id !== value;\n    });\n\n    if (doc) {\n      const activeElement = doc.activeElement as HTMLElement;\n      if (\n        !ignoreExternalFocusing &&\n        internalState.previouslyFocusedElementOutsideTrapZone &&\n        typeof internalState.previouslyFocusedElementOutsideTrapZone.focus === 'function' &&\n        (elementContains(root.current, activeElement) || activeElement === doc.body)\n      ) {\n        if (\n          !(\n            internalState.previouslyFocusedElementOutsideTrapZone === firstBumper.current ||\n            internalState.previouslyFocusedElementOutsideTrapZone === lastBumper.current\n          )\n        ) {\n          focusAsync(internalState.previouslyFocusedElementOutsideTrapZone);\n        }\n      }\n    }\n  }, [doc, id, ignoreExternalFocusing, internalState]);\n\n  const forceFocusInTrap = React.useCallback(\n    (ev: FocusEvent): void => {\n      if (disabled) {\n        return;\n      }\n      if (FocusTrapZone.focusStack.length && id === FocusTrapZone.focusStack[FocusTrapZone.focusStack.length - 1]) {\n        const focusedElement = ev.target as HTMLElement;\n        if (!elementContains(root.current, focusedElement)) {\n          focus();\n          internalState.hasFocus = true; // set focus here since we stop event propagation\n          ev.preventDefault();\n          ev.stopPropagation();\n        }\n      }\n    },\n    [disabled, id, focus, internalState],\n  );\n\n  const forceClickInTrap = React.useCallback(\n    (ev: MouseEvent): void => {\n      if (disabled) {\n        return;\n      }\n      if (FocusTrapZone.focusStack.length && id === FocusTrapZone.focusStack[FocusTrapZone.focusStack.length - 1]) {\n        const clickedElement = ev.target as HTMLElement;\n        if (clickedElement && !elementContains(root.current, clickedElement)) {\n          focus();\n          internalState.hasFocus = true; // set focus here since we stop event propagation\n          ev.preventDefault();\n          ev.stopPropagation();\n        }\n      }\n    },\n    [disabled, id, focus, internalState],\n  );\n\n  const updateEventHandlers = React.useCallback((): void => {\n    if (forceFocusInsideTrap && !internalState.disposeFocusHandler) {\n      internalState.disposeFocusHandler = on(window, 'focus', forceFocusInTrap, true);\n    } else if (!forceFocusInsideTrap && internalState.disposeFocusHandler) {\n      internalState.disposeFocusHandler();\n      internalState.disposeFocusHandler = undefined;\n    }\n\n    if (!isClickableOutsideFocusTrap && !internalState.disposeClickHandler) {\n      internalState.disposeClickHandler = on(window, 'click', forceClickInTrap, true);\n    } else if (isClickableOutsideFocusTrap && internalState.disposeClickHandler) {\n      internalState.disposeClickHandler();\n      internalState.disposeClickHandler = undefined;\n    }\n  }, [forceClickInTrap, forceFocusInTrap, forceFocusInsideTrap, isClickableOutsideFocusTrap, internalState]);\n\n  // Updates eventHandlers and cleans up focusStack when the component unmounts.\n  React.useEffect(() => {\n    const parentRoot = root.current;\n    updateEventHandlers();\n    return () => {\n      // don't handle return focus unless forceFocusInsideTrap is true or focus is still within FocusTrapZone\n      if (!disabled || forceFocusInsideTrap || !elementContains(parentRoot, doc?.activeElement as HTMLElement)) {\n        returnFocusToInitiator();\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps -- Should only run on mount.\n  }, [updateEventHandlers]);\n\n  // Updates focusStack and the previouslyFocusedElementOutsideTrapZone on prop change.\n  React.useEffect(() => {\n    const newForceFocusInsideTrap = forceFocusInsideTrap !== undefined ? forceFocusInsideTrap : true;\n    const newDisabled = disabled !== undefined ? disabled : false;\n\n    // Transition from forceFocusInsideTrap / FTZ disabled to enabled.\n    if (!newDisabled || newForceFocusInsideTrap) {\n      if (currentDisabledValue) {\n        return;\n      }\n\n      FocusTrapZone.focusStack.push(id);\n\n      internalState.previouslyFocusedElementOutsideTrapZone = elementToFocusOnDismiss\n        ? elementToFocusOnDismiss\n        : (doc!.activeElement as HTMLElement);\n      if (!disableFirstFocus && !elementContains(root.current, internalState.previouslyFocusedElementOutsideTrapZone)) {\n        focus();\n      }\n      if (!internalState.unmodalize && root.current && enableAriaHiddenSiblings) {\n        internalState.unmodalize = modalize(root.current);\n      }\n    } else if (!newForceFocusInsideTrap || newDisabled) {\n      // Transition from forceFocusInsideTrap / FTZ enabled to disabled.\n      returnFocusToInitiator();\n      if (internalState.unmodalize) {\n        internalState.unmodalize();\n      }\n    }\n\n    if (elementToFocusOnDismiss && internalState.previouslyFocusedElementOutsideTrapZone !== elementToFocusOnDismiss) {\n      internalState.previouslyFocusedElementOutsideTrapZone = elementToFocusOnDismiss;\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [elementToFocusOnDismiss, forceFocusInsideTrap, disabled]);\n\n  // Cleanup lifecyle method for internalState.\n  useUnmount(() => {\n    // Dispose of event handlers so their closures can be garbage-collected\n    if (internalState.disposeClickHandler) {\n      internalState.disposeClickHandler();\n      internalState.disposeClickHandler = undefined;\n    }\n    if (internalState.disposeFocusHandler) {\n      internalState.disposeFocusHandler();\n      internalState.disposeFocusHandler = undefined;\n    }\n    if (internalState.unmodalize) {\n      internalState.unmodalize();\n    }\n    // Dispose of element references so the DOM Nodes can be garbage-collected\n    delete internalState.previouslyFocusedElementInTrapZone;\n    delete internalState.previouslyFocusedElementOutsideTrapZone;\n  });\n\n  useComponentRef(componentRef, internalState.previouslyFocusedElementInTrapZone, focus);\n\n  return (\n    <div\n      {...divProps}\n      className={className}\n      ref={mergedRootRef}\n      aria-labelledby={ariaLabelledBy}\n      onFocusCapture={onRootFocusCapture}\n      onFocus={onFocus}\n      onBlur={onBlur}\n      onBlurCapture={onRootBlurCapture}\n    >\n      <div {...bumperProps} ref={firstBumper} />\n      {children}\n      <div {...bumperProps} ref={lastBumper} />\n    </div>\n  );\n}) as any;\n\nconst useUnmount = (unmountFunction: () => void) => {\n  const unmountRef = React.useRef(unmountFunction);\n  unmountRef.current = unmountFunction;\n  React.useEffect(\n    () => () => {\n      if (unmountRef.current) {\n        unmountRef.current();\n      }\n    },\n    [unmountFunction],\n  );\n};\n\nFocusTrapZone.displayName = COMPONENT_NAME;\nFocusTrapZone.focusStack = [];\n"]}