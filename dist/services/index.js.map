{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///(webpack)/buildin/module.js","webpack:///./src/services sync","webpack:///dist/F:/Projetos Individuais/ReactLibraries/trentim-react-sdk/src/services/BaseService.ts","webpack:///dist/F:/Projetos Individuais/ReactLibraries/trentim-react-sdk/src/services/index.ts","webpack:///external \"@pnp/sp\"","webpack:///external \"catch-decorator-ts\""],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","webpackPolyfill","deprecate","paths","children","webpackEmptyContext","req","e","Error","code","keys","resolve","id","__extends","impl","_super","CustomSPHttpClient","url","tenantUrl","location","origin","sitePage","pathname","startsWith","includes","replace","concat","options","fetch","this","ensureSitePageUrl","fetchRaw","sp_2","injectedModules","_sp","sp_1","baseItemsSelect","uniqueSelect","select","length","Set","_this","registerCustomRequestClientFactory","loadModules","then","_","configure","headers","err","console","error","BaseService","_c","injectedModules_1","injectedModules_1_1","module_1","res","log","_a","baseArr","filter","item","identifier","_d","filters","_e","expand","_f","cache","_g","top","_h","orderBy","_j","getBy","lists","web","query","items","apply","_l","__spreadArray","_k","_b","column","ascending","undefined","_m","usingCaching","itemId","getItems","__assign","__read","listTitle","hash","getByTitle","add","getById","update","defaultSelect","orderTuple","getItemByIdSelect","baseItem","versions","listName","attachments","attachmentFiles","addMultiple","libraryUrl","folderUrl","content","chunkSize","getFolderByServerRelativeUrl","files","addChunked","data","percent","blockNumber","totalBlocks","fileAddRes","progressCallback","accumulatorPercent","realTotalPercentage","forEach","push","Promise","allSettled","map","f","idx","fileSize","individualPercentage","reduce","b","currentName","currentPercentage","result","percentage","currentUser","userInfo","site","getContextInfo","context","isExternal","LoginName","IsExternalUser","ProfilePic","SiteFullUrl","Email","all","file","Name","fileInfo","removeOData","_files","list","opt","_list","currentUserHasPermissions","permissionType","hasPermission","__decorate","DefaultCatch","File","require"],"mappings":"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","file":"services/index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/services/index.ts\");\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"./src/services sync recursive\";","import { DefaultCatch } from 'catch-decorator-ts';\r\nimport {sp} from \"@pnp/sp\";\r\nimport { SPRest, registerCustomRequestClientFactory, SPHttpClient } from '@pnp/sp';\r\nimport type {AllTypes} from './IFakeImport';\r\nimport type { IRequestClient } from \"@pnp/common\";\r\nimport type { IItemAddResult, IItemUpdateResult } from \"@pnp/sp/items\";\r\nimport type { IFileAddResult, IFileInfo } from '@pnp/sp/files';\r\nimport type { IAttachmentFileInfo } from '@pnp/sp/attachments';\r\nimport type { ISPUser } from '../models/interfaces/ISPUser';\r\nimport type { PermissionKind } from '@pnp/sp/security';\r\nimport type { PnpModules, IBaseItemKey, IItemVersionInfo, ITypedHash, PreviousUnion, IQueryOptions } from './IBaseServiceConfig';\r\nimport type { IFetchOptions } from \"@pnp/common\";\r\n\r\ndeclare const types: AllTypes;\r\n\r\nclass CustomSPHttpClient extends SPHttpClient {\r\n    constructor(impl?) { super(impl); }\r\n\r\n    private ensureSitePageUrl(url: string) {\r\n        const tenantUrl = window.location.origin;\r\n        const sitePage = window.location.pathname;\r\n        if (url?.startsWith(tenantUrl) && !url?.includes(sitePage)) {\r\n            url = url.replace(tenantUrl, '');\r\n            url = `${tenantUrl}${sitePage}${url}`;\r\n        }\r\n        return url;\r\n    }\r\n\r\n    public fetch(url: string, options?: IFetchOptions): Promise<Response> {\r\n        return super.fetch(this.ensureSitePageUrl(url), options);\r\n    }\r\n\r\n    public fetchRaw(url: string, options?: IFetchOptions): Promise<Response> {\r\n        return super.fetchRaw(this.ensureSitePageUrl(url), options);\r\n    }\r\n}\r\n\r\n\r\nexport class BaseService {\r\n    public _sp: SPRest = sp;\r\n    constructor(public injectedModules: PnpModules[], private factory?: () => IRequestClient) {\r\n        if(!this.factory)\r\n            registerCustomRequestClientFactory(() => new CustomSPHttpClient());\r\n        else registerCustomRequestClientFactory(this.factory);\r\n        this.loadModules(this.injectedModules).then(_ => {\r\n            this._sp = sp.configure({ headers: { 'Origin': window.location.origin } }, window.location.origin);\r\n        }).catch(err => console.error(err));\r\n    }\r\n\r\n    private async loadModules(injectedModules: PnpModules[]): Promise<void> {\r\n        await import(\"@pnp/sp\");\r\n        for (const module of injectedModules) {\r\n            const res = await import(module);\r\n            if (!res) {\r\n                console.log(`Module ${res?.default?.name} failed to load.`);\r\n            }\r\n            if(res)\r\n                console.log(res);\r\n        }\r\n    }\r\n\r\n    private baseItemsSelect: IBaseItemKey = ['Id', 'Title', 'Created', 'Modified'];\r\n    private uniqueSelect = (select: string[]) => {\r\n        if (!select?.length)\r\n            return [];\r\n        return [...new Set(select.concat(this.baseItemsSelect))];\r\n    }\r\n\r\n    public removeOData<T>(baseArr: T[]): T[] {\r\n        return baseArr?.filter(item => {\r\n            for (const key in item)\r\n                if (key?.includes('odata'))\r\n                    delete item[key];\r\n            return true;\r\n        });\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getItems<T>(identifier: string, { filters = null, expand = null, cache = null, top = null, orderBy = null, getBy = 'Title' }: IQueryOptions, ...select: string[]): Promise<T[]> {\r\n        if (!getBy)\r\n            getBy = 'Title';\r\n        const lists = this._sp.web.lists[`getBy${getBy}`](identifier);\r\n        const query = lists.items\r\n            .expand(...expand ?? [])\r\n            .select(...this.uniqueSelect(select) ?? [])\r\n            .filter(filters ?? `Id ne null`)\r\n            .orderBy(orderBy?.column ?? 'Id', orderBy?.ascending !== undefined ? orderBy.ascending : true)\r\n            .top(top || 9999999);\r\n        if (!cache)\r\n            return await query.get<T[]>();\r\n        return query.usingCaching(cache).get<T[]>();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getItem<T>(identifier: string, itemId: number, options: IQueryOptions, ...select: string[]): Promise<T> {\r\n        options = { ...options, getBy: options?.getBy ?? 'Title' }\r\n        const res = await this.getItems<T>(identifier, { ...options, filters: options?.filters ? `${options?.filters} and Id eq ${itemId}` : `Id eq ${itemId}` }, ...select);\r\n        if (res?.length > 0)\r\n            return res[0];\r\n        return null;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null })\r\n    public async saveItem<T>(listTitle: string, hash: ITypedHash<T>): Promise<IItemAddResult> {\r\n        return await this._sp.web.lists.getByTitle(listTitle).items.add(hash);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null })\r\n    public async updateItem<T>(listTitle: string, itemId: number, hash: ITypedHash<T>): Promise<IItemUpdateResult> {\r\n        return await this._sp.web.lists.getByTitle(listTitle).items.getById(itemId).update(hash);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    private async getItemByIdSelect(listTitle: string, getBy: 'Title' | 'Id' = 'Title', ...select: string[]) {\r\n        return this._sp.web.lists[`getBy${getBy}`](listTitle).items.select(...this.uniqueSelect(select)).top(9999999);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getPreviousVersions<T, R = PreviousUnion<T, IItemVersionInfo>[]>\r\n        (listTitle: string, itemId: number, { filters = null, expand = null, getBy = 'Title', orderBy }: Pick<IQueryOptions, 'filters' | 'expand' | 'getBy' | 'orderBy'>, ...select: string[]): Promise<R> {\r\n        const defaultSelect = ['IsCurrentVersion', 'Created', 'VersionId', 'VersionLabel', 'Modified'];\r\n        const orderTuple: [string, boolean] = orderBy ? [orderBy?.column, orderBy?.ascending || false] : ['Created', true];\r\n        const baseItem = await this.getItemByIdSelect(listTitle, getBy, ...select);\r\n        if (!filters) {\r\n            if (!expand)\r\n                return await baseItem.getById(itemId).versions.select(...select, ...defaultSelect)\r\n                    .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n            return await baseItem.expand(...expand).getById(itemId).versions.select(...select, ...defaultSelect).expand(...expand)\r\n                .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n        }\r\n        else {\r\n            if (!expand)\r\n                return await baseItem.getById(itemId).versions.filter(filters).select(...select, ...defaultSelect)\r\n                    .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n            return await baseItem.expand(...expand).getById(itemId).versions.select(...select, ...defaultSelect).filter(filters).expand(...expand)\r\n                .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n        }\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async deleteItem(listTitle: string, itemId: number) {\r\n        await this._sp.web.lists.getByTitle(listTitle).items.getById(itemId).delete();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return false; })\r\n    public async sendAttatchments(listName: string, itemId: number, attachments: IAttachmentFileInfo[]) {\r\n        await this._sp.web.lists.getByTitle(listName).items.getById(itemId).attachmentFiles.addMultiple(attachments);\r\n        return true;\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async addFileToLibrary(libraryUrl: string, folderUrl: string, content: File): Promise<IFileAddResult> {\r\n        const chunkSize = 40960;\r\n        const fileAddRes = await this._sp.web.getFolderByServerRelativeUrl(libraryUrl).files.addChunked(folderUrl, content, (data) => {\r\n            const percent = (data.blockNumber / data.totalBlocks);\r\n            console.log(percent);\r\n        }, true, chunkSize);\r\n        console.log(\"File upload succeded\");\r\n        return fileAddRes;\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async addMultipleFilesToLibrary(files: { name: string, content: File, libraryUrl: string }[], progressCallback?: (generalPorcentage: number, individual: { currentName: string, currentPercentage: number }) => void) {\r\n        type byte = 1000000;\r\n        const chunkSize: byte = 1000000;\r\n        const accumulatorPercent: number[] = [];\r\n        let realTotalPercentage: number = 0;\r\n        files.forEach(_ => accumulatorPercent.push(0));\r\n        const result = await Promise.allSettled(files.map((f, idx) => {\r\n            return this._sp.web.getFolderByServerRelativeUrl(f.libraryUrl).files.addChunked(f.name, f.content, (data) => {\r\n                const totalBlocks = data.fileSize <= chunkSize ? 1 : data.totalBlocks;\r\n                const individualPercentage = (data.blockNumber / totalBlocks);\r\n                if (accumulatorPercent[idx] < 1)\r\n                    accumulatorPercent[idx] = individualPercentage;\r\n                realTotalPercentage = (accumulatorPercent?.reduce((a, b) => a + b, 0) / files?.length);\r\n                if (progressCallback)\r\n                    progressCallback(realTotalPercentage, { currentName: f.name, currentPercentage: individualPercentage });\r\n            }, true, chunkSize);\r\n        }));\r\n        return {\r\n            result,\r\n            percentage: realTotalPercentage\r\n        };\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getItemAttachments(listTitle: string, itemId: number) {\r\n        return await this._sp.web.lists.getByTitle(listTitle).items.getById(itemId).attachmentFiles.get();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getCurrentUser(): Promise<ISPUser> {\r\n        const userInfo = await this._sp.web.currentUser.get() as ISPUser;\r\n        const context = await this._sp.site.getContextInfo();\r\n        const isExternal = userInfo.LoginName.includes(\"#ext#\");\r\n        userInfo.IsExternalUser = isExternal;\r\n        userInfo.ProfilePic = `${context.SiteFullUrl}/_layouts/15/userphoto.aspx?accountname=${userInfo?.Email}`;\r\n        return userInfo;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getFileItemData<T>(identifier: string, files: IFileInfo[], { expand = null, getBy = 'Id' }: IQueryOptions, ...select: string[]) {\r\n        const _files = await Promise.all(files?.map(async file => {\r\n            const fileInfo = await this.getItems<T>(identifier, { expand, filters: `FileLeafRef eq '${file?.Name}'`, getBy: getBy ?? 'Title' }, ...select);\r\n            if (fileInfo?.length >= 1)\r\n                return this.removeOData([{ ...file, data: this.removeOData(fileInfo)[0] }])[0];\r\n            return { ...file, data: null };\r\n        }));\r\n        return _files;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); })\r\n    public async hasItemPermission(list: string, itemId: number, opt: { getBy?: 'Id' | 'Title', permissionType: PermissionKind }) {\r\n        const getBy = opt?.getBy || 'Id';\r\n        const _list = this._sp.web.lists[`getBy${getBy}`](list);\r\n        const item = _list.items.getById(itemId);\r\n        const hasPermission = await item.currentUserHasPermissions(opt.permissionType);\r\n        return hasPermission;\r\n    }\r\n}","export {BaseService} from './BaseService';","module.exports = require(\"@pnp/sp\");","module.exports = require(\"catch-decorator-ts\");"],"sourceRoot":""}