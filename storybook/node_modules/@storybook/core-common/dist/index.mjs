var h=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(r,t)=>(typeof require!="undefined"?require:r)[t]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var i={};import{dedent as he}from"ts-dedent";import{logger as v}from"@storybook/node-logger";import{dirname as xe}from"path";import j from"path";import M from"fs";var R=new Set([".js",".jsx",".ts",".tsx",".cjs",".mjs"]);function le(){return[...Array.from(R)]}var H=le();function g(e){return H.map(r=>e.endsWith(r)?e:`${e}${r}`).find(r=>M.existsSync(r))}function J(e){return H.map(r=>({path:e.endsWith(r)?e:`${e}${r}`,ext:r})).find(r=>M.existsSync(r.path))}var U=!1;function S(e){if(U===!1){let{register:o}=h("esbuild-register/dist/node");U=!0,o({target:`node${process.version.slice(1)}`,format:"cjs",hookIgnoreNodeModules:!1,tsconfigRaw:`{
      "compilerOptions": {
        "strict": false,
        "skipLibCheck": true,
      },
    }`})}let r=h(e);return typeof r=="object"&&r!==null&&typeof r.default<"u"?r.default:r}function ue(e){for(let r=0;r<e.length;r+=1){let t=J(e[r]);if(t)return t}}function x(e){let r=$(e);return r?S(r):null}function $(e){let r=Array.isArray(e)?e:[e],t=ue(r);return t?t.path:null}import{dedent as ge}from"ts-dedent";import ye from"glob";import z from"path";function k(e){let r=`{${Array.from(R).join(",")}}`;if(!(n=>!!ye.sync(z.resolve(e,`${n}${r}`)).length)("main"))throw new Error(ge`
      No configuration files have been found in your configDir (${z.resolve(e)}).
      Storybook needs either a "main" or "config" file.
    `)}function B({configDir:e}){k(e);let r=x(j.resolve(e,"presets"));if(x(j.resolve(e,"main"))){let o=$(j.resolve(e,"main"));if(o)return[o]}return r||[]}import be from"resolve-from";var q=(e,r)=>{try{return be(e,r)}catch{return}},W=e=>{try{return h.resolve(e)}catch{return}};var C=e=>e!=null&&typeof e=="object"&&Array.isArray(e)===!1,ve=e=>typeof e=="function";function Ce(e){return e.filter(r=>{let t=typeof r=="string"?r:r.name;return!/@storybook[\\\\/]preset-typescript/.test(t)})}function Y(e,r,t){return ve(e)?[...e({...t,...r})]:Array.isArray(e)?[...e]:[]}var Pe=(e,r,t)=>{let o=r.startsWith("/")?W:q.bind(null,e),n=o(r);if(n){if(r.match(/\/(manager|register(-panel)?)(\.(js|ts|tsx|jsx))?$/))return{type:"virtual",name:r,managerEntries:[n]};if(r.match(/\/(preset)(\.(js|ts|tsx|jsx))?$/))return{type:"presets",name:n}}let s=n&&o(`${r}/package.json`),m=s&&xe(s),c=u=>{if(o(`${r}${u}`))return`${m}${u}`},f=r,a=c("/manager"),p=c("/register")||c("/register-panel"),d=c("/preview"),l=o(`${f}/preset`);if(!(a||d)&&l)return{type:"presets",name:l};if(a||p||d||l){let u=[];return a&&u.push(a),!a&&p&&!l&&u.push(p),{type:"virtual",name:f,...u.length?{managerEntries:u}:{},...d?{previewAnnotations:[d]}:{},...l?{presets:[{name:l,options:t}]}:{}}}if(n)return{type:"presets",name:n}},ke=({configDir:e})=>r=>{let t=C(r)&&r.options||void 0,o=C(r)?r.name:r;try{let n=Pe(e,o,t);return{...t?{options:t}:{},...n}}catch{v.error(`Addon value should end in /manager or /preview or /register OR it should be a valid preset https://storybook.js.org/docs/react/addons/writing-presets/
${r}`)}};async function we(e){if(e.type==="virtual"){let{type:t,name:o,...n}=e;return n}let r=e.name?e.name:e;return S(r)}async function Oe(e,r,t){try{let o=e.name?e.name:e,n=e.options?e.options:{},s=await we(e);if(typeof s=="function"&&(s=s(t,n)),Array.isArray(s))return await w(s,r+1,t);if(C(s)){let{addons:m,presets:c,...f}=s,a=Y(c,n,t),p=Y(m,n,t);return[...await w([...a],r+1,t),...await w([...p.map(ke(t))].filter(Boolean),r+1,t),{name:o,preset:f,options:n}]}throw new Error(he`
      ${e} is not a valid preset
    `)}catch(o){let n=r>0?`  Failed to load preset: ${JSON.stringify(e)} on level ${r}`:`  Failed to load preset: ${JSON.stringify(e)}`;return v.warn(n),v.error(o),[]}}async function w(e,r,t){return!e||!Array.isArray(e)||!e.length?[]:(r||v.info("=> Loading presets"),(await Promise.all(e.map(async o=>Oe(o,r,t)))).reduce((o,n)=>o.concat(n),[]))}function K(e,r,t,o,n){let s=new Promise(m=>m(t));return e.length?e.reduce((m,{preset:c,options:f})=>{let a=c[r];if(!a)return m;if(typeof a=="function"){let p=a,d={preset:c,combinedOptions:{...n,...o,...f,presetsList:e,presets:{apply:async(l,u,b={})=>K(e,l,u,b,n)}}};return m.then(l=>p.call(d.preset,l,d.combinedOptions))}return m.then(p=>Array.isArray(p)&&Array.isArray(a)?[...p,...a]:C(p)&&C(a)?{...p,...a}:a)},s):s}async function Ee(e,r){let t=await w(e,0,r);return{apply:async(o,n,s={})=>K(t,o,n,s,r)}}async function Ir(e){let{corePresets:r=[],overridePresets:t=[],...o}=e,n=[...r,...B(e),...t],s=Ce(n);return s.length<n.length&&v.warn("Storybook now supports TypeScript natively. You can safely remove `@storybook/preset-typescript`."),Ee(s,o)}import Re from"file-system-cache";function A(e){return Re(e)}import _ from"path";import Se from"pkg-dir";function V(e){let r=process.cwd(),t=Se.sync(r),o;return t?o=_.resolve(t,"node_modules/.cache/storybook"):o=_.resolve(r,".cache/storybook"),_.join(o,e)}var Ur=A({basePath:V("dev-server"),ns:"storybook"});import{logger as I}from"@storybook/node-logger";var N=e=>r=>{let t=r.name||r;return t&&t.includes(e)},$e=(e,r,t)=>{let o=e.findIndex(N("@storybook/addon-essentials")),n=e.findIndex(N(r.name)),s=e.findIndex(N(t.name));return n===-1&&r.inEssentials&&(n=o),s===-1&&t.inEssentials&&(s=o),n!==-1&&s!==-1&&n<=s},qr=async({before:e,after:r,configFile:t,getConfig:o})=>{try{let n=await o(t);if(!n?.addons){I.warn("Unable to find 'addons' config in main Storybook config");return}if(!$e(n.addons,e,r)){let s=" (or '@storybook/addon-essentials')",m=`'${e.name}'${e.inEssentials?s:""}`,c=`'${r.name}'${r.inEssentials?s:""}`;I.warn(`Expected ${m} to be listed before ${c} in main Storybook config.`)}}catch{I.warn(`Unable to load config file: ${t}`)}};import{getEnvironment as Ae}from"lazy-universal-dotenv";import O from"path";import G from"find-up";var Vr=()=>{let e;try{let r=G.sync(".git",{type:"directory"});r&&(e=e||O.join(r,".."))}catch{}try{let r=G.sync(".svn",{type:"directory"});r&&(e=e||O.join(r,".."))}catch{}try{e=e||__dirname.split("node_modules")[0]}catch{}return e||process.cwd()},X=e=>e.split(process.platform==="win32"?";":":").filter(Boolean).map(r=>O.resolve("./",r)),je=/^\.{1,2}([/\\]|$)/;function Z(e){return je.test(e)?e:`.${O.sep}${e}`}function Qr(e={}){let r=e.production?"production":"development",t={NODE_ENV:"production",NODE_PATH:i.NODE_PATH||"",STORYBOOK:i.STORYBOOK||"true",PUBLIC_URL:e.production?".":""};Object.keys(i).filter(c=>/^STORYBOOK_/.test(c)).forEach(c=>{t[c]=i[c]});let o=Object.entries(t).reduce((c,[f,a])=>Object.assign(c,{[f]:JSON.stringify(a)}),{}),{stringified:n,raw:s}=Ae({nodeEnv:t.NODE_ENV}),m={...t,...s};return m.NODE_PATH=X(m.NODE_PATH||""),{stringified:{...o,...n},raw:m}}var et=e=>Object.entries(e).reduce((r,[t,o])=>(r[t]=JSON.stringify(o),r),{}),rt=e=>Object.entries(e).reduce((t,[o,n])=>(t[`process.env.${o}`]=JSON.stringify(n),t),{"process.env.XSTORYBOOK_EXAMPLE_APP":'""'});import Q from"path";import{sync as _e}from"find-up";var st=(e,r)=>{let t=_e("package.json",{cwd:e});if(!t)throw new Error(`Could not find package.json in: ${e}`);let o=Q.dirname(t);return Q.join(o,"dist","esm",r)};import{dedent as Ie}from"ts-dedent";async function ee(e){let r=await e.presets.apply("framework","",e);if(!r)throw new Error(Ie`
      You must specify a framework in '.storybook/main.js' config.

      https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#framework-field-mandatory
    `);return typeof r=="object"?r.name:r}async function mt(e){let{renderer:r}=await e.presets.apply("core",{},e);return r||ee(e)}function re(e,r,t){if(!e)return null;let o=e.split(/[\s='"]+/),n=o.indexOf(t);return n===-1&&(n=o.indexOf(r)),n===-1?null:o[n+1]}import Ne from"path";import Fe from"fs-extra";var te={"@storybook/react":"react","@storybook/vue":"vue","@storybook/vue3":"vue3","@storybook/angular":"angular","@storybook/html":"html","@storybook/web-components":"web-components","@storybook/polymer":"polymer","@storybook/ember":"ember","@storybook/marko":"marko","@storybook/mithril":"mithril","@storybook/riot":"riot","@storybook/svelte":"svelte","@storybook/preact":"preact","@storybook/rax":"rax","@storybook/server":"server"},oe=console,Te=({dependencies:e,devDependencies:r,peerDependencies:t},o)=>[Object.entries(e||{}).find(o),Object.entries(r||{}).find(o),Object.entries(t||{}).find(o)],De=e=>{let[r,t,o]=Te(e,([c])=>te[c]),[n,s]=r||t||o||[],m=n?te[n]:void 0;return r&&t&&r[0]===t[0]&&oe.warn(`Found "${r[0]}" in both "dependencies" and "devDependencies". This is probably a mistake.`),r&&o&&r[0]===o[0]&&oe.warn(`Found "${r[0]}" in both "dependencies" and "peerDependencies". This is probably a mistake.`),{version:s,framework:m,frameworkPackage:n,renderer:m,rendererPackage:n}},Le=["ts","js","tsx","jsx","mjs","cjs"],F=(e,r)=>{let t=Ne.join(r,e),o=Le.find(n=>Fe.existsSync(`${t}.${n}`));return o?`${t}.${o}`:null},Me=e=>{let r=".storybook",t=e.scripts?.storybook;if(t){let o=re(t,"-c","--config-dir");o&&(r=o)}return{configDir:r,mainConfig:F("main",r),previewConfig:F("preview",r),managerConfig:F("manager",r)}},yt=e=>{let r=De(e),t=Me(e);return{...r,...t}};import{readJSON as ne}from"fs-extra";import{dirname as He,join as Je}from"path";import Ue from"find-up";import ze from"resolve-from";import{logger as Be}from"@storybook/node-logger";var qe=async e=>{let r=await Ue("package.json",{cwd:e.configDir});if(!r)return{};let t=He(r),{dependencies:o=[],devDependencies:n=[]}=await ne(r)||{},s=Object.keys({...o,...n});return(await Promise.all(s.map(async c=>{try{let f=ze(t,Je(c,"package.json")),{storybook:a,name:p,version:d}=await ne(f)||{};if(a?.url)return{id:p,...a,version:d}}catch(f){if(f.code==="ERR_PACKAGE_PATH_NOT_EXPORTED")return;Be.warn(`unable to find package.json for ${c}`);return}}))).filter(Boolean).reduce((c,f)=>({...c,[f.id]:{id:f.id.toLowerCase(),url:se(f.url),title:f.title,version:f.version}}),{})},We=e=>fetch(`${e}/iframe.html`).then(async({ok:r,status:t})=>{if(r){if(t!==200)return!1;let o=await fetch(`${e}/iframe.html`,{headers:{Accept:"application/json"}});if(o.ok&&(await o.json().catch(n=>({}))).loginUrl)return!1}return r},()=>!1),se=e=>e.replace(/\/$/,""),Ye=e=>{let r=e.replace(/[A-Z]/g,t=>` ${t}`).replace(/[-_][A-Z]/gi,t=>` ${t.toUpperCase()}`).replace(/-/g," ").replace(/_/g," ");return`${r.substring(0,1).toUpperCase()}${r.substring(1)}`.trim()};async function kt(e){let r=await e.presets.apply("refs",await qe(e));return Object.entries(r).forEach(([t,o])=>{if(o.disable){delete r[t];return}r[t.toLowerCase()]={...o,id:t.toLowerCase(),title:o.title||Ye(o.id||t),url:se(o.url)}}),await Promise.all(Object.entries(r).map(async([t,o])=>{let n=await We(o.url);r[t]={...o,type:n?"server-checked":"unknown"}})),r}import{makeRe as Ke}from"picomatch";function ie(e){let r=Ke(e,{fastpaths:!1,noglobstar:!1,bash:!1});if(!r.source.startsWith("^"))throw new Error(`Invalid glob: >> ${e} >> ${r}`);return e.startsWith("./")?new RegExp(["^\\.",e.startsWith("./**")?"":"[\\\\/]",r.source.substring(1)].join("")):r}import Ve from"handlebars";function St(e,r){return Ve.compile(e)(r)}var jt=(e,r)=>Object.entries(r).reduce((t,[o,n])=>{let s=n.replace(/\\/g,"/").replace(/\$/g,"$$$");return t.replace(new RegExp(`{{${o}}}`,"g"),s)},e);import Ge from"path";function Ft({configDir:e}){return k(e),x(Ge.resolve(e,"main"))}import T from"path";import{logger as Xe}from"@storybook/node-logger";import{dedent as Ze}from"ts-dedent";function Jt({configDir:e}){let r=g(T.resolve(e,"addons")),t=g(T.resolve(e,"manager"));if((r||t)&&Xe.info("=> Loading custom manager config"),r&&t)throw new Error(Ze`
      You have both a "addons.js" and a "manager.js", remove the "addons.js" file from your configDir (${T.resolve(e,"addons")})`);return t||r}import D from"path";import{dedent as Qe}from"ts-dedent";function Wt({configDir:e}){let r=g(D.resolve(e,"config")),t=g(D.resolve(e,"preview"));if(r&&t)throw new Error(Qe`
      You have both a "config.js" and a "preview.js", remove the "config.js" file from your configDir (${D.resolve(e,"config")})`);return t||r}import er from"chalk";function Vt(e,r){console.log(er.cyan(e)),console.dir(r,{depth:null})}import rr from"fs";import P from"path";import{scan as tr}from"picomatch";import ae from"slash";var E="",ce="**/*.@(mdx|stories.mdx|stories.tsx|stories.ts|stories.jsx|stories.js)",or=(e,r)=>{try{return rr.lstatSync(P.resolve(e,r)).isDirectory()}catch{return!1}},nr=({configDir:e,workingDir:r,directory:t})=>{let o=P.resolve(e,t),n=P.relative(r,o);return Z(n)},sr=(e,{configDir:r,workingDir:t})=>{let o;if(typeof e=="string"){let f=tr(e);if(f.isGlob){let a=f.prefix+f.base,p=f.glob;o={titlePrefix:E,directory:a,files:p}}else or(r,e)?o={titlePrefix:E,directory:e,files:ce}:o={titlePrefix:E,directory:P.dirname(e),files:P.basename(e)}}else o={titlePrefix:E,files:ce,...e};let n=ae(o.files),{directory:s}=o,m=ae(nr({configDir:r,workingDir:t,directory:s})).replace(/\/$/,""),c=ie(`${m}/${n}`);return{...o,directory:m,importPathMatcher:c}},oo=(e,r)=>e.map(t=>sr(t,r));import ir from"pretty-hrtime";var fe=e=>ir(process.hrtime(e)).replace(" ms"," milliseconds").replace(" s"," seconds").replace(" m"," minutes");var co=async(e,r,t)=>{let o=0,n,s=()=>{};e.get("/progress",(f,a)=>{let p=!1,d=()=>{p=!0,a.end()};a.on("close",d),!(p||a.writableEnded)&&(a.setHeader("Cache-Control","no-cache"),a.setHeader("Content-Type","text/event-stream"),a.setHeader("Connection","keep-alive"),a.flushHeaders(),s=l=>{p||a.writableEnded||(a.write(`data: ${JSON.stringify(l)}

`),a.flush(),l.value===1&&d())})});let m=(f,a,p)=>{o=Math.max(f,o);let d={value:o,message:a.charAt(0).toUpperCase()+a.slice(1)};if(a==="building"){let l=p&&p.match(/(\d+)\/(\d+)/)||[],u=parseInt(l[1],10),b=parseInt(l[2],10);!Number.isNaN(u)&&!Number.isNaN(b)&&(d.modules={complete:u,total:b},n=b)}o===1&&(t.cache&&t.cache.set("modulesCount",n),d.message||(d.message=`Completed in ${fe(r)}.`)),s(d)},c=await t.cache?.get("modulesCount").catch(()=>{})||1e3;return{handler:m,modulesCount:c}};import ar from"fs-extra";async function po(e){return ar.readFile(e,{encoding:"utf8"})}function uo(){let{NODE_OPTIONS:e,NODE_PRESERVE_SYMLINKS:r}=i;return!!r||e?.includes("--preserve-symlinks")}import me from"path";import{sync as L}from"pkg-dir";import y from"fs";var pe=(e,r={})=>Object.entries(r).reduce((t,[o,n])=>t.replace(new RegExp(`%${o}%`,"g"),n),e);function xo(e,r){let t=y.readFileSync(`${L(__dirname)}/templates/base-preview-body.html`,"utf8"),o=me.resolve(e,"preview-body.html"),n=t;return y.existsSync(o)&&(n=y.readFileSync(o,"utf8")+n),pe(n,r)}function vo(e,r){let t=y.readFileSync(`${L(__dirname)}/templates/base-preview-head.html`,"utf8"),o=me.resolve(e,"preview-head.html"),n=t;return y.existsSync(o)&&(n+=y.readFileSync(o,"utf8")),pe(n,r)}function Co(){return`${L(__dirname)}/templates/preview.ejs`}import{dedent as cr}from"ts-dedent";var fr=["@storybook/html","@storybook/preact","@storybook/react","@storybook/server","@storybook/svelte","@storybook/vue","@storybook/vue3","@storybook/web-components"];function wo(e){if(fr.includes(e))throw new Error(cr`
      Invalid value of ${e} in the 'framework' field of Storybook config.

      Please run 'npx sb@next automigrate'

      See the v7 Migration guide for more information: 
      https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#framework-field-mandatory
      `)}function Eo(){return e=>e}export{R as boost,Ur as cache,qr as checkAddonOrder,A as createFileSystemCache,Ce as filterPresetsConfig,st as findDistEsm,qe as getAutoRefs,nr as getDirectoryFromWorkingDir,ee as getFrameworkName,g as getInterpretedFile,J as getInterpretedFileWithExt,Ee as getPresets,xo as getPreviewBodyTemplate,vo as getPreviewHeadTemplate,Co as getPreviewMainTemplate,Vr as getProjectRoot,kt as getRefs,mt as getRendererName,re as getStorybookConfiguration,yt as getStorybookInfo,ie as globToRegexp,St as handlebars,S as interopRequireDefault,jt as interpolate,uo as isPreservingSymlinks,Ir as loadAllPresets,B as loadCustomPresets,Qr as loadEnvs,Ft as loadMainConfig,Jt as loadManagerOrAddonsFile,Oe as loadPreset,Wt as loadPreviewOrConfigFile,Vt as logConfig,X as nodePathsToArray,oo as normalizeStories,sr as normalizeStoriesEntry,Z as normalizeStoryPath,po as readTemplate,Pe as resolveAddonName,V as resolvePathInStorybookCache,Eo as satisfies,x as serverRequire,$ as serverResolve,et as stringifyEnvs,rt as stringifyProcessEnvs,co as useProgressReporting,k as validateConfigurationFiles,wo as validateFrameworkName};
