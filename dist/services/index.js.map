{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///(webpack)/buildin/module.js","webpack:///./src/services sync","webpack:///dist/F:/Projetos Individuais/ReactLibraries/trentim-react-sdk/src/services/BaseService.ts","webpack:///dist/F:/Projetos Individuais/ReactLibraries/trentim-react-sdk/src/services/index.ts","webpack:///external \"@pnp/sp\"","webpack:///external \"@pnp/sp/attachments\"","webpack:///external \"@pnp/sp/files\"","webpack:///external \"@pnp/sp/folders\"","webpack:///external \"@pnp/sp/items\"","webpack:///external \"@pnp/sp/lists\"","webpack:///external \"@pnp/sp/lists/web\"","webpack:///external \"@pnp/sp/profiles\"","webpack:///external \"@pnp/sp/site-groups/web\"","webpack:///external \"@pnp/sp/site-users/web\"","webpack:///external \"@pnp/sp/webs\"","webpack:///external \"catch-decorator-ts\""],"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","webpackPolyfill","deprecate","paths","children","webpackEmptyContext","req","e","Error","code","keys","resolve","id","__extends","impl","_super","CustomSPHttpClient","url","tenantUrl","location","origin","sitePage","pathname","startsWith","includes","replace","concat","options","fetch","this","ensureSitePageUrl","fetchRaw","sp_2","injectedModules","_sp","sp_1","baseItemsSelect","uniqueSelect","select","length","Set","_this","registerCustomRequestClientFactory","configure","headers","BaseService","_d","_a","_b","module_1","console","error","e_1","baseArr","filter","item","identifier","filters","_e","expand","_f","cache","_g","top","_h","orderBy","_j","getBy","lists","web","query","items","apply","_l","__spreadArray","_k","column","_c","ascending","undefined","_m","usingCaching","itemId","getItems","__assign","__read","res","listTitle","hash","getByTitle","add","getById","update","defaultSelect","orderTuple","getItemByIdSelect","baseItem","versions","listName","attachments","attachmentFiles","addMultiple","libraryUrl","folderUrl","content","chunkSize","getFolderByServerRelativeUrl","files","addChunked","data","percent","blockNumber","totalBlocks","log","fileAddRes","progressCallback","accumulatorPercent","realTotalPercentage","forEach","_","push","Promise","allSettled","map","f","idx","fileSize","individualPercentage","reduce","b","currentName","currentPercentage","result","percentage","currentUser","userInfo","site","getContextInfo","context","isExternal","LoginName","IsExternalUser","ProfilePic","SiteFullUrl","Email","all","file","Name","fileInfo","removeOData","_files","list","opt","_list","currentUserHasPermissions","permissionType","hasPermission","__decorate","DefaultCatch","err","T","File","require"],"mappings":"UAAUA,EAAiCC,EAAMC,GAChD,UAAUC,UAAY,iBAAmBC,SAAW,SACnDA,OAAOD,QAAUD,SACb,UAAUG,SAAW,YAAcA,OAAOC,IAC9CD,OAAO,GAAIH,OACP,CACJ,IAAIK,EAAIL,IACR,IAAI,IAAIM,KAAKD,UAAWJ,UAAY,SAAWA,QAAUF,GAAMO,GAAKD,EAAEC,K,CAErEC,OAAQ,WACX,O,YCTE,IAAIC,EAAmB,GAGvB,SAASC,EAAoBC,GAG5B,GAAGF,EAAiBE,GAAW,CAC9B,OAAOF,EAAiBE,GAAUT,QAGnC,IAAIC,EAASM,EAAiBE,GAAY,CACzCJ,EAAGI,EACHC,EAAG,MACHV,QAAS,IAIVW,EAAQF,GAAUG,KAAKX,EAAOD,QAASC,EAAQA,EAAOD,QAASQ,GAG/DP,EAAOS,EAAI,KAGX,OAAOT,EAAOD,QAKfQ,EAAoBK,EAAIF,EAGxBH,EAAoBM,EAAIP,EAGxBC,EAAoBO,EAAI,SAASf,EAASgB,EAAMC,GAC/C,IAAIT,EAAoBU,EAAElB,EAASgB,GAAO,CACzCG,OAAOC,eAAepB,EAASgB,EAAM,CAAEK,WAAY,KAAMC,IAAKL,MAKhET,EAAoBe,EAAI,SAASvB,GAChC,UAAUwB,SAAW,aAAeA,OAAOC,YAAa,CACvDN,OAAOC,eAAepB,EAASwB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAepB,EAAS,aAAc,CAAE0B,MAAO,QAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GACvC,GAAGA,EAAO,EAAGF,EAAQlB,EAAoBkB,GACzC,GAAGE,EAAO,EAAG,OAAOF,EACpB,GAAIE,EAAO,UAAaF,IAAU,UAAYA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKX,OAAOY,OAAO,MACvBvB,EAAoBe,EAAEO,GACtBX,OAAOC,eAAeU,EAAI,UAAW,CAAET,WAAY,KAAMK,MAAOA,IAChE,GAAGE,EAAO,UAAYF,GAAS,SAAU,IAAI,IAAIM,KAAON,EAAOlB,EAAoBO,EAAEe,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAASjC,GAChC,IAAIgB,EAAShB,GAAUA,EAAO4B,WAC7B,SAASM,IAAe,OAAOlC,EAAO,YACtC,SAASmC,IAAqB,OAAOnC,GACtCO,EAAoBO,EAAEE,EAAQ,IAAKA,GACnC,OAAOA,GAIRT,EAAoBU,EAAI,SAASmB,EAAQC,GAAY,OAAOnB,OAAOoB,UAAUC,eAAe5B,KAAKyB,EAAQC,IAGzG9B,EAAoBiC,EAAI,IAIxB,OAAOjC,EAAoBA,EAAoBkC,EAAI,2B,2DClFrDzC,EAAOD,QAAU,SAASC,GACzB,IAAKA,EAAO0C,gBAAiB,CAC5B1C,EAAO2C,UAAY,aACnB3C,EAAO4C,MAAQ,GAEf,IAAK5C,EAAO6C,SAAU7C,EAAO6C,SAAW,GACxC3B,OAAOC,eAAenB,EAAQ,SAAU,CACvCoB,WAAY,KACZC,IAAK,WACJ,OAAOrB,EAAOS,KAGhBS,OAAOC,eAAenB,EAAQ,KAAM,CACnCoB,WAAY,KACZC,IAAK,WACJ,OAAOrB,EAAOI,KAGhBJ,EAAO0C,gBAAkB,EAE1B,OAAO1C,I,8CCpBR,SAAS8C,EAAoBC,GAC5B,IAAIC,EAAI,IAAIC,MAAM,uBAAyBF,EAAM,KACjDC,EAAEE,KAAO,mBACT,MAAMF,EAEPF,EAAoBK,KAAO,WAAa,MAAO,IAC/CL,EAAoBM,QAAUN,EAC9B9C,EAAOD,QAAU+C,EACjBA,EAAoBO,GAAK,iC,sqICRzB,8BACA,mBACA,mBAUA,kBAAiCC,OAC7B,WAAYC,G,OAASC,YAAMD,IAAK,KAExBE,8BAAR,SAA0BC,GACtB,IAAMC,EAAYtD,OAAOuD,SAASC,OAClC,IAAMC,EAAWzD,OAAOuD,SAASG,SACjC,IAAIL,IAAG,MAAHA,SAAG,SAAHA,EAAKM,WAAWL,OAAeD,IAAG,MAAHA,SAAG,SAAHA,EAAKO,SAASH,IAAW,CACxDJ,EAAMA,EAAIQ,QAAQP,EAAW,IAC7BD,EAAM,UAAGC,GAASQ,OAAGL,GAAQK,OAAGT,GAEpC,OAAOA,GAGJD,kBAAP,SAAaC,EAAaU,GACtB,OAAOZ,YAAMa,MAAK1D,KAAA,KAAC2D,KAAKC,kBAAkBb,GAAMU,IAG7CX,qBAAP,SAAgBC,EAAaU,GACzB,OAAOZ,YAAMgB,SAAQ7D,KAAA,KAAC2D,KAAKC,kBAAkBb,GAAMU,IAE3D,SApBA,CAAiCK,gBAuBjC,iBAwBI,WAAmBC,EAAuC5E,GAA1D,WAAmB,KAAA4E,kBAAuC,KAAA5E,UAvBnD,KAAA6E,IAAcC,KA8Bb,KAAAC,gBAAgC,CAAC,KAAM,QAAS,UAAW,YAC3D,KAAAC,aAAe,SAACC,GACpB,KAAKA,IAAM,MAANA,SAAM,SAANA,EAAQC,QACT,MAAO,GACX,OAAO,EAAP,KAAW,IAAIC,IAAIF,EAAOZ,OAAOe,EAAKL,mBAAiB,QAVvD,IAAIP,KAAKxE,SACL,IAAAqF,oCAAmC,WAAM,WAAI1B,SAC5C,IAAA0B,oCAAmCb,KAAKxE,SAC7CwE,KAAKK,IAAMC,KAAGQ,UAAU,CAAEC,QAAS,CAAE,OAAUhF,OAAOuD,SAASC,SAAYxD,OAAOuD,SAASC,QAzBlFyB,iBAAb,W,8GACI,oDAAc,mB,OAAdC,SACA,oDAAc,uB,OAAdA,SACA,oDAAc,8B,OAAdA,SACA,oDAAc,6B,OAAdA,SACA,oDAAc,oB,OAAdA,SACA,oDAAc,wB,OAAdA,SACA,oDAAc,oB,OAAdA,SACA,oDAAc,sB,OAAdA,SACA,oDAAc,oB,OAAdA,SACA,oDAAc,0B,QAAdA,S,KACGjB,KAAKI,gBAAgBM,OAAS,GAA9B,a,8CACsBQ,SAAKd,iBAAee,W,4CAApCC,U,4CAEG,qFAAaA,M,QAAbH,S,gCAEAI,QAAQC,MAAM,0BAA4BF,EAAQG,G,gOAmB3DP,wBAAP,SAAsBQ,GAClB,OAAOA,IAAO,MAAPA,SAAO,SAAPA,EAASC,OAAO,SAAAC,GACnB,IAAK,IAAMjE,KAAOiE,EAAlB,CACI,GAAIjE,IAAG,MAAHA,SAAG,SAAHA,EAAKkC,SAAS,gBACP+B,EAAKjE,GACpB,OAAO,QAKFuD,qBAAb,SAAyBW,EAAoBT,G,YAAED,YAAAW,EAAU,SAAH,EAAG,KAAIX,EAAEY,WAAAC,EAAS,SAAH,EAAG,KAAID,EAAEE,UAAAC,EAAQrE,SAAH,EAAG,KAAIoE,EAAEE,QAAAC,EAAM,SAAH,EAAG,KAAID,EAAEE,YAAAC,EAAU,SAAH,EAAG,KAAID,EAAEE,UAAAC,EAAQ,SAAH,EAAG,QAAOD,EAAmB,S,IAAA,+BAAmB,CAAnB5B,oB,wGACtJ,IAAK6B,EACDA,EAAQ,QACNC,EAAQvC,KAAKK,IAAImC,IAAID,MAAM,eAAQD,IAASX,GAC5Cc,GAAQ,KAAAF,EAAMG,OACfZ,OAAMa,MAAAC,EAAAC,OAAIf,IAAM,MAANA,SAAM,EAANA,EAAU,IAAE,SACtBrB,OAAMkC,MAAAG,EAAAD,QAAI,EAAA7C,KAAKQ,aAAaC,MAAO,MAAAU,aAAI,IAAE,QACzCM,OAAOG,IAAO,MAAPA,SAAO,EAAPA,EAAW,cAClBQ,SAAQ,EAAAA,IAAO,MAAPA,SAAO,SAAPA,EAASW,UAAM,MAAAC,aAAI,MAAMZ,IAAO,MAAPA,SAAO,SAAPA,EAASa,aAAcC,UAAYd,EAAQa,UAAY,MACxFf,IAAIA,GAAO,S,KACXF,EAAD,YACO,SAAMS,EAAM1F,O,OAAnB,MAAM,CAAN,EAAOoG,U,OACX,MAAM,CAAN,EAAOV,EAAMW,aAAapB,GAAOjF,aAIxBiE,oBAAb,SAAwBW,EAAoB0B,EAAgBvD,G,MAAwB,S,IAAA,+BAAmB,CAAnBW,oB,8FAChFX,EAAU,EAAH,KAAQA,GAAO,CAAEwC,OAAO3F,EAAAmD,IAAO,MAAPA,SAAO,SAAPA,EAASwC,SAAK,MAAApB,aAAI,UACrC,SAAMlB,KAAKsD,SAAQX,MAAb3C,KAAI6C,GAAalB,EAAU4B,OAAOzD,GAAO,CAAE8B,SAAS9B,IAAO,MAAPA,SAAO,SAAPA,EAAS8B,SAAU,UAAG9B,IAAO,MAAPA,SAAO,SAAPA,EAAS8B,QAAO,eAAA/B,OAAcwD,GAAW,gBAASA,MAAQG,EAAO/C,GAAM,S,OAA7JgD,EAAMtC,SACZ,IAAIsC,IAAG,MAAHA,SAAG,SAAHA,EAAK/C,QAAS,EACd,MAAO,CAAP,EAAO+C,EAAI,IACf,MAAM,CAAN,EAAO,YAIEzC,qBAAb,SAAyB0C,EAAmBC,G,wFACjC,SAAM3D,KAAKK,IAAImC,IAAID,MAAMqB,WAAWF,GAAWhB,MAAMmB,IAAIF,I,OAAhE,MAAM,CAAN,EAAOzC,gBAIEF,uBAAb,SAA2B0C,EAAmBL,EAAgBM,G,wFACnD,SAAM3D,KAAKK,IAAImC,IAAID,MAAMqB,WAAWF,GAAWhB,MAAMoB,QAAQT,GAAQU,OAAOJ,I,OAAnF,MAAM,CAAN,EAAOzC,gBAIGF,8BAAd,SAAgC0C,EAAmBpB,GAAA,GAAAA,SAAA,GAAAA,UAAiC,S,IAAA,+BAAmB,CAAnB7B,oB,uEAChF,MAAM,CAAN,GAAOrD,EAAA4C,KAAKK,IAAImC,IAAID,MAAM,eAAQD,IAASoB,GAAWhB,OAAMjC,OAAMkC,MAAAzB,EAAA2B,OAAI7C,KAAKQ,aAAaC,IAAO,QAAEyB,IAAI,eAI5FlB,gCAAb,SACK0C,EAAmBL,EAAgBnC,G,IAAEC,YAAAS,EAAU,SAAH,EAAG,KAAIT,EAAE6B,WAAAlB,EAAS,SAAH,EAAG,KAAIkB,EAAE/B,UAAAqB,EAAQ,SAAH,EAAG,QAAOrB,EAAEmB,EAAO,UAAqE,S,IAAA,+BAAmB,CAAnB3B,oB,kHAC5JuD,EAAgB,CAAC,mBAAoB,UAAW,YAAa,eAAgB,YAC7EC,EAAgC7B,EAAU,CAACA,IAAO,MAAPA,SAAO,SAAPA,EAASW,QAAQX,IAAO,MAAPA,SAAO,SAAPA,EAASa,YAAa,OAAS,CAAC,UAAW,MAC5F,SAAMjD,KAAKkE,kBAAiBvB,MAAtB3C,KAAI6C,GAAmBa,EAAWpB,GAAKkB,EAAK/C,GAAM,S,OAAnE0D,EAAWvB,S,KACZhB,EAAD,Y,KACKE,EAAD,YACO,UAAM,EAAAqC,EAASL,QAAQT,GAAQe,UAAS3D,OAAMkC,MAAAd,EAAAgB,SAAIpC,GAAM,OAAA+C,EAAKQ,GAAa,QAC5E5B,QAAQ6B,EAAW,GAAIA,EAAW,IAAIlH,O,OAD3C,MAAM,CAAN,EAAO6F,U,OAEJ,UAAM,KAAAuB,EAASrC,OAAMa,MAAfwB,EAAQtB,OAAWf,GAAM,QAAEgC,QAAQT,GAAQe,UAAS3D,OAAMkC,MAAAV,EAAAY,SAAIpC,GAAM,OAAA+C,EAAKQ,GAAa,SAAElC,OAAMa,MAAAZ,EAAAc,OAAIf,GAAM,QAChHM,QAAQ6B,EAAW,GAAIA,EAAW,IAAIlH,O,OAD3C,MAAM,CAAN,EAAO6F,U,YAIFd,EAAD,YACO,UAAM,EAAAqC,EAASL,QAAQT,GAAQe,SAAS3C,OAAOG,IAASnB,OAAMkC,MAAAR,EAAAU,SAAIpC,GAAM,OAAA+C,EAAKQ,GAAa,QAC5F5B,QAAQ6B,EAAW,GAAIA,EAAW,IAAIlH,O,OAD3C,MAAM,CAAN,EAAO6F,U,OAEJ,UAAM,KAAAuB,EAASrC,OAAMa,MAAfwB,EAAQtB,OAAWf,GAAM,QAAEgC,QAAQT,GAAQe,UAAS3D,OAAMkC,MAAAG,EAAAD,SAAIpC,GAAM,OAAA+C,EAAKQ,GAAa,QAAEvC,OAAOG,IAASE,OAAMa,MAAAN,EAAAQ,OAAIf,GAAM,QAChIM,QAAQ6B,EAAW,GAAIA,EAAW,IAAIlH,O,OAD3C,MAAM,CAAN,EAAO6F,gBAMF5B,uBAAb,SAAwB0C,EAAmBL,G,wFACvC,SAAMrD,KAAKK,IAAImC,IAAID,MAAMqB,WAAWF,GAAWhB,MAAMoB,QAAQT,GAAvD,a,OAANnC,S,gBAISF,6BAAb,SAA8BqD,EAAkBhB,EAAgBiB,G,wFAC5D,SAAMtE,KAAKK,IAAImC,IAAID,MAAMqB,WAAWS,GAAU3B,MAAMoB,QAAQT,GAAQkB,gBAAgBC,YAAYF,I,OAAhGpD,SACA,MAAM,CAAN,EAAO,YAIEF,6BAAb,SAA8ByD,EAAoBC,EAAmBC,G,gGAC3DC,EAAY,MACC,SAAM5E,KAAKK,IAAImC,IAAIqC,6BAA6BJ,GAAYK,MAAMC,WAAWL,EAAWC,EAAS,SAACK,GACjH,IAAMC,EAAWD,EAAKE,YAAcF,EAAKG,YACzC9D,QAAQ+D,IAAIH,IACb,KAAML,I,OAHHS,EAAanE,SAInBG,QAAQ+D,IAAI,wBACZ,MAAM,CAAN,EAAOC,SAIErE,sCAAb,SAAuC8D,EAA8DQ,G,+GAE3FV,EAAkB,IAClBW,EAA+B,GACjCC,EAA8B,EAClCV,EAAMW,QAAQ,SAAAC,GAAK,OAAAH,EAAmBI,KAAK,KAC5B,SAAMC,QAAQC,WAAWf,EAAMgB,IAAI,SAACC,EAAGC,GAClD,OAAOpF,EAAKP,IAAImC,IAAIqC,6BAA6BkB,EAAEtB,YAAYK,MAAMC,WAAWgB,EAAEtJ,KAAMsJ,EAAEpB,QAAS,SAACK,GAChG,IAAMG,EAAcH,EAAKiB,UAAYrB,EAAY,EAAII,EAAKG,YAC1D,IAAMe,EAAwBlB,EAAKE,YAAcC,EACjD,GAAII,EAAmBS,GAAO,EAC1BT,EAAmBS,GAAOE,EAC9BV,GAAuBD,IAAkB,MAAlBA,SAAkB,SAAlBA,EAAoBY,OAAO,SAACtK,EAAGuK,GAAM,OAAAvK,EAAIuK,GAAG,KAAKtB,IAAK,MAALA,SAAK,SAALA,EAAOpE,QAC/E,GAAI4E,EACAA,EAAiBE,EAAqB,CAAEa,YAAaN,EAAEtJ,KAAM6J,kBAAmBJ,KACrF,KAAMtB,O,OATP2B,EAASrF,SAWf,MAAM,CAAN,EAAO,CACHqF,OAAM,EACNC,WAAYhB,UAKPxE,+BAAb,SAAgC0C,EAAmBL,G,wFACxC,SAAMrD,KAAKK,IAAImC,IAAID,MAAMqB,WAAWF,GAAWhB,MAAMoB,QAAQT,GAAQkB,gBAAgBxH,O,OAA5F,MAAM,CAAN,EAAOmE,gBAIEF,2BAAb,W,kGACqB,SAAMhB,KAAKK,IAAImC,IAAIiE,YAAY1J,O,OAA1C2J,EAAWxF,SACD,SAAMlB,KAAKK,IAAIsG,KAAKC,kB,OAA9BC,EAAU3F,SACV4F,EAAaJ,EAASK,UAAUpH,SAAS,SAC/C+G,EAASM,eAAiBF,EAC1BJ,EAASO,WAAa,UAAGJ,EAAQK,YAAW,4CAAArH,OAA2C6G,IAAQ,MAARA,SAAQ,SAARA,EAAUS,OACjG,MAAM,CAAN,EAAOT,SAIE1F,4BAAb,SAAgCW,EAAoBmD,EAAoB5D,G,IAAEC,WAAAW,EAAS,SAAH,EAAG,KAAIX,EAAE6B,UAAAV,EAAQ,SAAH,EAAG,KAAIU,EAAmB,S,IAAA,+BAAmB,CAAnBvC,oB,yGACrG,SAAMmF,QAAQwB,IAAItC,IAAK,MAALA,SAAK,SAALA,EAAOgB,IAAI,SAAMuB,GAAI,oC,uDACjC,SAAMrH,KAAKsD,SAAQX,MAAb3C,KAAI6C,GAAalB,EAAY,CAAEG,OAAM,EAAEF,QAAS,0BAAmByF,IAAI,MAAJA,SAAI,SAAJA,EAAMC,KAAI,KAAKhF,MAAOA,IAAK,MAALA,SAAK,EAALA,EAAS,UAASkB,EAAK/C,GAAM,S,OAAvI8G,EAAWrG,SACjB,IAAIqG,IAAQ,MAARA,SAAQ,SAARA,EAAU7G,SAAU,EACpB,MAAO,CAAP,EAAOV,KAAKwH,YAAY,CAAC,EAAD,KAAMH,GAAI,CAAErC,KAAMhF,KAAKwH,YAAYD,GAAU,OAAO,IAChF,MAAM,CAAN,SAAYF,GAAI,CAAErC,KAAM,iB,OAJtByC,EAASxG,SAMf,MAAM,CAAN,EAAOwG,SAIEzG,8BAAb,SAA+B0G,EAAcrE,EAAgBsE,G,oGACnDrF,GAAQqF,IAAG,MAAHA,SAAG,SAAHA,EAAKrF,QAAS,KACtBsF,EAAQ5H,KAAKK,IAAImC,IAAID,MAAM,eAAQD,IAASoF,GAC5ChG,EAAOkG,EAAMlF,MAAMoB,QAAQT,GACX,SAAM3B,EAAKmG,0BAA0BF,EAAIG,iB,OAAzDC,EAAgB7G,SACtB,MAAM,CAAN,EAAO6G,S,QA3IXC,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,MAAO,KACpD,qIAgBAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,OAAO,OACpD,2IASAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,OAAO,OACpD,wEAAkDC,IAAC,aAADA,KAAC,sBAAnD,6DAKAH,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,OAAO,OACpD,+EAAoEC,IAAC,aAADA,KAAC,sBAArE,+DAKAH,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,OAAO,OACpD,8IAKAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,OAAO,OACpD,uJAsBAF,IADC,IAAAC,cAAa,SAACC,GAAQ,OAAA7G,QAAQC,MAAM4G,KACrC,gIAKAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,OAAO,QACpD,4IAMAF,IADC,IAAAC,cAAa,SAACC,GAAQ,OAAA7G,QAAQC,MAAM4G,KACrC,+DAA8EE,OAA9E,qEAWAJ,IADC,IAAAC,cAAa,SAACC,GAAQ,OAAA7G,QAAQC,MAAM4G,KACrC,gJAwBAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,MAAO,KACpD,wIAKAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,OAAO,OACpD,uHAUAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,GAAM,MAAO,KACpD,kJAWAF,IADC,IAAAC,cAAa,SAACC,GAAU7G,QAAQC,MAAM4G,KACvC,8IAOJ,SA7LA,GAAazM,4B,kqCAvBb0D,E,8HAuBA6B,E,6GAAavF,I,gaCnCb,yCAAQmB,uCAAAE,gBAAAC,iBAAA,SAAAiE,gB,wBCARtF,EAAOD,QAAU4M,QAAQ,Y,oCCAzB3M,EAAOD,QAAU4M,QAAQ,wB,8BCAzB3M,EAAOD,QAAU4M,QAAQ,kB,gCCAzB3M,EAAOD,QAAU4M,QAAQ,oB,8BCAzB3M,EAAOD,QAAU4M,QAAQ,kB,8BCAzB3M,EAAOD,QAAU4M,QAAQ,kB,kCCAzB3M,EAAOD,QAAU4M,QAAQ,sB,iCCAzB3M,EAAOD,QAAU4M,QAAQ,qB,wCCAzB3M,EAAOD,QAAU4M,QAAQ,4B,uCCAzB3M,EAAOD,QAAU4M,QAAQ,2B,6BCAzB3M,EAAOD,QAAU4M,QAAQ,iB,mCCAzB3M,EAAOD,QAAU4M,QAAQ","file":"services/index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/services/index.ts\");\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = \"./src/services sync recursive\";","import { DefaultCatch } from 'catch-decorator-ts';\r\nimport {sp} from \"@pnp/sp\";\r\nimport { SPRest, registerCustomRequestClientFactory, SPHttpClient } from '@pnp/sp';\r\nimport type { IRequestClient } from \"@pnp/common\";\r\nimport type { IItemAddResult, IItemUpdateResult } from \"@pnp/sp/items\";\r\nimport type { IFileAddResult, IFileInfo } from '@pnp/sp/files';\r\nimport type { IAttachmentFileInfo } from '@pnp/sp/attachments';\r\nimport type { ISPUser } from '../models/interfaces/ISPUser';\r\nimport type { PermissionKind } from '@pnp/sp/security';\r\nimport type { PnpModules, IBaseItemKey, IItemVersionInfo, PreviousUnion, IQueryOptions } from './IBaseServiceConfig';\r\nimport type { IFetchOptions } from \"@pnp/common\";\r\n\r\nclass CustomSPHttpClient extends SPHttpClient {\r\n    constructor(impl?) { super(impl); }\r\n\r\n    private ensureSitePageUrl(url: string) {\r\n        const tenantUrl = window.location.origin;\r\n        const sitePage = window.location.pathname;\r\n        if (url?.startsWith(tenantUrl) && !url?.includes(sitePage)) {\r\n            url = url.replace(tenantUrl, '');\r\n            url = `${tenantUrl}${sitePage}${url}`;\r\n        }\r\n        return url;\r\n    }\r\n\r\n    public fetch(url: string, options?: IFetchOptions): Promise<Response> {\r\n        return super.fetch(this.ensureSitePageUrl(url), options);\r\n    }\r\n\r\n    public fetchRaw(url: string, options?: IFetchOptions): Promise<Response> {\r\n        return super.fetchRaw(this.ensureSitePageUrl(url), options);\r\n    }\r\n}\r\n\r\n/**@TO-DO: Document this API. */\r\nexport class BaseService {\r\n    public _sp: SPRest = sp;\r\n\r\n    public async init() {\r\n        await import (\"@pnp/sp/webs\");\r\n        await import (\"@pnp/sp/profiles\");\r\n        await import (\"@pnp/sp/site-groups/web\");\r\n        await import (\"@pnp/sp/site-users/web\");\r\n        await import (\"@pnp/sp/lists\");\r\n        await import (\"@pnp/sp/lists/web\");\r\n        await import (\"@pnp/sp/files\");\r\n        await import (\"@pnp/sp/folders\");\r\n        await import (\"@pnp/sp/items\");\r\n        await import (\"@pnp/sp/attachments\");\r\n        if(this.injectedModules.length > 0) {\r\n            for (const module of this.injectedModules)\r\n                try {\r\n                    await import(module);\r\n                } catch (e) {\r\n                    console.error(\"Failed to load module: \" + module, e);\r\n                }\r\n        }\r\n    }\r\n\r\n    constructor(public injectedModules: PnpModules[], private factory?: () => IRequestClient) {\r\n        if(!this.factory)\r\n            registerCustomRequestClientFactory(() => new CustomSPHttpClient());\r\n        else registerCustomRequestClientFactory(this.factory);\r\n        this._sp = sp.configure({ headers: { 'Origin': window.location.origin } }, window.location.origin);\r\n    }\r\n\r\n    private baseItemsSelect: IBaseItemKey = ['Id', 'Title', 'Created', 'Modified'];\r\n    private uniqueSelect = (select: string[]) => {\r\n        if (!select?.length)\r\n            return [];\r\n        return [...new Set(select.concat(this.baseItemsSelect))];\r\n    }\r\n\r\n    public removeOData<T>(baseArr: T[]): T[] {\r\n        return baseArr?.filter(item => {\r\n            for (const key in item)\r\n                if (key?.includes('odata'))\r\n                    delete item[key];\r\n            return true;\r\n        });\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getItems<T>(identifier: string, { filters = null, expand = null, cache = null, top = null, orderBy = null, getBy = 'Title' }: IQueryOptions, ...select: string[]): Promise<T[]> {\r\n        if (!getBy)\r\n            getBy = 'Title';\r\n        const lists = this._sp.web.lists[`getBy${getBy}`](identifier);\r\n        const query = lists.items\r\n            .expand(...expand ?? [])\r\n            .select(...this.uniqueSelect(select) ?? [])\r\n            .filter(filters ?? `Id ne null`)\r\n            .orderBy(orderBy?.column ?? 'Id', orderBy?.ascending !== undefined ? orderBy.ascending : true)\r\n            .top(top || 9999999);\r\n        if (!cache)\r\n            return await query.get<T[]>();\r\n        return query.usingCaching(cache).get<T[]>();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getItem<T>(identifier: string, itemId: number, options: IQueryOptions, ...select: string[]): Promise<T> {\r\n        options = { ...options, getBy: options?.getBy ?? 'Title' }\r\n        const res = await this.getItems<T>(identifier, { ...options, filters: options?.filters ? `${options?.filters} and Id eq ${itemId}` : `Id eq ${itemId}` }, ...select);\r\n        if (res?.length > 0)\r\n            return res[0];\r\n        return null;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null })\r\n    public async saveItem<T>(listTitle: string, hash: T): Promise<IItemAddResult> {\r\n        return await this._sp.web.lists.getByTitle(listTitle).items.add(hash);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null })\r\n    public async updateItem<T>(listTitle: string, itemId: number, hash: T): Promise<IItemUpdateResult> {\r\n        return await this._sp.web.lists.getByTitle(listTitle).items.getById(itemId).update(hash);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    private async getItemByIdSelect(listTitle: string, getBy: 'Title' | 'Id' = 'Title', ...select: string[]) {\r\n        return this._sp.web.lists[`getBy${getBy}`](listTitle).items.select(...this.uniqueSelect(select)).top(9999999);\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getPreviousVersions<T, R = PreviousUnion<T, IItemVersionInfo>[]>\r\n        (listTitle: string, itemId: number, { filters = null, expand = null, getBy = 'Title', orderBy }: Pick<IQueryOptions, 'filters' | 'expand' | 'getBy' | 'orderBy'>, ...select: string[]): Promise<R> {\r\n        const defaultSelect = ['IsCurrentVersion', 'Created', 'VersionId', 'VersionLabel', 'Modified'];\r\n        const orderTuple: [string, boolean] = orderBy ? [orderBy?.column, orderBy?.ascending || false] : ['Created', true];\r\n        const baseItem = await this.getItemByIdSelect(listTitle, getBy, ...select);\r\n        if (!filters) {\r\n            if (!expand)\r\n                return await baseItem.getById(itemId).versions.select(...select, ...defaultSelect)\r\n                    .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n            return await baseItem.expand(...expand).getById(itemId).versions.select(...select, ...defaultSelect).expand(...expand)\r\n                .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n        }\r\n        else {\r\n            if (!expand)\r\n                return await baseItem.getById(itemId).versions.filter(filters).select(...select, ...defaultSelect)\r\n                    .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n            return await baseItem.expand(...expand).getById(itemId).versions.select(...select, ...defaultSelect).filter(filters).expand(...expand)\r\n                .orderBy(orderTuple[0], orderTuple[1]).get<R>();\r\n        }\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async deleteItem(listTitle: string, itemId: number) {\r\n        await this._sp.web.lists.getByTitle(listTitle).items.getById(itemId).delete();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return false; })\r\n    public async sendAttatchments(listName: string, itemId: number, attachments: IAttachmentFileInfo[]) {\r\n        await this._sp.web.lists.getByTitle(listName).items.getById(itemId).attachmentFiles.addMultiple(attachments);\r\n        return true;\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async addFileToLibrary(libraryUrl: string, folderUrl: string, content: File): Promise<IFileAddResult> {\r\n        const chunkSize = 40960;\r\n        const fileAddRes = await this._sp.web.getFolderByServerRelativeUrl(libraryUrl).files.addChunked(folderUrl, content, (data) => {\r\n            const percent = (data.blockNumber / data.totalBlocks);\r\n            console.log(percent);\r\n        }, true, chunkSize);\r\n        console.log(\"File upload succeded\");\r\n        return fileAddRes;\r\n    }\r\n\r\n    @DefaultCatch((err) => console.error(err))\r\n    public async addMultipleFilesToLibrary(files: { name: string, content: File, libraryUrl: string }[], progressCallback?: (generalPorcentage: number, individual: { currentName: string, currentPercentage: number }) => void) {\r\n        type byte = 1000000;\r\n        const chunkSize: byte = 1000000;\r\n        const accumulatorPercent: number[] = [];\r\n        let realTotalPercentage: number = 0;\r\n        files.forEach(_ => accumulatorPercent.push(0));\r\n        const result = await Promise.allSettled(files.map((f, idx) => {\r\n            return this._sp.web.getFolderByServerRelativeUrl(f.libraryUrl).files.addChunked(f.name, f.content, (data) => {\r\n                const totalBlocks = data.fileSize <= chunkSize ? 1 : data.totalBlocks;\r\n                const individualPercentage = (data.blockNumber / totalBlocks);\r\n                if (accumulatorPercent[idx] < 1)\r\n                    accumulatorPercent[idx] = individualPercentage;\r\n                realTotalPercentage = (accumulatorPercent?.reduce((a, b) => a + b, 0) / files?.length);\r\n                if (progressCallback)\r\n                    progressCallback(realTotalPercentage, { currentName: f.name, currentPercentage: individualPercentage });\r\n            }, true, chunkSize);\r\n        }));\r\n        return {\r\n            result,\r\n            percentage: realTotalPercentage\r\n        };\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getItemAttachments(listTitle: string, itemId: number) {\r\n        return await this._sp.web.lists.getByTitle(listTitle).items.getById(itemId).attachmentFiles.get();\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return null; })\r\n    public async getCurrentUser(): Promise<ISPUser> {\r\n        const userInfo = await this._sp.web.currentUser.get() as ISPUser;\r\n        const context = await this._sp.site.getContextInfo();\r\n        const isExternal = userInfo.LoginName.includes(\"#ext#\");\r\n        userInfo.IsExternalUser = isExternal;\r\n        userInfo.ProfilePic = `${context.SiteFullUrl}/_layouts/15/userphoto.aspx?accountname=${userInfo?.Email}`;\r\n        return userInfo;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); return []; })\r\n    public async getFileItemData<T>(identifier: string, files: IFileInfo[], { expand = null, getBy = 'Id' }: IQueryOptions, ...select: string[]) {\r\n        const _files = await Promise.all(files?.map(async file => {\r\n            const fileInfo = await this.getItems<T>(identifier, { expand, filters: `FileLeafRef eq '${file?.Name}'`, getBy: getBy ?? 'Title' }, ...select);\r\n            if (fileInfo?.length >= 1)\r\n                return this.removeOData([{ ...file, data: this.removeOData(fileInfo)[0] }])[0];\r\n            return { ...file, data: null };\r\n        }));\r\n        return _files;\r\n    }\r\n\r\n    @DefaultCatch((err) => { console.error(err); })\r\n    public async hasItemPermission(list: string, itemId: number, opt: { getBy?: 'Id' | 'Title', permissionType: PermissionKind }) {\r\n        const getBy = opt?.getBy || 'Id';\r\n        const _list = this._sp.web.lists[`getBy${getBy}`](list);\r\n        const item = _list.items.getById(itemId);\r\n        const hasPermission = await item.currentUserHasPermissions(opt.permissionType);\r\n        return hasPermission;\r\n    }\r\n}","export {BaseService} from './BaseService';","module.exports = require(\"@pnp/sp\");","module.exports = require(\"@pnp/sp/attachments\");","module.exports = require(\"@pnp/sp/files\");","module.exports = require(\"@pnp/sp/folders\");","module.exports = require(\"@pnp/sp/items\");","module.exports = require(\"@pnp/sp/lists\");","module.exports = require(\"@pnp/sp/lists/web\");","module.exports = require(\"@pnp/sp/profiles\");","module.exports = require(\"@pnp/sp/site-groups/web\");","module.exports = require(\"@pnp/sp/site-users/web\");","module.exports = require(\"@pnp/sp/webs\");","module.exports = require(\"catch-decorator-ts\");"],"sourceRoot":""}