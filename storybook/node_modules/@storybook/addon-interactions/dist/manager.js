var Vt=Object.create;var pt=Object.defineProperty;var Jt=Object.getOwnPropertyDescriptor;var Xt=Object.getOwnPropertyNames;var Yt=Object.getPrototypeOf,Zt=Object.prototype.hasOwnProperty;var Ut=(t,o,e,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of Xt(o))!Zt.call(t,s)&&s!==e&&pt(t,s,{get:()=>o[s],enumerable:!(r=Jt(o,s))||r.enumerable});return t};var A=(t,o,e)=>(e=t!=null?Vt(Yt(t)):{},Ut(o||!t||!t.__esModule?pt(e,"default",{value:t,enumerable:!0}):e,t));var R=require("@storybook/addons");var et="storybook/interactions",dt=`${et}/panel`;var U=A(require("global")),i=A(require("react")),q=require("@storybook/api"),T=require("@storybook/core-events"),I=require("@storybook/instrumenter");var C=A(require("react")),L=require("@storybook/components"),Z=require("@storybook/instrumenter"),D=require("@storybook/theming"),vt=require("polished");var p=A(require("react")),g=require("@storybook/components"),yt=require("@storybook/instrumenter"),_=require("@storybook/theming");var ut=A(require("react")),v=require("@storybook/instrumenter"),F=require("@storybook/theming"),qt=F.styled.div(({theme:t,status:o})=>{let e={[v.CallStates.DONE]:t.color.positive,[v.CallStates.ERROR]:t.color.negative,[v.CallStates.ACTIVE]:t.color.warning,[v.CallStates.WAITING]:t.color.warning}[o];return{padding:"4px 6px 4px 8px;",borderRadius:"4px",backgroundColor:e,color:"white",fontFamily:F.typography.fonts.base,textTransform:"uppercase",fontSize:F.typography.size.s1,letterSpacing:3,fontWeight:F.typography.weight.bold,width:65,textAlign:"center"}}),gt=({status:t})=>{let o={[v.CallStates.DONE]:"Pass",[v.CallStates.ERROR]:"Fail",[v.CallStates.ACTIVE]:"Runs",[v.CallStates.WAITING]:"Runs"}[t];return ut.default.createElement(qt,{status:t},o)};var Kt=_.styled.div(({theme:t})=>({background:t.background.app,borderBottom:`1px solid ${t.appBorderColor}`,position:"sticky",top:0,zIndex:1})),Qt=_.styled.nav(({theme:t})=>({height:40,display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:15})),to=(0,_.styled)(g.Button)(({theme:t})=>({borderRadius:4,padding:6,color:t.textMutedColor,"&:not(:disabled)":{"&:hover,&:focus-visible":{color:t.color.secondary}}})),W=(0,_.styled)(g.TooltipNote)(({theme:t})=>({fontFamily:t.typography.fonts.base})),z=(0,_.styled)(g.IconButton)(({theme:t})=>({color:t.textMutedColor,margin:"0 3px"})),oo=(0,_.styled)(g.Separator)({marginTop:0}),eo=(0,_.styled)(g.P)(({theme:t})=>({color:t.textMutedColor,justifyContent:"flex-end",textAlign:"right",whiteSpace:"nowrap",marginTop:"auto",marginBottom:1,paddingRight:15,fontSize:13})),mt=_.styled.div({display:"flex",alignItems:"center"}),no=(0,_.styled)(z)({marginLeft:9}),ro=(0,_.styled)(to)({marginLeft:9,marginRight:9,marginBottom:1,lineHeight:"12px"}),so=(0,_.styled)(z)(({theme:t,animating:o,disabled:e})=>({opacity:e?.5:1,svg:{animation:o&&`${t.animation.rotate360} 200ms ease-out`}})),ft=({controls:t,controlStates:o,status:e,storyFileName:r,onScrollToEnd:s,isRerunAnimating:l,setIsRerunAnimating:a})=>{let c=e===yt.CallStates.ERROR?"Scroll to error":"Scroll to end";return p.default.createElement(Kt,null,p.default.createElement(g.Bar,null,p.default.createElement(Qt,null,p.default.createElement(mt,null,p.default.createElement(gt,{status:e}),p.default.createElement(ro,{onClick:s,disabled:!s},c),p.default.createElement(oo,null),p.default.createElement(g.WithTooltip,{hasChrome:!1,tooltip:p.default.createElement(W,{note:"Go to start"})},p.default.createElement(no,{"aria-label":"Go to start",containsIcon:!0,onClick:t.start,disabled:!o.start},p.default.createElement(g.Icons,{icon:"rewind"}))),p.default.createElement(g.WithTooltip,{hasChrome:!1,tooltip:p.default.createElement(W,{note:"Go back"})},p.default.createElement(z,{"aria-label":"Go back",containsIcon:!0,onClick:t.back,disabled:!o.back},p.default.createElement(g.Icons,{icon:"playback"}))),p.default.createElement(g.WithTooltip,{hasChrome:!1,tooltip:p.default.createElement(W,{note:"Go forward"})},p.default.createElement(z,{"aria-label":"Go forward",containsIcon:!0,onClick:t.next,disabled:!o.next},p.default.createElement(g.Icons,{icon:"playnext"}))),p.default.createElement(g.WithTooltip,{hasChrome:!1,tooltip:p.default.createElement(W,{note:"Go to end"})},p.default.createElement(z,{"aria-label":"Go to end",containsIcon:!0,onClick:t.end,disabled:!o.end},p.default.createElement(g.Icons,{icon:"fastforward"}))),p.default.createElement(g.WithTooltip,{hasChrome:!1,tooltip:p.default.createElement(W,{note:"Rerun"})},p.default.createElement(so,{"aria-label":"Rerun",containsIcon:!0,onClick:t.rerun,onAnimationEnd:()=>a(!1),animating:l,disabled:l},p.default.createElement(g.Icons,{icon:"sync"})))),r&&p.default.createElement(mt,null,p.default.createElement(eo,null,r)))))};var f=A(require("react")),B=require("@storybook/components"),P=require("@storybook/instrumenter"),S=require("@storybook/theming"),Tt=require("polished");var u=A(require("react")),H=require("@storybook/theming");var Ct=require("@devtools-ds/object-inspector"),J=require("@storybook/theming"),n=A(require("react")),ao={base:"#444",nullish:"#7D99AA",string:"#16B242",number:"#5D40D0",boolean:"#f41840",objectkey:"#698394",instance:"#A15C20",function:"#EA7509",muted:"#7D99AA",tag:{name:"#6F2CAC",suffix:"#1F99E5"},date:"#459D9C",error:{name:"#D43900",message:"#444"},regex:{source:"#A15C20",flags:"#EA7509"},meta:"#EA7509",method:"#0271B6"},lo={base:"#eee",nullish:"#aaa",string:"#5FE584",number:"#6ba5ff",boolean:"#ff4191",objectkey:"#accfe6",instance:"#E3B551",function:"#E3B551",muted:"#aaa",tag:{name:"#f57bff",suffix:"#8EB5FF"},date:"#70D4D3",error:{name:"#f40",message:"#eee"},regex:{source:"#FAD483",flags:"#E3B551"},meta:"#FAD483",method:"#5EC1FF"},b=()=>{let{base:t}=(0,J.useTheme)();return t==="dark"?lo:ao},io=/[^A-Z0-9]/i,bt=/[\s.,â€¦]+$/gm,ht=(t,o)=>{if(t.length<=o)return t;for(let e=o-1;e>=0;e-=1)if(io.test(t[e])&&e>10)return`${t.slice(0,e).replace(bt,"")}\u2026`;return`${t.slice(0,o).replace(bt,"")}\u2026`},co=t=>{try{return JSON.stringify(t,null,1)}catch{return String(t)}},St=(t,o)=>t.flatMap((e,r)=>r===t.length-1?[e]:[e,n.default.cloneElement(o,{key:`sep${r}`})]),N=({value:t,nested:o,showObjectInspector:e,callsById:r,...s})=>{switch(!0){case t===null:return n.default.createElement(po,{...s});case t===void 0:return n.default.createElement(uo,{...s});case Array.isArray(t):return n.default.createElement(fo,{...s,value:t,callsById:r});case typeof t=="string":return n.default.createElement(go,{...s,value:t});case typeof t=="number":return n.default.createElement(mo,{...s,value:t});case typeof t=="boolean":return n.default.createElement(yo,{...s,value:t});case Object.prototype.hasOwnProperty.call(t,"__date__"):return n.default.createElement(Io,{...s,...t.__date__});case Object.prototype.hasOwnProperty.call(t,"__error__"):return n.default.createElement(xo,{...s,...t.__error__});case Object.prototype.hasOwnProperty.call(t,"__regexp__"):return n.default.createElement(Eo,{...s,...t.__regexp__});case Object.prototype.hasOwnProperty.call(t,"__function__"):return n.default.createElement(ho,{...s,...t.__function__});case Object.prototype.hasOwnProperty.call(t,"__symbol__"):return n.default.createElement(_o,{...s,...t.__symbol__});case Object.prototype.hasOwnProperty.call(t,"__element__"):return n.default.createElement(So,{...s,...t.__element__});case Object.prototype.hasOwnProperty.call(t,"__class__"):return n.default.createElement(Co,{...s,...t.__class__});case Object.prototype.hasOwnProperty.call(t,"__callId__"):return n.default.createElement(X,{call:r.get(t.__callId__),callsById:r});case Object.prototype.toString.call(t)==="[object Object]":return n.default.createElement(bo,{value:t,showInspector:e,...s});default:return n.default.createElement(ko,{value:t,...s})}},po=t=>{let o=b();return n.default.createElement("span",{style:{color:o.nullish},...t},"null")},uo=t=>{let o=b();return n.default.createElement("span",{style:{color:o.nullish},...t},"undefined")},go=({value:t,...o})=>{let e=b();return n.default.createElement("span",{style:{color:e.string},...o},JSON.stringify(ht(t,50)))},mo=({value:t,...o})=>{let e=b();return n.default.createElement("span",{style:{color:e.number},...o},t)},yo=({value:t,...o})=>{let e=b();return n.default.createElement("span",{style:{color:e.boolean},...o},String(t))},fo=({value:t,nested:o=!1,callsById:e})=>{let r=b();if(o)return n.default.createElement("span",{style:{color:r.base}},"[\u2026]");let s=t.slice(0,3).map(a=>n.default.createElement(N,{key:JSON.stringify(a),value:a,nested:!0,callsById:e})),l=St(s,n.default.createElement("span",null,", "));return t.length<=3?n.default.createElement("span",{style:{color:r.base}},"[",l,"]"):n.default.createElement("span",{style:{color:r.base}},"(",t.length,") [",l,", \u2026]")},bo=({showInspector:t,value:o,nested:e=!1})=>{let r=(0,J.useTheme)().base==="dark",s=b();if(t)return n.default.createElement(n.default.Fragment,null,n.default.createElement(Ct.ObjectInspector,{id:"interactions-object-inspector",data:o,includePrototypes:!1,colorScheme:r?"dark":"light"}));if(e)return n.default.createElement("span",{style:{color:s.base}},"{\u2026}");let l=St(Object.entries(o).slice(0,2).map(([a,c])=>n.default.createElement(n.Fragment,{key:a},n.default.createElement("span",{style:{color:s.objectkey}},a,": "),n.default.createElement(N,{value:c,nested:!0}))),n.default.createElement("span",null,", "));return Object.keys(o).length<=2?n.default.createElement("span",{style:{color:s.base}},"{ ",l," }"):n.default.createElement("span",{style:{color:s.base}},"(",Object.keys(o).length,") ","{ ",l,", \u2026 }")},Co=({name:t})=>{let o=b();return n.default.createElement("span",{style:{color:o.instance}},t)},ho=({name:t})=>{let o=b();return t?n.default.createElement("span",{style:{color:o.function}},t):n.default.createElement("span",{style:{color:o.nullish,fontStyle:"italic"}},"anonymous")},So=({prefix:t,localName:o,id:e,classNames:r=[],innerText:s})=>{let l=t?`${t}:${o}`:o,a=b();return n.default.createElement("span",{style:{wordBreak:"keep-all"}},n.default.createElement("span",{key:`${l}_lt`,style:{color:a.muted}},"<"),n.default.createElement("span",{key:`${l}_tag`,style:{color:a.tag.name}},l),n.default.createElement("span",{key:`${l}_suffix`,style:{color:a.tag.suffix}},e?`#${e}`:r.reduce((c,y)=>`${c}.${y}`,"")),n.default.createElement("span",{key:`${l}_gt`,style:{color:a.muted}},">"),!e&&r.length===0&&s&&n.default.createElement(n.default.Fragment,null,n.default.createElement("span",{key:`${l}_text`},s),n.default.createElement("span",{key:`${l}_close_lt`,style:{color:a.muted}},"<"),n.default.createElement("span",{key:`${l}_close_tag`,style:{color:a.tag.name}},"/",l),n.default.createElement("span",{key:`${l}_close_gt`,style:{color:a.muted}},">")))},Io=({value:t})=>{let[o,e,r]=t.split(/[T.Z]/),s=b();return n.default.createElement("span",{style:{whiteSpace:"nowrap",color:s.date}},o,n.default.createElement("span",{style:{opacity:.7}},"T"),e==="00:00:00"?n.default.createElement("span",{style:{opacity:.7}},e):e,r==="000"?n.default.createElement("span",{style:{opacity:.7}},".",r):`.${r}`,n.default.createElement("span",{style:{opacity:.7}},"Z"))},xo=({name:t,message:o})=>{let e=b();return n.default.createElement("span",{style:{color:e.error.name}},t,o&&": ",o&&n.default.createElement("span",{style:{color:e.error.message},title:o.length>50?o:""},ht(o,50)))},Eo=({flags:t,source:o})=>{let e=b();return n.default.createElement("span",{style:{whiteSpace:"nowrap",color:e.regex.flags}},"/",n.default.createElement("span",{style:{color:e.regex.source}},o),"/",t)},_o=({description:t})=>{let o=b();return n.default.createElement("span",{style:{whiteSpace:"nowrap",color:o.instance}},"Symbol(",t&&n.default.createElement("span",{style:{color:o.meta}},'"',t,'"'),")")},ko=({value:t})=>{let o=b();return n.default.createElement("span",{style:{color:o.meta}},co(t))},wo=({label:t})=>{let o=b(),{typography:e}=(0,J.useTheme)();return n.default.createElement("span",{style:{color:o.base,fontFamily:e.fonts.base,fontSize:e.size.s2-1}},t)},X=({call:t,callsById:o})=>{if(!t)return null;if(t.method==="step"&&t.path.length===0)return n.default.createElement(wo,{label:t.args[0]});let e=t.path.flatMap((l,a)=>{let c=l.__callId__;return[c?n.default.createElement(X,{key:`elem${a}`,call:o.get(c),callsById:o}):n.default.createElement("span",{key:`elem${a}`},l),n.default.createElement("wbr",{key:`wbr${a}`}),n.default.createElement("span",{key:`dot${a}`},".")]}),r=t.args.flatMap((l,a,c)=>{let y=n.default.createElement(N,{key:`node${a}`,value:l,callsById:o});return a<c.length-1?[y,n.default.createElement("span",{key:`comma${a}`},",\xA0"),n.default.createElement("wbr",{key:`wbr${a}`})]:[y]}),s=b();return n.default.createElement(n.default.Fragment,null,n.default.createElement("span",{style:{color:s.base}},e),n.default.createElement("span",{style:{color:s.method}},t.method),n.default.createElement("span",{style:{color:s.base}},"(",n.default.createElement("wbr",null),r,n.default.createElement("wbr",null),")"))};var It=(t,o=0)=>{for(let e=o,r=1;e<t.length;e+=1)if(t[e]==="("?r+=1:t[e]===")"&&(r-=1),r===0)return t.slice(o,e);return""},nt=t=>{try{return t==="undefined"?void 0:JSON.parse(t)}catch{return t}},Ao=H.styled.span(({theme:t})=>({color:t.base==="light"?t.color.positiveText:t.color.positive})),To=H.styled.span(({theme:t})=>({color:t.base==="light"?t.color.negativeText:t.color.negative})),rt=({value:t,parsed:o})=>o?u.default.createElement(N,{showObjectInspector:!0,value:t,style:{color:"#D43900"}}):u.default.createElement(To,null,t),st=({value:t,parsed:o})=>o?typeof t=="string"&&t.startsWith("called with")?u.default.createElement(u.default.Fragment,null,t):u.default.createElement(N,{showObjectInspector:!0,value:t,style:{color:"#16B242"}}):u.default.createElement(Ao,null,t),xt=({message:t})=>{let o=t.split(`
`);return u.default.createElement("pre",{style:{margin:0,padding:"8px 10px 8px 36px",fontSize:H.typography.size.s1}},o.flatMap((e,r)=>{if(e.startsWith("expect(")){let m=It(e,7),h=m&&7+m.length,x=m&&e.slice(h).match(/\.(to|last|nth)[A-Z]\w+\(/);if(x){let E=h+x.index+x[0].length,k=It(e,E);if(k)return["expect(",u.default.createElement(rt,{key:`received_${m}`,value:m}),e.slice(h,E),u.default.createElement(st,{key:`expected_${k}`,value:k}),e.slice(E+k.length),u.default.createElement("br",{key:`br${r}`})]}}if(e.match(/^\s*- /))return[u.default.createElement(st,{key:e+r,value:e}),u.default.createElement("br",{key:`br${r}`})];if(e.match(/^\s*\+ /))return[u.default.createElement(rt,{key:e+r,value:e}),u.default.createElement("br",{key:`br${r}`})];let[,s,l]=e.match(/^(Expected|Received): (.*)$/)||[];if(s&&l)return s==="Expected"?["Expected: ",u.default.createElement(st,{key:e+r,value:nt(l),parsed:!0}),u.default.createElement("br",{key:`br${r}`})]:["Received: ",u.default.createElement(rt,{key:e+r,value:nt(l),parsed:!0}),u.default.createElement("br",{key:`br${r}`})];let[,a,c]=e.match(/(Expected number|Received number|Number) of calls: (\d+)$/i)||[];if(a&&c)return[`${a} of calls: `,u.default.createElement(N,{key:e+r,value:Number(c)}),u.default.createElement("br",{key:`br${r}`})];let[,y]=e.match(/^Received has value: (.+)$/)||[];return y?["Received has value: ",u.default.createElement(N,{key:e+r,value:nt(y)}),u.default.createElement("br",{key:`br${r}`})]:[u.default.createElement("span",{key:e+r},e),u.default.createElement("br",{key:`br${r}`})]}))};var _t=A(require("react")),kt=require("@storybook/components"),w=require("@storybook/instrumenter"),wt=require("@storybook/theming"),At=require("polished");var Oo={pure:{gray:{500:"#CCCCCC"}}},vo={colors:Oo},Et=vo;var{colors:{pure:{gray:No}}}=Et,Po=(0,wt.styled)(kt.Icons)(({theme:t,status:o})=>{let e={[w.CallStates.DONE]:t.color.positive,[w.CallStates.ERROR]:t.color.negative,[w.CallStates.ACTIVE]:t.color.secondary,[w.CallStates.WAITING]:(0,At.transparentize)(.5,No[500])}[o];return{width:o===w.CallStates.WAITING?6:12,height:o===w.CallStates.WAITING?6:12,color:e,justifySelf:"center"}}),Y=({status:t,className:o})=>{let e={[w.CallStates.DONE]:"check",[w.CallStates.ERROR]:"stopalt",[w.CallStates.ACTIVE]:"play",[w.CallStates.WAITING]:"circle"}[t];return _t.default.createElement(Po,{"data-testid":`icon-${t}`,status:t,icon:e,className:o})};var Bo=S.styled.div(()=>({fontFamily:S.typography.fonts.mono,fontSize:S.typography.size.s1,overflowWrap:"break-word",inlineSize:"calc( 100% - 40px )"})),$o=(0,S.styled)("div",{shouldForwardProp:t=>!["call","pausedAt"].includes(t.toString())})(({theme:t,call:o})=>({position:"relative",display:"flex",flexDirection:"column",borderBottom:`1px solid ${t.appBorderColor}`,fontFamily:S.typography.fonts.base,fontSize:13,...o.status===P.CallStates.ERROR&&{backgroundColor:t.base==="dark"?(0,Tt.transparentize)(.93,t.color.negative):t.background.warning},paddingLeft:o.ancestors.length*20}),({theme:t,call:o,pausedAt:e})=>e===o.id&&{"&::before":{content:'""',position:"absolute",top:-5,zIndex:1,borderTop:"4.5px solid transparent",borderLeft:`7px solid ${t.color.warning}`,borderBottom:"4.5px solid transparent"},"&::after":{content:'""',position:"absolute",top:-1,zIndex:1,width:"100%",borderTop:`1.5px solid ${t.color.warning}`}}),Do=S.styled.div(({theme:t,isInteractive:o})=>({display:"flex","&:hover":o?{}:{background:t.background.hoverable}})),Mo=(0,S.styled)("button",{shouldForwardProp:t=>!["call"].includes(t.toString())})(({theme:t,disabled:o,call:e})=>({flex:1,display:"grid",background:"none",border:0,gridTemplateColumns:"15px 1fr",alignItems:"center",minHeight:40,margin:0,padding:"8px 15px",textAlign:"start",cursor:o||e.status===P.CallStates.ERROR?"default":"pointer","&:focus-visible":{outline:0,boxShadow:`inset 3px 0 0 0 ${e.status===P.CallStates.ERROR?t.color.warning:t.color.secondary}`,background:e.status===P.CallStates.ERROR?"transparent":t.background.hoverable},"& > div":{opacity:e.status===P.CallStates.WAITING?.5:1}})),Fo=S.styled.div({padding:6}),Lo=(0,S.styled)(B.IconButton)(({theme:t})=>({color:t.textMutedColor,margin:"0 3px"})),jo=(0,S.styled)(B.TooltipNote)(({theme:t})=>({fontFamily:t.typography.fonts.base})),Wo=(0,S.styled)("div")(({theme:t})=>({padding:"8px 10px 8px 36px",fontSize:S.typography.size.s1,color:t.color.defaultText,pre:{margin:0,padding:0}})),zo=({exception:t})=>{if(t.message.startsWith("expect("))return f.createElement(xt,{...t});let o=t.message.split(`

`),e=o.length>1;return f.createElement(Wo,null,f.createElement("pre",null,o[0]),e&&f.createElement("p",null,"See the full stack trace in the browser console."))},Ot=({call:t,callsById:o,controls:e,controlStates:r,childCallIds:s,isHidden:l,isCollapsed:a,toggleCollapsed:c,pausedAt:y})=>{var E;let[m,h]=f.useState(!1),x=!r.goto||!t.interceptable||!!t.ancestors.length;return l?null:f.createElement($o,{call:t,pausedAt:y},f.createElement(Do,{isInteractive:x},f.createElement(Mo,{call:t,onClick:()=>e.goto(t.id),disabled:x,onMouseEnter:()=>r.goto&&h(!0),onMouseLeave:()=>r.goto&&h(!1)},f.createElement(Y,{status:m?P.CallStates.ACTIVE:t.status}),f.createElement(Bo,{style:{marginLeft:6,marginBottom:1}},f.createElement(X,{call:t,callsById:o}))),f.createElement(Fo,null,(s==null?void 0:s.length)>0&&f.createElement(B.WithTooltip,{hasChrome:!1,tooltip:f.createElement(jo,{note:`${a?"Show":"Hide"} interactions`})},f.createElement(Lo,{containsIcon:!0,onClick:c},f.createElement(B.Icons,{icon:"listunordered"}))))),t.status===P.CallStates.ERROR&&((E=t.exception)==null?void 0:E.callId)===t.id&&f.createElement(zo,{exception:t.exception}))};var Ho=D.styled.div(({theme:t,withException:o})=>({minHeight:"100%",background:t.background.content,...o&&{backgroundColor:t.base==="dark"?(0,vt.transparentize)(.93,t.color.negative):t.background.warning}})),Ro=D.styled.div(({theme:t})=>({padding:15,fontSize:t.typography.size.s2-1,lineHeight:"19px"})),Go=D.styled.code(({theme:t})=>({margin:"0 1px",padding:3,fontSize:t.typography.size.s1-1,lineHeight:1,verticalAlign:"top",background:"rgba(0, 0, 0, 0.05)",border:`1px solid ${t.appBorderColor}`,borderRadius:3})),Vo=D.styled.div({paddingBottom:4,fontWeight:"bold"}),Jo=D.styled.p({margin:0,padding:"0 0 20px"}),Xo=D.styled.pre(({theme:t})=>({margin:0,padding:0,fontSize:t.typography.size.s1-1})),Nt=C.memo(function({calls:o,controls:e,controlStates:r,interactions:s,fileName:l,hasException:a,caughtException:c,isPlaying:y,pausedAt:m,onScrollToEnd:h,endRef:x,isRerunAnimating:E,setIsRerunAnimating:k,...K}){var $;return C.createElement(L.AddonPanel,{...K},C.createElement(Ho,{withException:!!c},r.debugger&&(s.length>0||a||E)&&C.createElement(ft,{controls:e,controlStates:r,status:y?Z.CallStates.ACTIVE:a?Z.CallStates.ERROR:Z.CallStates.DONE,storyFileName:l,onScrollToEnd:h,isRerunAnimating:E,setIsRerunAnimating:k}),C.createElement("div",null,s.map(O=>C.createElement(Ot,{key:O.id,call:O,callsById:o,controls:e,controlStates:r,childCallIds:O.childCallIds,isHidden:O.isHidden,isCollapsed:O.isCollapsed,toggleCollapsed:O.toggleCollapsed,pausedAt:m}))),c&&!(($=c.message)!=null&&$.startsWith("ignoredException"))&&C.createElement(Ro,null,C.createElement(Vo,null,"Caught exception in ",C.createElement(Go,null,"play")," function"),C.createElement(Jo,null,"This story threw an error after it finished rendering which means your interactions couldn' t be run.Go to this story' s play function in ",l," to fix."),C.createElement(Xo,{"data-chromatic":"ignore"},c.stack||`${c.name}: ${c.message}`)),C.createElement("div",{ref:x}),!y&&!c&&s.length===0&&C.createElement(L.Placeholder,null,"No interactions found",C.createElement(L.Link,{href:"https://storybook.js.org/docs/react/writing-stories/play-function",target:"_blank",withArrow:!0},"Learn how to add interactions to your story"))))});var Pt=require("@storybook/theming"),Bt=A(require("react-dom"));var $t=({children:t})=>{let o=global.document.getElementById("tabbutton-interactions");return o&&Bt.default.createPortal(t,o)},Dt=(0,Pt.styled)(Y)({marginLeft:5});var Yo={debugger:!1,start:!1,back:!1,goto:!1,next:!1,end:!1},Mt=({log:t,calls:o,collapsed:e,setCollapsed:r})=>{let s=new Map,l=new Map;return t.map(({callId:a,ancestors:c,status:y})=>{let m=!1;return c.forEach(h=>{e.has(h)&&(m=!0),l.set(h,(l.get(h)||[]).concat(a))}),{...o.get(a),status:y,isHidden:m}}).map(a=>{var y;let c=a.status===I.CallStates.ERROR&&((y=s.get(a.ancestors.slice(-1)[0]))==null?void 0:y.status)===I.CallStates.ACTIVE?I.CallStates.ACTIVE:a.status;return s.set(a.id,{...a,status:c}),{...a,status:c,childCallIds:l.get(a.id),isCollapsed:e.has(a.id),toggleCollapsed:()=>r(m=>(m.has(a.id)?m.delete(a.id):m.add(a.id),new Set(m)))}})},Ft=t=>{let[o,e]=i.useState(),[r,s]=i.useState(Yo),[l,a]=i.useState(),[c,y]=i.useState(!1),[m,h]=i.useState(!1),[x,E]=i.useState(!1),[k,K]=i.useState(),[$,O]=i.useState(new Set),[Q,tt]=i.useState(),[G,at]=i.useState([]),[lt,Lt]=i.useState(),it=i.useRef([]),V=i.useRef(new Map),jt=({status:d,...j})=>V.current.set(j.id,j),ot=i.useRef();i.useEffect(()=>{let d;return U.default.window.IntersectionObserver&&(d=new U.default.window.IntersectionObserver(([j])=>K(j.isIntersecting?void 0:j.target),{root:U.default.window.document.querySelector("#panel-tab-content")}),ot.current&&d.observe(ot.current)),()=>d==null?void 0:d.disconnect()},[]);let M=(0,q.useChannel)({[I.EVENTS.CALL]:jt,[I.EVENTS.SYNC]:d=>{s(d.controlStates),a(d.pausedAt),at(Mt({log:d.logItems,calls:V.current,collapsed:$,setCollapsed:O})),it.current=d.logItems},[T.STORY_RENDER_PHASE_CHANGED]:d=>{e(d.storyId),h(d.newPhase==="playing"),a(void 0),d.newPhase==="rendering"&&(y(!1),tt(void 0))},[T.STORY_THREW_EXCEPTION]:()=>{y(!0)},[T.PLAY_FUNCTION_THREW_EXCEPTION]:d=>{(d==null?void 0:d.message)!==T.IGNORED_EXCEPTION.message?tt(d):tt(void 0)}},[$]);i.useEffect(()=>{at(Mt({log:it.current,calls:V.current,collapsed:$,setCollapsed:O}))},[$]),i.useEffect(()=>{m||x||Lt(G.filter(({method:d})=>d!=="step").length)},[G,m,x]);let Wt=i.useMemo(()=>({start:()=>M(I.EVENTS.START,{storyId:o}),back:()=>M(I.EVENTS.BACK,{storyId:o}),goto:d=>M(I.EVENTS.GOTO,{storyId:o,callId:d}),next:()=>M(I.EVENTS.NEXT,{storyId:o}),end:()=>M(I.EVENTS.END,{storyId:o}),rerun:()=>{E(!0),M(T.FORCE_REMOUNT,{storyId:o})}}),[o]),zt=(0,q.useParameter)("fileName",""),[Ht]=zt.toString().split("/").slice(-1),Rt=()=>k==null?void 0:k.scrollIntoView({behavior:"smooth",block:"end"}),Gt=lt>0||!!Q||x,ct=!!Q||G.some(d=>d.status===I.CallStates.ERROR);return c?i.createElement(i.Fragment,{key:"interactions"}):i.createElement(i.Fragment,{key:"interactions"},i.createElement($t,null,Gt&&(ct?i.createElement(Dt,{status:I.CallStates.ERROR}):` (${lt})`)),i.createElement(Nt,{calls:V.current,controls:Wt,controlStates:r,interactions:G,fileName:Ht,hasException:ct,caughtException:Q,isPlaying:m,pausedAt:l,endRef:ot,onScrollToEnd:k&&Rt,isRerunAnimating:x,setIsRerunAnimating:E,...t}))};R.addons.register(et,()=>{R.addons.add(dt,{type:R.types.PANEL,title:"Interactions",match:({viewMode:t})=>t==="story",render:Ft})});
