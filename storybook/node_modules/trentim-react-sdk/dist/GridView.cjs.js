"use strict";var Ur=Object.defineProperty;var Yr=(t,i,n)=>i in t?Ur(t,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[i]=n;var xt=(t,i,n)=>(Yr(t,typeof i!="symbol"?i+"":i,n),n);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const $=require("react"),We=require("./general.dd882aa0.js"),o=require("./IconButton.34226127.js"),ne=require("./Overlay.620ddc0e.js");require("react-dom");const $r=t=>t&&typeof t=="object"&&"default"in t?t:{default:t};function jr(t){if(t&&t.__esModule)return t;const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const e=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(i,n,e.get?e:{enumerable:!0,get:()=>t[n]})}}return i.default=t,Object.freeze(i)}const K=$r($),h=jr($);class In{static groupMaps(i){const n=new Map;return i.forEach((e,r,a)=>{let s=r.split("_")[1];!s&&!r.includes("_")&&(s=r);const l=!n.has(s),c=[...a].filter(d=>d[0]===r);if(l)n.set(s,new Map(c));else{const d=n.get(s);c.forEach(g=>d==null?void 0:d.set(g[0],g[1]))}}),n}}xt(In,"mapFilterOptions",i=>i.filter(n=>(n==null?void 0:n.text)!==null&&(n==null?void 0:n.text)!==void 0).map(({key:n,text:e,data:r})=>({key:n,text:e,data:r})));const Ii=class{static buildFilters(i,n,e){var s,l;const r=[],a=Ii.filterFromColumns(e,n);for(let c=0;c<a.length;c++){const d=a[c],g=(s=d==null?void 0:d.renderFilterAs)!=null?s:"Dropdown",m=d==null?void 0:d.key,u=(l=i==null?void 0:i.filter(p=>p))==null?void 0:l.map((p,_)=>{var b,y,C,x;let v=(b=We.getDeepValue(p,m))==null?void 0:b.toString();return(y=d==null?void 0:d.dateConversionOptions)!=null&&y.shouldConvertToLocaleString&&(v=We.convertIsoToLocaleString(v,(C=d==null?void 0:d.dateConversionOptions)==null?void 0:C.locales,(x=d==null?void 0:d.dateConversionOptions)==null?void 0:x.formatOptions)),{key:_+"_"+(d==null?void 0:d.key),text:v,data:p}}),f=u==null?void 0:u.filter((p,_,v)=>v.map(b=>b==null?void 0:b.text).indexOf(p==null?void 0:p.text)===_);r.push({key:d==null?void 0:d.key,options:f,enableMultiple:!0,name:d==null?void 0:d.name,renderAs:g})}return r}};let dt=Ii;xt(dt,"onApplyFilter",({allRows:i,setActualRows:n,setIsFilterPanel:e,applyCustomFilter:r,onItemsFiltered:a,onFilterPanelCancel:s})=>l=>{if(r){const g=In.groupMaps(l);return r({allRows:i,setActualRows:n,setIsFilterPanel:e,selectedItems:l,groupedMaps:g})}if(l.size===0)return n(i),a&&a(i),s&&s("not-selected"),e(!1);const c=In.groupMaps(l);let d=[];for(const[g,m]of c.entries()){const u=(d==null?void 0:d.length)>0?d:i;m==null||m.forEach(f=>{var v,b,y,C;const p=!!((v=f==null?void 0:f.data)!=null&&v.from)&&!!((b=f==null?void 0:f.data)!=null&&b.to),_=u.filter(x=>{var R,D;if(p){const S=(R=f==null?void 0:f.data)==null?void 0:R.from,I=(D=f==null?void 0:f.data)==null?void 0:D.to,N=new Date(We.getDeepValue(x,g));return N>=S&&N<=I}return We.getDeepValue(x,g)===(f==null?void 0:f.text)});_.length>0&&!((C=d==null?void 0:d.map(x=>x==null?void 0:x.Id))!=null&&C.includes((y=f==null?void 0:f.data)==null?void 0:y.Id))&&d.push(..._)})}d=d.filter((g,m,u)=>u.map(f=>f==null?void 0:f.Id).indexOf(g==null?void 0:g.Id)===m);for(const[g,m]of c.entries()){const u=[...m.values()],f=d.filter(p=>{const _=We.getDeepValue(p,g);return u.some(v=>{var b,y,C,x;if(((b=v==null?void 0:v.data)==null?void 0:b.from)&&((y=v==null?void 0:v.data)==null?void 0:y.to)){const R=(C=v==null?void 0:v.data)==null?void 0:C.from,D=(x=v==null?void 0:v.data)==null?void 0:x.to,S=new Date(_);return S>=R&&S<=D}return(v==null?void 0:v.text)===_})});(f==null?void 0:f.length)>0&&(d=f)}d=d.filter((g,m,u)=>u.map(f=>f==null?void 0:f.Id).indexOf(g==null?void 0:g.Id)===m),n(d),e(!1),a&&a(d)}),xt(dt,"filterFromColumns",(i,n)=>n.filter(e=>!(i!=null&&i.includes(e==null?void 0:e.key)))),xt(dt,"onSearchItemChange",({allRows:i,searchBoxItems:n,setActualRows:e,onSearchBoxItemsFiltered:r})=>(a,s)=>{const l=[];if(!a)return e(i),[];for(const c of s){const g=((l==null?void 0:l.length)>0?l:i).filter(m=>{var f,p;const u=(f=We.getDeepValue(m,c))==null?void 0:f.toString();return(p=u==null?void 0:u.toLowerCase())==null?void 0:p.startsWith(a==null?void 0:a.toLowerCase())});l.push(...g)}return n.current=l,r&&r(l),l});var we=(t=>(t[t.NONE=0]="NONE",t[t.WEEK=1]="WEEK",t[t.MONTH=2]="MONTH",t[t.YEAR=3]="YEAR",t[t.CUSTOM=4]="CUSTOM",t))(we||{}),Qt=(t=>(t[t.CLICK=0]="CLICK",t[t.ENTER=1]="ENTER",t))(Qt||{}),At=(t=>(t[t.ascending=1]="ascending",t[t.descending=2]="descending",t))(At||{});const An=class{};let bt=An;xt(bt,"onApplyGrouping",({setGroups:i,setIsGroupPanel:n,onItemsGrouped:e,onGroupPanelCancel:r,groupByFields:a,startIndex:s,level:l,items:c,emptyGroupLabel:d,setActualRows:g,setIsGrouping:m,cols:u})=>{var b,y,C,x,R,D;const f=(C=(y=(b=a==null?void 0:a[0])==null?void 0:b.name)==null?void 0:y.split(";"))==null?void 0:C[0],p=(D=(R=(x=a==null?void 0:a[0])==null?void 0:x.name)==null?void 0:R.split(";"))==null?void 0:D[1];if(!(a!=null&&a[0])||f==="@NONE")return n(!1),m({active:!1,key:null,name:null}),r&&r("not-selected"),e&&e({selectedKey:f,setGroups:i}),i(void 0);m({active:!0,key:f,name:p});const{groups:_,updatedItemsOrder:v}=An.buildGroups({emptyGroupLabel:d,groupByFields:a,items:c,level:l,startIndex:s,cols:u});i(_),g(v),n(!1),e&&e({selectedKey:f,setGroups:i})}),xt(bt,"buildGroups",({emptyGroupLabel:i,groupByFields:n,items:e,level:r,startIndex:a,cols:s})=>{var g,m,u,f;const l=i!=null?i:"Sem itens definidos";let c=[],d=[];if(n){const p=n[r],_=(g=p==null?void 0:p.name)==null?void 0:g.split(";")[0],v=(m=s==null?void 0:s.find(C=>(C==null?void 0:C.key)===_))==null?void 0:m.dateConversionOptions,b=v==null?void 0:v.shouldConvertToLocaleString,y=(u=p==null?void 0:p.name)==null?void 0:u.split(";")[1];if(n&&n.length>0){const C={};e.forEach(D=>{var I;let S=(I=We.getDeepValue(D,_))!=null?I:l;b&&(S=We.convertIsoToLocaleString(S,v==null?void 0:v.locales,v==null?void 0:v.formatOptions)),typeof S=="number"&&(S=`${S}.`),typeof C[S]>"u"&&(C[S]=[]),C[S].push(D)});const x={};let R=Object.keys(C);R=p.order===At.ascending?R.sort():R.sort().reverse(),R.forEach(D=>{x[D]=C[D]});for(const D in x){const S=C[D].length,I={name:D==="undefined"?l:`${y}: ${D}`,key:D==="undefined"?l:D,startIndex:a,count:S,isCollapsed:!0};if(n[r+1]){const N=An.buildGroups({emptyGroupLabel:i,items:C[D],groupByFields:n,startIndex:a,level:r+1,cols:s});(f=N==null?void 0:N.updatedItemsOrder)==null||f.forEach(k=>{d.push(k)}),I.children=N.groups}else C[D].forEach(N=>{d.push(N)});a=a+S,c.push(I)}}}return{updatedItemsOrder:d,groups:c}});var Io=function(t){return function(i,n,e){return t(i,n,e)*e}},li=function(t,i){if(t)throw Error("Invalid sort config: "+i)},Ro=function(t){var i=t||{},n=i.asc,e=i.desc,r=n?1:-1,a=n||e;li(!a,"Expected `asc` or `desc` property"),li(n&&e,"Ambiguous object with `asc` and `desc` config properties");var s=t.comparer&&Io(t.comparer);return{order:r,sortBy:a,comparer:s}},Zr=function(t){return function i(n,e,r,a,s,l,c){var d,g;if(typeof n=="string")d=l[n],g=c[n];else if(typeof n=="function")d=n(l),g=n(c);else{var m=Ro(n);return i(m.sortBy,e,r,m.order,m.comparer||t,l,c)}var u=s(d,g,a);return(u===0||d==null&&g==null)&&e.length>r?i(e[r],e,r+1,a,s,l,c):u}};function No(t,i,n){if(t===void 0||t===!0)return function(a,s){return i(a,s,n)};if(typeof t=="string")return li(t.includes("."),"String syntax not allowed for nested properties."),function(a,s){return i(a[t],s[t],n)};if(typeof t=="function")return function(a,s){return i(t(a),t(s),n)};if(Array.isArray(t)){var e=Zr(i);return function(a,s){return e(t[0],t,1,n,i,a,s)}}var r=Ro(t);return No(r.sortBy,r.comparer||i,r.order)}var Un=function(t,i,n,e){var r;return Array.isArray(i)?(Array.isArray(n)&&n.length<2&&(r=n,n=r[0]),i.sort(No(n,e,t))):i};function fi(t){var i=Io(t.comparer);return function(n){var e=Array.isArray(n)&&!t.inPlaceSorting?n.slice():n;return{asc:function(r){return Un(1,e,r,i)},desc:function(r){return Un(-1,e,r,i)},by:function(r){return Un(1,e,r,i)}}}}var Eo=function(t,i,n){return t==null?n:i==null?-n:t<i?-1:t>i?1:0};fi({comparer:Eo});fi({comparer:Eo,inPlaceSorting:!0});function qr(t,i){var O,V,W,G,A,F,Y,ee,q,he,ce,re,ye,me,se,fe,oe,_e,te,ve,Ye,Be,Oe,$e,Te,rt,Pe;const[n,e]=$.useState(t==null?void 0:t.columns),[r,a]=$.useState({active:!1,key:null,name:null}),[s,l]=$.useState(void 0),[c,d]=$.useState((V=(O=t==null?void 0:t.headerOptions)==null?void 0:O.enableGrouping)!=null?V:!1),[g,m]=$.useState(new Map),[u,f]=$.useState(null),[p,_]=$.useState(t==null?void 0:t.rows),[v,b]=$.useState((W=t==null?void 0:t.rows)!=null?W:[]),[y,C]=$.useState(!1),[x,R]=$.useState(!1),[D,S]=$.useState(null),I=$.useRef([]),[N,k]=$.useState([]),w=$.useMemo(()=>n==null?void 0:n.filter(X=>!(X!=null&&X.hideColumn)),[n]);$.useEffect(()=>{var X;d((X=t==null?void 0:t.headerOptions)==null?void 0:X.enableGrouping)},[(G=t==null?void 0:t.headerOptions)==null?void 0:G.enableGrouping]);const E=$.useCallback(fi({comparer:new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare}),[]),P=X=>!!(t!=null&&t.onItemClick)&&(t==null?void 0:t.onItemClick(X)),T=X=>(xe,ie)=>{if(!ie)return;let J=ie==null?void 0:ie.isSortedDescending;ie!=null&&ie.isSorted&&(J=!J);let ke=X;const Ie=J?"desc":"asc",Ge=ie==null?void 0:ie.key;if(r!=null&&r.active){const Re=r==null?void 0:r.key;if(Re===(ie==null?void 0:ie.key))return;Ie==="asc"?ke=E(ke).by({asc:[ue=>{var pe;return(pe=We.getDeepValue(ue,Re))==null?void 0:pe.toString()},ue=>{var pe;return(pe=We.getDeepValue(ue,Ge))==null?void 0:pe.toString()}]}):Ie==="desc"&&(ke=E(ke).by({desc:[ue=>{var pe;return(pe=We.getDeepValue(ue,Re))==null?void 0:pe.toString()},ue=>{var pe;return(pe=We.getDeepValue(ue,Ge))==null?void 0:pe.toString()}]})),bt.onApplyGrouping({emptyGroupLabel:t==null?void 0:t.emptyGroupLabel,setIsGroupPanel:R,setGroups:l,onItemsGrouped:t==null?void 0:t.onItemsGrouped,onGroupPanelCancel:t==null?void 0:t.onGroupPanelCancel,items:ke,groupByFields:[{name:`${Re};${r==null?void 0:r.name}`,order:At.ascending}],setActualRows:b,level:0,startIndex:0,cols:n,setIsGrouping:a}),e(ue=>ue.map(pe=>(pe.isSorted=pe.key===(ie==null?void 0:ie.key),pe!=null&&pe.isSorted&&(pe.isSortedDescending=J),pe)));return}Ie==="asc"?ke=E(ke).by({asc:Re=>{var ue;return(ue=We.getDeepValue(Re,Ge))==null?void 0:ue.toString()}}):Ie==="desc"&&(ke=E(ke).by({desc:Re=>{var ue;return(ue=We.getDeepValue(Re,Ge))==null?void 0:ue.toString()}})),b(ke),e(Re=>Re.map(ue=>(ue.isSorted=ue.key===(ie==null?void 0:ie.key),ue!=null&&ue.isSorted&&(ue.isSortedDescending=J),ue)))};$.useEffect(()=>{var ie;if(!((ie=t==null?void 0:t.columns)!=null&&ie.length))return;const xe=(t==null?void 0:t.columns).map(J=>{var ke,Ie;return(ke=J==null?void 0:J.key)!=null&&ke.includes(".")?(J.onRender=(Ge,Re)=>{const ue=We.getDeepValue(Ge,J==null?void 0:J.key);return K.default.createElement("span",null,ue)},J):((Ie=J==null?void 0:J.dateConversionOptions)!=null&&Ie.shouldConvertToLocaleString&&(J.onRender=(Ge,Re)=>{var pe,ae;const ue=We.convertIsoToLocaleString(Ge[J==null?void 0:J.key],(pe=J==null?void 0:J.dateConversionOptions)==null?void 0:pe.locales,(ae=J==null?void 0:J.dateConversionOptions)==null?void 0:ae.formatOptions);return K.default.createElement("span",null,ue)}),J)});e(xe)},[t==null?void 0:t.columns]),$.useEffect(()=>{var ie,J,ke;if(!((ie=t==null?void 0:t.initialGroupedBy)!=null&&ie.key))return;const xe=((J=t==null?void 0:t.initialGroupedBy)==null?void 0:J.key)+";"+((ke=t==null?void 0:t.initialGroupedBy)==null?void 0:ke.name);bt.onApplyGrouping({emptyGroupLabel:t==null?void 0:t.emptyGroupLabel,setIsGroupPanel:R,setGroups:l,onItemsGrouped:t==null?void 0:t.onItemsGrouped,onGroupPanelCancel:t==null?void 0:t.onGroupPanelCancel,items:v,groupByFields:[{name:xe,order:At.ascending}],setActualRows:b,level:0,startIndex:0,cols:n,setIsGrouping:a})},[(A=t==null?void 0:t.initialGroupedBy)==null?void 0:A.key]),$.useEffect(()=>{t!=null&&t.getCurrentRows&&(t==null||t.getCurrentRows(v))},[v]);const M=$.useCallback(()=>{var ie,J;const xe=((ie=t==null?void 0:t.initialGroupedBy)==null?void 0:ie.key)+";"+((J=t==null?void 0:t.initialGroupedBy)==null?void 0:J.name);bt.onApplyGrouping({emptyGroupLabel:t==null?void 0:t.emptyGroupLabel,setIsGroupPanel:R,setGroups:l,onItemsGrouped:t==null?void 0:t.onItemsGrouped,onGroupPanelCancel:t==null?void 0:t.onGroupPanelCancel,items:v,groupByFields:[{name:xe,order:At.ascending}],setActualRows:b,level:0,startIndex:0,cols:n,setIsGrouping:a})},[v,n,t==null?void 0:t.emptyGroupLabel,(F=t==null?void 0:t.initialGroupedBy)==null?void 0:F.key]);$.useImperativeHandle(i,()=>({reGroupInitialGroup:M}),[v]),$.useEffect(()=>{b(t==null?void 0:t.rows),_(t==null?void 0:t.rows)},[t==null?void 0:t.rows]),$.useEffect(()=>{e(X=>[...X.map(xe=>({...xe,onColumnClick:T(v)}))])},[v==null?void 0:v.length,r==null?void 0:r.active,r==null?void 0:r.key,r==null?void 0:r.name]),$.useEffect(()=>{k([...dt.buildFilters(p,n,t==null?void 0:t.hiddenFilterKeys)])},[p==null?void 0:p.length,n==null?void 0:n.length,(Y=t==null?void 0:t.hiddenGroupKeys)==null?void 0:Y.length]);const L=$.useMemo(()=>N.map(X=>In.mapFilterOptions(X==null?void 0:X.options)),[N]),B={isOpen:y,onApply:dt.onApplyFilter({allRows:p,setActualRows:b,setIsFilterPanel:C,applyCustomFilter:t==null?void 0:t.applyCustomFilter,onItemsFiltered:t==null?void 0:t.onItemsFiltered,onFilterPanelCancel:t==null?void 0:t.onFilterPanelCancel}),onCancel:()=>{C(!1),t!=null&&t.onFilterPanelCancel&&(t==null||t.onFilterPanelCancel("cancel"))},onClose:()=>{C(!1),t!=null&&t.onFilterPanelCancel&&(t==null||t.onFilterPanelCancel("dismiss"))},panelTitle:(ee=t==null?void 0:t.filterPanelTitle)!=null?ee:"Filtrar",actualFilteredValues:g,setActualFilteredValues:m,dateValue:D,setFilterDate:S,filterOptionsMatrix:L,availableFilters:N,top:(he=(q=t==null?void 0:t.panelChildren)==null?void 0:q.filter)==null?void 0:he.top,footer:(re=(ce=t==null?void 0:t.panelChildren)==null?void 0:ce.filter)==null?void 0:re.footer},z={isOpen:x,onCancel:()=>{R(!1),t!=null&&t.onGroupPanelCancel&&(t==null||t.onGroupPanelCancel("cancel"))},onClose:()=>{R(!1),t!=null&&t.onGroupPanelCancel&&(t==null||t.onGroupPanelCancel("dismiss"))},onOpen:()=>{R(!0)},panelTitle:(ye=t==null?void 0:t.groupPanelTitle)!=null?ye:"Agrupar",setSelectedGroupKeys:f,selectedGroupKeys:u,options:(se=(me=dt.filterFromColumns(t==null?void 0:t.hiddenGroupKeys,n))==null?void 0:me.map(X=>({key:X==null?void 0:X.key,text:X==null?void 0:X.name})))!=null?se:[],onApply:X=>bt.onApplyGrouping({emptyGroupLabel:t==null?void 0:t.emptyGroupLabel,setIsGroupPanel:R,setGroups:l,onItemsGrouped:t==null?void 0:t.onItemsGrouped,onGroupPanelCancel:t==null?void 0:t.onGroupPanelCancel,items:v,setActualRows:b,groupByFields:[{name:X,order:At.ascending}],level:0,startIndex:0,cols:n,setIsGrouping:a}),top:(oe=(fe=t==null?void 0:t.panelChildren)==null?void 0:fe.group)==null?void 0:oe.top,footer:(te=(_e=t==null?void 0:t.panelChildren)==null?void 0:_e.group)==null?void 0:te.footer},H={...t==null?void 0:t.headerOptions,onSearchItemChange:dt.onSearchItemChange({allRows:p,searchBoxItems:I,setActualRows:b,onSearchBoxItemsFiltered:t==null?void 0:t.onSearchBoxItemsFiltered}),setIsFilterPanelOpen:X=>{C(X)},setIsGroupPanelOpen:X=>{R(X)},enableSearch:(Ye=(ve=t==null?void 0:t.headerOptions)==null?void 0:ve.enableSearch)!=null?Ye:!0,enableFilter:(Oe=(Be=t==null?void 0:t.headerOptions)==null?void 0:Be.enableFilter)!=null?Oe:!0,enableGrouping:c,onClickSearchIcon:(X,xe,ie)=>{if(X===Qt.CLICK)return b(I==null?void 0:I.current);if(X===Qt.ENTER){if(!xe)return b(p);const J=dt.onSearchItemChange({allRows:p,searchBoxItems:I,setActualRows:b,onSearchBoxItemsFiltered:t==null?void 0:t.onSearchBoxItemsFiltered})(xe,ie);b(J)}},onFilterIconClick:t==null?void 0:t.onFilterIconClick,onGroupIconClick:t==null?void 0:t.onGroupIconClick,onSearchBoxClick:t==null?void 0:t.onSearchBoxClick,filterButtonProps:($e=t==null?void 0:t.headerOptions)==null?void 0:$e.filterButtonProps,groupButtonProps:(Te=t==null?void 0:t.headerOptions)==null?void 0:Te.groupButtonProps,searchBoxProps:(rt=t==null?void 0:t.headerOptions)==null?void 0:rt.searchBoxProps,leftHeaderSpace:(Pe=t==null?void 0:t.headerOptions)==null?void 0:Pe.leftHeaderSpace};return{state:{actualRows:v,visibleCols:w,filterPanelConfig:B,groupPanelConfig:z,isFilterPanelOpen:y,isGroupPanelOpen:x,listConfig:H,groups:s},handlers:{onItemClick:P}}}const To=$.createContext({enableFilter:!0,enableSearch:!0,customButtons:[],setIsFilterPanelOpen:void 0,searchBoxPlaceholder:"",defaultButtonsOrder:{group:0,search:1,filter:2},setIsGroupPanelOpen:void 0,onClickSearchIcon:void 0}),vi=$.createContext({isOpen:!1,onApply:void 0,onCancel:void 0,onClose:void 0,panelTitle:"",actualFilteredValues:new Map,setActualFilteredValues:void 0,onOpen:void 0,dateValue:null,setFilterDate:void 0,filterOptionsMatrix:[],availableFilters:[],top:void 0,footer:void 0}),pi=$.createContext({isOpen:!1,onApply:void 0,onCancel:void 0,onClose:void 0,onOpen:void 0,panelTitle:"",options:[],selectedGroupKeys:null,setSelectedGroupKeys:void 0,top:void 0,footer:void 0});function Li(t){var i;return t&&(t===window?i={left:0,top:0,width:window.innerWidth,height:window.innerHeight,right:window.innerWidth,bottom:window.innerHeight}:t.getBoundingClientRect&&(i=t.getBoundingClientRect())),i}var Xr={label:o.labelProperties,audio:o.audioProperties,video:o.videoProperties,ol:o.olProperties,li:o.liProperties,a:o.anchorProperties,button:o.buttonProperties,input:o.inputProperties,textarea:o.textAreaProperties,select:o.selectProperties,option:o.optionProperties,table:o.tableProperties,tr:o.trProperties,th:o.thProperties,td:o.tdProperties,colGroup:o.colGroupProperties,col:o.colProperties,form:o.formProperties,iframe:o.iframeProperties,img:o.imgProperties};function Jr(t,i,n){var e=t&&Xr[t]||o.htmlElementProperties;return o.getNativeProps(i,e,n)}var Qr=/[\(\[\{\<][^\)\]\}\>]*[\)\]\}\>]/g,ea=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,ta=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,na=/\s+/g,ia=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function oa(t,i){var n="",e=t.split(" ");return e.length===2?(n+=e[0].charAt(0).toUpperCase(),n+=e[1].charAt(0).toUpperCase()):e.length===3?(n+=e[0].charAt(0).toUpperCase(),n+=e[2].charAt(0).toUpperCase()):e.length!==0&&(n+=e[0].charAt(0).toUpperCase()),i&&n.length>1?n.charAt(1)+n.charAt(0):n}function ra(t){return t=t.replace(Qr,""),t=t.replace(ea,""),t=t.replace(na," "),t=t.trim(),t}function Po(t,i,n){return!t||(t=ra(t),ia.test(t)||!n&&ta.test(t))?"":oa(t,i)}var aa=function(t){var i;return function(n){i||(i=new Set,o.extendComponent(t,{componentWillUnmount:function(){i.forEach(function(r){return cancelAnimationFrame(r)})}}));var e=requestAnimationFrame(function(){i.delete(e),n()});i.add(e)}},Fn="change",sa="items-change",Q;(function(t){t[t.none=0]="none",t[t.single=1]="single",t[t.multiple=2]="multiple"})(Q||(Q={}));var zi;(function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"})(zi||(zi={}));var Ao=function(){function t(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var e=i[0]||{},r=e.onSelectionChanged,a=e.onItemsChanged,s=e.getKey,l=e.canSelectItem,c=l===void 0?function(){return!0}:l,d=e.items,g=e.selectionMode,m=g===void 0?Q.multiple:g;this.mode=m,this._getKey=s||la,this._changeEventSuppressionCount=0,this._exemptedCount=0,this._anchoredIndex=0,this._unselectableCount=0,this._onSelectionChanged=r,this._onItemsChanged=a,this._canSelectItem=c,this._keyToIndexMap={},this._isModal=!1,this.setItems(d||[],!0),this.count=this.getSelectedCount()}return t.prototype.canSelectItem=function(i,n){return typeof n=="number"&&n<0?!1:this._canSelectItem(i,n)},t.prototype.getKey=function(i,n){var e=this._getKey(i,n);return typeof e=="number"||e?""+e:""},t.prototype.setChangeEvents=function(i,n){this._changeEventSuppressionCount+=i?-1:1,this._changeEventSuppressionCount===0&&this._hasChanged&&(this._hasChanged=!1,n||this._change())},t.prototype.isModal=function(){return this._isModal},t.prototype.setModal=function(i){this._isModal!==i&&(this.setChangeEvents(!1),this._isModal=i,i||this.setAllSelected(!1),this._change(),this.setChangeEvents(!0))},t.prototype.setItems=function(i,n){n===void 0&&(n=!0);var e={},r={},a=!1;this.setChangeEvents(!1),this._unselectableCount=0;for(var s=!1,l=0;l<i.length;l++){var c=i[l];if(c){var d=this.getKey(c,l);d&&(!s&&(!(d in this._keyToIndexMap)||this._keyToIndexMap[d]!==l)&&(s=!0),e[d]=l)}r[l]=c&&!this.canSelectItem(c),r[l]&&this._unselectableCount++}(n||i.length===0)&&this._setAllSelected(!1,!0);var g={},m=0;for(var u in this._exemptedIndices)if(this._exemptedIndices.hasOwnProperty(u)){var f=Number(u),c=this._items[f],p=c?this.getKey(c,Number(f)):void 0,_=p?e[p]:f;_===void 0?a=!0:(g[_]=!0,m++,a=a||_!==f)}if(this._items&&this._exemptedCount===0&&i.length!==this._items.length&&this._isAllSelected&&(a=!0),!s)for(var v=0,b=Object.keys(this._keyToIndexMap);v<b.length;v++){var d=b[v];if(!(d in e)){s=!0;break}}this._exemptedIndices=g,this._exemptedCount=m,this._keyToIndexMap=e,this._unselectableIndices=r,this._items=i,this._selectedItems=null,a&&this._updateCount(),s&&(o.EventGroup.raise(this,sa),this._onItemsChanged&&this._onItemsChanged()),a&&this._change(),this.setChangeEvents(!0)},t.prototype.getItems=function(){return this._items},t.prototype.getSelection=function(){if(!this._selectedItems){this._selectedItems=[];var i=this._items;if(i)for(var n=0;n<i.length;n++)this.isIndexSelected(n)&&this._selectedItems.push(i[n])}return this._selectedItems},t.prototype.getSelectedCount=function(){return this._isAllSelected?this._items.length-this._exemptedCount-this._unselectableCount:this._exemptedCount},t.prototype.getSelectedIndices=function(){if(!this._selectedIndices){this._selectedIndices=[];var i=this._items;if(i)for(var n=0;n<i.length;n++)this.isIndexSelected(n)&&this._selectedIndices.push(n)}return this._selectedIndices},t.prototype.getItemIndex=function(i){var n=this._keyToIndexMap[i];return n!=null?n:-1},t.prototype.isRangeSelected=function(i,n){if(n===0)return!1;for(var e=i+n,r=i;r<e;r++)if(!this.isIndexSelected(r))return!1;return!0},t.prototype.isAllSelected=function(){var i=this._items.length-this._unselectableCount;return this.mode===Q.single&&(i=Math.min(i,1)),this.count>0&&this._isAllSelected&&this._exemptedCount===0||!this._isAllSelected&&this._exemptedCount===i&&i>0},t.prototype.isKeySelected=function(i){var n=this._keyToIndexMap[i];return this.isIndexSelected(n)},t.prototype.isIndexSelected=function(i){return!!(this.count>0&&this._isAllSelected&&!this._exemptedIndices[i]&&!this._unselectableIndices[i]||!this._isAllSelected&&this._exemptedIndices[i])},t.prototype.setAllSelected=function(i){if(!(i&&this.mode!==Q.multiple)){var n=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),n>0&&(this._exemptedCount>0||i!==this._isAllSelected)&&(this._exemptedIndices={},(i!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=i,this._change()),this._updateCount()),this.setChangeEvents(!0)}},t.prototype.setKeySelected=function(i,n,e){var r=this._keyToIndexMap[i];r>=0&&this.setIndexSelected(r,n,e)},t.prototype.setIndexSelected=function(i,n,e){if(this.mode!==Q.none&&(i=Math.min(Math.max(0,i),this._items.length-1),!(i<0||i>=this._items.length))){this.setChangeEvents(!1);var r=this._exemptedIndices[i],a=!this._unselectableIndices[i];a&&(n&&this.mode===Q.single&&this._setAllSelected(!1,!0),r&&(n&&this._isAllSelected||!n&&!this._isAllSelected)&&(delete this._exemptedIndices[i],this._exemptedCount--),!r&&(n&&!this._isAllSelected||!n&&this._isAllSelected)&&(this._exemptedIndices[i]=!0,this._exemptedCount++),e&&(this._anchoredIndex=i)),this._updateCount(),this.setChangeEvents(!0)}},t.prototype.setRangeSelected=function(i,n,e,r){if(this.mode!==Q.none&&(i=Math.min(Math.max(0,i),this._items.length-1),n=Math.min(Math.max(0,n),this._items.length-i),!(i<0||i>=this._items.length||n===0))){this.setChangeEvents(!1);for(var a=this._anchoredIndex||0,s=i,l=i+n-1,c=a>=l?s:l;s<=l;s++)this.setIndexSelected(s,e,r?s===c:!1);this.setChangeEvents(!0)}},t.prototype.selectToKey=function(i,n){this.selectToIndex(this._keyToIndexMap[i],n)},t.prototype.selectToRange=function(i,n,e){if(this.mode!==Q.none){if(this.mode===Q.single){n===1&&this.setIndexSelected(i,!0,!0);return}var r=this._anchoredIndex||0,a=Math.min(i,r),s=Math.max(i+n-1,r);for(this.setChangeEvents(!1),e&&this._setAllSelected(!1,!0);a<=s;a++)this.setIndexSelected(a,!0,!1);this.setChangeEvents(!0)}},t.prototype.selectToIndex=function(i,n){if(this.mode!==Q.none){if(this.mode===Q.single){this.setIndexSelected(i,!0,!0);return}var e=this._anchoredIndex||0,r=Math.min(i,e),a=Math.max(i,e);for(this.setChangeEvents(!1),n&&this._setAllSelected(!1,!0);r<=a;r++)this.setIndexSelected(r,!0,!1);this.setChangeEvents(!0)}},t.prototype.toggleAllSelected=function(){this.setAllSelected(!this.isAllSelected())},t.prototype.toggleKeySelected=function(i){this.setKeySelected(i,!this.isKeySelected(i),!0)},t.prototype.toggleIndexSelected=function(i){this.setIndexSelected(i,!this.isIndexSelected(i),!0)},t.prototype.toggleRangeSelected=function(i,n){if(this.mode!==Q.none){var e=this.isRangeSelected(i,n),r=i+n;if(!(this.mode===Q.single&&n>1)){this.setChangeEvents(!1);for(var a=i;a<r;a++)this.setIndexSelected(a,!e,!1);this.setChangeEvents(!0)}}},t.prototype._updateCount=function(i){i===void 0&&(i=!1);var n=this.getSelectedCount();n!==this.count&&(this.count=n,this._change()),!this.count&&!i&&this.setModal(!1)},t.prototype._setAllSelected=function(i,n){if(n===void 0&&(n=!1),!(i&&this.mode!==Q.multiple)){var e=this._items?this._items.length-this._unselectableCount:0;this.setChangeEvents(!1),e>0&&(this._exemptedCount>0||i!==this._isAllSelected)&&(this._exemptedIndices={},(i!==this._isAllSelected||this._exemptedCount>0)&&(this._exemptedCount=0,this._isAllSelected=i,this._change()),this._updateCount(n)),this.setChangeEvents(!0)}},t.prototype._change=function(){this._changeEventSuppressionCount===0?(this._selectedItems=null,this._selectedIndices=void 0,o.EventGroup.raise(this,Fn),this._onSelectionChanged&&this._onSelectionChanged()):this._hasChanged=!0},t}();function la(t,i){var n=(t||{}).key,e=n===void 0?""+i:n;return e}var ca=/[\{\}]/g,da=/\{\d+\}/g;function St(t){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];var e=i;function r(a){var s=e[a.replace(ca,"")];return s==null&&(s=""),s}return t.replace(da,r)}var ua="data-selection-disabled",Bi="data-selection-index",Ut="data-selection-toggle",cn="data-selection-invoke",ga="data-selection-touch-invoke",Oi="data-selection-all-toggle",ha="data-selection-select",_i=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;e._root=h.createRef(),e.ignoreNextFocus=function(){e._handleNextFocus(!1)},e._onSelectionChange=function(){var s=e.props.selection,l=s.isModal&&s.isModal();e.setState({isModal:l})},e._onMouseDownCapture=function(s){var l=s.target;if(document.activeElement!==l&&!o.elementContains(document.activeElement,l)){e.ignoreNextFocus();return}if(!!o.elementContains(l,e._root.current))for(;l!==e._root.current;){if(e._hasAttribute(l,cn)){e.ignoreNextFocus();break}l=o.getParent(l)}},e._onFocus=function(s){var l=s.target,c=e.props.selection,d=e._isCtrlPressed||e._isMetaPressed,g=e._getSelectionMode();if(e._shouldHandleFocus&&g!==Q.none){var m=e._hasAttribute(l,Ut),u=e._findItemRoot(l);if(!m&&u){var f=e._getItemIndex(u);d?(c.setIndexSelected(f,c.isIndexSelected(f),!0),e.props.enterModalOnTouch&&e._isTouch&&c.setModal&&(c.setModal(!0),e._setIsTouch(!1))):e.props.isSelectedOnFocus&&e._onItemSurfaceClick(s,f)}}e._handleNextFocus(!1)},e._onMouseDown=function(s){e._updateModifiers(s);var l=s.target,c=e._findItemRoot(l);if(!e._isSelectionDisabled(l))for(;l!==e._root.current&&!e._hasAttribute(l,Oi);){if(c){if(e._hasAttribute(l,Ut))break;if(e._hasAttribute(l,cn))break;if((l===c||e._shouldAutoSelect(l))&&!e._isShiftPressed&&!e._isCtrlPressed&&!e._isMetaPressed){e._onInvokeMouseDown(s,e._getItemIndex(c));break}else if(e.props.disableAutoSelectOnInputElements&&(l.tagName==="A"||l.tagName==="BUTTON"||l.tagName==="INPUT"))return}l=o.getParent(l)}},e._onTouchStartCapture=function(s){e._setIsTouch(!0)},e._onClick=function(s){var l=e.props.enableTouchInvocationTarget,c=l===void 0?!1:l;e._updateModifiers(s);for(var d=s.target,g=e._findItemRoot(d),m=e._isSelectionDisabled(d);d!==e._root.current;){if(e._hasAttribute(d,Oi)){m||e._onToggleAllClick(s);break}else if(g){var u=e._getItemIndex(g);if(e._hasAttribute(d,Ut)){m||(e._isShiftPressed?e._onItemSurfaceClick(s,u):e._onToggleClick(s,u));break}else if(e._isTouch&&c&&e._hasAttribute(d,ga)||e._hasAttribute(d,cn)){e._onInvokeClick(s,u);break}else if(d===g){m||e._onItemSurfaceClick(s,u);break}else if(d.tagName==="A"||d.tagName==="BUTTON"||d.tagName==="INPUT")return}d=o.getParent(d)}},e._onContextMenu=function(s){var l=s.target,c=e.props,d=c.onItemContextMenu,g=c.selection;if(d){var m=e._findItemRoot(l);if(m){var u=e._getItemIndex(m);e._onInvokeMouseDown(s,u);var f=d(g.getItems()[u],u,s.nativeEvent);f||s.preventDefault()}}},e._onDoubleClick=function(s){var l=s.target,c=e.props.onItemInvoked,d=e._findItemRoot(l);if(d&&c&&!e._isInputElement(l)){for(var g=e._getItemIndex(d);l!==e._root.current&&!(e._hasAttribute(l,Ut)||e._hasAttribute(l,cn));){if(l===d){e._onInvokeClick(s,g);break}l=o.getParent(l)}l=o.getParent(l)}},e._onKeyDownCapture=function(s){e._updateModifiers(s),e._handleNextFocus(!0)},e._onKeyDown=function(s){e._updateModifiers(s);var l=s.target,c=e._isSelectionDisabled(l),d=e.props.selection,g=s.which===o.KeyCodes.a&&(e._isCtrlPressed||e._isMetaPressed),m=s.which===o.KeyCodes.escape;if(!e._isInputElement(l)){var u=e._getSelectionMode();if(g&&u===Q.multiple&&!d.isAllSelected()){c||d.setAllSelected(!0),s.stopPropagation(),s.preventDefault();return}if(m&&d.getSelectedCount()>0){c||d.setAllSelected(!1),s.stopPropagation(),s.preventDefault();return}var f=e._findItemRoot(l);if(f)for(var p=e._getItemIndex(f);l!==e._root.current&&!e._hasAttribute(l,Ut);){if(e._shouldAutoSelect(l)){c||e._onInvokeMouseDown(s,p);break}else{if((s.which===o.KeyCodes.enter||s.which===o.KeyCodes.space)&&(l.tagName==="BUTTON"||l.tagName==="A"||l.tagName==="INPUT"))return!1;if(l===f){if(s.which===o.KeyCodes.enter){e._onInvokeClick(s,p),s.preventDefault();return}else if(s.which===o.KeyCodes.space){c||e._onToggleClick(s,p),s.preventDefault();return}break}}l=o.getParent(l)}}},e._events=new o.EventGroup(e),e._async=new o.Async(e),o.initializeComponentRef(e);var r=e.props.selection,a=r.isModal&&r.isModal();return e.state={isModal:a},e}return i.getDerivedStateFromProps=function(n,e){var r=n.selection.isModal&&n.selection.isModal();return o.__assign(o.__assign({},e),{isModal:r})},i.prototype.componentDidMount=function(){var n=o.getWindow(this._root.current);this._events.on(n,"keydown, keyup",this._updateModifiers,!0),this._events.on(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(document.body,"touchend",this._onTouchStartCapture,!0),this._events.on(this.props.selection,"change",this._onSelectionChange)},i.prototype.render=function(){var n=this.state.isModal;return h.createElement("div",{className:o.css("ms-SelectionZone",this.props.className,{"ms-SelectionZone--modal":!!n}),ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu,onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus,"data-selection-is-modal":n?!0:void 0},this.props.children,h.createElement(o.FocusRects,null))},i.prototype.componentDidUpdate=function(n){var e=this.props.selection;e!==n.selection&&(this._events.off(n.selection),this._events.on(e,"change",this._onSelectionChange))},i.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},i.prototype._isSelectionDisabled=function(n){if(this._getSelectionMode()===Q.none)return!0;for(;n!==this._root.current;){if(this._hasAttribute(n,ua))return!0;n=o.getParent(n)}return!1},i.prototype._onToggleAllClick=function(n){var e=this.props.selection,r=this._getSelectionMode();r===Q.multiple&&(e.toggleAllSelected(),n.stopPropagation(),n.preventDefault())},i.prototype._onToggleClick=function(n,e){var r=this.props.selection,a=this._getSelectionMode();if(r.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&!r.isIndexSelected(e)&&r.setModal&&(r.setModal(!0),this._setIsTouch(!1)),a===Q.multiple)r.toggleIndexSelected(e);else if(a===Q.single){var s=r.isIndexSelected(e),l=r.isModal&&r.isModal();r.setAllSelected(!1),r.setIndexSelected(e,!s,!0),l&&r.setModal&&r.setModal(!0)}else{r.setChangeEvents(!0);return}r.setChangeEvents(!0),n.stopPropagation()},i.prototype._onInvokeClick=function(n,e){var r=this.props,a=r.selection,s=r.onItemInvoked;s&&(s(a.getItems()[e],e,n.nativeEvent),n.preventDefault(),n.stopPropagation())},i.prototype._onItemSurfaceClick=function(n,e){var r=this.props.selection,a=this._isCtrlPressed||this._isMetaPressed,s=this._getSelectionMode();s===Q.multiple?this._isShiftPressed&&!this._isTabPressed?r.selectToIndex(e,!a):a?r.toggleIndexSelected(e):this._clearAndSelectIndex(e):s===Q.single&&this._clearAndSelectIndex(e)},i.prototype._onInvokeMouseDown=function(n,e){var r=this.props.selection;r.isIndexSelected(e)||this._clearAndSelectIndex(e)},i.prototype._findScrollParentAndTryClearOnEmptyClick=function(n){var e=o.findScrollableParent(this._root.current);this._events.off(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(e,"click",this._tryClearOnEmptyClick),(e&&n.target instanceof Node&&e.contains(n.target)||e===n.target)&&this._tryClearOnEmptyClick(n)},i.prototype._tryClearOnEmptyClick=function(n){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(n.target)&&this.props.selection.setAllSelected(!1)},i.prototype._clearAndSelectIndex=function(n){var e=this.props.selection,r=e.getSelectedCount()===1&&e.isIndexSelected(n);if(!r){var a=e.isModal&&e.isModal();e.setChangeEvents(!1),e.setAllSelected(!1),e.setIndexSelected(n,!0,!0),(a||this.props.enterModalOnTouch&&this._isTouch)&&(e.setModal&&e.setModal(!0),this._isTouch&&this._setIsTouch(!1)),e.setChangeEvents(!0)}},i.prototype._updateModifiers=function(n){this._isShiftPressed=n.shiftKey,this._isCtrlPressed=n.ctrlKey,this._isMetaPressed=n.metaKey;var e=n.keyCode;this._isTabPressed=e?e===o.KeyCodes.tab:!1},i.prototype._findItemRoot=function(n){for(var e=this.props.selection;n!==this._root.current;){var r=n.getAttribute(Bi),a=Number(r);if(r!==null&&a>=0&&a<e.getItems().length)break;n=o.getParent(n)}if(n!==this._root.current)return n},i.prototype._getItemIndex=function(n){return Number(n.getAttribute(Bi))},i.prototype._shouldAutoSelect=function(n){return this._hasAttribute(n,ha)},i.prototype._hasAttribute=function(n,e){for(var r=!1;!r&&n!==this._root.current;)r=n.getAttribute(e)==="true",n=o.getParent(n);return r},i.prototype._isInputElement=function(n){return n.tagName==="INPUT"||n.tagName==="TEXTAREA"},i.prototype._isNonHandledClick=function(n){var e=o.getDocument();if(e&&n)for(;n&&n!==e.documentElement;){if(o.isElementTabbable(n))return!1;n=o.getParent(n)}return!0},i.prototype._handleNextFocus=function(n){var e=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=n,n&&this._async.setTimeout(function(){e._shouldHandleFocus=!1},100)},i.prototype._setIsTouch=function(n){var e=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,n&&this._async.setTimeout(function(){e._isTouch=!1},300)},i.prototype._getSelectionMode=function(){var n=this.props.selection,e=this.props.selectionMode,r=e===void 0?n?n.mode:Q.none:e;return r},i.defaultProps={isSelectedOnFocus:!0,selectionMode:Q.multiple},i}(h.Component),Lt;(function(t){t[t.hidden=0]="hidden",t[t.visible=1]="visible"})(Lt||(Lt={}));var et;(function(t){t[t.disabled=0]="disabled",t[t.clickable=1]="clickable",t[t.hasDropdown=2]="hasDropdown"})(et||(et={}));var Rn;(function(t){t[t.unconstrained=0]="unconstrained",t[t.horizontalConstrained=1]="horizontalConstrained"})(Rn||(Rn={}));var Ht;(function(t){t[t.outside=0]="outside",t[t.surface=1]="surface",t[t.header=2]="header"})(Ht||(Ht={}));var zt;(function(t){t[t.fixedColumns=0]="fixedColumns",t[t.justified=1]="justified"})(zt||(zt={}));var Ke;(function(t){t[t.onHover=0]="onHover",t[t.always=1]="always",t[t.hidden=2]="hidden"})(Ke||(Ke={}));function ht(t,i,n){var e=h.useState(i),r=e[0],a=e[1],s=o.useConst(t!==void 0),l=s?t:r,c=h.useRef(l),d=h.useRef(n);h.useEffect(function(){c.current=l,d.current=n});var g=o.useConst(function(){return function(m,u){var f=typeof m=="function"?m(c.current):m;d.current&&d.current(u,f),s||a(f)}});return[l,g]}var en=36,Bt=function(t){var i=t.count,n=t.indentWidth,e=n===void 0?en:n,r=t.role,a=r===void 0?"presentation":r,s=i*e;return i>0?h.createElement("span",{className:"ms-GroupSpacer",style:{display:"inline-block",width:s},role:a}):null},ma={root:"ms-GroupedList",compact:"ms-GroupedList--Compact",group:"ms-GroupedList-group",link:"ms-Link",listCell:"ms-List-cell"},fa={easeInOutSine:"cubic-bezier(0.445, 0.050, 0.550, 0.950)"},va=function(t){var i,n,e=t.theme,r=t.className,a=t.compact,s=e.palette,l=o.getGlobalClassNames(ma,e);return{root:[l.root,e.fonts.small,{position:"relative",selectors:(i={},i["."+l.listCell]={minHeight:38},i)},a&&[l.compact,{selectors:(n={},n["."+l.listCell]={minHeight:32},n)}],r],group:[l.group,{transition:"background-color "+o.AnimationVariables.durationValue2+" "+fa.easeInOutSine}],groupIsDropping:{backgroundColor:s.neutralLight}}},Dn={root:"ms-Link"},pa=function(t){var i,n,e,r,a,s,l=t.className,c=t.isButton,d=t.isDisabled,g=t.isUnderlined,m=t.theme,u=m.semanticColors,f=u.link,p=u.linkHovered,_=u.disabledText,v=u.focusBorder,b=o.getGlobalClassNames(Dn,m);return{root:[b.root,m.fonts.medium,{color:f,outline:"none",fontSize:"inherit",fontWeight:"inherit",textDecoration:g?"underline":"none",selectors:(i={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+v+" inset",outline:"1px auto "+v,selectors:(n={},n[o.HighContrastSelector]={outline:"1px solid WindowText"},n)}},i[o.HighContrastSelector]={borderBottom:"none"},i)},c&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(e={},e[o.HighContrastSelector]={color:"LinkText",forcedColorAdjust:"none"},e)},!c&&{selectors:(r={},r[o.HighContrastSelector]={MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},r)},d&&["is-disabled",{color:_,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!d&&{selectors:{"&:active, &:hover, &:active:hover":{color:p,textDecoration:"underline",selectors:(a={},a[o.HighContrastSelector]={color:"LinkText"},a)},"&:focus":{color:f,selectors:(s={},s[o.HighContrastSelector]={color:"LinkText"},s)}}},b.root,l]}},_a={root:"ms-DetailsRow",compact:"ms-DetailsList--Compact",cell:"ms-DetailsRow-cell",cellAnimation:"ms-DetailsRow-cellAnimation",cellCheck:"ms-DetailsRow-cellCheck",check:"ms-DetailsRow-check",cellMeasurer:"ms-DetailsRow-cellMeasurer",listCellFirstChild:"ms-List-cell:first-child",isContentUnselectable:"is-contentUnselectable",isSelected:"is-selected",isCheckVisible:"is-check-visible",isRowHeader:"is-row-header",fields:"ms-DetailsRow-fields"},ba="[data-is-focusable='true']",mt={cellLeftPadding:12,cellRightPadding:8,cellExtraRightPadding:24},tn={rowHeight:42,compactRowHeight:32},vt=o.__assign(o.__assign({},tn),{rowVerticalPadding:11,compactRowVerticalPadding:6}),ya=function(t){var i,n,e,r,a,s,l,c,d,g,m,u,f,p,_=t.theme,v=t.isSelected,b=t.canSelect,y=t.droppingClassName,C=t.anySelected,x=t.isCheckVisible,R=t.checkboxCellClassName,D=t.compact,S=t.className,I=t.cellStyleProps,N=I===void 0?mt:I,k=t.enableUpdateAnimations,w=t.disabled,E=_.palette,P=_.fonts,T=E.neutralPrimary,M=E.white,L=E.neutralSecondary,B=E.neutralLighter,z=E.neutralLight,H=E.neutralDark,O=E.neutralQuaternaryAlt,V=_.semanticColors,W=V.focusBorder,G=V.linkHovered,A=o.getGlobalClassNames(_a,_),F={defaultHeaderText:T,defaultMetaText:L,defaultBackground:M,defaultHoverHeaderText:H,defaultHoverMetaText:T,defaultHoverBackground:B,selectedHeaderText:H,selectedMetaText:T,selectedBackground:z,selectedHoverHeaderText:H,selectedHoverMetaText:T,selectedHoverBackground:O,focusHeaderText:H,focusMetaText:T,focusBackground:z,focusHoverBackground:O},Y={top:2,right:2,bottom:2,left:2},ee=[o.getFocusStyle(_,{inset:-1,borderColor:W,outlineColor:M,highContrastStyle:Y}),A.isSelected,{color:F.selectedMetaText,background:F.selectedBackground,borderBottom:"1px solid "+M,selectors:(i={"&:before":{position:"absolute",display:"block",top:-1,height:1,bottom:0,left:0,right:0,content:"",borderTop:"1px solid "+M}},i["."+A.cell+" > ."+Dn.root]={color:G,selectors:(n={},n[o.HighContrastSelector]={color:"HighlightText"},n)},i["&:hover"]={background:F.selectedHoverBackground,color:F.selectedHoverMetaText,selectors:(e={},e[o.HighContrastSelector]={background:"Highlight",selectors:(r={},r["."+A.cell]={color:"HighlightText"},r["."+A.cell+" > ."+Dn.root]={forcedColorAdjust:"none",color:"HighlightText"},r)},e["."+A.isRowHeader]={color:F.selectedHoverHeaderText,selectors:(a={},a[o.HighContrastSelector]={color:"HighlightText"},a)},e)},i["&:focus"]={background:F.focusBackground,selectors:(s={},s["."+A.cell]={color:F.focusMetaText,selectors:(l={},l[o.HighContrastSelector]={color:"HighlightText",selectors:{"> a":{color:"HighlightText"}}},l)},s["."+A.isRowHeader]={color:F.focusHeaderText,selectors:(c={},c[o.HighContrastSelector]={color:"HighlightText"},c)},s[o.HighContrastSelector]={background:"Highlight"},s)},i[o.HighContrastSelector]=o.__assign(o.__assign({background:"Highlight",color:"HighlightText"},o.getHighContrastNoAdjustStyle()),{selectors:{a:{color:"HighlightText"}}}),i["&:focus:hover"]={background:F.focusHoverBackground},i)}],q=[A.isContentUnselectable,{userSelect:"none",cursor:"default"}],he={minHeight:vt.compactRowHeight,border:0},ce={minHeight:vt.compactRowHeight,paddingTop:vt.compactRowVerticalPadding,paddingBottom:vt.compactRowVerticalPadding,paddingLeft:N.cellLeftPadding+"px"},re=[o.getFocusStyle(_,{inset:-1}),A.cell,{display:"inline-block",position:"relative",boxSizing:"border-box",minHeight:vt.rowHeight,verticalAlign:"top",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",paddingTop:vt.rowVerticalPadding,paddingBottom:vt.rowVerticalPadding,paddingLeft:N.cellLeftPadding+"px",selectors:(d={"& > button":{maxWidth:"100%"}},d[ba]=o.getFocusStyle(_,{inset:-1,borderColor:L,outlineColor:M}),d)},v&&{selectors:(g={},g[o.HighContrastSelector]=o.__assign({background:"Highlight",color:"HighlightText"},o.getHighContrastNoAdjustStyle()),g)},D&&ce,w&&{opacity:.5}];return{root:[A.root,o.AnimationClassNames.fadeIn400,y,_.fonts.small,x&&A.isCheckVisible,o.getFocusStyle(_,{borderColor:W,outlineColor:M}),{borderBottom:"1px solid "+B,background:F.defaultBackground,color:F.defaultMetaText,display:"inline-flex",minWidth:"100%",minHeight:vt.rowHeight,whiteSpace:"nowrap",padding:0,boxSizing:"border-box",verticalAlign:"top",textAlign:"left",selectors:(m={},m["."+A.listCellFirstChild+" &:before"]={display:"none"},m["&:hover"]={background:F.defaultHoverBackground,color:F.defaultHoverMetaText,selectors:(u={},u["."+A.isRowHeader]={color:F.defaultHoverHeaderText},u["."+A.cell+" > ."+Dn.root]={color:G},u)},m["&:hover ."+A.check]={opacity:1},m["."+o.IsFocusVisibleClassName+" &:focus ."+A.check]={opacity:1},m[".ms-GroupSpacer"]={flexShrink:0,flexGrow:0},m)},v&&ee,!b&&q,D&&he,S],cellUnpadded:{paddingRight:N.cellRightPadding+"px"},cellPadded:{paddingRight:N.cellExtraRightPadding+N.cellRightPadding+"px",selectors:(f={},f["&."+A.cellCheck]={paddingRight:0},f)},cell:re,cellAnimation:k&&o.AnimationStyles.slideLeftIn40,cellMeasurer:[A.cellMeasurer,{overflow:"visible",whiteSpace:"nowrap"}],checkCell:[re,A.cellCheck,R,{padding:0,paddingTop:1,marginTop:-1,flexShrink:0}],checkCover:{position:"absolute",top:-1,left:0,bottom:0,right:0,display:C?"block":"none"},fields:[A.fields,{display:"flex",alignItems:"stretch"}],isRowHeader:[A.isRowHeader,{color:F.defaultHeaderText,fontSize:P.medium.fontSize},v&&{color:F.selectedHeaderText,fontWeight:o.FontWeights.semibold,selectors:(p={},p[o.HighContrastSelector]={color:"HighlightText"},p)}],isMultiline:[re,{whiteSpace:"normal",wordBreak:"break-word",textOverflow:"clip"}],check:[A.check]}},Fo={tooltipHost:"ms-TooltipHost",root:"ms-DetailsHeader",cell:"ms-DetailsHeader-cell",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintCaretStyle:"ms-DetailsHeader-dropHintCaretStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVertical:"ms-DetailsColumn-gripperBarVertical",checkTooltip:"ms-DetailsHeader-checkTooltip",check:"ms-DetailsHeader-check"},Zt=42,Ho=function(t){var i=t.theme,n=t.cellStyleProps,e=n===void 0?mt:n,r=i.semanticColors,a=o.getGlobalClassNames(Fo,i);return[a.cell,o.getFocusStyle(i),{color:r.bodyText,position:"relative",display:"inline-block",boxSizing:"border-box",padding:"0 "+e.cellRightPadding+"px 0 "+e.cellLeftPadding+"px",lineHeight:"inherit",margin:"0",height:Zt,verticalAlign:"top",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left"}]},Ca=function(t){var i,n,e,r,a=t.theme,s=t.className,l=t.isAllSelected,c=t.isResizingColumn,d=t.isSizing,g=t.isAllCollapsed,m=t.cellStyleProps,u=m===void 0?mt:m,f=a.semanticColors,p=a.palette,_=a.fonts,v=o.getGlobalClassNames(Fo,a),b={iconForegroundColor:f.bodySubtext,headerForegroundColor:f.bodyText,headerBackgroundColor:f.bodyBackground,resizerColor:p.neutralTertiaryAlt},y={opacity:1,transition:"opacity 0.3s linear"},C=Ho(t);return{root:[v.root,_.small,{display:"inline-block",background:b.headerBackgroundColor,position:"relative",minWidth:"100%",verticalAlign:"top",height:Zt,lineHeight:Zt,whiteSpace:"nowrap",boxSizing:"content-box",paddingBottom:"1px",paddingTop:"16px",borderBottom:"1px solid "+f.bodyDivider,cursor:"default",userSelect:"none",selectors:(i={},i["&:hover ."+v.check]={opacity:1},i["& ."+v.tooltipHost+" ."+v.checkTooltip]={display:"block"},i)},l&&v.isAllSelected,c&&v.isResizingColumn,s],check:[v.check,{height:Zt},{selectors:(n={},n["."+o.IsFocusVisibleClassName+" &:focus"]={opacity:1},n)}],cellWrapperPadded:{paddingRight:u.cellExtraRightPadding+u.cellRightPadding},cellIsCheck:[C,v.cellIsCheck,{position:"relative",padding:0,margin:0,display:"inline-flex",alignItems:"center",border:"none"},l&&{opacity:1}],cellIsGroupExpander:[C,{display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:_.small.fontSize,padding:0,border:"none",width:en,color:p.neutralSecondary,selectors:{":hover":{backgroundColor:p.neutralLighter},":active":{backgroundColor:p.neutralLight}}}],cellIsActionable:{selectors:{":hover":{color:f.bodyText,background:f.listHeaderBackgroundHovered},":active":{background:f.listHeaderBackgroundPressed}}},cellIsEmpty:{textOverflow:"clip"},cellSizer:[v.cellSizer,o.focusClear(),{display:"inline-block",position:"relative",cursor:"ew-resize",bottom:0,top:0,overflow:"hidden",height:"inherit",background:"transparent",zIndex:1,width:16,selectors:(e={":after":{content:'""',position:"absolute",top:0,bottom:0,width:1,background:b.resizerColor,opacity:0,left:"50%"},":focus:after":y,":hover:after":y},e["&."+v.isResizing+":after"]=[y,{boxShadow:"0 0 5px 0 rgba(0, 0, 0, 0.4)"}],e)}],cellIsResizing:v.isResizing,cellSizerStart:{margin:"0 -8px"},cellSizerEnd:{margin:0,marginLeft:-16},collapseButton:[v.collapseButton,{transformOrigin:"50% 50%",transition:"transform .1s linear"},g?[v.isCollapsed,{transform:"rotate(0deg)"}]:{transform:o.getRTL(a)?"rotate(-90deg)":"rotate(90deg)"}],checkTooltip:v.checkTooltip,sizingOverlay:d&&{position:"absolute",left:0,top:0,right:0,bottom:0,cursor:"ew-resize",background:"rgba(255, 255, 255, 0)",selectors:(r={},r[o.HighContrastSelector]=o.__assign({background:"transparent"},o.getHighContrastNoAdjustStyle()),r)},accessibleLabel:o.hiddenContentStyle,dropHintCircleStyle:[v.dropHintCircleStyle,{display:"inline-block",visibility:"hidden",position:"absolute",bottom:0,height:9,width:9,borderRadius:"50%",marginLeft:-5,top:34,overflow:"visible",zIndex:10,border:"1px solid "+p.themePrimary,background:p.white}],dropHintCaretStyle:[v.dropHintCaretStyle,{display:"none",position:"absolute",top:-28,left:-6.5,fontSize:_.medium.fontSize,color:p.themePrimary,overflow:"visible",zIndex:10}],dropHintLineStyle:[v.dropHintLineStyle,{display:"none",position:"absolute",bottom:0,top:0,overflow:"hidden",height:42,width:1,background:p.themePrimary,zIndex:10}],dropHintStyle:{display:"inline-block",position:"absolute"}}},Mo={root:"ms-Check",circle:"ms-Check-circle",check:"ms-Check-check",checkHost:"ms-Check-checkHost"},Sa=function(t){var i,n,e,r,a,s=t.height,l=s===void 0?t.checkBoxHeight||"18px":s,c=t.checked,d=t.className,g=t.theme,m=g.palette,u=g.semanticColors,f=g.fonts,p=o.getRTL(g),_=o.getGlobalClassNames(Mo,g),v={fontSize:l,position:"absolute",left:0,top:0,width:l,height:l,textAlign:"center",display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle"};return{root:[_.root,f.medium,{lineHeight:"1",width:l,height:l,verticalAlign:"top",position:"relative",userSelect:"none",selectors:(i={":before":{content:'""',position:"absolute",top:"1px",right:"1px",bottom:"1px",left:"1px",borderRadius:"50%",opacity:1,background:u.bodyBackground}},i["."+_.checkHost+":hover &, ."+_.checkHost+":focus &, &:hover, &:focus"]={opacity:1},i)},c&&["is-checked",{selectors:{":before":{background:m.themePrimary,opacity:1,selectors:(n={},n[o.HighContrastSelector]={background:"Window"},n)}}}],d],circle:[_.circle,v,{color:m.neutralSecondary,selectors:(e={},e[o.HighContrastSelector]={color:"WindowText"},e)},c&&{color:m.white}],check:[_.check,v,{opacity:0,color:m.neutralSecondary,fontSize:o.IconFontSizes.medium,left:p?"-0.5px":".5px",top:"-1px",selectors:(r={":hover":{opacity:1}},r[o.HighContrastSelector]=o.__assign({},o.getHighContrastNoAdjustStyle()),r)},c&&{opacity:1,color:m.white,fontWeight:900,selectors:(a={},a[o.HighContrastSelector]={border:"none",color:"WindowText"},a)}],checkHost:_.checkHost}},ka={root:"ms-DetailsRow-check",isDisabled:"ms-DetailsRow-check--isDisabled",isHeader:"ms-DetailsRow-check--isHeader"},nn=48,Da=function(t){var i=t.theme,n=t.className,e=t.isHeader,r=t.selected,a=t.anySelected,s=t.canSelect,l=t.compact,c=t.isVisible,d=o.getGlobalClassNames(ka,i),g=tn.rowHeight,m=tn.compactRowHeight,u=e?Zt:l?m:g,f=c||r||a;return{root:[d.root,n],check:[!s&&d.isDisabled,e&&d.isHeader,o.getFocusStyle(i),i.fonts.small,Mo.checkHost,{display:"flex",alignItems:"center",justifyContent:"center",cursor:"default",boxSizing:"border-box",verticalAlign:"top",background:"none",backgroundColor:"transparent",border:"none",opacity:f?1:0,height:u,width:nn,padding:0,margin:0}],isDisabled:[]}},xa={root:"ms-GroupHeader",compact:"ms-GroupHeader--compact",check:"ms-GroupHeader-check",dropIcon:"ms-GroupHeader-dropIcon",expand:"ms-GroupHeader-expand",isCollapsed:"is-collapsed",title:"ms-GroupHeader-title",isSelected:"is-selected",iconTag:"ms-Icon--Tag",group:"ms-GroupedList-group",isDropping:"is-dropping"},dn={easeOutCirc:"cubic-bezier(0.075, 0.820, 0.165, 1.000)",easeOutSine:"cubic-bezier(0.390, 0.575, 0.565, 1.000)",easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)"},wa=48,Ia=40,Ra=function(t){var i,n,e,r,a,s=t.theme,l=t.className,c=t.selected,d=t.isCollapsed,g=t.compact,m=mt.cellLeftPadding,u=g?Ia:wa,f=s.semanticColors,p=s.palette,_=s.fonts,v=o.getGlobalClassNames(xa,s),b=[o.getFocusStyle(s),{cursor:"default",background:"none",backgroundColor:"transparent",border:"none",padding:0}];return{root:[v.root,o.getFocusStyle(s),s.fonts.medium,{borderBottom:"1px solid "+f.listBackground,cursor:"default",userSelect:"none",selectors:(i={":hover":{background:f.listItemBackgroundHovered,color:f.actionLinkHovered}},i["&:hover ."+v.check]={opacity:1},i["."+o.IsFocusVisibleClassName+" &:focus ."+v.check]={opacity:1},i[":global(."+v.group+"."+v.isDropping+")"]={selectors:(n={},n["& > ."+v.root+" ."+v.dropIcon]={transition:"transform "+o.AnimationVariables.durationValue4+" "+dn.easeOutCirc+" "+("opacity "+o.AnimationVariables.durationValue1+" "+dn.easeOutSine),transitionDelay:o.AnimationVariables.durationValue3,opacity:1,transform:"rotate(0.2deg) scale(1);"},n["."+v.check]={opacity:0},n)},i)},c&&[v.isSelected,{background:f.listItemBackgroundChecked,selectors:(e={":hover":{background:f.listItemBackgroundCheckedHovered}},e[""+v.check]={opacity:1},e)}],g&&[v.compact,{border:"none"}],l],groupHeaderContainer:[{display:"flex",alignItems:"center",height:u}],headerCount:[{padding:"0px 4px"}],check:[v.check,b,{display:"flex",alignItems:"center",justifyContent:"center",paddingTop:1,marginTop:-1,opacity:0,width:nn,height:u,selectors:(r={},r["."+o.IsFocusVisibleClassName+" &:focus"]={opacity:1},r)}],expand:[v.expand,b,{display:"flex",alignItems:"center",justifyContent:"center",fontSize:_.small.fontSize,width:en,height:u,color:c?p.neutralPrimary:p.neutralSecondary,selectors:{":hover":{backgroundColor:c?p.neutralQuaternary:p.neutralLight},":active":{backgroundColor:c?p.neutralTertiaryAlt:p.neutralQuaternaryAlt}}}],expandIsCollapsed:[d?[v.isCollapsed,{transform:"rotate(0deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}]:{transform:o.getRTL(s)?"rotate(-90deg)":"rotate(90deg)",transformOrigin:"50% 50%",transition:"transform .1s linear"}],title:[v.title,{paddingLeft:m,fontSize:g?_.medium.fontSize:_.mediumPlus.fontSize,fontWeight:d?o.FontWeights.regular:o.FontWeights.semibold,cursor:"pointer",outline:0,whiteSpace:"nowrap",textOverflow:"ellipsis"}],dropIcon:[v.dropIcon,{position:"absolute",left:-26,fontSize:o.IconFontSizes.large,color:p.neutralSecondary,transition:"transform "+o.AnimationVariables.durationValue2+" "+dn.easeInBack+", "+("opacity "+o.AnimationVariables.durationValue4+" "+dn.easeOutSine),opacity:0,transform:"rotate(0.2deg) scale(0.65)",transformOrigin:"10px 10px",selectors:(a={},a[":global(."+v.iconTag+")"]={position:"absolute"},a)}]}},Na=o.classNamesFunction(),Lo=h.forwardRef(function(t,i){var n=t.checked,e=n===void 0?!1:n,r=t.className,a=t.theme,s=t.styles,l=t.useFastIcons,c=l===void 0?!0:l,d=Na(s,{theme:a,className:r,checked:e}),g=c?o.FontIcon:o.Icon;return h.createElement("div",{className:d.root,ref:i},h.createElement(g,{iconName:"CircleRing",className:d.circle}),h.createElement(g,{iconName:"StatusCircleCheckmark",className:d.check}))});Lo.displayName="CheckBase";var Hn=o.styled(Lo,Sa,void 0,{scope:"Check"},!0),gt;(function(t){t[t.xSmall=0]="xSmall",t[t.small=1]="small",t[t.medium=2]="medium",t[t.large=3]="large"})(gt||(gt={}));var ci;(function(t){t[t.normal=0]="normal",t[t.large=1]="large"})(ci||(ci={}));var Ea=o.classNamesFunction(),Ta=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i.prototype.render=function(){var n=this.props,e=n.type,r=n.size,a=n.ariaLabel,s=n.ariaLive,l=n.styles,c=n.label,d=n.theme,g=n.className,m=n.labelPosition,u=a,f=o.getNativeProps(this.props,o.divProperties,["size"]),p=r;p===void 0&&e!==void 0&&(p=e===ci.large?gt.large:gt.medium);var _=Ea(l,{theme:d,size:p,className:g,labelPosition:m});return h.createElement("div",o.__assign({},f,{className:_.root}),h.createElement("div",{className:_.circle}),c&&h.createElement("div",{className:_.label},c),u&&h.createElement("div",{role:"status","aria-live":s},h.createElement(ne.DelayedRender,null,h.createElement("div",{className:_.screenReaderText},u))))},i.defaultProps={size:gt.medium,ariaLive:"polite",labelPosition:"bottom"},i}(h.Component),Pa={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},Aa=o.memoizeFunction(function(){return o.keyframes({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}})}),Fa=function(t){var i,n=t.theme,e=t.size,r=t.className,a=t.labelPosition,s=n.palette,l=o.getGlobalClassNames(Pa,n);return{root:[l.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},a==="top"&&{flexDirection:"column-reverse"},a==="right"&&{flexDirection:"row"},a==="left"&&{flexDirection:"row-reverse"},r],circle:[l.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+s.themeLight,borderTopColor:s.themePrimary,animationName:Aa(),animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(i={},i[o.HighContrastSelector]=o.__assign({borderTopColor:"Highlight"},o.getHighContrastNoAdjustStyle()),i)},e===gt.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],e===gt.small&&["ms-Spinner--small",{width:16,height:16}],e===gt.medium&&["ms-Spinner--medium",{width:20,height:20}],e===gt.large&&["ms-Spinner--large",{width:28,height:28}]],label:[l.label,n.fonts.small,{color:s.themePrimary,margin:"8px 0 0",textAlign:"center"},a==="top"&&{margin:"0 0 8px"},a==="right"&&{margin:"0 0 0 8px"},a==="left"&&{margin:"0 8px 0 0"}],screenReaderText:o.hiddenContentStyle}},di=o.styled(Ta,Fa,void 0,{scope:"Spinner"}),Ha=o.classNamesFunction(),Ma=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._toggleCollapse=function(){var r=e.props,a=r.group,s=r.onToggleCollapse,l=r.isGroupLoading,c=e.state.isCollapsed,d=!c,g=!d&&l&&l(a);e.setState({isCollapsed:d,isLoadingVisible:g}),s&&s(a)},e._onKeyUp=function(r){var a=e.props,s=a.group,l=a.onGroupHeaderKeyUp;if(l&&l(r,s),!r.defaultPrevented){var c=e.state.isCollapsed&&r.which===o.getRTLSafeKeyCode(o.KeyCodes.right,e.props.theme),d=!e.state.isCollapsed&&r.which===o.getRTLSafeKeyCode(o.KeyCodes.left,e.props.theme);(d||c)&&(e._toggleCollapse(),r.stopPropagation(),r.preventDefault())}},e._onToggleClick=function(r){e._toggleCollapse(),r.stopPropagation(),r.preventDefault()},e._onToggleSelectGroupClick=function(r){var a=e.props,s=a.onToggleSelectGroup,l=a.group;s&&s(l),r.preventDefault(),r.stopPropagation()},e._onHeaderClick=function(){var r=e.props,a=r.group,s=r.onGroupHeaderClick,l=r.onToggleSelectGroup;s?s(a):l&&l(a)},e._onRenderTitle=function(r){var a=r.group,s=r.ariaColSpan;return a?h.createElement("div",{className:e._classNames.title,id:e._id,role:"gridcell","aria-colspan":s},h.createElement("span",null,a.name),h.createElement("span",{className:e._classNames.headerCount},"(",a.count,a.hasMoreData&&"+",")")):null},e._id=o.getId("GroupHeader"),e.state={isCollapsed:e.props.group&&e.props.group.isCollapsed,isLoadingVisible:!1},e}return i.getDerivedStateFromProps=function(n,e){if(n.group){var r=n.group.isCollapsed,a=n.isGroupLoading,s=!r&&a&&a(n.group);return o.__assign(o.__assign({},e),{isCollapsed:r||!1,isLoadingVisible:s||!1})}return e},i.prototype.render=function(){var n=this.props,e=n.group,r=n.groupLevel,a=r===void 0?0:r,s=n.viewport,l=n.selectionMode,c=n.loadingText,d=n.isSelected,g=d===void 0?!1:d,m=n.selected,u=m===void 0?!1:m,f=n.indentWidth,p=n.onRenderTitle,_=p===void 0?this._onRenderTitle:p,v=n.onRenderGroupHeaderCheckbox,b=n.isCollapsedGroupSelectVisible,y=b===void 0?!0:b,C=n.expandButtonProps,x=n.expandButtonIcon,R=n.selectAllButtonProps,D=n.theme,S=n.styles,I=n.className,N=n.compact,k=n.ariaPosInSet,w=n.ariaSetSize,E=n.ariaRowIndex,P=n.useFastIcons,T=P?this._fastDefaultCheckboxRender:this._defaultCheckboxRender,M=v?o.composeRenderFunction(v,T):T,L=this.state,B=L.isCollapsed,z=L.isLoadingVisible,H=l===Q.multiple,O=H&&(y||!(e&&e.isCollapsed)),V=u||g,W=o.getRTL(D);return this._classNames=Ha(S,{theme:D,className:I,selected:V,isCollapsed:B,compact:N}),e?h.createElement("div",{className:this._classNames.root,style:s?{minWidth:s.width}:{},onClick:this._onHeaderClick,role:"row","aria-setsize":w,"aria-posinset":k,"aria-rowindex":E,"data-is-focusable":!0,onKeyUp:this._onKeyUp,"aria-label":e.ariaLabel,"aria-labelledby":e.ariaLabel?void 0:this._id,"aria-expanded":!this.state.isCollapsed,"aria-selected":H?V:void 0,"aria-level":a+1},h.createElement("div",{className:this._classNames.groupHeaderContainer,role:"presentation"},O?h.createElement("div",{role:"gridcell"},h.createElement("button",o.__assign({"data-is-focusable":!1,type:"button",className:this._classNames.check,role:"checkbox",id:this._id+"-check","aria-checked":V,"aria-labelledby":this._id+"-check "+this._id,"data-selection-toggle":!0,onClick:this._onToggleSelectGroupClick},R),M({checked:V,theme:D},M))):l!==Q.none&&h.createElement(Bt,{indentWidth:nn,count:1}),h.createElement(Bt,{indentWidth:f,count:a}),h.createElement("div",{className:this._classNames.dropIcon,role:"presentation"},h.createElement(o.Icon,{iconName:"Tag"})),h.createElement("div",{role:"gridcell"},h.createElement("button",o.__assign({"data-is-focusable":!1,type:"button",className:this._classNames.expand,onClick:this._onToggleClick,"aria-expanded":!this.state.isCollapsed},C),h.createElement(o.Icon,{className:this._classNames.expandIsCollapsed,iconName:x||(W?"ChevronLeftMed":"ChevronRightMed")}))),_(this.props,this._onRenderTitle),z&&h.createElement(di,{label:c}))):null},i.prototype._defaultCheckboxRender=function(n){return h.createElement(Hn,{checked:n.checked})},i.prototype._fastDefaultCheckboxRender=function(n){return h.createElement(La,{theme:n.theme,checked:n.checked})},i.defaultProps={expandButtonProps:{"aria-label":"expand collapse group"}},i}(h.Component),La=h.memo(function(t){return h.createElement(Hn,{theme:t.theme,checked:t.checked,className:t.className,useFastIcons:!0})}),za=o.styled(Ma,Ra,void 0,{scope:"GroupHeader"}),Ba={root:"ms-GroupShowAll",link:"ms-Link"},Oa=function(t){var i,n=t.theme,e=n.fonts,r=o.getGlobalClassNames(Ba,n);return{root:[r.root,{position:"relative",padding:"10px 84px",cursor:"pointer",selectors:(i={},i["."+r.link]={fontSize:e.small.fontSize},i)}]}},Wa=o.classNamesFunction(),Ga=function(t,i){var n=t.as,e=t.className,r=t.disabled,a=t.href,s=t.onClick,l=t.styles,c=t.theme,d=t.underline,g=h.useRef(null),m=o.useMergedRefs(g,i);Va(t,g),o.useFocusRects(g);var u=Wa(l,{className:e,isButton:!a,isDisabled:r,isUnderlined:d,theme:c}),f=function(y){r?y.preventDefault():s&&s(y)},p=n||(a?"a":"button"),_={},v={root:p},b={root:o.__assign(o.__assign({},Ka(p,t)),{"aria-disabled":r,className:u.root,onClick:f,ref:m})};return{state:_,slots:v,slotProps:b}},Va=function(t,i){h.useImperativeHandle(t.componentRef,function(){return{focus:function(){i.current&&i.current.focus()}}},[i])},Ka=function(t,i){i.as;var n=i.disabled,e=i.target,r=i.href;i.theme,i.getStyles,i.styles,i.componentRef,i.underline;var a=o.__rest(i,["as","disabled","target","href","theme","getStyles","styles","componentRef","underline"]);return typeof t=="string"?t==="a"?o.__assign({target:e,href:n?void 0:r},a):t==="button"?o.__assign({type:"button",disabled:n},a):o.__assign(o.__assign({},a),{disabled:n}):o.__assign({target:e,href:r,disabled:n},a)},zo=h.forwardRef(function(t,i){var n=Ga(t,i),e=n.slots,r=n.slotProps;return h.createElement(e.root,o.__assign({},r.root))});zo.displayName="LinkBase";var Ua=o.styled(zo,pa,void 0,{scope:"Link"}),Ya=o.classNamesFunction(),$a=function(t){var i=t.group,n=t.groupLevel,e=t.showAllLinkText,r=e===void 0?"Show All":e,a=t.styles,s=t.theme,l=t.onToggleSummarize,c=Ya(a,{theme:s}),d=$.useCallback(function(g){l(i),g.stopPropagation(),g.preventDefault()},[l,i]);return i?h.createElement("div",{className:c.root},h.createElement(Bt,{count:n}),h.createElement(Ua,{onClick:d},r)):null},ja=o.styled($a,Oa,void 0,{scope:"GroupShowAll"}),Za={root:"ms-groupFooter"},qa=function(t){var i=t.theme,n=t.className,e=o.getGlobalClassNames(Za,i);return{root:[i.fonts.medium,e.root,{position:"relative",padding:"5px 38px"},n]}},Xa=o.classNamesFunction(),Ja=function(t){var i=t.group,n=t.groupLevel,e=t.footerText,r=t.indentWidth,a=t.styles,s=t.theme,l=Xa(a,{theme:s});return i&&e?h.createElement("div",{className:l.root},h.createElement(Bt,{indentWidth:r,count:n}),e):null},Qa=o.styled(Ja,qa,void 0,{scope:"GroupFooter"}),Yt={auto:0,top:1,bottom:2,center:3},es=16,ts=100,ns=500,is=200,os=500,Wi=10,rs=30,as=2,ss=2,ls="page-",Gi="spacer-",Vi={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},Bo=function(t){return t.getBoundingClientRect()},cs=Bo,ds=Bo,Nn=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._root=h.createRef(),e._surface=h.createRef(),e._pageRefs={},e._getDerivedStateFromProps=function(r,a){return r.items!==e.props.items||r.renderCount!==e.props.renderCount||r.startIndex!==e.props.startIndex||r.version!==e.props.version?(e._resetRequiredWindows(),e._requiredRect=null,e._measureVersion++,e._invalidatePageCache(),e._updatePages(r,a)):a},e._onRenderRoot=function(r){var a=r.rootRef,s=r.surfaceElement,l=r.divProps;return h.createElement("div",o.__assign({ref:a},l),s)},e._onRenderSurface=function(r){var a=r.surfaceRef,s=r.pageElements,l=r.divProps;return h.createElement("div",o.__assign({ref:a},l),s)},e._onRenderPage=function(r,a){for(var s=e.props,l=s.onRenderCell,c=s.role,d=r.page,g=d.items,m=g===void 0?[]:g,u=d.startIndex,f=o.__rest(r,["page"]),p=c===void 0?"listitem":"presentation",_=[],v=0;v<m.length;v++){var b=u+v,y=m[v],C=e.props.getKey?e.props.getKey(y,b):y&&y.key;C==null&&(C=b),_.push(h.createElement("div",{role:p,className:"ms-List-cell",key:C,"data-list-index":b,"data-automationid":"ListCell"},l&&l(y,b,e.props.ignoreScrollingState?void 0:e.state.isScrolling)))}return h.createElement("div",o.__assign({},f),_)},o.initializeComponentRef(e),e.state={pages:[],isScrolling:!1,getDerivedStateFromProps:e._getDerivedStateFromProps},e._async=new o.Async(e),e._events=new o.EventGroup(e),e._estimatedPageHeight=0,e._totalEstimates=0,e._requiredWindowsAhead=0,e._requiredWindowsBehind=0,e._measureVersion=0,e._onAsyncScroll=e._async.debounce(e._onAsyncScroll,ts,{leading:!1,maxWait:ns}),e._onAsyncIdle=e._async.debounce(e._onAsyncIdle,is,{leading:!1}),e._onAsyncResize=e._async.debounce(e._onAsyncResize,es,{leading:!1}),e._onScrollingDone=e._async.debounce(e._onScrollingDone,os,{leading:!1}),e._cachedPageHeights={},e._estimatedPageHeight=0,e._focusedIndex=-1,e._pageCache={},e}return i.getDerivedStateFromProps=function(n,e){return e.getDerivedStateFromProps(n,e)},Object.defineProperty(i.prototype,"pageRefs",{get:function(){return this._pageRefs},enumerable:!1,configurable:!0}),i.prototype.scrollToIndex=function(n,e,r){r===void 0&&(r=Yt.auto);for(var a=this.props.startIndex,s=this._getRenderCount(),l=a+s,c=this._allowedRect,d=0,g=1,m=a;m<l;m+=g){var u=this._getPageSpecification(m,c),f=u.height;g=u.itemCount;var p=m<=n&&m+g>n;if(p){if(e&&this._scrollElement){for(var _=ds(this._scrollElement),v={top:this._scrollElement.scrollTop,bottom:this._scrollElement.scrollTop+_.height},b=n-m,y=0;y<b;++y)d+=e(m+y);var C=d+e(n);switch(r){case Yt.top:this._scrollElement.scrollTop=d;return;case Yt.bottom:this._scrollElement.scrollTop=C-_.height;return;case Yt.center:this._scrollElement.scrollTop=(d+C-_.height)/2;return;case Yt.auto:}var x=d>=v.top&&C<=v.bottom;if(x)return;var R=d<v.top,D=C>v.bottom;R||D&&(d=C-_.height)}this._scrollElement&&(this._scrollElement.scrollTop=d);return}d+=f}},i.prototype.getStartItemIndexInView=function(n){for(var e=this.state.pages||[],r=0,a=e;r<a.length;r++){var s=a[r],l=!s.isSpacer&&(this._scrollTop||0)>=s.top&&(this._scrollTop||0)<=s.top+s.height;if(l)if(n)for(var d=0,g=s.startIndex;g<s.startIndex+s.itemCount;g++){var c=n(g);if(s.top+d<=this._scrollTop&&this._scrollTop<s.top+d+c)return g;d+=c}else{var c=Math.floor(s.height/s.itemCount);return s.startIndex+Math.floor((this._scrollTop-s.top)/c)}}return 0},i.prototype.componentDidMount=function(){this.setState(this._updatePages(this.props,this.state)),this._measureVersion++,this._scrollElement=o.findScrollableParent(this._root.current),this._events.on(window,"resize",this._onAsyncResize),this._root.current&&this._events.on(this._root.current,"focus",this._onFocus,!0),this._scrollElement&&(this._events.on(this._scrollElement,"scroll",this._onScroll),this._events.on(this._scrollElement,"scroll",this._onAsyncScroll))},i.prototype.componentDidUpdate=function(n,e){var r=this.props,a=this.state;if(this.state.pagesVersion!==e.pagesVersion){if(r.getPageHeight)this._onAsyncIdle();else{var s=this._updatePageMeasurements(a.pages);s?(this._materializedRect=null,this._hasCompletedFirstRender?this._onAsyncScroll():(this._hasCompletedFirstRender=!0,this.setState(this._updatePages(r,a)))):this._onAsyncIdle()}r.onPagesUpdated&&r.onPagesUpdated(a.pages)}},i.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose(),delete this._scrollElement},i.prototype.shouldComponentUpdate=function(n,e){var r=this.state.pages,a=e.pages,s=!1;if(!e.isScrolling&&this.state.isScrolling||n.version!==this.props.version)return!0;if(n.items===this.props.items&&r.length===a.length)for(var l=0;l<r.length;l++){var c=r[l],d=a[l];if(c.key!==d.key||c.itemCount!==d.itemCount){s=!0;break}}else s=!0;return s},i.prototype.forceUpdate=function(){this._invalidatePageCache(),this._updateRenderRects(this.props,this.state,!0),this.setState(this._updatePages(this.props,this.state)),this._measureVersion++,t.prototype.forceUpdate.call(this)},i.prototype.getTotalListHeight=function(){return this._surfaceRect.height},i.prototype.render=function(){for(var n=this.props,e=n.className,r=n.role,a=r===void 0?"list":r,s=n.onRenderSurface,l=n.onRenderRoot,c=this.state.pages,d=c===void 0?[]:c,g=[],m=o.getNativeProps(this.props,o.divProperties),u=0,f=d;u<f.length;u++){var p=f[u];g.push(this._renderPage(p))}var _=s?o.composeRenderFunction(s,this._onRenderSurface):this._onRenderSurface,v=l?o.composeRenderFunction(l,this._onRenderRoot):this._onRenderRoot;return v({rootRef:this._root,pages:d,surfaceElement:_({surfaceRef:this._surface,pages:d,pageElements:g,divProps:{role:"presentation",className:"ms-List-surface"}}),divProps:o.__assign(o.__assign({},m),{className:o.css("ms-List",e),role:g.length>0?a:void 0,"aria-label":g.length>0?m["aria-label"]:void 0})})},i.prototype._shouldVirtualize=function(n){n===void 0&&(n=this.props);var e=n.onShouldVirtualize;return!e||e(n)},i.prototype._invalidatePageCache=function(){this._pageCache={}},i.prototype._renderPage=function(n){var e=this,r=this.props.usePageCache,a;if(r&&(a=this._pageCache[n.key],a&&a.pageElement))return a.pageElement;var s=this._getPageStyle(n),l=this.props.onRenderPage,c=l===void 0?this._onRenderPage:l,d=c({page:n,className:"ms-List-page",key:n.key,ref:function(g){e._pageRefs[n.key]=g},style:s,role:"presentation"},this._onRenderPage);return r&&n.startIndex===0&&(this._pageCache[n.key]={page:n,pageElement:d}),d},i.prototype._getPageStyle=function(n){var e=this.props.getPageStyle;return o.__assign(o.__assign({},e?e(n):{}),n.items?{}:{height:n.height})},i.prototype._onFocus=function(n){for(var e=n.target;e!==this._surface.current;){var r=e.getAttribute("data-list-index");if(r){this._focusedIndex=Number(r);break}e=o.getParent(e)}},i.prototype._onScroll=function(){!this.state.isScrolling&&!this.props.ignoreScrollingState&&this.setState({isScrolling:!0}),this._resetRequiredWindows(),this._onScrollingDone()},i.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0,this._requiredWindowsBehind=0},i.prototype._onAsyncScroll=function(){this._updateRenderRects(this.props,this.state),(!this._materializedRect||!us(this._requiredRect,this._materializedRect))&&this.setState(this._updatePages(this.props,this.state))},i.prototype._onAsyncIdle=function(){var n=this.props,e=n.renderedWindowsAhead,r=n.renderedWindowsBehind,a=this,s=a._requiredWindowsAhead,l=a._requiredWindowsBehind,c=Math.min(e,s+1),d=Math.min(r,l+1);(c!==s||d!==l)&&(this._requiredWindowsAhead=c,this._requiredWindowsBehind=d,this._updateRenderRects(this.props,this.state),this.setState(this._updatePages(this.props,this.state))),(e>c||r>d)&&this._onAsyncIdle()},i.prototype._onScrollingDone=function(){this.props.ignoreScrollingState||this.setState({isScrolling:!1})},i.prototype._onAsyncResize=function(){this.forceUpdate()},i.prototype._updatePages=function(n,e){this._requiredRect||this._updateRenderRects(n,e);var r=this._buildPages(n,e),a=e.pages;return this._notifyPageChanges(a,r.pages,this.props),o.__assign(o.__assign(o.__assign({},e),r),{pagesVersion:{}})},i.prototype._notifyPageChanges=function(n,e,r){var a=r.onPageAdded,s=r.onPageRemoved;if(a||s){for(var l={},c=0,d=n;c<d.length;c++){var g=d[c];g.items&&(l[g.startIndex]=g)}for(var m=0,u=e;m<u.length;m++){var g=u[m];g.items&&(l[g.startIndex]?delete l[g.startIndex]:this._onPageAdded(g))}for(var f in l)l.hasOwnProperty(f)&&this._onPageRemoved(l[f])}},i.prototype._updatePageMeasurements=function(n){var e=!1;if(!this._shouldVirtualize())return e;for(var r=0;r<n.length;r++){var a=n[r];a.items&&(e=this._measurePage(a)||e)}return e},i.prototype._measurePage=function(n){var e=!1,r=this._pageRefs[n.key],a=this._cachedPageHeights[n.startIndex];if(r&&this._shouldVirtualize()&&(!a||a.measureVersion!==this._measureVersion)){var s={width:r.clientWidth,height:r.clientHeight};(s.height||s.width)&&(e=n.height!==s.height,n.height=s.height,this._cachedPageHeights[n.startIndex]={height:s.height,measureVersion:this._measureVersion},this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+s.height)/(this._totalEstimates+1)),this._totalEstimates++)}return e},i.prototype._onPageAdded=function(n){var e=this.props.onPageAdded;e&&e(n)},i.prototype._onPageRemoved=function(n){var e=this.props.onPageRemoved;e&&e(n)},i.prototype._buildPages=function(n,e){var r=n.renderCount,a=n.items,s=n.startIndex,l=n.getPageHeight;r=this._getRenderCount(n);for(var c=o.__assign({},Vi),d=[],g=1,m=0,u=null,f=this._focusedIndex,p=s+r,_=this._shouldVirtualize(n),v=this._estimatedPageHeight===0&&!l,b=this._allowedRect,y=function(D){var S=C._getPageSpecification(D,b),I=S.height,N=S.data,k=S.key;g=S.itemCount;var w=m+I-1,E=o.findIndex(e.pages,function(O){return!!O.items&&O.startIndex===D})>-1,P=!b||w>=b.top&&m<=b.bottom,T=!C._requiredRect||w>=C._requiredRect.top&&m<=C._requiredRect.bottom,M=!v&&(T||P&&E)||!_,L=f>=D&&f<D+g,B=D===s;if(M||L||B){u&&(d.push(u),u=null);var z=Math.min(g,p-D),H=C._createPage(k,a.slice(D,D+z),D,void 0,void 0,N);H.top=m,H.height=I,C._visibleRect&&C._visibleRect.bottom&&(H.isVisible=w>=C._visibleRect.top&&m<=C._visibleRect.bottom),d.push(H),T&&C._allowedRect&&gs(c,{top:m,bottom:w,height:I,left:b.left,right:b.right,width:b.width})}else u||(u=C._createPage(Gi+D,void 0,D,0,void 0,N,!0)),u.height=(u.height||0)+(w-m)+1,u.itemCount+=g;if(m+=w-m+1,v&&_)return"break"},C=this,x=s;x<p;x+=g){var R=y(x);if(R==="break")break}return u&&(u.key=Gi+"end",d.push(u)),this._materializedRect=c,o.__assign(o.__assign({},e),{pages:d,measureVersion:this._measureVersion})},i.prototype._getPageSpecification=function(n,e){var r=this.props.getPageSpecification;if(r){var a=r(n,e),s=a.itemCount,l=s===void 0?this._getItemCountForPage(n,e):s,c=a.height,d=c===void 0?this._getPageHeight(n,e,l):c;return{itemCount:l,height:d,data:a.data,key:a.key}}else{var l=this._getItemCountForPage(n,e);return{itemCount:l,height:this._getPageHeight(n,e,l)}}},i.prototype._getPageHeight=function(n,e,r){if(this.props.getPageHeight)return this.props.getPageHeight(n,e,r);var a=this._cachedPageHeights[n];return a?a.height:this._estimatedPageHeight||rs},i.prototype._getItemCountForPage=function(n,e){var r=this.props.getItemCountForPage?this.props.getItemCountForPage(n,e):Wi;return r||Wi},i.prototype._createPage=function(n,e,r,a,s,l,c){r===void 0&&(r=-1),a===void 0&&(a=e?e.length:0),s===void 0&&(s={}),n=n||ls+r;var d=this._pageCache[n];return d&&d.page?d.page:{key:n,startIndex:r,itemCount:a,items:e,style:s,top:0,height:0,data:l,isSpacer:c||!1}},i.prototype._getRenderCount=function(n){var e=n||this.props,r=e.items,a=e.startIndex,s=e.renderCount;return s===void 0?r?r.length-a:0:s},i.prototype._updateRenderRects=function(n,e,r){var a=n.renderedWindowsAhead,s=n.renderedWindowsBehind,l=e.pages;if(!!this._shouldVirtualize(n)){var c=this._surfaceRect||o.__assign({},Vi),d=this._scrollElement&&this._scrollElement.scrollHeight,g=this._scrollElement?this._scrollElement.scrollTop:0;this._surface.current&&(r||!l||!this._surfaceRect||!d||d!==this._scrollHeight||Math.abs(this._scrollTop-g)>this._estimatedPageHeight/3)&&(c=this._surfaceRect=cs(this._surface.current),this._scrollTop=g),(r||!d||d!==this._scrollHeight)&&this._measureVersion++,this._scrollHeight=d||0;var m=Math.max(0,-c.top),u=o.getWindow(this._root.current),f={top:m,left:c.left,bottom:m+u.innerHeight,right:c.right,width:c.width,height:u.innerHeight};this._requiredRect=Ki(f,this._requiredWindowsBehind,this._requiredWindowsAhead),this._allowedRect=Ki(f,s,a),this._visibleRect=f}},i.defaultProps={startIndex:0,onRenderCell:function(n,e,r){return h.createElement(h.Fragment,null,n&&n.name||"")},renderedWindowsAhead:ss,renderedWindowsBehind:as},i}(h.Component);function Ki(t,i,n){var e=t.top-i*t.height,r=t.height+(i+n)*t.height;return{top:e,bottom:e+r,height:r,left:t.left,right:t.right,width:t.width}}function us(t,i){return t.top>=i.top&&t.left>=i.left&&t.bottom<=i.bottom&&t.right<=i.right}function gs(t,i){return t.top=i.top<t.top||t.top===-1?i.top:t.top,t.left=i.left<t.left||t.left===-1?i.left:t.left,t.bottom=i.bottom>t.bottom||t.bottom===-1?i.bottom:t.bottom,t.right=i.right>t.right||t.right===-1?i.right:t.right,t.width=t.right-t.left+1,t.height=t.bottom-t.top+1,t}var hs="is-dropping",ms=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;e._root=h.createRef(),e._list=h.createRef(),e._subGroupRefs={},e._droppingClassName="",e._onRenderGroupHeader=function(s){return h.createElement(za,o.__assign({},s))},e._onRenderGroupShowAll=function(s){return h.createElement(ja,o.__assign({},s))},e._onRenderGroupFooter=function(s){return h.createElement(Qa,o.__assign({},s))},e._renderSubGroup=function(s,l){var c=e.props,d=c.dragDropEvents,g=c.dragDropHelper,m=c.eventsToRegister,u=c.getGroupItemLimit,f=c.groupNestingDepth,p=c.groupProps,_=c.items,v=c.headerProps,b=c.showAllProps,y=c.footerProps,C=c.listProps,x=c.onRenderCell,R=c.selection,D=c.selectionMode,S=c.viewport,I=c.onRenderGroupHeader,N=c.onRenderGroupShowAll,k=c.onRenderGroupFooter,w=c.onShouldVirtualize,E=c.group,P=c.compact,T=s.level?s.level+1:f;return!s||s.count>0||p&&p.showEmptyGroups?h.createElement(i,{ref:function(M){return e._subGroupRefs["subGroup_"+l]=M},key:e._getGroupKey(s,l),dragDropEvents:d,dragDropHelper:g,eventsToRegister:m,footerProps:y,getGroupItemLimit:u,group:s,groupIndex:l,groupNestingDepth:T,groupProps:p,headerProps:v,items:_,listProps:C,onRenderCell:x,selection:R,selectionMode:D,showAllProps:b,viewport:S,onRenderGroupHeader:I,onRenderGroupShowAll:N,onRenderGroupFooter:k,onShouldVirtualize:w,groups:E?E.children:[],compact:P}):null},e._getGroupDragDropOptions=function(){var s=e.props,l=s.group,c=s.groupIndex,d=s.dragDropEvents,g=s.eventsToRegister,m={eventMap:g,selectionIndex:-1,context:{data:l,index:c,isGroup:!0},updateDropState:e._updateDroppingState,canDrag:d.canDrag,canDrop:d.canDrop,onDrop:d.onDrop,onDragStart:d.onDragStart,onDragEnter:d.onDragEnter,onDragLeave:d.onDragLeave,onDragEnd:d.onDragEnd,onDragOver:d.onDragOver};return m},e._updateDroppingState=function(s,l){var c=e.state.isDropping,d=e.props,g=d.dragDropEvents,m=d.group;c!==s&&(c?g&&g.onDragLeave&&g.onDragLeave(m,l):g&&g.onDragEnter&&(e._droppingClassName=g.onDragEnter(m,l)),e.setState({isDropping:s}))};var r=n.selection,a=n.group;return o.initializeComponentRef(e),e._id=o.getId("GroupedListSection"),e.state={isDropping:!1,isSelected:r&&a?r.isRangeSelected(a.startIndex,a.count):!1},e._events=new o.EventGroup(e),e}return i.prototype.componentDidMount=function(){var n=this.props,e=n.dragDropHelper,r=n.selection;e&&this._root.current&&(this._dragDropSubscription=e.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())),r&&this._events.on(r,Fn,this._onSelectionChange)},i.prototype.componentWillUnmount=function(){this._events.dispose(),this._dragDropSubscription&&this._dragDropSubscription.dispose()},i.prototype.componentDidUpdate=function(n){(this.props.group!==n.group||this.props.groupIndex!==n.groupIndex||this.props.dragDropHelper!==n.dragDropHelper)&&(this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getGroupDragDropOptions())))},i.prototype.render=function(){var n=this.props,e=n.getGroupItemLimit,r=n.group,a=n.groupIndex,s=n.headerProps,l=n.showAllProps,c=n.footerProps,d=n.viewport,g=n.selectionMode,m=n.onRenderGroupHeader,u=m===void 0?this._onRenderGroupHeader:m,f=n.onRenderGroupShowAll,p=f===void 0?this._onRenderGroupShowAll:f,_=n.onRenderGroupFooter,v=_===void 0?this._onRenderGroupFooter:_,b=n.onShouldVirtualize,y=n.groupedListClassNames,C=n.groups,x=n.compact,R=n.listProps,D=R===void 0?{}:R,S=this.state.isSelected,I=r&&e?e(r):1/0,N=r&&!r.children&&!r.isCollapsed&&!r.isShowingAll&&(r.count>I||r.hasMoreData),k=r&&r.children&&r.children.length>0,w=D.version,E={group:r,groupIndex:a,groupLevel:r?r.level:0,isSelected:S,selected:S,viewport:d,selectionMode:g,groups:C,compact:x},P={groupedListId:this._id,ariaSetSize:C?C.length:void 0,ariaPosInSet:a!==void 0?a+1:void 0},T=o.__assign(o.__assign(o.__assign({},s),E),P),M=o.__assign(o.__assign({},l),E),L=o.__assign(o.__assign({},c),E),B=!!this.props.dragDropHelper&&this._getGroupDragDropOptions().canDrag(r)&&!!this.props.dragDropEvents.canDragGroups;return h.createElement("div",o.__assign({ref:this._root},B&&{draggable:!0},{className:o.css(y&&y.group,this._getDroppingClassName()),role:"presentation"}),u(T,this._onRenderGroupHeader),r&&r.isCollapsed?null:k?h.createElement(Nn,{role:"presentation",ref:this._list,items:r?r.children:[],onRenderCell:this._renderSubGroup,getItemCountForPage:this._returnOne,onShouldVirtualize:b,version:w,id:this._id}):this._onRenderGroup(I),r&&r.isCollapsed?null:N&&p(M,this._onRenderGroupShowAll),v(L,this._onRenderGroupFooter))},i.prototype.forceUpdate=function(){t.prototype.forceUpdate.call(this),this.forceListUpdate()},i.prototype.forceListUpdate=function(){var n=this.props.group;if(this._list.current){if(this._list.current.forceUpdate(),n&&n.children&&n.children.length>0)for(var e=n.children.length,r=0;r<e;r++){var a=this._list.current.pageRefs["subGroup_"+String(r)];a&&a.forceListUpdate()}}else{var a=this._subGroupRefs["subGroup_"+String(0)];a&&a.forceListUpdate()}},i.prototype._onSelectionChange=function(){var n=this.props,e=n.group,r=n.selection;if(r&&e){var a=r.isRangeSelected(e.startIndex,e.count);a!==this.state.isSelected&&this.setState({isSelected:a})}},i.prototype._onRenderGroupCell=function(n,e,r){return function(a,s){return n(e,a,s,r)}},i.prototype._onRenderGroup=function(n){var e=this.props,r=e.group,a=e.items,s=e.onRenderCell,l=e.listProps,c=e.groupNestingDepth,d=e.onShouldVirtualize,g=e.groupProps,m=r&&!r.isShowingAll?r.count:a.length,u=r?r.startIndex:0;return h.createElement(Nn,o.__assign({role:g&&g.role?g.role:"rowgroup","aria-label":r==null?void 0:r.name,items:a,onRenderCell:this._onRenderGroupCell(s,c,r),ref:this._list,renderCount:Math.min(m,n),startIndex:u,onShouldVirtualize:d,id:this._id},l))},i.prototype._returnOne=function(){return 1},i.prototype._getGroupKey=function(n,e){return"group-"+(n&&n.key?n.key:String(n.level)+String(e))},i.prototype._getDroppingClassName=function(){var n=this.state.isDropping,e=this.props,r=e.group,a=e.groupedListClassNames;return n=!!(r&&n),o.css(n&&this._droppingClassName,n&&hs,n&&a&&a.groupIsDropping)},i}(h.Component),fs=o.classNamesFunction(),vs=tn.rowHeight,ps=tn.compactRowHeight,_s=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;e._list=h.createRef(),e._renderGroup=function(c,d){var g=e.props,m=g.dragDropEvents,u=g.dragDropHelper,f=g.eventsToRegister,p=g.groupProps,_=g.items,v=g.listProps,b=g.onRenderCell,y=g.selectionMode,C=g.selection,x=g.viewport,R=g.onShouldVirtualize,D=g.groups,S=g.compact,I={onToggleSelectGroup:e._onToggleSelectGroup,onToggleCollapse:e._onToggleCollapse,onToggleSummarize:e._onToggleSummarize},N=o.__assign(o.__assign({},p.headerProps),I),k=o.__assign(o.__assign({},p.showAllProps),I),w=o.__assign(o.__assign({},p.footerProps),I),E=e._getGroupNestingDepth();if(!p.showEmptyGroups&&c&&c.count===0)return null;var P=o.__assign(o.__assign({},v||{}),{version:e.state.version});return h.createElement(ms,{key:e._getGroupKey(c,d),dragDropEvents:m,dragDropHelper:u,eventsToRegister:f,footerProps:w,getGroupItemLimit:p&&p.getGroupItemLimit,group:c,groupIndex:d,groupNestingDepth:E,groupProps:p,headerProps:N,listProps:P,items:_,onRenderCell:b,onRenderGroupHeader:p.onRenderHeader,onRenderGroupShowAll:p.onRenderShowAll,onRenderGroupFooter:p.onRenderFooter,selectionMode:y,selection:C,showAllProps:k,viewport:x,onShouldVirtualize:R,groupedListClassNames:e._classNames,groups:D,compact:S})},e._getDefaultGroupItemLimit=function(c){return c.children&&c.children.length>0?c.children.length:c.count},e._getGroupItemLimit=function(c){var d=e.props.groupProps,g=d&&d.getGroupItemLimit?d.getGroupItemLimit:e._getDefaultGroupItemLimit;return g(c)},e._getGroupHeight=function(c){var d=e.props.compact?ps:vs;return d+(c.isCollapsed?0:d*e._getGroupItemLimit(c))},e._getPageHeight=function(c){var d=e.state.groups,g=e.props.getGroupHeight,m=g===void 0?e._getGroupHeight:g,u=d&&d[c];return u?m(u,c):0},e._onToggleCollapse=function(c){var d=e.props.groupProps,g=d&&d.headerProps&&d.headerProps.onToggleCollapse;c&&(g&&g(c),c.isCollapsed=!c.isCollapsed,e._updateIsSomeGroupExpanded(),e.forceUpdate())},e._onToggleSelectGroup=function(c){var d=e.props,g=d.selection,m=d.selectionMode;c&&g&&m===Q.multiple&&g.toggleRangeSelected(c.startIndex,c.count)},e._isInnerZoneKeystroke=function(c){return c.which===o.getRTLSafeKeyCode(o.KeyCodes.right)},e._onToggleSummarize=function(c){var d=e.props.groupProps,g=d&&d.showAllProps&&d.showAllProps.onToggleSummarize;g?g(c):(c&&(c.isShowingAll=!c.isShowingAll),e.forceUpdate())},e._getPageSpecification=function(c){var d=e.state.groups,g=d&&d[c];return{key:g&&g.key}},o.initializeComponentRef(e),e._isSomeGroupExpanded=e._computeIsSomeGroupExpanded(n.groups);var r=n.listProps,a=r===void 0?{}:r,s=a.version,l=s===void 0?{}:s;return e.state={groups:n.groups,items:n.items,listProps:n.listProps,version:l},e}return i.getDerivedStateFromProps=function(n,e){var r=n.groups,a=n.selectionMode,s=n.compact,l=n.items,c=n.listProps,d=c&&c.version,g=o.__assign(o.__assign({},e),{selectionMode:a,compact:s,groups:r,listProps:c}),m=!1,u=e.listProps&&e.listProps.version;return(d!==u||l!==e.items||r!==e.groups||a!==e.selectionMode||s!==e.compact)&&(m=!0),r!==e.groups&&(g=o.__assign(o.__assign({},g),{groups:r})),(a!==e.selectionMode||s!==e.compact)&&(m=!0),m&&(g=o.__assign(o.__assign({},g),{version:{}})),g},i.prototype.scrollToIndex=function(n,e,r){this._list.current&&this._list.current.scrollToIndex(n,e,r)},i.prototype.getStartItemIndexInView=function(){return this._list.current.getStartItemIndexInView()||0},i.prototype.componentDidMount=function(){var n=this.props,e=n.groupProps,r=n.groups,a=r===void 0?[]:r;e&&e.isAllGroupsCollapsed&&this._setGroupsCollapsedState(a,e.isAllGroupsCollapsed)},i.prototype.render=function(){var n=this.props,e=n.className,r=n.usePageCache,a=n.onShouldVirtualize,s=n.theme,l=n.role,c=l===void 0?"treegrid":l,d=n.styles,g=n.compact,m=n.focusZoneProps,u=m===void 0?{}:m,f=n.rootListProps,p=f===void 0?{}:f,_=this.state,v=_.groups,b=_.version;this._classNames=fs(d,{theme:s,className:e,compact:g});var y=u.shouldEnterInnerZone,C=y===void 0?this._isInnerZoneKeystroke:y;return h.createElement(o.FocusZone,o.__assign({direction:o.FocusZoneDirection.vertical,"data-automationid":"GroupedList","data-is-scrollable":"false",role:"presentation"},u,{shouldEnterInnerZone:C,className:o.css(this._classNames.root,u.className)}),v?h.createElement(Nn,o.__assign({ref:this._list,role:c,items:v,onRenderCell:this._renderGroup,getItemCountForPage:this._returnOne,getPageHeight:this._getPageHeight,getPageSpecification:this._getPageSpecification,usePageCache:r,onShouldVirtualize:a,version:b},p)):this._renderGroup(void 0,0))},i.prototype.forceUpdate=function(){t.prototype.forceUpdate.call(this),this._forceListUpdates()},i.prototype.toggleCollapseAll=function(n){var e=this.state.groups,r=e===void 0?[]:e,a=this.props.groupProps,s=a&&a.onToggleCollapseAll;r.length>0&&(s&&s(n),this._setGroupsCollapsedState(r,n),this._updateIsSomeGroupExpanded(),this.forceUpdate())},i.prototype._setGroupsCollapsedState=function(n,e){for(var r=0;r<n.length;r++)n[r].isCollapsed=e},i.prototype._returnOne=function(){return 1},i.prototype._getGroupKey=function(n,e){return"group-"+(n&&n.key?n.key:String(e))},i.prototype._getGroupNestingDepth=function(){for(var n=this.state.groups,e=0,r=n;r&&r.length>0;)e++,r=r[0].children;return e},i.prototype._forceListUpdates=function(n){this.setState({version:{}})},i.prototype._computeIsSomeGroupExpanded=function(n){var e=this;return!!(n&&n.some(function(r){return r.children?e._computeIsSomeGroupExpanded(r.children):!r.isCollapsed}))},i.prototype._updateIsSomeGroupExpanded=function(){var n=this.state.groups,e=this.props.onGroupExpandStateChanged,r=this._computeIsSomeGroupExpanded(n);this._isSomeGroupExpanded!==r&&(e&&e(r),this._isSomeGroupExpanded=r)},i.defaultProps={selectionMode:Q.multiple,isHeaderVisible:!0,groupProps:{},compact:!1},i}(h.Component),bs=o.styled(_s,va,void 0,{scope:"GroupedList"}),ys=o.classNamesFunction(),Cs=function(t){var i=t.isVisible,n=i===void 0?!1:i,e=t.canSelect,r=e===void 0?!1:e,a=t.anySelected,s=a===void 0?!1:a,l=t.selected,c=l===void 0?!1:l,d=t.selectionMode,g=t.isHeader,m=g===void 0?!1:g,u=t.className;t.checkClassName;var f=t.styles,p=t.theme,_=t.compact,v=t.onRenderDetailsCheckbox,b=t.useFastIcons,y=b===void 0?!0:b,C=o.__rest(t,["isVisible","canSelect","anySelected","selected","selectionMode","isHeader","className","checkClassName","styles","theme","compact","onRenderDetailsCheckbox","useFastIcons"]),x=y?Ds:ks,R=v?o.composeRenderFunction(v,x):x,D=ys(f,{theme:p,canSelect:r,selected:c,anySelected:s,className:u,isHeader:m,isVisible:n,compact:_}),S={checked:c,theme:p},I=Jr("div",C,["aria-label","aria-labelledby","aria-describedby"]),N=d===Q.single?"radio":"checkbox";return r?h.createElement("div",o.__assign({},C,{role:N,className:o.css(D.root,D.check),"aria-checked":c,"data-selection-toggle":!0,"data-automationid":"DetailsRowCheck",tabIndex:-1}),R(S)):h.createElement("div",o.__assign({},I,{className:o.css(D.root,D.check)}))},Ss=h.memo(function(t){return h.createElement(Hn,{theme:t.theme,checked:t.checked,className:t.className,useFastIcons:!0})});function ks(t){return h.createElement(Hn,{checked:t.checked})}function Ds(t){return h.createElement(Ss,{theme:t.theme,checked:t.checked})}var Oo=o.styled(Cs,Da,void 0,{scope:"DetailsRowCheck"},!0),xs=0,Ui=1,ui=function(){function t(i){this._selection=i.selection,this._dragEnterCounts={},this._activeTargets={},this._lastId=0,this._initialized=!1}return t.prototype.dispose=function(){this._events&&this._events.dispose()},t.prototype.subscribe=function(i,n,e){var r=this;if(!this._initialized){this._events=new o.EventGroup(this);var a=o.getDocument();a&&(this._events.on(a.body,"mouseup",this._onMouseUp.bind(this),!0),this._events.on(a,"mouseup",this._onDocumentMouseUp.bind(this),!0)),this._initialized=!0}var s=e.key,l=s===void 0?""+ ++this._lastId:s,c=[],d,g,m,u,f,p,_,v,b,y;if(e&&i){var C=e.eventMap,x=e.context,R=e.updateDropState,D={root:i,options:e,key:l};if(v=this._isDraggable(D),b=this._isDroppable(D),(v||b)&&C)for(var S=0,I=C;S<I.length;S++){var N=I[S],k={callback:N.callback.bind(null,x),eventName:N.eventName};c.push(k),this._events.on(i,k.eventName,k.callback)}b&&(g=function(w){w.isHandled||(w.isHandled=!0,r._dragEnterCounts[l]--,r._dragEnterCounts[l]===0&&R(!1,w))},m=function(w){w.preventDefault(),w.isHandled||(w.isHandled=!0,r._dragEnterCounts[l]++,r._dragEnterCounts[l]===1&&R(!0,w))},u=function(w){r._dragEnterCounts[l]=0,R(!1,w)},f=function(w){r._dragEnterCounts[l]=0,R(!1,w),e.onDrop&&e.onDrop(e.context.data,w)},p=function(w){w.preventDefault(),e.onDragOver&&e.onDragOver(e.context.data,w)},this._dragEnterCounts[l]=0,n.on(i,"dragenter",m),n.on(i,"dragleave",g),n.on(i,"dragend",u),n.on(i,"drop",f),n.on(i,"dragover",p)),v&&(_=this._onMouseDown.bind(this,D),u=this._onDragEnd.bind(this,D),d=function(w){var E=e;E&&E.onDragStart&&E.onDragStart(E.context.data,E.context.index,r._selection.getSelection(),w),r._isDragging=!0,w.dataTransfer&&w.dataTransfer.setData("id",i.id)},n.on(i,"dragstart",d),n.on(i,"mousedown",_),n.on(i,"dragend",u)),y={target:D,dispose:function(){if(r._activeTargets[l]===y&&delete r._activeTargets[l],i){for(var w=0,E=c;w<E.length;w++){var P=E[w];r._events.off(i,P.eventName,P.callback)}b&&(n.off(i,"dragenter",m),n.off(i,"dragleave",g),n.off(i,"dragend",u),n.off(i,"dragover",p),n.off(i,"drop",f)),v&&(n.off(i,"dragstart",d),n.off(i,"mousedown",_),n.off(i,"dragend",u))}}},this._activeTargets[l]=y}return{key:l,dispose:function(){y&&y.dispose()}}},t.prototype.unsubscribe=function(i,n){var e=this._activeTargets[n];e&&e.dispose()},t.prototype._onDragEnd=function(i,n){var e=i.options;e.onDragEnd&&e.onDragEnd(e.context.data,n)},t.prototype._onMouseUp=function(i){if(this._isDragging=!1,this._dragData){for(var n=0,e=Object.keys(this._activeTargets);n<e.length;n++){var r=e[n],a=this._activeTargets[r];a.target.root&&(this._events.off(a.target.root,"mousemove"),this._events.off(a.target.root,"mouseleave"))}this._dragData.dropTarget&&(o.EventGroup.raise(this._dragData.dropTarget.root,"dragleave"),o.EventGroup.raise(this._dragData.dropTarget.root,"drop"))}this._dragData=null},t.prototype._onDocumentMouseUp=function(i){var n=o.getDocument();n&&i.target===n.documentElement&&this._onMouseUp(i)},t.prototype._onMouseMove=function(i,n){var e=n.buttons,r=e===void 0?Ui:e;if(this._dragData&&r!==Ui){this._onMouseUp(n);return}var a=i.root,s=i.key;this._isDragging&&this._isDroppable(i)&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key!==s&&!this._isChild(a,this._dragData.dropTarget.root)&&this._dragEnterCounts[this._dragData.dropTarget.key]>0&&(o.EventGroup.raise(this._dragData.dropTarget.root,"dragleave"),o.EventGroup.raise(a,"dragenter"),this._dragData.dropTarget=i)},t.prototype._onMouseLeave=function(i,n){this._isDragging&&this._dragData&&this._dragData.dropTarget&&this._dragData.dropTarget.key===i.key&&(o.EventGroup.raise(i.root,"dragleave"),this._dragData.dropTarget=void 0)},t.prototype._onMouseDown=function(i,n){if(n.button===xs)if(this._isDraggable(i)){this._dragData={clientX:n.clientX,clientY:n.clientY,eventTarget:n.target,dragTarget:i};for(var e=0,r=Object.keys(this._activeTargets);e<r.length;e++){var a=r[e],s=this._activeTargets[a];s.target.root&&(this._events.on(s.target.root,"mousemove",this._onMouseMove.bind(this,s.target)),this._events.on(s.target.root,"mouseleave",this._onMouseLeave.bind(this,s.target)))}}else this._dragData=null},t.prototype._isChild=function(i,n){for(;n&&n.parentElement;){if(n.parentElement===i)return!0;n=n.parentElement}return!1},t.prototype._isDraggable=function(i){var n=i.options;return!!(n.canDrag&&n.canDrag(n.context.data))},t.prototype._isDroppable=function(i){var n=i.options,e=this._dragData&&this._dragData.dragTarget?this._dragData.dragTarget.options.context:void 0;return!!(n.canDrop&&n.canDrop(n.context,e))},t}(),ws=0,Is=o.classNamesFunction(),Rs=200,Yi=1500,Yn=20,$i=function(t){return function(i){return i?i.column.isIconOnly?h.createElement("span",{className:t.accessibleLabel},i.column.name):h.createElement(h.Fragment,null,i.column.name):null}},Ns=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._root=h.createRef(),e._onRenderFilterIcon=function(r){return function(a){var s=a.columnProps,l=o.__rest(a,["columnProps"]),c=s!=null&&s.useFastIcons?o.FontIcon:o.Icon;return h.createElement(c,o.__assign({},l))}},e._onRenderColumnHeaderTooltip=function(r){return h.createElement("span",{className:r.hostClassName},r.children)},e._onColumnClick=function(r){var a=e.props,s=a.onColumnClick,l=a.column;l.columnActionsMode!==et.disabled&&(l.onColumnClick&&l.onColumnClick(r,l),s&&s(r,l))},e._onDragStart=function(r,a,s,l){var c=e._classNames;a&&(e._updateHeaderDragInfo(a),e._root.current.classList.add(c.borderWhileDragging),e._async.setTimeout(function(){e._root.current&&e._root.current.classList.add(c.noBorderWhileDragging)},Yn))},e._onDragEnd=function(r,a){var s=e._classNames;a&&e._updateHeaderDragInfo(-1,a),e._root.current.classList.remove(s.borderWhileDragging),e._root.current.classList.remove(s.noBorderWhileDragging)},e._updateHeaderDragInfo=function(r,a){e.props.setDraggedItemIndex&&e.props.setDraggedItemIndex(r),e.props.updateDragInfo&&e.props.updateDragInfo({itemIndex:r},a)},e._onColumnContextMenu=function(r){var a=e.props,s=a.onColumnContextMenu,l=a.column;l.onColumnContextMenu&&(l.onColumnContextMenu(l,r),r.preventDefault()),s&&(s(l,r),r.preventDefault())},e._onRootMouseDown=function(r){var a=e.props.isDraggable;a&&r.button===ws&&r.stopPropagation()},o.initializeComponentRef(e),e._async=new o.Async(e),e._events=new o.EventGroup(e),e}return i.prototype.render=function(){var n=this.props,e=n.column,r=n.parentId,a=n.isDraggable,s=n.styles,l=n.theme,c=n.cellStyleProps,d=c===void 0?mt:c,g=n.useFastIcons,m=g===void 0?!0:g,u=this.props.onRenderColumnHeaderTooltip,f=u===void 0?this._onRenderColumnHeaderTooltip:u;this._classNames=Is(s,{theme:l,headerClassName:e.headerClassName,iconClassName:e.iconClassName,isActionable:e.columnActionsMode!==et.disabled,isEmpty:!e.name,isIconVisible:e.isSorted||e.isGrouped||e.isFiltered,isPadded:e.isPadded,isIconOnly:e.isIconOnly,cellStyleProps:d,transitionDurationDrag:Rs,transitionDurationDrop:Yi});var p=this._classNames,_=m?o.FontIcon:o.Icon,v=e.onRenderFilterIcon?o.composeRenderFunction(e.onRenderFilterIcon,this._onRenderFilterIcon(this._classNames)):this._onRenderFilterIcon(this._classNames),b=e.onRenderHeader?o.composeRenderFunction(e.onRenderHeader,$i(this._classNames)):$i(this._classNames),y=e.columnActionsMode!==et.disabled&&(e.onColumnClick!==void 0||this.props.onColumnClick!==void 0),C={"aria-label":e.ariaLabel?e.ariaLabel:e.isIconOnly?e.name:void 0,"aria-labelledby":e.ariaLabel||e.isIconOnly?void 0:r+"-"+e.key+"-name","aria-describedby":!this.props.onRenderColumnHeaderTooltip&&this._hasAccessibleDescription()?r+"-"+e.key+"-tooltip":void 0};return h.createElement(h.Fragment,null,h.createElement("div",o.__assign({key:e.key,ref:this._root,role:"columnheader"},!y&&C,{"aria-sort":e.isSorted?e.isSortedDescending?"descending":"ascending":"none","data-is-focusable":!y&&e.columnActionsMode!==et.disabled?"true":void 0,className:p.root,"data-is-draggable":a,draggable:a,style:{width:e.calculatedWidth+d.cellLeftPadding+d.cellRightPadding+(e.isPadded?d.cellExtraRightPadding:0)},"data-automationid":"ColumnsHeaderColumn","data-item-key":e.key}),a&&h.createElement(_,{iconName:"GripperBarVertical",className:p.gripperBarVerticalStyle}),f({hostClassName:p.cellTooltip,id:r+"-"+e.key+"-tooltip",setAriaDescribedBy:!1,column:e,content:e.columnActionsMode!==et.disabled?e.ariaLabel:"",children:h.createElement("span",o.__assign({id:r+"-"+e.key,className:p.cellTitle,"data-is-focusable":y&&e.columnActionsMode!==et.disabled?"true":void 0,role:y?"button":void 0},y&&C,{onContextMenu:this._onColumnContextMenu,onClick:this._onColumnClick,"aria-haspopup":e.columnActionsMode===et.hasDropdown?"menu":void 0,"aria-expanded":e.columnActionsMode===et.hasDropdown?!!e.isMenuOpen:void 0}),h.createElement("span",{id:r+"-"+e.key+"-name",className:p.cellName},(e.iconName||e.iconClassName)&&h.createElement(_,{className:p.iconClassName,iconName:e.iconName}),b(this.props)),e.isFiltered&&h.createElement(_,{className:p.nearIcon,iconName:"Filter"}),e.isSorted&&h.createElement(_,{className:p.sortIcon,iconName:e.isSortedDescending?"SortDown":"SortUp"}),e.isGrouped&&h.createElement(_,{className:p.nearIcon,iconName:"GroupedDescending"}),e.columnActionsMode===et.hasDropdown&&!e.isIconOnly&&v({"aria-hidden":!0,columnProps:this.props,className:p.filterChevron,iconName:"ChevronDown"}))},this._onRenderColumnHeaderTooltip)),this.props.onRenderColumnHeaderTooltip?null:this._renderAccessibleDescription())},i.prototype.componentDidMount=function(){var n=this;this.props.dragDropHelper&&this.props.isDraggable&&this._addDragDropHandling();var e=this._classNames;this.props.isDropped&&(this._root.current&&(this._root.current.classList.add(e.borderAfterDropping),this._async.setTimeout(function(){n._root.current&&n._root.current.classList.add(e.noBorderAfterDropping)},Yn)),this._async.setTimeout(function(){n._root.current&&(n._root.current.classList.remove(e.borderAfterDropping),n._root.current.classList.remove(e.noBorderAfterDropping))},Yi+Yn))},i.prototype.componentWillUnmount=function(){this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this._async.dispose(),this._events.dispose()},i.prototype.componentDidUpdate=function(){!this._dragDropSubscription&&this.props.dragDropHelper&&this.props.isDraggable&&this._addDragDropHandling(),this._dragDropSubscription&&!this.props.isDraggable&&(this._dragDropSubscription.dispose(),this._events.off(this._root.current,"mousedown"),delete this._dragDropSubscription)},i.prototype._getColumnDragDropOptions=function(){var n=this,e=this.props.columnIndex,r={selectionIndex:e,context:{data:e,index:e},canDrag:function(){return n.props.isDraggable},canDrop:function(){return!1},onDragStart:this._onDragStart,updateDropState:function(){},onDrop:function(){},onDragEnd:this._onDragEnd};return r},i.prototype._hasAccessibleDescription=function(){var n=this.props.column;return!!(n.filterAriaLabel||n.sortAscendingAriaLabel||n.sortDescendingAriaLabel||n.groupAriaLabel)},i.prototype._renderAccessibleDescription=function(){var n=this.props,e=n.column,r=n.parentId,a=this._classNames;return this._hasAccessibleDescription()&&!this.props.onRenderColumnHeaderTooltip?h.createElement("label",{key:e.key+"_label",id:r+"-"+e.key+"-tooltip",className:a.accessibleLabel,hidden:!0},e.isFiltered&&e.filterAriaLabel||null,e.isSorted&&(e.isSortedDescending?e.sortDescendingAriaLabel:e.sortAscendingAriaLabel)||null,e.isGrouped&&e.groupAriaLabel||null):null},i.prototype._addDragDropHandling=function(){this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getColumnDragDropOptions()),this._events.on(this._root.current,"mousedown",this._onRootMouseDown)},i}(h.Component),Es={isActionable:"is-actionable",cellIsCheck:"ms-DetailsHeader-cellIsCheck",collapseButton:"ms-DetailsHeader-collapseButton",isCollapsed:"is-collapsed",isAllSelected:"is-allSelected",isSelectAllHidden:"is-selectAllHidden",isResizingColumn:"is-resizingColumn",isEmpty:"is-empty",isIconVisible:"is-icon-visible",cellSizer:"ms-DetailsHeader-cellSizer",isResizing:"is-resizing",dropHintCircleStyle:"ms-DetailsHeader-dropHintCircleStyle",dropHintLineStyle:"ms-DetailsHeader-dropHintLineStyle",cellTitle:"ms-DetailsHeader-cellTitle",cellName:"ms-DetailsHeader-cellName",filterChevron:"ms-DetailsHeader-filterChevron",gripperBarVerticalStyle:"ms-DetailsColumn-gripperBar",nearIcon:"ms-DetailsColumn-nearIcon"},Ts=function(t){var i,n=t.theme,e=t.headerClassName,r=t.iconClassName,a=t.isActionable,s=t.isEmpty,l=t.isIconVisible,c=t.isPadded,d=t.isIconOnly,g=t.cellStyleProps,m=g===void 0?mt:g,u=t.transitionDurationDrag,f=t.transitionDurationDrop,p=n.semanticColors,_=n.palette,v=n.fonts,b=o.getGlobalClassNames(Es,n),y={iconForegroundColor:p.bodySubtext,headerForegroundColor:p.bodyText,headerBackgroundColor:p.bodyBackground,dropdownChevronForegroundColor:_.neutralSecondary,resizerColor:_.neutralTertiaryAlt},C={color:y.iconForegroundColor,opacity:1,paddingLeft:8},x={outline:"1px solid "+_.themePrimary},R={outlineColor:"transparent"};return{root:[Ho(t),v.small,a&&[b.isActionable,{selectors:{":hover":{color:p.bodyText,background:p.listHeaderBackgroundHovered},":active":{background:p.listHeaderBackgroundPressed}}}],s&&[b.isEmpty,{textOverflow:"clip"}],l&&b.isIconVisible,c&&{paddingRight:m.cellExtraRightPadding+m.cellRightPadding},{selectors:{':hover i[data-icon-name="GripperBarVertical"]':{display:"block"}}},e],gripperBarVerticalStyle:{display:"none",position:"absolute",textAlign:"left",color:_.neutralTertiary,left:1},nearIcon:[b.nearIcon,C],sortIcon:[C,{paddingLeft:4,position:"relative",top:1}],iconClassName:[{color:y.iconForegroundColor,opacity:1},r],filterChevron:[b.filterChevron,{color:y.dropdownChevronForegroundColor,paddingLeft:6,verticalAlign:"middle",fontSize:v.small.fontSize}],cellTitle:[b.cellTitle,o.getFocusStyle(n),o.__assign({display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"stretch",boxSizing:"border-box",overflow:"hidden",padding:"0 "+m.cellRightPadding+"px 0 "+m.cellLeftPadding+"px"},d?{alignContent:"flex-end",maxHeight:"100%",flexWrap:"wrap-reverse"}:{})],cellName:[b.cellName,{flex:"0 1 auto",overflow:"hidden",textOverflow:"ellipsis",fontWeight:o.FontWeights.semibold,fontSize:v.medium.fontSize},d&&{selectors:(i={},i["."+b.nearIcon]={paddingLeft:0},i)}],cellTooltip:{display:"block",position:"absolute",top:0,left:0,bottom:0,right:0},accessibleLabel:o.hiddenContentStyle,borderWhileDragging:x,noBorderWhileDragging:[R,{transition:"outline "+u+"ms ease"}],borderAfterDropping:x,noBorderAfterDropping:[R,{transition:"outline  "+f+"ms ease"}]}},Ps=o.styled(Ns,Ts,void 0,{scope:"DetailsColumn"}),tt;(function(t){t[t.none=0]="none",t[t.hidden=1]="hidden",t[t.visible=2]="visible"})(tt||(tt={}));var As=o.classNamesFunction(),Fs=0,Hs=1,Qe=[],Ms=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._rootElement=h.createRef(),e._rootComponent=h.createRef(),e._draggedColumnIndex=-1,e._dropHintDetails={},e._updateDroppingState=function(r,a){e._draggedColumnIndex>=0&&a.type!=="drop"&&!r&&e._resetDropHints()},e._onDragOver=function(r,a){e._draggedColumnIndex>=0&&(a.stopPropagation(),e._computeDropHintToBeShown(a.clientX))},e._onDrop=function(r,a){var s=e._getColumnReorderProps();if(e._draggedColumnIndex>=0&&a){var l=e._draggedColumnIndex>e._currentDropHintIndex?e._currentDropHintIndex:e._currentDropHintIndex-1,c=e._isValidCurrentDropHintIndex();if(a.stopPropagation(),c)if(e._onDropIndexInfo.sourceIndex=e._draggedColumnIndex,e._onDropIndexInfo.targetIndex=l,s.onColumnDrop){var d={draggedIndex:e._draggedColumnIndex,targetIndex:l};s.onColumnDrop(d)}else s.handleColumnReorder&&s.handleColumnReorder(e._draggedColumnIndex,l)}e._resetDropHints(),e._dropHintDetails={},e._draggedColumnIndex=-1},e._updateDragInfo=function(r,a){var s=e._getColumnReorderProps(),l=r.itemIndex;if(l>=0)e._draggedColumnIndex=e._isCheckboxColumnHidden()?l-1:l-2,e._getDropHintPositions(),s.onColumnDragStart&&s.onColumnDragStart(!0);else if(a&&e._draggedColumnIndex>=0&&(e._resetDropHints(),e._draggedColumnIndex=-1,e._dropHintDetails={},s.onColumnDragEnd)){var c=e._isEventOnHeader(a);s.onColumnDragEnd({dropLocation:c},a)}},e._getDropHintPositions=function(){for(var r=e.props.columns,a=r===void 0?Qe:r,s=e._getColumnReorderProps(),l=0,c=0,d,g=s.frozenColumnCountFromStart||0,m=s.frozenColumnCountFromEnd||0,u=g;u<a.length-m+1;u++)if(e._rootElement.current){var f=e._rootElement.current.querySelectorAll("#columnDropHint_"+u)[0];if(f)if(u===g)l=f.offsetLeft,c=f.offsetLeft,d=f;else{var p=(f.offsetLeft+l)/2;e._dropHintDetails[u-1]={originX:l,startX:c,endX:p,dropHintElementRef:d},c=p,d=f,l=f.offsetLeft,u===a.length-m&&(e._dropHintDetails[u]={originX:l,startX:c,endX:f.offsetLeft,dropHintElementRef:d})}}},e._computeDropHintToBeShown=function(r){var a=o.getRTL(e.props.theme);if(e._rootElement.current){var s=e._rootElement.current.getBoundingClientRect(),l=s.left,c=r-l,d=e._currentDropHintIndex;if(e._isValidCurrentDropHintIndex()&&un(a,c,e._dropHintDetails[d].startX,e._dropHintDetails[d].endX))return;var g=e.props.columns,m=g===void 0?Qe:g,u=e._getColumnReorderProps(),f=u.frozenColumnCountFromStart||0,p=u.frozenColumnCountFromEnd||0,_=f,v=m.length-p,b=-1;if(ji(a,c,e._dropHintDetails[_].endX)?b=_:Zi(a,c,e._dropHintDetails[v].startX)?b=v:e._isValidCurrentDropHintIndex()&&(e._dropHintDetails[d+1]&&un(a,c,e._dropHintDetails[d+1].startX,e._dropHintDetails[d+1].endX)?b=d+1:e._dropHintDetails[d-1]&&un(a,c,e._dropHintDetails[d-1].startX,e._dropHintDetails[d-1].endX)&&(b=d-1)),b===-1)for(var y=f,C=v;y<C;){var x=Math.ceil((C+y)/2);if(un(a,c,e._dropHintDetails[x].startX,e._dropHintDetails[x].endX)){b=x;break}else ji(a,c,e._dropHintDetails[x].originX)?C=x:Zi(a,c,e._dropHintDetails[x].originX)&&(y=x)}b===e._draggedColumnIndex||b===e._draggedColumnIndex+1?e._isValidCurrentDropHintIndex()&&e._resetDropHints():d!==b&&b>=0&&(e._resetDropHints(),e._updateDropHintElement(e._dropHintDetails[b].dropHintElementRef,"inline-block"),e._currentDropHintIndex=b)}},e._renderColumnSizer=function(r){var a,s=r.columnIndex,l=e.props.columns,c=l===void 0?Qe:l,d=c[s],g=e.state.columnResizeDetails,m=e._classNames;return d.isResizable?h.createElement("div",{key:d.key+"_sizer","aria-hidden":!0,role:"button","data-is-focusable":!1,onClick:Ls,"data-sizer-index":s,onBlur:e._onSizerBlur,className:o.css(m.cellSizer,s<c.length-1?m.cellSizerStart:m.cellSizerEnd,(a={},a[m.cellIsResizing]=g&&g.columnIndex===s,a)),onDoubleClick:e._onSizerDoubleClick.bind(e,s)}):null},e._onRenderColumnHeaderTooltip=function(r){return h.createElement("span",{className:r.hostClassName},r.children)},e._onSelectAllClicked=function(){var r=e.props.selection;r&&r.toggleAllSelected()},e._onRootMouseDown=function(r){var a=r.target.getAttribute("data-sizer-index"),s=Number(a),l=e.props.columns,c=l===void 0?Qe:l;a===null||r.button!==Fs||(e.setState({columnResizeDetails:{columnIndex:s,columnMinWidth:c[s].calculatedWidth,originX:r.clientX}}),r.preventDefault(),r.stopPropagation())},e._onRootMouseMove=function(r){var a=e.state,s=a.columnResizeDetails,l=a.isSizing;s&&!l&&r.clientX!==s.originX&&e.setState({isSizing:!0})},e._onRootKeyDown=function(r){var a=e.state,s=a.columnResizeDetails,l=a.isSizing,c=e.props,d=c.columns,g=d===void 0?Qe:d,m=c.onColumnResized,u=r.target.getAttribute("data-sizer-index");if(!(!u||l)){var f=Number(u);if(!s)r.which===o.KeyCodes.enter&&(e.setState({columnResizeDetails:{columnIndex:f,columnMinWidth:g[f].calculatedWidth}}),r.preventDefault(),r.stopPropagation());else{var p=void 0;r.which===o.KeyCodes.enter?(e.setState({columnResizeDetails:void 0}),r.preventDefault(),r.stopPropagation()):r.which===o.KeyCodes.left?p=o.getRTL(e.props.theme)?1:-1:r.which===o.KeyCodes.right&&(p=o.getRTL(e.props.theme)?-1:1),p&&(r.shiftKey||(p*=10),e.setState({columnResizeDetails:o.__assign(o.__assign({},s),{columnMinWidth:s.columnMinWidth+p})}),m&&m(g[f],s.columnMinWidth+p,f),r.preventDefault(),r.stopPropagation())}}},e._onSizerMouseMove=function(r){var a=r.buttons,s=e.props,l=s.onColumnIsSizingChanged,c=s.onColumnResized,d=s.columns,g=d===void 0?Qe:d,m=e.state.columnResizeDetails;if(a!==void 0&&a!==Hs){e._onSizerMouseUp(r);return}if(r.clientX!==m.originX&&l&&l(g[m.columnIndex],!0),c){var u=r.clientX-m.originX;o.getRTL(e.props.theme)&&(u=-u),c(g[m.columnIndex],m.columnMinWidth+u,m.columnIndex)}},e._onSizerBlur=function(r){var a=e.state.columnResizeDetails;a&&e.setState({columnResizeDetails:void 0,isSizing:!1})},e._onSizerMouseUp=function(r){var a=e.props,s=a.columns,l=s===void 0?Qe:s,c=a.onColumnIsSizingChanged,d=e.state.columnResizeDetails;e.setState({columnResizeDetails:void 0,isSizing:!1}),c&&c(l[d.columnIndex],!1)},e._onToggleCollapseAll=function(){var r=e.props.onToggleCollapseAll,a=!e.state.isAllCollapsed;e.setState({isAllCollapsed:a}),r&&r(a)},o.initializeComponentRef(e),e._events=new o.EventGroup(e),e.state={columnResizeDetails:void 0,isAllCollapsed:e.props.isAllCollapsed,isAllSelected:!!e.props.selection&&e.props.selection.isAllSelected()},e._onDropIndexInfo={sourceIndex:-1,targetIndex:-1},e._id=o.getId("header"),e._currentDropHintIndex=-1,e._dragDropHelper=new ui({selection:{getSelection:function(){}},minimumPixelsForDrag:e.props.minimumPixelsForDrag}),e}return i.prototype.componentDidMount=function(){var n=this.props.selection;this._events.on(n,Fn,this._onSelectionChanged),this._rootElement.current&&(this._events.on(this._rootElement.current,"mousedown",this._onRootMouseDown),this._events.on(this._rootElement.current,"keydown",this._onRootKeyDown),this._getColumnReorderProps()&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement.current,this._events,this._getHeaderDragDropOptions())))},i.prototype.componentDidUpdate=function(n){if(this._getColumnReorderProps()?!this._subscriptionObject&&this._rootElement.current&&(this._subscriptionObject=this._dragDropHelper.subscribe(this._rootElement.current,this._events,this._getHeaderDragDropOptions())):this._subscriptionObject&&(this._subscriptionObject.dispose(),delete this._subscriptionObject),this.props!==n&&this._onDropIndexInfo.sourceIndex>=0&&this._onDropIndexInfo.targetIndex>=0){var e=n.columns,r=e===void 0?Qe:e,a=this.props.columns,s=a===void 0?Qe:a;r[this._onDropIndexInfo.sourceIndex].key===s[this._onDropIndexInfo.targetIndex].key&&(this._onDropIndexInfo={sourceIndex:-1,targetIndex:-1})}this.props.isAllCollapsed!==n.isAllCollapsed&&this.setState({isAllCollapsed:this.props.isAllCollapsed})},i.prototype.componentWillUnmount=function(){this._subscriptionObject&&(this._subscriptionObject.dispose(),delete this._subscriptionObject),this._dragDropHelper.dispose(),this._events.dispose()},i.prototype.render=function(){var n=this,e=this.props,r=e.columns,a=r===void 0?Qe:r,s=e.ariaLabel,l=e.ariaLabelForToggleAllGroupsButton,c=e.ariaLabelForSelectAllCheckbox,d=e.selectAllVisibility,g=e.ariaLabelForSelectionColumn,m=e.indentWidth,u=e.onColumnClick,f=e.onColumnContextMenu,p=e.onRenderColumnHeaderTooltip,_=p===void 0?this._onRenderColumnHeaderTooltip:p,v=e.styles,b=e.selectionMode,y=e.theme,C=e.onRenderDetailsCheckbox,x=e.groupNestingDepth,R=e.useFastIcons,D=e.checkboxVisibility,S=e.className,I=this.state,N=I.isAllSelected,k=I.columnResizeDetails,w=I.isSizing,E=I.isAllCollapsed,P=d!==tt.none,T=d===tt.hidden,M=D===Ke.always,L=this._getColumnReorderProps(),B=L&&L.frozenColumnCountFromStart?L.frozenColumnCountFromStart:0,z=L&&L.frozenColumnCountFromEnd?L.frozenColumnCountFromEnd:0;this._classNames=As(v,{theme:y,isAllSelected:N,isSelectAllHidden:d===tt.hidden,isResizingColumn:!!k&&w,isSizing:w,isAllCollapsed:E,isCheckboxHidden:T,className:S});var H=this._classNames,O=R?o.FontIcon:o.Icon,V=x>0&&this.props.collapseAllVisibility===Lt.visible,W=1+(P?1:0)+(V?1:0),G=o.getRTL(y);return h.createElement(o.FocusZone,{role:"row","aria-label":s,className:H.root,componentRef:this._rootComponent,elementRef:this._rootElement,onMouseMove:this._onRootMouseMove,"data-automationid":"DetailsHeader",direction:o.FocusZoneDirection.horizontal},P?[h.createElement("div",{key:"__checkbox",className:H.cellIsCheck,"aria-labelledby":this._id+"-checkTooltip",onClick:T?void 0:this._onSelectAllClicked,role:"columnheader"},_({hostClassName:H.checkTooltip,id:this._id+"-checkTooltip",setAriaDescribedBy:!1,content:c,children:h.createElement(Oo,{id:this._id+"-check","aria-label":b===Q.multiple?c:g,"data-is-focusable":!T||void 0,isHeader:!0,selected:N,anySelected:!1,canSelect:!T,className:H.check,onRenderDetailsCheckbox:C,useFastIcons:R,isVisible:M})},this._onRenderColumnHeaderTooltip)),this.props.onRenderColumnHeaderTooltip?null:c&&!T?h.createElement("label",{key:"__checkboxLabel",id:this._id+"-checkTooltip",className:H.accessibleLabel,"aria-hidden":!0},c):g&&T?h.createElement("label",{key:"__checkboxLabel",id:this._id+"-checkTooltip",className:H.accessibleLabel,"aria-hidden":!0},g):null]:null,V?h.createElement("div",{className:H.cellIsGroupExpander,onClick:this._onToggleCollapseAll,"data-is-focusable":!0,"aria-label":l,"aria-expanded":!E,role:"columnheader"},h.createElement(O,{className:H.collapseButton,iconName:G?"ChevronLeftMed":"ChevronRightMed"})):null,h.createElement(Bt,{indentWidth:m,role:"gridcell",count:x-1}),a.map(function(A,F){var Y=L?F>=B&&F<a.length-z:!1;return[L&&(Y||F===a.length-z)&&n._renderDropHint(F),h.createElement(Ps,{column:A,styles:A.styles,key:A.key,columnIndex:W+F,parentId:n._id,isDraggable:Y,updateDragInfo:n._updateDragInfo,dragDropHelper:n._dragDropHelper,onColumnClick:u,onColumnContextMenu:f,onRenderColumnHeaderTooltip:n.props.onRenderColumnHeaderTooltip,isDropped:n._onDropIndexInfo.targetIndex===F,cellStyleProps:n.props.cellStyleProps,useFastIcons:R}),n._renderColumnDivider(F)]}),L&&z===0&&this._renderDropHint(a.length),w&&h.createElement(o.Layer,null,h.createElement("div",{className:H.sizingOverlay,onMouseMove:this._onSizerMouseMove,onMouseUp:this._onSizerMouseUp})))},i.prototype.focus=function(){var n;return!!(!((n=this._rootComponent.current)===null||n===void 0)&&n.focus())},i.prototype._getColumnReorderProps=function(){var n=this.props,e=n.columnReorderOptions,r=n.columnReorderProps;return r||e&&o.__assign(o.__assign({},e),{onColumnDragEnd:void 0})},i.prototype._getHeaderDragDropOptions=function(){var n={selectionIndex:1,context:{data:this,index:0},canDrag:function(){return!1},canDrop:function(){return!0},onDragStart:function(){},updateDropState:this._updateDroppingState,onDrop:this._onDrop,onDragEnd:function(){},onDragOver:this._onDragOver};return n},i.prototype._isValidCurrentDropHintIndex=function(){return this._currentDropHintIndex>=0},i.prototype._isCheckboxColumnHidden=function(){var n=this.props,e=n.selectionMode,r=n.checkboxVisibility;return e===Q.none||r===Ke.hidden},i.prototype._resetDropHints=function(){this._currentDropHintIndex>=0&&(this._updateDropHintElement(this._dropHintDetails[this._currentDropHintIndex].dropHintElementRef,"none"),this._currentDropHintIndex=-1)},i.prototype._updateDropHintElement=function(n,e){n.childNodes[1].style.display=e,n.childNodes[0].style.display=e},i.prototype._isEventOnHeader=function(n){if(this._rootElement.current){var e=this._rootElement.current.getBoundingClientRect();if(n.clientX>e.left&&n.clientX<e.right&&n.clientY>e.top&&n.clientY<e.bottom)return Ht.header}},i.prototype._renderColumnDivider=function(n){var e=this.props.columns,r=e===void 0?Qe:e,a=r[n],s=a.onRenderDivider;return s?s({column:a,columnIndex:n},this._renderColumnSizer):this._renderColumnSizer({column:a,columnIndex:n})},i.prototype._renderDropHint=function(n){var e=this._classNames,r=this.props.useFastIcons?o.FontIcon:o.Icon;return h.createElement("div",{key:"dropHintKey",className:e.dropHintStyle,id:"columnDropHint_"+n},h.createElement("div",{role:"presentation",key:"dropHintCircleKey",className:e.dropHintCaretStyle,"data-is-focusable":!1,"data-sizer-index":n,"aria-hidden":!0},h.createElement(r,{iconName:"CircleShapeSolid"})),h.createElement("div",{key:"dropHintLineKey","aria-hidden":!0,"data-is-focusable":!1,"data-sizer-index":n,className:e.dropHintLineStyle}))},i.prototype._onSizerDoubleClick=function(n,e){var r=this.props,a=r.onColumnAutoResized,s=r.columns,l=s===void 0?Qe:s;a&&a(l[n],n)},i.prototype._onSelectionChanged=function(){var n=!!this.props.selection&&this.props.selection.isAllSelected();this.state.isAllSelected!==n&&this.setState({isAllSelected:n})},i.defaultProps={selectAllVisibility:tt.visible,collapseAllVisibility:Lt.visible,useFastIcons:!0},i}(h.Component);function un(t,i,n,e){return t?i<=n&&i>=e:i>=n&&i<=e}function ji(t,i,n){return t?i>=n:i<=n}function Zi(t,i,n){return t?i<=n:i>=n}function Ls(t){t.stopPropagation()}var zs=o.styled(Ms,Ca,void 0,{scope:"DetailsHeader"}),Bs=function(t,i){var n=t&&i&&i.fieldName?t[i.fieldName]:"";return n==null&&(n=""),typeof n=="boolean"?n.toString():n},Os=function(t){var i=t.columns,n=t.rowClassNames,e=t.cellStyleProps,r=e===void 0?mt:e,a=t.item,s=t.itemIndex,l=t.onRenderItemColumn,c=t.getCellValueKey,d=t.cellsByColumn,g=t.enableUpdateAnimations,m=t.rowHeaderId,u=h.useRef(),f=u.current||(u.current={});return h.createElement("div",{className:n.fields,"data-automationid":"DetailsRowFields",role:"presentation"},i.map(function(p){var _=typeof p.calculatedWidth>"u"?"auto":p.calculatedWidth+r.cellLeftPadding+r.cellRightPadding+(p.isPadded?r.cellExtraRightPadding:0),v=p.onRender,b=v===void 0?l:v,y=p.getValueKey,C=y===void 0?c:y,x=d&&p.key in d?d[p.key]:b?b(a,s,p):Bs(a,p),R=f[p.key],D=g&&C?C(a,s,p):void 0,S=!1;D!==void 0&&R!==void 0&&D!==R&&(S=!0),f[p.key]=D;var I=""+p.key+(D!==void 0?"-"+D:"");return h.createElement("div",{key:I,id:p.isRowHeader?m:void 0,role:p.isRowHeader?"rowheader":"gridcell","aria-readonly":!0,className:o.css(p.className,p.isMultiline&&n.isMultiline,p.isRowHeader&&n.isRowHeader,n.cell,p.isPadded?n.cellPadded:n.cellUnpadded,S&&n.cellAnimation),style:{width:_},"data-automationid":"DetailsRowCell","data-automation-key":p.key},x)}))},Ws=o.classNamesFunction(),Gs="is-dropping",qi=[],Vs=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._root=h.createRef(),e._cellMeasurer=h.createRef(),e._focusZone=h.createRef(),e._onSelectionChanged=function(){var r=gn(e.props);o.shallowCompare(r,e.state.selectionState)||e.setState({selectionState:r})},e._updateDroppingState=function(r,a){var s=e.state.isDropping,l=e.props,c=l.dragDropEvents,d=l.item;r?c.onDragEnter&&(e._droppingClassNames=c.onDragEnter(d,a)):c.onDragLeave&&c.onDragLeave(d,a),s!==r&&e.setState({isDropping:r})},o.initializeComponentRef(e),e._events=new o.EventGroup(e),e.state={selectionState:gn(n),columnMeasureInfo:void 0,isDropping:!1},e._droppingClassNames="",e}return i.getDerivedStateFromProps=function(n,e){return o.__assign(o.__assign({},e),{selectionState:gn(n)})},i.prototype.componentDidMount=function(){var n=this.props,e=n.dragDropHelper,r=n.selection,a=n.item,s=n.onDidMount;e&&this._root.current&&(this._dragDropSubscription=e.subscribe(this._root.current,this._events,this._getRowDragDropOptions())),r&&this._events.on(r,Fn,this._onSelectionChanged),s&&a&&(this._onDidMountCalled=!0,s(this))},i.prototype.componentDidUpdate=function(n){var e=this.state,r=this.props,a=r.item,s=r.onDidMount,l=e.columnMeasureInfo;if((this.props.itemIndex!==n.itemIndex||this.props.item!==n.item||this.props.dragDropHelper!==n.dragDropHelper)&&(this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this.props.dragDropHelper&&this._root.current&&(this._dragDropSubscription=this.props.dragDropHelper.subscribe(this._root.current,this._events,this._getRowDragDropOptions()))),l&&l.index>=0&&this._cellMeasurer.current){var c=this._cellMeasurer.current.getBoundingClientRect().width;l.onMeasureDone(c),this.setState({columnMeasureInfo:void 0})}a&&s&&!this._onDidMountCalled&&(this._onDidMountCalled=!0,s(this))},i.prototype.componentWillUnmount=function(){var n=this.props,e=n.item,r=n.onWillUnmount;r&&e&&r(this),this._dragDropSubscription&&(this._dragDropSubscription.dispose(),delete this._dragDropSubscription),this._events.dispose()},i.prototype.shouldComponentUpdate=function(n,e){if(this.props.useReducedRowRenderer){var r=gn(n);return this.state.selectionState.isSelected!==r.isSelected?!0:!o.shallowCompare(this.props,n)}else return!0},i.prototype.render=function(){var n=this.props,e=n.className,r=n.columns,a=r===void 0?qi:r,s=n.dragDropEvents,l=n.item,c=n.itemIndex,d=n.id,g=n.flatIndexOffset,m=g===void 0?2:g,u=n.onRenderCheck,f=u===void 0?this._onRenderCheck:u,p=n.onRenderDetailsCheckbox,_=n.onRenderItemColumn,v=n.getCellValueKey,b=n.selectionMode,y=n.rowWidth,C=y===void 0?0:y,x=n.checkboxVisibility,R=n.getRowAriaLabel,D=n.getRowAriaDescription,S=n.getRowAriaDescribedBy,I=n.checkButtonAriaLabel,N=n.checkboxCellClassName,k=n.rowFieldsAs,w=k===void 0?Os:k,E=n.selection,P=n.indentWidth,T=n.enableUpdateAnimations,M=n.compact,L=n.theme,B=n.styles,z=n.cellsByColumn,H=n.groupNestingDepth,O=n.useFastIcons,V=O===void 0?!0:O,W=n.cellStyleProps,G=n.group,A=n.focusZoneProps,F=n.disabled,Y=F===void 0?!1:F,ee=this.state,q=ee.columnMeasureInfo,he=ee.isDropping,ce=this.state.selectionState,re=ce.isSelected,ye=re===void 0?!1:re,me=ce.isSelectionModal,se=me===void 0?!1:me,fe=s?!!(s.canDrag&&s.canDrag(l)):void 0,oe=he?this._droppingClassNames||Gs:"",_e=R?R(l):void 0,te=D?D(l):void 0,ve=S?S(l):void 0,Ye=!!E&&E.canSelectItem(l,c)&&!Y,Be=b===Q.multiple,Oe=b!==Q.none&&x!==Ke.hidden,$e=b===Q.none?void 0:ye,Te=G?c-G.startIndex+1:void 0,rt=G?G.count:void 0,Pe=A?A.direction:o.FocusZoneDirection.horizontal;this._classNames=o.__assign(o.__assign({},this._classNames),Ws(B,{theme:L,isSelected:ye,canSelect:!Be,anySelected:se,checkboxCellClassName:N,droppingClassName:oe,className:e,compact:M,enableUpdateAnimations:T,cellStyleProps:W,disabled:Y}));var X={isMultiline:this._classNames.isMultiline,isRowHeader:this._classNames.isRowHeader,cell:this._classNames.cell,cellAnimation:this._classNames.cellAnimation,cellPadded:this._classNames.cellPadded,cellUnpadded:this._classNames.cellUnpadded,fields:this._classNames.fields};o.shallowCompare(this._rowClassNames||{},X)||(this._rowClassNames=X);var xe=h.createElement(w,{rowClassNames:this._rowClassNames,rowHeaderId:d+"-header",cellsByColumn:z,columns:a,item:l,itemIndex:c,columnStartIndex:(Oe?1:0)+(H?1:0),onRenderItemColumn:_,getCellValueKey:v,enableUpdateAnimations:T,cellStyleProps:W}),ie="row",J=this.props.role?this.props.role:ie;return this._ariaRowDescriptionId=o.getId("DetailsRow-description"),h.createElement(o.FocusZone,o.__assign({"data-is-focusable":!0},o.getNativeProps(this.props,o.divProperties),typeof fe=="boolean"?{"data-is-draggable":fe,draggable:fe}:{},A,{direction:Pe,elementRef:this._root,componentRef:this._focusZone,role:J,"aria-label":_e,"aria-disabled":Y||void 0,"aria-describedby":te?this._ariaRowDescriptionId:ve,className:this._classNames.root,"data-selection-index":c,"data-selection-touch-invoke":!0,"data-selection-disabled":Y||void 0,"data-item-index":c,"aria-rowindex":Te===void 0?c+m:void 0,"aria-level":H&&H+1||void 0,"aria-posinset":Te,"aria-setsize":rt,"data-automationid":"DetailsRow",style:{minWidth:C},"aria-selected":$e,allowFocusRoot:!0}),te?h.createElement("span",{key:"description",role:"presentation",hidden:!0,id:this._ariaRowDescriptionId},te):null,Oe&&h.createElement("div",{role:"gridcell","data-selection-toggle":!0,className:this._classNames.checkCell},f({id:d?d+"-checkbox":void 0,selected:ye,selectionMode:b,anySelected:se,"aria-label":I,"aria-labelledby":d?d+"-checkbox "+d+"-header":void 0,canSelect:Ye,compact:M,className:this._classNames.check,theme:L,isVisible:x===Ke.always,onRenderDetailsCheckbox:p,useFastIcons:V})),h.createElement(Bt,{indentWidth:P,role:"gridcell",count:H-(this.props.collapseAllVisibility===Lt.hidden?1:0)}),l&&xe,q&&h.createElement("span",{role:"presentation",className:o.css(this._classNames.cellMeasurer,this._classNames.cell),ref:this._cellMeasurer},h.createElement(w,{rowClassNames:this._rowClassNames,rowHeaderId:d+"-header",columns:[q.column],item:l,itemIndex:c,columnStartIndex:(Oe?1:0)+(H?1:0)+a.length,onRenderItemColumn:_,getCellValueKey:v})),h.createElement("span",{role:"checkbox",className:this._classNames.checkCover,"aria-checked":ye,"data-selection-toggle":!0}))},i.prototype.measureCell=function(n,e){var r=this.props.columns,a=r===void 0?qi:r,s=o.__assign({},a[n]);s.minWidth=0,s.maxWidth=999999,delete s.calculatedWidth,this.setState({columnMeasureInfo:{index:n,column:s,onMeasureDone:e}})},i.prototype.focus=function(n){var e;return n===void 0&&(n=!1),!!(!((e=this._focusZone.current)===null||e===void 0)&&e.focus(n))},i.prototype._onRenderCheck=function(n){return h.createElement(Oo,o.__assign({},n))},i.prototype._getRowDragDropOptions=function(){var n=this.props,e=n.item,r=n.itemIndex,a=n.dragDropEvents,s=n.eventsToRegister,l={eventMap:s,selectionIndex:r,context:{data:e,index:r},canDrag:a.canDrag,canDrop:a.canDrop,onDragStart:a.onDragStart,updateDropState:this._updateDroppingState,onDrop:a.onDrop,onDragEnd:a.onDragEnd,onDragOver:a.onDragOver};return l},i}(h.Component);function gn(t){var i,n=t.itemIndex,e=t.selection;return{isSelected:!!(e!=null&&e.isIndexSelected(n)),isSelectionModal:!!(!((i=e==null?void 0:e.isModal)===null||i===void 0)&&i.call(e))}}var Ks=o.styled(Vs,ya,void 0,{scope:"DetailsRow"}),Xi=500,Us=3;function Ys(t){return function(i){o.__extends(n,i);function n(e){var r=i.call(this,e)||this;return r._root=h.createRef(),r._registerResizeObserver=function(){var a=o.getWindow(r._root.current);r._viewportResizeObserver=new a.ResizeObserver(r._onAsyncResize),r._viewportResizeObserver.observe(r._root.current)},r._unregisterResizeObserver=function(){r._viewportResizeObserver&&(r._viewportResizeObserver.disconnect(),delete r._viewportResizeObserver)},r._updateViewport=function(a){var s=r.state.viewport,l=r._root.current,c=o.findScrollableParent(l),d=Li(c),g=Li(l),m=function(){a&&r._composedComponentInstance&&r._composedComponentInstance.forceUpdate()},u=(g&&g.width)!==s.width||(d&&d.height)!==s.height;u&&r._resizeAttempts<Us&&g&&d?(r._resizeAttempts++,r.setState({viewport:{width:g.width,height:d.height}},function(){r._updateViewport(a)})):(r._resizeAttempts=0,m())},r._async=new o.Async(r),r._events=new o.EventGroup(r),r._resizeAttempts=0,r.state={viewport:{width:0,height:0}},r}return n.prototype.componentDidMount=function(){var e=this,r=this.props,a=r.delayFirstMeasure,s=r.disableResizeObserver,l=r.skipViewportMeasures,c=o.getWindow(this._root.current);this._onAsyncResize=this._async.debounce(this._onAsyncResize,Xi,{leading:!1}),l||(!s&&this._isResizeObserverAvailable()?this._registerResizeObserver():this._events.on(c,"resize",this._onAsyncResize),a?this._async.setTimeout(function(){e._updateViewport()},Xi):this._updateViewport())},n.prototype.componentDidUpdate=function(e){var r=e.skipViewportMeasures,a=this.props,s=a.disableResizeObserver,l=a.skipViewportMeasures,c=o.getWindow(this._root.current);l!==r&&(l?(this._unregisterResizeObserver(),this._events.off(c,"resize",this._onAsyncResize)):(!s&&this._isResizeObserverAvailable()?this._viewportResizeObserver||this._registerResizeObserver():this._events.on(c,"resize",this._onAsyncResize),this._updateViewport()))},n.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose(),this._unregisterResizeObserver()},n.prototype.render=function(){var e=this.state.viewport,r=e.width>0&&e.height>0?e:void 0;return h.createElement("div",{className:"ms-Viewport",ref:this._root,style:{minWidth:1,minHeight:1}},h.createElement(t,o.__assign({ref:this._updateComposedComponentRef,viewport:r},this.props)))},n.prototype.forceUpdate=function(){this._updateViewport(!0)},n.prototype._onAsyncResize=function(){this._updateViewport()},n.prototype._isResizeObserverAvailable=function(){var e=o.getWindow(this._root.current);return e&&e.ResizeObserver},n}(o.BaseDecorator)}var $s=function(t){var i=0;if(t)for(var n=o.__spreadArray([],t),e=void 0;n&&n.length>0;)++i,e=n.pop(),e&&e.children&&n.push.apply(n,e.children);return i},js=o.classNamesFunction(),pt=100,Zs=2,qs=2,Xs=function(t){var i=t.selection,n=t.ariaLabelForListHeader,e=t.ariaLabelForSelectAllCheckbox,r=t.ariaLabelForSelectionColumn,a=t.className,s=t.checkboxVisibility,l=t.compact,c=t.constrainMode,d=t.dragDropEvents,g=t.groups,m=t.groupProps,u=t.indentWidth,f=t.items,p=t.isPlaceholderData,_=t.isHeaderVisible,v=t.layoutMode,b=t.onItemInvoked,y=t.onItemContextMenu,C=t.onColumnHeaderClick,x=t.onColumnHeaderContextMenu,R=t.selectionMode,D=R===void 0?i.mode:R,S=t.selectionPreservedOnEmptyClick,I=t.selectionZoneProps,N=t.ariaLabel,k=t.ariaLabelForGrid,w=t.rowElementEventMap,E=t.shouldApplyApplicationRole,P=E===void 0?!1:E,T=t.getKey,M=t.listProps,L=t.usePageCache,B=t.onShouldVirtualize,z=t.viewport,H=t.minimumPixelsForDrag,O=t.getGroupHeight,V=t.styles,W=t.theme,G=t.cellStyleProps,A=G===void 0?mt:G,F=t.onRenderCheckbox,Y=t.useFastIcons,ee=t.dragDropHelper,q=t.adjustedColumns,he=t.isCollapsed,ce=t.isSizing,re=t.isSomeGroupExpanded,ye=t.version,me=t.rootRef,se=t.listRef,fe=t.focusZoneRef,oe=t.columnReorderOptions,_e=t.groupedListRef,te=t.headerRef,ve=t.onGroupExpandStateChanged,Ye=t.onColumnIsSizingChanged,Be=t.onRowDidMount,Oe=t.onRowWillUnmount,$e=t.disableSelectionZone,Te=t.onColumnResized,rt=t.onColumnAutoResized,Pe=t.onToggleCollapse,X=t.onActiveRowChanged,xe=t.onBlur,ie=t.rowElementEventMap,J=t.onRenderMissingItem,ke=t.onRenderItemColumn,Ie=t.getCellValueKey,Ge=t.getRowAriaLabel,Re=t.getRowAriaDescribedBy,ue=t.checkButtonAriaLabel,pe=t.checkButtonGroupAriaLabel,ae=t.checkboxCellClassName,je=t.useReducedRowRenderer,ft=t.enableUpdateAnimations,at=t.enterModalSelectionOnTouch,Wt=t.onRenderDefaultRow,an=t.selectionZoneRef,Me=t.focusZoneProps,Gt="grid",Dt=t.role?t.role:Gt,sn=o.getId("row"),U=el(g),le=tl(g),Se=h.useMemo(function(){return o.__assign({renderedWindowsAhead:ce?0:Zs,renderedWindowsBehind:ce?0:qs,getKey:T,version:ye},M)},[ce,T,ye,M]),Ve=tt.none;if(D===Q.single&&(Ve=tt.hidden),D===Q.multiple){var Ae=m&&m.headerProps&&m.headerProps.isCollapsedGroupSelectVisible;Ae===void 0&&(Ae=!0);var Rt=Ae||!g||re;Ve=Rt?tt.visible:tt.hidden}s===Ke.hidden&&(Ve=tt.none);var Nt=h.useCallback(function(ge){return h.createElement(zs,o.__assign({},ge))},[]),Vt=h.useCallback(function(){return null},[]),zn=t.onRenderDetailsHeader,Ri=h.useMemo(function(){return zn?o.composeRenderFunction(zn,Nt):Nt},[zn,Nt]),Bn=t.onRenderDetailsFooter,Fr=h.useMemo(function(){return Bn?o.composeRenderFunction(Bn,Vt):Vt},[Bn,Vt]),Hr=h.useMemo(function(){return{columns:q,groupNestingDepth:U,selection:i,selectionMode:D,viewport:z,checkboxVisibility:s,indentWidth:u,cellStyleProps:A}},[q,U,i,D,z,s,u,A]),On=oe&&oe.onDragEnd,Ni=h.useCallback(function(ge,Fe){var Ee=ge.dropLocation,Ze=Ht.outside;if(On){if(Ee&&Ee!==Ht.header)Ze=Ee;else if(me.current){var qe=me.current.getBoundingClientRect();Fe.clientX>qe.left&&Fe.clientX<qe.right&&Fe.clientY>qe.top&&Fe.clientY<qe.bottom&&(Ze=Ht.surface)}On(Ze)}},[On,me]),Mr=h.useMemo(function(){if(oe)return o.__assign(o.__assign({},oe),{onColumnDragEnd:Ni})},[oe,Ni]),Lr=(_?1:0)+$s(g)+(f?f.length:0),zr=(Ve!==tt.none?1:0)+(q?q.length:0)+(g?1:0),ln=h.useMemo(function(){return js(V,{theme:W,compact:l,isFixed:v===zt.fixedColumns,isHorizontalConstrained:c===Rn.horizontalConstrained,className:a})},[V,W,l,v,c,a]),Wn=m&&m.onRenderFooter,Ei=h.useMemo(function(){return Wn?function(ge,Fe){return Wn(o.__assign(o.__assign({},ge),{columns:q,groupNestingDepth:U,indentWidth:u,selection:i,selectionMode:D,viewport:z,checkboxVisibility:s,cellStyleProps:A}),Fe)}:void 0},[Wn,q,U,u,i,D,z,s,A]),Gn=m&&m.onRenderHeader,Ti=h.useMemo(function(){return Gn?function(ge,Fe){var Ee,Ze,qe=ge.groupIndex,it=qe!==void 0?(Ze=(Ee=ge.groups)===null||Ee===void 0?void 0:Ee[qe])===null||Ze===void 0?void 0:Ze.key:void 0,Kt=it!==void 0&&le[it]?le[it].totalRowCount:0;return Gn(o.__assign(o.__assign({},ge),{columns:q,groupNestingDepth:U,indentWidth:u,selection:i,selectionMode:s!==Ke.hidden?D:Q.none,viewport:z,checkboxVisibility:s,cellStyleProps:A,ariaColSpan:q.length,ariaPosInSet:void 0,ariaSetSize:void 0,ariaRowCount:void 0,ariaRowIndex:qe!==void 0?Kt+(_?1:0):void 0}),Fe)}:function(ge,Fe){var Ee,Ze,qe=ge.groupIndex,it=qe!==void 0?(Ze=(Ee=ge.groups)===null||Ee===void 0?void 0:Ee[qe])===null||Ze===void 0?void 0:Ze.key:void 0,Kt=it!==void 0&&le[it]?le[it].totalRowCount:0;return Fe(o.__assign(o.__assign({},ge),{ariaColSpan:q.length,ariaPosInSet:void 0,ariaSetSize:void 0,ariaRowCount:void 0,ariaRowIndex:qe!==void 0?Kt+(_?1:0):void 0}))}},[Gn,q,U,u,_,i,D,z,s,A,le]),Br=h.useMemo(function(){var ge;return o.__assign(o.__assign({},m),{role:Dt===Gt?"rowgroup":"presentation",onRenderFooter:Ei,onRenderHeader:Ti,headerProps:o.__assign(o.__assign({},m==null?void 0:m.headerProps),{selectAllButtonProps:o.__assign({"aria-label":pe},(ge=m==null?void 0:m.headerProps)===null||ge===void 0?void 0:ge.selectAllButtonProps)})})},[m,Ei,Ti,pe,Dt]),Vn=o.useConst(function(){return o.memoizeFunction(function(ge){var Fe=0;return ge.forEach(function(Ee){return Fe+=Ee.calculatedWidth||Ee.minWidth}),Fe})}),Pi=m&&m.collapseAllVisibility,Ai=h.useMemo(function(){return Vn(q)},[q,Vn]),Kn=h.useCallback(function(ge,Fe,Ee,Ze){var qe=t.onRenderRow?o.composeRenderFunction(t.onRenderRow,Wt):Wt,it=Ze?Ze.key:void 0,Kt=it&&le[it]?le[it].numOfGroupHeadersBeforeItem:0,Kr=Dt===Gt?void 0:"presentation",Mi={item:Fe,itemIndex:Ee,flatIndexOffset:(_?2:1)+Kt,compact:l,columns:q,groupNestingDepth:ge,id:sn+"-"+Ee,selectionMode:D,selection:i,onDidMount:Be,onWillUnmount:Oe,onRenderItemColumn:ke,getCellValueKey:Ie,eventsToRegister:ie,dragDropEvents:d,dragDropHelper:ee,viewport:z,checkboxVisibility:s,collapseAllVisibility:Pi,getRowAriaLabel:Ge,getRowAriaDescribedBy:Re,checkButtonAriaLabel:ue,checkboxCellClassName:ae,useReducedRowRenderer:je,indentWidth:u,cellStyleProps:A,onRenderDetailsCheckbox:F,enableUpdateAnimations:ft,rowWidth:Ai,useFastIcons:Y,role:Kr};return Fe?qe(Mi):J?J(Ee,Mi):null},[l,q,D,i,sn,Be,Oe,ke,Ie,ie,d,ee,z,s,Pi,Ge,Re,_,ue,ae,je,u,A,F,ft,Y,Wt,J,t.onRenderRow,Ai,Dt,le]),Or=h.useCallback(function(ge){return function(Fe,Ee){return Kn(ge,Fe,Ee)}},[Kn]),Wr=h.useCallback(function(ge){return ge.which===o.getRTLSafeKeyCode(o.KeyCodes.right,W)},[W]),Fi=o.__assign(o.__assign({},Me),{componentRef:Me&&Me.componentRef?Me.componentRef:fe,className:ln.focusZone,direction:Me?Me.direction:o.FocusZoneDirection.vertical,shouldEnterInnerZone:Me&&Me.shouldEnterInnerZone?Me.shouldEnterInnerZone:Wr,onActiveElementChanged:Me&&Me.onActiveElementChanged?Me.onActiveElementChanged:X,shouldRaiseClicksOnEnter:!1,onBlur:Me&&Me.onBlur?Me.onBlur:xe}),Hi=g?h.createElement(bs,{focusZoneProps:Fi,componentRef:_e,groups:g,groupProps:Br,items:f,onRenderCell:Kn,role:"presentation",selection:i,selectionMode:s!==Ke.hidden?D:Q.none,dragDropEvents:d,dragDropHelper:ee,eventsToRegister:w,listProps:Se,onGroupExpandStateChanged:ve,usePageCache:L,onShouldVirtualize:B,getGroupHeight:O,compact:l}):h.createElement(o.FocusZone,o.__assign({},Fi),h.createElement(Nn,o.__assign({ref:se,role:"presentation",items:f,onRenderCell:Or(0),usePageCache:L,onShouldVirtualize:B},Se))),Gr=h.useCallback(function(ge){ge.which===o.KeyCodes.down&&fe.current&&fe.current.focus()&&(i.getSelectedIndices().length===0&&i.setIndexSelected(0,!0,!1),ge.preventDefault(),ge.stopPropagation())},[i,fe]),Vr=h.useCallback(function(ge){ge.which===o.KeyCodes.up&&!ge.altKey&&te.current&&te.current.focus()&&(ge.preventDefault(),ge.stopPropagation())},[te]);return h.createElement("div",o.__assign({ref:me,className:ln.root,"data-automationid":"DetailsList","data-is-scrollable":"false","aria-label":N},P?{role:"application"}:{}),h.createElement(o.FocusRects,null),h.createElement("div",{role:Dt,"aria-label":k,"aria-rowcount":p?-1:Lr,"aria-colcount":zr,"aria-readonly":"true","aria-busy":p},h.createElement("div",{onKeyDown:Gr,role:"presentation",className:ln.headerWrapper},_&&Ri({componentRef:te,selectionMode:D,layoutMode:v,selection:i,columns:q,onColumnClick:C,onColumnContextMenu:x,onColumnResized:Te,onColumnIsSizingChanged:Ye,onColumnAutoResized:rt,groupNestingDepth:U,isAllCollapsed:he,onToggleCollapseAll:Pe,ariaLabel:n,ariaLabelForSelectAllCheckbox:e,ariaLabelForSelectionColumn:r,selectAllVisibility:Ve,collapseAllVisibility:m&&m.collapseAllVisibility,viewport:z,columnReorderProps:Mr,minimumPixelsForDrag:H,cellStyleProps:A,checkboxVisibility:s,indentWidth:u,onRenderDetailsCheckbox:F,rowWidth:Vn(q),useFastIcons:Y},Ri)),h.createElement("div",{onKeyDown:Vr,role:"presentation",className:ln.contentWrapper},$e?Hi:h.createElement(_i,o.__assign({ref:an,selection:i,selectionPreservedOnEmptyClick:S,selectionMode:D,onItemInvoked:b,onItemContextMenu:y,enterModalOnTouch:at},I||{}),Hi)),Fr(o.__assign({},Hr))))},Js=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._root=h.createRef(),e._header=h.createRef(),e._groupedList=h.createRef(),e._list=h.createRef(),e._focusZone=h.createRef(),e._selectionZone=h.createRef(),e._onRenderRow=function(r,a){return h.createElement(Ks,o.__assign({},r))},e._getDerivedStateFromProps=function(r,a){var s=e.props,l=s.checkboxVisibility,c=s.items,d=s.setKey,g=s.selectionMode,m=g===void 0?e._selection.mode:g,u=s.columns,f=s.viewport,p=s.compact,_=s.dragDropEvents,v=(e.props.groupProps||{}).isAllGroupsCollapsed,b=v===void 0?void 0:v,y=r.viewport&&r.viewport.width||0,C=f&&f.width||0,x=r.setKey!==d||r.setKey===void 0,R=!1;r.layoutMode!==e.props.layoutMode&&(R=!0);var D=a;return x&&(e._initialFocusedIndex=r.initialFocusedIndex,D=o.__assign(o.__assign({},D),{focusedItemIndex:e._initialFocusedIndex!==void 0?e._initialFocusedIndex:-1})),!e.props.disableSelectionZone&&r.items!==c&&e._selection.setItems(r.items,x),(r.checkboxVisibility!==l||r.columns!==u||y!==C||r.compact!==p)&&(R=!0),D=o.__assign(o.__assign({},D),e._adjustColumns(r,D,!0)),r.selectionMode!==m&&(R=!0),b===void 0&&r.groupProps&&r.groupProps.isAllGroupsCollapsed!==void 0&&(D=o.__assign(o.__assign({},D),{isCollapsed:r.groupProps.isAllGroupsCollapsed,isSomeGroupExpanded:!r.groupProps.isAllGroupsCollapsed})),r.dragDropEvents!==_&&(e._dragDropHelper&&e._dragDropHelper.dispose(),e._dragDropHelper=r.dragDropEvents?new ui({selection:e._selection,minimumPixelsForDrag:r.minimumPixelsForDrag}):void 0,R=!0),R&&(D=o.__assign(o.__assign({},D),{version:{}})),D},e._onGroupExpandStateChanged=function(r){e.setState({isSomeGroupExpanded:r})},e._onColumnIsSizingChanged=function(r,a){e.setState({isSizing:a})},e._onRowDidMount=function(r){var a=r.props,s=a.item,l=a.itemIndex,c=e._getItemKey(s,l);e._activeRows[c]=r,e._setFocusToRowIfPending(r);var d=e.props.onRowDidMount;d&&d(s,l)},e._onRowWillUnmount=function(r){var a=e.props.onRowWillUnmount,s=r.props,l=s.item,c=s.itemIndex,d=e._getItemKey(l,c);delete e._activeRows[d],a&&a(l,c)},e._onToggleCollapse=function(r){e.setState({isCollapsed:r}),e._groupedList.current&&e._groupedList.current.toggleCollapseAll(r)},e._onColumnResized=function(r,a,s){var l=Math.max(r.minWidth||pt,a);e.props.onColumnResize&&e.props.onColumnResize(r,l,s),e._rememberCalculatedWidth(r,l),e.setState(o.__assign(o.__assign({},e._adjustColumns(e.props,e.state,!0,s)),{version:{}}))},e._onColumnAutoResized=function(r,a){var s=0,l=0,c=Object.keys(e._activeRows).length;for(var d in e._activeRows)if(e._activeRows.hasOwnProperty(d)){var g=e._activeRows[d];g.measureCell(a,function(m){s=Math.max(s,m),l++,l===c&&e._onColumnResized(r,s,a)})}},e._onActiveRowChanged=function(r,a){var s=e.props,l=s.items,c=s.onActiveItemChanged;if(!!r&&r.getAttribute("data-item-index")){var d=Number(r.getAttribute("data-item-index"));d>=0&&(c&&c(l[d],d,a),e.setState({focusedItemIndex:d}))}},e._onBlur=function(r){e.setState({focusedItemIndex:-1})},o.initializeComponentRef(e),e._async=new o.Async(e),e._activeRows={},e._columnOverrides={},e.state={focusedItemIndex:-1,lastWidth:0,adjustedColumns:e._getAdjustedColumns(n,void 0),isSizing:!1,isCollapsed:n.groupProps&&n.groupProps.isAllGroupsCollapsed,isSomeGroupExpanded:n.groupProps&&!n.groupProps.isAllGroupsCollapsed,version:{},getDerivedStateFromProps:e._getDerivedStateFromProps},e._selection=n.selection||new Ao({onSelectionChanged:void 0,getKey:n.getKey,selectionMode:n.selectionMode}),e.props.disableSelectionZone||e._selection.setItems(n.items,!1),e._dragDropHelper=n.dragDropEvents?new ui({selection:e._selection,minimumPixelsForDrag:n.minimumPixelsForDrag}):void 0,e._initialFocusedIndex=n.initialFocusedIndex,e}return i.getDerivedStateFromProps=function(n,e){return e.getDerivedStateFromProps(n,e)},i.prototype.scrollToIndex=function(n,e,r){this._list.current&&this._list.current.scrollToIndex(n,e,r),this._groupedList.current&&this._groupedList.current.scrollToIndex(n,e,r)},i.prototype.focusIndex=function(n,e,r,a){e===void 0&&(e=!1);var s=this.props.items[n];if(s){this.scrollToIndex(n,r,a);var l=this._getItemKey(s,n),c=this._activeRows[l];c&&this._setFocusToRow(c,e)}},i.prototype.getStartItemIndexInView=function(){return this._list&&this._list.current?this._list.current.getStartItemIndexInView():this._groupedList&&this._groupedList.current?this._groupedList.current.getStartItemIndexInView():0},i.prototype.updateColumn=function(n,e){var r,a,s=[],l=this.props,c=l.columns,d=c===void 0?s:c,g=l.selectionMode,m=l.checkboxVisibility,u=l.columnReorderOptions,f=e.width,p=e.newColumnIndex,_=d.findIndex(function(N){return N.key===n.key});if(f&&this._onColumnResized(n,f,_),p!==void 0&&u){var v=g===Q.none||m===Ke.hidden,b=m!==Ke.hidden,y=(b?2:1)+_,C=v?y-1:y-2,x=v?p-1:p-2,R=(r=u.frozenColumnCountFromStart)!==null&&r!==void 0?r:0,D=(a=u.frozenColumnCountFromEnd)!==null&&a!==void 0?a:0,S=x>=R&&x<d.length-D;if(S)if(u.onColumnDrop){var I={draggedIndex:C,targetIndex:x};u.onColumnDrop(I)}else u.handleColumnReorder&&u.handleColumnReorder(C,x)}},i.prototype.componentWillUnmount=function(){this._dragDropHelper&&this._dragDropHelper.dispose(),this._async.dispose()},i.prototype.componentDidUpdate=function(n,e){if(this._notifyColumnsResized(),this._initialFocusedIndex!==void 0){var r=this.props.items[this._initialFocusedIndex];if(r){var a=this._getItemKey(r,this._initialFocusedIndex),s=this._activeRows[a];s&&this._setFocusToRowIfPending(s)}}if(this.props.items!==n.items&&this.props.items.length>0&&this.state.focusedItemIndex!==-1&&!o.elementContains(this._root.current,document.activeElement,!1)){var l=this.state.focusedItemIndex<this.props.items.length?this.state.focusedItemIndex:this.props.items.length-1,r=this.props.items[l],a=this._getItemKey(r,this.state.focusedItemIndex),s=this._activeRows[a];s?this._setFocusToRow(s):this._initialFocusedIndex=l}this.props.onDidUpdate&&this.props.onDidUpdate(this)},i.prototype.render=function(){return h.createElement(Xs,o.__assign({},this.props,this.state,{selection:this._selection,dragDropHelper:this._dragDropHelper,rootRef:this._root,listRef:this._list,groupedListRef:this._groupedList,focusZoneRef:this._focusZone,headerRef:this._header,selectionZoneRef:this._selectionZone,onGroupExpandStateChanged:this._onGroupExpandStateChanged,onColumnIsSizingChanged:this._onColumnIsSizingChanged,onRowDidMount:this._onRowDidMount,onRowWillUnmount:this._onRowWillUnmount,onColumnResized:this._onColumnResized,onColumnAutoResized:this._onColumnAutoResized,onToggleCollapse:this._onToggleCollapse,onActiveRowChanged:this._onActiveRowChanged,onBlur:this._onBlur,onRenderDefaultRow:this._onRenderRow}))},i.prototype.forceUpdate=function(){t.prototype.forceUpdate.call(this),this._forceListUpdates()},i.prototype._getGroupNestingDepth=function(){for(var n=this.props.groups,e=0,r=n;r&&r.length>0;)e++,r=r[0].children;return e},i.prototype._setFocusToRowIfPending=function(n){var e=n.props.itemIndex;this._initialFocusedIndex!==void 0&&e===this._initialFocusedIndex&&(this._setFocusToRow(n),delete this._initialFocusedIndex)},i.prototype._setFocusToRow=function(n,e){e===void 0&&(e=!1),this._selectionZone.current&&this._selectionZone.current.ignoreNextFocus(),this._async.setTimeout(function(){n.focus(e)},0)},i.prototype._forceListUpdates=function(){this._groupedList.current&&this._groupedList.current.forceUpdate(),this._list.current&&this._list.current.forceUpdate()},i.prototype._notifyColumnsResized=function(){this.state.adjustedColumns.forEach(function(n){n.onColumnResize&&n.onColumnResize(n.currentWidth)})},i.prototype._adjustColumns=function(n,e,r,a){var s=this._getAdjustedColumns(n,e,r,a),l=this.props.viewport,c=l&&l.width?l.width:0;return o.__assign(o.__assign({},e),{adjustedColumns:s,lastWidth:c})},i.prototype._getAdjustedColumns=function(n,e,r,a){var s=this,l=n.items,c=n.layoutMode,d=n.selectionMode,g=n.viewport,m=g&&g.width?g.width:0,u=n.columns,f=this.props?this.props.columns:[],p=e?e.lastWidth:-1,_=e?e.lastSelectionMode:void 0;if(!r&&p===m&&_===d&&(!f||u===f))return u||[];u=u||Qs(l,!0);var v;return c===zt.fixedColumns?(v=this._getFixedColumns(u,m,n),v.forEach(function(b){s._rememberCalculatedWidth(b,b.calculatedWidth)})):(v=this._getJustifiedColumns(u,m,n),v.forEach(function(b){s._getColumnOverride(b.key).currentWidth=b.calculatedWidth})),v},i.prototype._getFixedColumns=function(n,e,r){var a=this,s=this.props,l=s.selectionMode,c=l===void 0?this._selection.mode:l,d=s.checkboxVisibility,g=s.flexMargin,m=s.skipViewportMeasures,u=e-(g||0),f=0;n.forEach(function(b){m||!b.flexGrow?u-=b.maxWidth||b.minWidth||pt:(u-=b.minWidth||pt,f+=b.flexGrow),u-=hn(b,r,!0)});var p=c!==Q.none&&d!==Ke.hidden?nn:0,_=this._getGroupNestingDepth()*en;u-=p+_;var v=u/f;return m||n.forEach(function(b){var y=o.__assign(o.__assign({},b),a._columnOverrides[b.key]);if(y.flexGrow&&y.maxWidth){var C=y.flexGrow*v+y.minWidth,x=C-y.maxWidth;x>0&&(u+=x,f-=x/(C-y.minWidth)*y.flexGrow)}}),v=u>0?u/f:0,n.map(function(b){var y=o.__assign(o.__assign({},b),a._columnOverrides[b.key]);return!m&&y.flexGrow&&u<=0||y.calculatedWidth||(!m&&y.flexGrow?(y.calculatedWidth=y.minWidth+y.flexGrow*v,y.calculatedWidth=Math.min(y.calculatedWidth,y.maxWidth||Number.MAX_VALUE)):y.calculatedWidth=y.maxWidth||y.minWidth||pt),y})},i.prototype._getJustifiedColumns=function(n,e,r){var a=this,s=r.selectionMode,l=s===void 0?this._selection.mode:s,c=r.checkboxVisibility,d=l!==Q.none&&c!==Ke.hidden?nn:0,g=this._getGroupNestingDepth()*en,m=0,u=0,f=e-(d+g),p=n.map(function(k,w){var E=o.__assign(o.__assign({},k),{calculatedWidth:k.minWidth||pt}),P=o.__assign(o.__assign({},E),a._columnOverrides[k.key]);return E.isCollapsible||E.isCollapsable||(u+=hn(E,r)),m+=hn(P,r),P});if(u>f)return p;for(var _=p.length-1;_>=0&&m>f;){var v=p[_],b=v.minWidth||pt,y=m-f;if(v.calculatedWidth-b>=y||!(v.isCollapsible||v.isCollapsable)){var C=v.calculatedWidth;v.calculatedWidth=Math.max(v.calculatedWidth-y,b),m-=C-v.calculatedWidth}else m-=hn(v,r),p.splice(_,1);_--}for(var x=0;x<p.length&&m<f;x++){var v=p[x],R=x===p.length-1,D=this._columnOverrides[v.key];if(!(D&&D.calculatedWidth&&!R)){var S=f-m,I=void 0;if(R)I=S;else{var N=v.maxWidth,b=v.minWidth||N||pt;I=N?Math.min(S,N-b):S}v.calculatedWidth=v.calculatedWidth+I,m+=I}}return p},i.prototype._rememberCalculatedWidth=function(n,e){var r=this._getColumnOverride(n.key);r.calculatedWidth=e,r.currentWidth=e},i.prototype._getColumnOverride=function(n){return this._columnOverrides[n]=this._columnOverrides[n]||{}},i.prototype._getItemKey=function(n,e){var r=this.props.getKey,a=void 0;return n&&(a=n.key),r&&(a=r(n,e)),a||(a=e),a},i.defaultProps={layoutMode:zt.justified,selectionMode:Q.multiple,constrainMode:Rn.horizontalConstrained,checkboxVisibility:Ke.onHover,isHeaderVisible:!0,compact:!1,useFastIcons:!0},i=o.__decorate([Ys],i),i}(h.Component);function Qs(t,i,n,e,r,a,s,l){var c=[];if(t&&t.length){var d=t[0];for(var g in d)d.hasOwnProperty(g)&&c.push({key:g,name:g,fieldName:g,minWidth:pt,maxWidth:300,isCollapsable:!!c.length,isCollapsible:!!c.length,isMultiline:s===void 0?!1:s,isSorted:e===g,isSortedDescending:!!r,isRowHeader:!1,columnActionsMode:l!=null?l:et.clickable,isResizable:i,onColumnClick:n,isGrouped:a===g})}return c}function hn(t,i,n){var e=i.cellStyleProps,r=e===void 0?mt:e;return(n?0:t.calculatedWidth)+r.cellLeftPadding+r.cellRightPadding+(t.isPadded?r.cellExtraRightPadding:0)}function el(t){for(var i=0,n=t;n&&n.length>0;)i++,n=n[0].children;return i}function tl(t){return h.useMemo(function(){var i={};if(t)for(var n=1,e=1,r=0,a=t;r<a.length;r++){var s=a[r],l=s.key;i[l]={numOfGroupHeadersBeforeItem:e,totalRowCount:n},e++,n+=s.count+1}return i},[t])}var nl={root:"ms-DetailsList",compact:"ms-DetailsList--Compact",contentWrapper:"ms-DetailsList-contentWrapper",headerWrapper:"ms-DetailsList-headerWrapper",isFixed:"is-fixed",isHorizontalConstrained:"is-horizontalConstrained",listCell:"ms-List-cell"},il=function(t){var i,n,e=t.theme,r=t.className,a=t.isHorizontalConstrained,s=t.compact,l=t.isFixed,c=e.semanticColors,d=o.getGlobalClassNames(nl,e);return{root:[d.root,e.fonts.small,{position:"relative",color:c.listText,selectors:(i={},i["& ."+d.listCell]={minHeight:38,wordBreak:"break-word"},i)},l&&d.isFixed,s&&[d.compact,{selectors:(n={},n["."+d.listCell]={minHeight:32},n)}],a&&[d.isHorizontalConstrained,{overflowX:"auto",overflowY:"visible",WebkitOverflowScrolling:"touch"}],r],focusZone:[{display:"inline-block",minWidth:"100%",minHeight:1}],headerWrapper:d.headerWrapper,contentWrapper:d.contentWrapper}},ol=o.styled(Js,il,void 0,{scope:"DetailsList"}),rl=h.createContext({scrollablePane:void 0}),_t;(function(t){t[t.Both=0]="Both",t[t.Header=1]="Header",t[t.Footer=2]="Footer"})(_t||(_t={}));var al=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._root=h.createRef(),e._stickyContentTop=h.createRef(),e._stickyContentBottom=h.createRef(),e._nonStickyContent=h.createRef(),e._placeHolder=h.createRef(),e.syncScroll=function(r){var a=e.nonStickyContent;a&&e.props.isScrollSynced&&(a.scrollLeft=r.scrollLeft)},e._getContext=function(){return e.context},e._onScrollEvent=function(r,a){if(e.root&&e.nonStickyContent){var s=e._getNonStickyDistanceFromTop(r),l=!1,c=!1;if(e.canStickyTop){var d=s-e._getStickyDistanceFromTop();l=d<r.scrollTop}e.canStickyBottom&&r.clientHeight-a.offsetHeight<=s&&(c=s-Math.floor(r.scrollTop)>=e._getStickyDistanceFromTopForFooter(r,a)),document.activeElement&&e.nonStickyContent.contains(document.activeElement)&&(e.state.isStickyTop!==l||e.state.isStickyBottom!==c)?e._activeElement=document.activeElement:e._activeElement=void 0,e.setState({isStickyTop:e.canStickyTop&&l,isStickyBottom:c,distanceFromTop:s})}},e._getStickyDistanceFromTop=function(){var r=0;return e.stickyContentTop&&(r=e.stickyContentTop.offsetTop),r},e._getStickyDistanceFromTopForFooter=function(r,a){var s=0;return e.stickyContentBottom&&(s=r.clientHeight-a.offsetHeight+e.stickyContentBottom.offsetTop),s},e._getNonStickyDistanceFromTop=function(r){var a=0,s=e.root;if(s){for(;s&&s.offsetParent!==r;)a+=s.offsetTop,s=s.offsetParent;s&&s.offsetParent===r&&(a+=s.offsetTop)}return a},o.initializeComponentRef(e),e.state={isStickyTop:!1,isStickyBottom:!1,distanceFromTop:void 0},e._activeElement=void 0,e}return Object.defineProperty(i.prototype,"root",{get:function(){return this._root.current},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"placeholder",{get:function(){return this._placeHolder.current},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stickyContentTop",{get:function(){return this._stickyContentTop.current},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"stickyContentBottom",{get:function(){return this._stickyContentBottom.current},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"nonStickyContent",{get:function(){return this._nonStickyContent.current},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canStickyTop",{get:function(){return this.props.stickyPosition===_t.Both||this.props.stickyPosition===_t.Header},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"canStickyBottom",{get:function(){return this.props.stickyPosition===_t.Both||this.props.stickyPosition===_t.Footer},enumerable:!1,configurable:!0}),i.prototype.componentDidMount=function(){var n=this._getContext().scrollablePane;!n||(n.subscribe(this._onScrollEvent),n.addSticky(this))},i.prototype.componentWillUnmount=function(){var n=this._getContext().scrollablePane;!n||(n.unsubscribe(this._onScrollEvent),n.removeSticky(this))},i.prototype.componentDidUpdate=function(n,e){var r=this._getContext().scrollablePane;if(!!r){var a=this.state,s=a.isStickyBottom,l=a.isStickyTop,c=a.distanceFromTop,d=!1;e.distanceFromTop!==c&&(r.sortSticky(this,!0),d=!0),(e.isStickyTop!==l||e.isStickyBottom!==s)&&(this._activeElement&&this._activeElement.focus(),r.updateStickyRefHeights(),d=!0),d&&r.syncScrollSticky(this)}},i.prototype.shouldComponentUpdate=function(n,e){if(!this.context.scrollablePane)return!0;var r=this.state,a=r.isStickyTop,s=r.isStickyBottom,l=r.distanceFromTop;return a!==e.isStickyTop||s!==e.isStickyBottom||this.props.stickyPosition!==n.stickyPosition||this.props.children!==n.children||l!==e.distanceFromTop||$n(this._nonStickyContent,this._stickyContentTop)||$n(this._nonStickyContent,this._stickyContentBottom)||$n(this._nonStickyContent,this._placeHolder)},i.prototype.render=function(){var n=this.state,e=n.isStickyTop,r=n.isStickyBottom,a=this.props,s=a.stickyClassName,l=a.children;return this.context.scrollablePane?h.createElement("div",{ref:this._root},this.canStickyTop&&h.createElement("div",{ref:this._stickyContentTop,style:{pointerEvents:e?"auto":"none"}},h.createElement("div",{style:this._getStickyPlaceholderHeight(e)})),this.canStickyBottom&&h.createElement("div",{ref:this._stickyContentBottom,style:{pointerEvents:r?"auto":"none"}},h.createElement("div",{style:this._getStickyPlaceholderHeight(r)})),h.createElement("div",{style:this._getNonStickyPlaceholderHeightAndWidth(),ref:this._placeHolder},(e||r)&&h.createElement("span",{style:o.hiddenContentStyle},l),h.createElement("div",{ref:this._nonStickyContent,className:e||r?s:void 0,style:this._getContentStyles(e||r)},l))):h.createElement("div",null,this.props.children)},i.prototype.addSticky=function(n){this.nonStickyContent&&n.appendChild(this.nonStickyContent)},i.prototype.resetSticky=function(){this.nonStickyContent&&this.placeholder&&this.placeholder.appendChild(this.nonStickyContent)},i.prototype.setDistanceFromTop=function(n){var e=this._getNonStickyDistanceFromTop(n);this.setState({distanceFromTop:e})},i.prototype._getContentStyles=function(n){return{backgroundColor:this.props.stickyBackgroundColor||this._getBackground(),overflow:n?"hidden":""}},i.prototype._getStickyPlaceholderHeight=function(n){var e=this.nonStickyContent?this.nonStickyContent.offsetHeight:0;return{visibility:n?"hidden":"visible",height:n?0:e}},i.prototype._getNonStickyPlaceholderHeightAndWidth=function(){var n=this.state,e=n.isStickyTop,r=n.isStickyBottom;if(e||r){var a=0,s=0;return this.nonStickyContent&&this.nonStickyContent.firstElementChild&&(a=this.nonStickyContent.offsetHeight,s=this.nonStickyContent.firstElementChild.scrollWidth+(this.nonStickyContent.firstElementChild.offsetWidth-this.nonStickyContent.firstElementChild.clientWidth)),{height:a,width:s}}else return{}},i.prototype._getBackground=function(){if(!!this.root){for(var n=this.root;window.getComputedStyle(n).getPropertyValue("background-color")==="rgba(0, 0, 0, 0)"||window.getComputedStyle(n).getPropertyValue("background-color")==="transparent";){if(n.tagName==="HTML")return;n.parentElement&&(n=n.parentElement)}return window.getComputedStyle(n).getPropertyValue("background-color")}},i.defaultProps={stickyPosition:_t.Both,isScrollSynced:!0},i.contextType=rl,i}(h.Component);function $n(t,i){return t&&i&&t.current&&i.current&&t.current.offsetHeight!==i.current.offsetHeight}var j;(function(t){t[t.tiny=0]="tiny",t[t.extraExtraSmall=1]="extraExtraSmall",t[t.extraSmall=2]="extraSmall",t[t.small=3]="small",t[t.regular=4]="regular",t[t.large=5]="large",t[t.extraLarge=6]="extraLarge",t[t.size8=17]="size8",t[t.size10=9]="size10",t[t.size16=8]="size16",t[t.size24=10]="size24",t[t.size28=7]="size28",t[t.size32=11]="size32",t[t.size40=12]="size40",t[t.size48=13]="size48",t[t.size56=16]="size56",t[t.size72=14]="size72",t[t.size100=15]="size100",t[t.size120=18]="size120"})(j||(j={}));var nt;(function(t){t[t.none=0]="none",t[t.offline=1]="offline",t[t.online=2]="online",t[t.away=3]="away",t[t.dnd=4]="dnd",t[t.blocked=5]="blocked",t[t.busy=6]="busy"})(nt||(nt={}));var Z;(function(t){t[t.lightBlue=0]="lightBlue",t[t.blue=1]="blue",t[t.darkBlue=2]="darkBlue",t[t.teal=3]="teal",t[t.lightGreen=4]="lightGreen",t[t.green=5]="green",t[t.darkGreen=6]="darkGreen",t[t.lightPink=7]="lightPink",t[t.pink=8]="pink",t[t.magenta=9]="magenta",t[t.purple=10]="purple",t[t.black=11]="black",t[t.orange=12]="orange",t[t.red=13]="red",t[t.darkRed=14]="darkRed",t[t.transparent=15]="transparent",t[t.violet=16]="violet",t[t.lightRed=17]="lightRed",t[t.gold=18]="gold",t[t.burgundy=19]="burgundy",t[t.warmGray=20]="warmGray",t[t.coolGray=21]="coolGray",t[t.gray=22]="gray",t[t.cyan=23]="cyan",t[t.rust=24]="rust"})(Z||(Z={}));var Ne,be;(function(t){t.size8="20px",t.size10="20px",t.size16="16px",t.size24="24px",t.size28="28px",t.size32="32px",t.size40="40px",t.size48="48px",t.size56="56px",t.size72="72px",t.size100="100px",t.size120="120px"})(be||(be={}));var Le;(function(t){t.size6="6px",t.size8="8px",t.size12="12px",t.size16="16px",t.size20="20px",t.size28="28px",t.size32="32px",t.border="2px"})(Le||(Le={}));var Mn=function(t){return{isSize8:t===j.size8,isSize10:t===j.size10||t===j.tiny,isSize16:t===j.size16,isSize24:t===j.size24||t===j.extraExtraSmall,isSize28:t===j.size28||t===j.extraSmall,isSize32:t===j.size32,isSize40:t===j.size40||t===j.small,isSize48:t===j.size48||t===j.regular,isSize56:t===j.size56,isSize72:t===j.size72||t===j.large,isSize100:t===j.size100||t===j.extraLarge,isSize120:t===j.size120}},Wo=(Ne={},Ne[j.tiny]=10,Ne[j.extraExtraSmall]=24,Ne[j.extraSmall]=28,Ne[j.small]=40,Ne[j.regular]=48,Ne[j.large]=72,Ne[j.extraLarge]=100,Ne[j.size8]=8,Ne[j.size10]=10,Ne[j.size16]=16,Ne[j.size24]=24,Ne[j.size28]=28,Ne[j.size32]=32,Ne[j.size40]=40,Ne[j.size48]=48,Ne[j.size56]=56,Ne[j.size72]=72,Ne[j.size100]=100,Ne[j.size120]=120,Ne),Go=function(t){return{isAvailable:t===nt.online,isAway:t===nt.away,isBlocked:t===nt.blocked,isBusy:t===nt.busy,isDoNotDisturb:t===nt.dnd,isOffline:t===nt.offline}},Ji=6,Qi=3,eo=40,to=20,sl=o.classNamesFunction({cacheSize:100}),Vo=h.forwardRef(function(t,i){var n=t.coinSize,e=t.isOutOfOffice,r=t.styles,a=t.presence,s=t.theme,l=t.presenceTitle,c=t.presenceColors,d=h.useRef(null),g=o.useMergedRefs(i,d),m=Mn(t.size),u=!(m.isSize8||m.isSize10||m.isSize16||m.isSize24||m.isSize28||m.isSize32)&&(n?n>32:!0),f=n?n/Qi<eo?n/Qi+"px":eo+"px":"",p=n?n/Ji<to?n/Ji+"px":to+"px":"",_=n?{fontSize:p,lineHeight:f}:void 0,v=n?{width:f,height:f}:void 0,b=sl(r,{theme:s,presence:a,size:t.size,isOutOfOffice:e,presenceColors:c});return a===nt.none?null:h.createElement("div",{role:"presentation",className:b.presence,style:v,title:l,ref:g},u&&h.createElement(o.Icon,{className:b.presenceIcon,iconName:ll(t.presence,t.isOutOfOffice),style:_}))});Vo.displayName="PersonaPresenceBase";function ll(t,i){if(!!t){var n="SkypeArrow";switch(nt[t]){case"online":return"SkypeCheck";case"away":return i?n:"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return i?n:""}return""}}var cl={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"},dl=function(t){var i,n,e,r,a,s,l=t.theme,c=t.presenceColors,d=l.semanticColors,g=l.fonts,m=o.getGlobalClassNames(cl,l),u=Mn(t.size),f=Go(t.presence),p=c&&c.available||"#6BB700",_=c&&c.away||"#FFAA44",v=c&&c.busy||"#C43148",b=c&&c.dnd||"#C50F1F",y=c&&c.offline||"#8A8886",C=c&&c.oof||"#B4009E",x=c&&c.background||d.bodyBackground,R=f.isOffline||t.isOutOfOffice&&(f.isAvailable||f.isBusy||f.isAway||f.isDoNotDisturb),D="1px",S="2px",I=u.isSize72||u.isSize100?S:D;return{presence:[m.presence,o.__assign(o.__assign({position:"absolute",height:Le.size12,width:Le.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+x,textAlign:"center",boxSizing:"content-box",backgroundClip:"border-box"},o.getHighContrastNoAdjustStyle()),{selectors:(i={},i[o.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},i)}),(u.isSize8||u.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[o.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},n)},(u.isSize8||u.isSize10||u.isSize24||u.isSize28||u.isSize32)&&Pt(Le.size8),(u.isSize40||u.isSize48)&&Pt(Le.size12),u.isSize16&&{height:Le.size6,width:Le.size6,borderWidth:"1.5px"},u.isSize56&&Pt(Le.size16),u.isSize72&&Pt(Le.size20),u.isSize100&&Pt(Le.size28),u.isSize120&&Pt(Le.size32),f.isAvailable&&{backgroundColor:p,selectors:(e={},e[o.HighContrastSelector]=$t("Highlight"),e)},f.isAway&&$t(_),f.isBlocked&&[{selectors:(r={":after":u.isSize40||u.isSize48||u.isSize72||u.isSize100?{content:'""',width:"100%",height:I,backgroundColor:v,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},r[o.HighContrastSelector]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},r)}],f.isBusy&&$t(v),f.isDoNotDisturb&&$t(b),f.isOffline&&$t(y),(R||f.isBlocked)&&[{backgroundColor:x,selectors:(a={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:I+" solid "+v,borderRadius:"50%",boxSizing:"border-box"}},a[o.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},a)}],R&&f.isAvailable&&Tt(I,p),R&&f.isBusy&&Tt(I,v),R&&f.isAway&&Tt(I,C),R&&f.isDoNotDisturb&&Tt(I,b),R&&f.isOffline&&Tt(I,y),R&&f.isOffline&&t.isOutOfOffice&&Tt(I,C)],presenceIcon:[m.presenceIcon,{color:x,fontSize:"6px",lineHeight:Le.size12,verticalAlign:"top",selectors:(s={},s[o.HighContrastSelector]={color:"Window"},s)},u.isSize56&&{fontSize:"8px",lineHeight:Le.size16},u.isSize72&&{fontSize:g.small.fontSize,lineHeight:Le.size20},u.isSize100&&{fontSize:g.medium.fontSize,lineHeight:Le.size28},u.isSize120&&{fontSize:g.medium.fontSize,lineHeight:Le.size32},f.isAway&&{position:"relative",left:R?void 0:"1px"},R&&f.isAvailable&&Et(p),R&&f.isBusy&&Et(v),R&&f.isAway&&Et(C),R&&f.isDoNotDisturb&&Et(b),R&&f.isOffline&&Et(y),R&&f.isOffline&&t.isOutOfOffice&&Et(C)]}};function Et(t){return{color:t,borderColor:t}}function Tt(t,i){return{selectors:{":before":{border:t+" solid "+i}}}}function Pt(t){return{height:t,width:t}}function $t(t){return{backgroundColor:t}}var no=o.styled(Vo,dl,void 0,{scope:"PersonaPresence"}),Ko=[Z.lightBlue,Z.blue,Z.darkBlue,Z.teal,Z.green,Z.darkGreen,Z.lightPink,Z.pink,Z.magenta,Z.purple,Z.orange,Z.lightRed,Z.darkRed,Z.violet,Z.gold,Z.burgundy,Z.warmGray,Z.cyan,Z.rust,Z.coolGray],ul=Ko.length;function gl(t){var i=Z.blue;if(!t)return i;for(var n=0,e=t.length-1;e>=0;e--){var r=t.charCodeAt(e),a=e%8;n^=(r<<a)+(r>>8-a)}return i=Ko[n%ul],i}function hl(t){switch(t){case Z.lightBlue:return"#4F6BED";case Z.blue:return"#0078D4";case Z.darkBlue:return"#004E8C";case Z.teal:return"#038387";case Z.lightGreen:case Z.green:return"#498205";case Z.darkGreen:return"#0B6A0B";case Z.lightPink:return"#C239B3";case Z.pink:return"#E3008C";case Z.magenta:return"#881798";case Z.purple:return"#5C2E91";case Z.orange:return"#CA5010";case Z.red:return"#EE1111";case Z.lightRed:return"#D13438";case Z.darkRed:return"#A4262C";case Z.transparent:return"transparent";case Z.violet:return"#8764B8";case Z.gold:return"#986F0B";case Z.burgundy:return"#750B1C";case Z.warmGray:return"#7A7574";case Z.cyan:return"#005B70";case Z.rust:return"#8E562E";case Z.coolGray:return"#69797E";case Z.black:return"#1D1D1D";case Z.gray:return"#393939"}}function ml(t){var i=t.primaryText,n=t.text,e=t.initialsColor,r;return typeof e=="string"?r=e:(e=e!==void 0?e:gl(n||i),r=hl(e)),r}var Uo=o.classNamesFunction({cacheSize:100}),fl=o.memoizeFunction(function(t,i,n,e,r,a){return o.mergeStyles(t,!a&&{backgroundColor:ml({text:e,initialsColor:i,primaryText:r}),color:n})}),Yo={size:j.size48,presence:nt.none,imageAlt:""};function vl(t){process.env.NODE_ENV!=="production"&&o.useWarnings({name:"PersonaCoin",props:t,deprecations:{primaryText:"text"}})}function pl(t){var i=t.onPhotoLoadingStateChange,n=t.imageUrl,e=h.useState(o.ImageLoadState.notLoaded),r=e[0],a=e[1];h.useEffect(function(){a(o.ImageLoadState.notLoaded)},[n]);var s=function(l){a(l),i==null||i(l)};return[r,s]}var $o=h.forwardRef(function(t,i){var n=o.getPropsWithDefaults(Yo,t);vl(n);var e=pl(n),r=e[0],a=e[1],s=_l(a),l=n.className,c=n.coinProps,d=n.showUnknownPersonaCoin,g=n.coinSize,m=n.styles,u=n.imageUrl,f=n.initialsColor,p=n.initialsTextColor,_=n.isOutOfOffice,v=n.onRenderCoin,b=v===void 0?s:v,y=n.onRenderPersonaCoin,C=y===void 0?b:y,x=n.onRenderInitials,R=x===void 0?io:x,D=n.presence,S=n.presenceTitle,I=n.presenceColors,N=n.primaryText,k=n.showInitialsUntilImageLoads,w=n.text,E=n.theme,P=n.size,T=o.getNativeProps(n,o.divProperties),M=o.getNativeProps(c||{},o.divProperties),L=g?{width:g,height:g}:void 0,B=d,z={coinSize:g,isOutOfOffice:_,presence:D,presenceTitle:S,presenceColors:I,size:P,theme:E},H=Uo(m,{theme:E,className:c&&c.className?c.className:l,size:P,coinSize:g,showUnknownPersonaCoin:d}),O=Boolean(r!==o.ImageLoadState.loaded&&(k&&u||!u||r===o.ImageLoadState.error||B));return h.createElement("div",o.__assign({role:"presentation"},T,{className:H.coin,ref:i}),P!==j.size8&&P!==j.size10&&P!==j.tiny?h.createElement("div",o.__assign({role:"presentation"},M,{className:H.imageArea,style:L}),O&&h.createElement("div",{className:fl(H.initials,f,p,w,N,d),style:L,"aria-hidden":"true"},R(n,io)),!B&&C(n,s),h.createElement(no,o.__assign({},z))):n.presence?h.createElement(no,o.__assign({},z)):h.createElement(o.Icon,{iconName:"Contact",className:H.size10WithoutPresenceIcon}),n.children)});$o.displayName="PersonaCoinBase";var _l=function(t){return function(i){var n=i.coinSize,e=i.styles,r=i.imageUrl,a=i.imageAlt,s=i.imageShouldFadeIn,l=i.imageShouldStartVisible,c=i.theme,d=i.showUnknownPersonaCoin,g=i.size,m=g===void 0?Yo.size:g;if(!r)return null;var u=Uo(e,{theme:c,size:m,showUnknownPersonaCoin:d}),f=n||Wo[m];return h.createElement(o.Image,{className:u.image,imageFit:o.ImageFit.cover,src:r,width:f,height:f,alt:a,shouldFadeIn:s,shouldStartVisible:l,onLoadingStateChange:t})}},io=function(t){var i=t.imageInitials,n=t.allowPhoneInitials,e=t.showUnknownPersonaCoin,r=t.text,a=t.primaryText,s=t.theme;if(e)return h.createElement(o.Icon,{iconName:"Help"});var l=o.getRTL(s);return i=i||Po(r||a||"",l,n),i!==""?h.createElement("span",null,i):h.createElement(o.Icon,{iconName:"Contact"})},bl={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"},yl=function(t){var i,n=t.className,e=t.theme,r=t.coinSize,a=e.palette,s=e.fonts,l=Mn(t.size),c=o.getGlobalClassNames(bl,e),d="rgb(234, 234, 234)",g="rgb(168, 0, 0)",m=r||t.size&&Wo[t.size]||48;return{coin:[c.coin,s.medium,l.isSize8&&c.size8,l.isSize10&&c.size10,l.isSize16&&c.size16,l.isSize24&&c.size24,l.isSize28&&c.size28,l.isSize32&&c.size32,l.isSize40&&c.size40,l.isSize48&&c.size48,l.isSize56&&c.size56,l.isSize72&&c.size72,l.isSize100&&c.size100,l.isSize120&&c.size120,n],size10WithoutPresenceIcon:{fontSize:s.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[c.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:m,width:m},m<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[c.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},m<=10&&{overflow:"visible",background:"transparent",height:0,width:0},m>10&&{height:m,width:m}],initials:[c.initials,{borderRadius:"50%",color:t.showUnknownPersonaCoin?g:a.white,fontSize:s.large.fontSize,fontWeight:o.FontWeights.semibold,lineHeight:m===48?46:m,height:m,selectors:(i={},i[o.HighContrastSelector]=o.__assign(o.__assign({border:"1px solid WindowText"},o.getHighContrastNoAdjustStyle()),{color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"}),i.i={fontWeight:o.FontWeights.semibold},i)},t.showUnknownPersonaCoin&&{backgroundColor:d},m<32&&{fontSize:s.xSmall.fontSize},m>=32&&m<40&&{fontSize:s.medium.fontSize},m>=40&&m<56&&{fontSize:s.mediumPlus.fontSize},m>=56&&m<72&&{fontSize:s.xLarge.fontSize},m>=72&&m<100&&{fontSize:s.xxLarge.fontSize},m>=100&&{fontSize:s.superLarge.fontSize}]}},Cl=o.styled($o,yl,void 0,{scope:"PersonaCoin"}),Sl=o.classNamesFunction(),kl={size:j.size48,presence:nt.none,imageAlt:"",showOverflowTooltip:!0};function Dl(t){process.env.NODE_ENV!=="production"&&o.useWarnings({name:"Persona",props:t,deprecations:{primaryText:"text"}})}var jo=h.forwardRef(function(t,i){var n=o.getPropsWithDefaults(kl,t);Dl(n);var e=h.useRef(null),r=o.useMergedRefs(i,e),a=function(){return n.text||n.primaryText||""},s=function(oe,_e,te){return h.createElement("div",{dir:"auto",className:oe},_e&&_e(n,te))},l=function(oe,_e){return _e===void 0&&(_e=!0),oe?_e?function(){return h.createElement(ne.TooltipHost,{content:oe,overflowMode:ne.TooltipOverflowMode.Parent,directionalHint:o.DirectionalHint.topLeftEdge},oe)}:function(){return h.createElement(h.Fragment,null,oe)}:void 0},c=function(oe){return h.createElement(Cl,o.__assign({},oe))},d=l(a(),n.showOverflowTooltip),g=l(n.secondaryText,n.showOverflowTooltip),m=l(n.tertiaryText,n.showOverflowTooltip),u=l(n.optionalText,n.showOverflowTooltip),f=n.hidePersonaDetails,p=n.onRenderOptionalText,_=p===void 0?u:p,v=n.onRenderPrimaryText,b=v===void 0?d:v,y=n.onRenderSecondaryText,C=y===void 0?g:y,x=n.onRenderTertiaryText,R=x===void 0?m:x,D=n.onRenderPersonaCoin,S=D===void 0?c:D,I=n.size,N=n.allowPhoneInitials,k=n.className,w=n.coinProps,E=n.showUnknownPersonaCoin,P=n.coinSize,T=n.styles,M=n.imageAlt,L=n.imageInitials,B=n.imageShouldFadeIn,z=n.imageShouldStartVisible,H=n.imageUrl,O=n.initialsColor,V=n.initialsTextColor,W=n.isOutOfOffice,G=n.onPhotoLoadingStateChange,A=n.onRenderCoin,F=n.onRenderInitials,Y=n.presence,ee=n.presenceTitle,q=n.presenceColors,he=n.showInitialsUntilImageLoads,ce=n.showSecondaryText,re=n.theme,ye=o.__assign({allowPhoneInitials:N,showUnknownPersonaCoin:E,coinSize:P,imageAlt:M,imageInitials:L,imageShouldFadeIn:B,imageShouldStartVisible:z,imageUrl:H,initialsColor:O,initialsTextColor:V,onPhotoLoadingStateChange:G,onRenderCoin:A,onRenderInitials:F,presence:Y,presenceTitle:ee,showInitialsUntilImageLoads:he,size:I,text:a(),isOutOfOffice:W,presenceColors:q},w),me=Sl(T,{theme:re,className:k,showSecondaryText:ce,presence:Y,size:I}),se=o.getNativeProps(n,o.divProperties),fe=h.createElement("div",{className:me.details},s(me.primaryText,b,d),s(me.secondaryText,C,g),s(me.tertiaryText,R,m),s(me.optionalText,_,u),n.children);return h.createElement("div",o.__assign({},se,{ref:r,className:me.root,style:P?{height:P,minWidth:P}:void 0}),S(ye,S),(!f||I===j.size8||I===j.size10||I===j.tiny)&&fe)});jo.displayName="PersonaBase";var xl={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"},wl=function(t){var i=t.className,n=t.showSecondaryText,e=t.theme,r=e.semanticColors,a=e.fonts,s=o.getGlobalClassNames(xl,e),l=Mn(t.size),c=Go(t.presence),d="16px",g={color:r.bodySubtext,fontWeight:o.FontWeights.regular,fontSize:a.small.fontSize};return{root:[s.root,e.fonts.medium,ne.normalize,{color:r.bodyText,position:"relative",height:be.size48,minWidth:be.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},l.isSize8&&[s.size8,{height:be.size8,minWidth:be.size8}],l.isSize10&&[s.size10,{height:be.size10,minWidth:be.size10}],l.isSize16&&[s.size16,{height:be.size16,minWidth:be.size16}],l.isSize24&&[s.size24,{height:be.size24,minWidth:be.size24}],l.isSize24&&n&&{height:"36px"},l.isSize28&&[s.size28,{height:be.size28,minWidth:be.size28}],l.isSize28&&n&&{height:"32px"},l.isSize32&&[s.size32,{height:be.size32,minWidth:be.size32}],l.isSize40&&[s.size40,{height:be.size40,minWidth:be.size40}],l.isSize48&&s.size48,l.isSize56&&[s.size56,{height:be.size56,minWidth:be.size56}],l.isSize72&&[s.size72,{height:be.size72,minWidth:be.size72}],l.isSize100&&[s.size100,{height:be.size100,minWidth:be.size100}],l.isSize120&&[s.size120,{height:be.size120,minWidth:be.size120}],c.isAvailable&&s.available,c.isAway&&s.away,c.isBlocked&&s.blocked,c.isBusy&&s.busy,c.isDoNotDisturb&&s.doNotDisturb,c.isOffline&&s.offline,i],details:[s.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(l.isSize8||l.isSize10)&&{paddingLeft:17},(l.isSize24||l.isSize28||l.isSize32)&&{padding:"0 8px"},(l.isSize40||l.isSize48)&&{padding:"0 12px"}],primaryText:[s.primaryText,ne.noWrap,{color:r.bodyText,fontWeight:o.FontWeights.regular,fontSize:a.medium.fontSize,selectors:{":hover":{color:r.inputTextHovered}}},n&&{height:d,lineHeight:d,overflowX:"hidden"},(l.isSize8||l.isSize10)&&{fontSize:a.small.fontSize,lineHeight:be.size8},l.isSize16&&{lineHeight:be.size28},(l.isSize24||l.isSize28||l.isSize32||l.isSize40||l.isSize48)&&n&&{height:18},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&{fontSize:a.xLarge.fontSize},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&n&&{height:22}],secondaryText:[s.secondaryText,ne.noWrap,g,(l.isSize8||l.isSize10||l.isSize16||l.isSize24||l.isSize28||l.isSize32)&&{display:"none"},n&&{display:"block",height:d,lineHeight:d,overflowX:"hidden"},l.isSize24&&n&&{height:18},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&{fontSize:a.medium.fontSize},(l.isSize56||l.isSize72||l.isSize100||l.isSize120)&&n&&{height:18}],tertiaryText:[s.tertiaryText,ne.noWrap,g,{display:"none",fontSize:a.medium.fontSize},(l.isSize72||l.isSize100||l.isSize120)&&{display:"block"}],optionalText:[s.optionalText,ne.noWrap,g,{display:"none",fontSize:a.medium.fontSize},(l.isSize100||l.isSize120)&&{display:"block"}],textContent:[s.textContent,ne.noWrap]}},Zo=o.styled(jo,wl,void 0,{scope:"Persona"}),Il="forward",oo="backward",bi=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._inputElement=h.createRef(),e._autoFillEnabled=!0,e._onCompositionStart=function(r){e.setState({isComposing:!0}),e._autoFillEnabled=!1},e._onCompositionUpdate=function(){ne.isIE11()&&e._updateValue(e._getCurrentInputValue(),!0)},e._onCompositionEnd=function(r){var a=e._getCurrentInputValue();e._tryEnableAutofill(a,e.value,!1,!0),e.setState({isComposing:!1}),e._async.setTimeout(function(){e._updateValue(e._getCurrentInputValue(),!1)},0)},e._onClick=function(){e.value&&e.value!==""&&e._autoFillEnabled&&(e._autoFillEnabled=!1)},e._onKeyDown=function(r){if(e.props.onKeyDown&&e.props.onKeyDown(r),!r.nativeEvent.isComposing)switch(r.which){case o.KeyCodes.backspace:e._autoFillEnabled=!1;break;case o.KeyCodes.left:case o.KeyCodes.right:e._autoFillEnabled&&(e.setState({inputValue:e.props.suggestedDisplayValue||""}),e._autoFillEnabled=!1);break;default:e._autoFillEnabled||e.props.enableAutofillOnKeyPress.indexOf(r.which)!==-1&&(e._autoFillEnabled=!0);break}},e._onInputChanged=function(r){var a=e._getCurrentInputValue(r);if(e.state.isComposing||e._tryEnableAutofill(a,e.value,r.nativeEvent.isComposing),!(ne.isIE11()&&e.state.isComposing)){var s=r.nativeEvent.isComposing,l=s===void 0?e.state.isComposing:s;e._updateValue(a,l)}},e._onChanged=function(){},e._updateValue=function(r,a){if(!(!r&&r===e.value)){var s=e.props,l=s.onInputChange,c=s.onInputValueChange;l&&(r=(l==null?void 0:l(r,a))||""),e.setState({inputValue:r},function(){return c==null?void 0:c(r,a)})}},o.initializeComponentRef(e),e._async=new o.Async(e),e.state={inputValue:n.defaultVisibleValue||"",isComposing:!1},e}return i.getDerivedStateFromProps=function(n,e){if(n.updateValueInWillReceiveProps){var r=n.updateValueInWillReceiveProps();if(r!==null&&r!==e.inputValue&&!e.isComposing)return o.__assign(o.__assign({},e),{inputValue:r})}return null},Object.defineProperty(i.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var n=this._inputElement.current;return n.selectionDirection!==Il?n.selectionEnd:n.selectionStart}else return-1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this._getControlledValue()||this.state.inputValue||""},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!1,configurable:!0}),i.prototype.componentDidUpdate=function(n,e,r){var a=this.props,s=a.suggestedDisplayValue,l=a.shouldSelectFullInputValueInComponentDidUpdate,c=a.preventValueSelection,d=0;if(!c)if(this._autoFillEnabled&&this.value&&s&&qo(s,this.value)){var g=!1;if(l&&(g=l()),g&&this._inputElement.current)this._inputElement.current.setSelectionRange(0,s.length,oo);else{for(;d<this.value.length&&this.value[d].toLocaleLowerCase()===s[d].toLocaleLowerCase();)d++;d>0&&this._inputElement.current&&this._inputElement.current.setSelectionRange(d,s.length,oo)}}else this._inputElement.current&&r!==null&&!this._autoFillEnabled&&!this.state.isComposing&&this._inputElement.current.setSelectionRange(r.start,r.end,r.dir)},i.prototype.componentWillUnmount=function(){this._async.dispose()},i.prototype.render=function(){var n=o.getNativeProps(this.props,o.inputProperties),e=o.__assign(o.__assign({},this.props.style),{fontFamily:"inherit"});return h.createElement("input",o.__assign({autoCapitalize:"off",autoComplete:"off","aria-autocomplete":"both"},n,{style:e,ref:this._inputElement,value:this._getDisplayValue(),onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionUpdate,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))},i.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()},i.prototype.clear=function(){this._autoFillEnabled=!0,this._updateValue("",!1),this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)},i.prototype.getSnapshotBeforeUpdate=function(){var n,e,r=this._inputElement.current;return r&&r.selectionStart!==this.value.length?{start:(n=r.selectionStart)!==null&&n!==void 0?n:r.value.length,end:(e=r.selectionEnd)!==null&&e!==void 0?e:r.value.length,dir:r.selectionDirection||"backward"}:null},i.prototype._getCurrentInputValue=function(n){return n&&n.target&&n.target.value?n.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""},i.prototype._tryEnableAutofill=function(n,e,r,a){!r&&n&&this._inputElement.current&&this._inputElement.current.selectionStart===n.length&&!this._autoFillEnabled&&(n.length>e.length||a)&&(this._autoFillEnabled=!0)},i.prototype._getDisplayValue=function(){return this._autoFillEnabled?Rl(this.value,this.props.suggestedDisplayValue):this.value},i.prototype._getControlledValue=function(){var n=this.props.value;return n===void 0||typeof n=="string"?n:(console.warn("props.value of Autofill should be a string, but it is "+n+" with type of "+typeof n),n.toString())},i.defaultProps={enableAutofillOnKeyPress:[o.KeyCodes.down,o.KeyCodes.up]},i}(h.Component);function Rl(t,i){var n=t;return i&&t&&qo(i,n)&&(n=i),n}function qo(t,i){if(!t||!i)return!1;if(process.env.NODE_ENV!=="production")for(var n=0,e=[t,i];n<e.length;n++){var r=e[n];if(typeof r!="string")throw new Error(bi.name+' received non-string value "'+r+'" of type '+typeof r+" from either input's value or suggestedDisplayValue")}return t.toLocaleLowerCase().indexOf(i.toLocaleLowerCase())===0}var Nl=o.classNamesFunction(),El=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i.prototype.render=function(){var n=this.props,e=n.message,r=n.styles,a=n.as,s=a===void 0?"div":a,l=n.className,c=Nl(r,{className:l});return h.createElement(s,o.__assign({role:"status",className:c.root},o.getNativeProps(this.props,o.divProperties,["className"])),h.createElement(ne.DelayedRender,null,h.createElement("div",{className:c.screenReaderText},e)))},i.defaultProps={"aria-live":"polite"},i}(h.Component),Tl=function(t){return{root:t.className,screenReaderText:o.hiddenContentStyle}},Pl=o.styled(El,Tl),Al="40px",Fl="0 4px",Hl=o.memoizeFunction(function(t,i){var n,e,r,a=o.getStyles(t),s={root:{padding:Fl,height:Al,color:t.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent",selectors:(n={},n[o.HighContrastSelector]={borderColor:"Window"},n)},rootHovered:{color:t.palette.themePrimary,selectors:(e={},e[o.HighContrastSelector]={color:"Highlight"},e)},iconHovered:{color:t.palette.themePrimary},rootPressed:{color:t.palette.black},rootExpanded:{color:t.palette.themePrimary},iconPressed:{color:t.palette.themeDarker},rootDisabled:{color:t.palette.neutralTertiary,backgroundColor:"transparent",borderColor:"transparent",selectors:(r={},r[o.HighContrastSelector]={color:"GrayText"},r)},rootChecked:{color:t.palette.black},iconChecked:{color:t.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:t.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:t.palette.neutralSecondary},textContainer:{flexGrow:0}};return o.concatStyleSets(a,s,i)}),Ml=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i.prototype.render=function(){var n=this.props,e=n.styles,r=n.theme;return h.createElement(o.BaseButton,o.__assign({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Hl(r,e),onRenderDescription:o.nullRender}))},i=o.__decorate([o.customizable("ActionButton",["theme","styles"],!0)],i),i}(h.Component),En=Ml,Ue;(function(t){t[t.Sunday=0]="Sunday",t[t.Monday=1]="Monday",t[t.Tuesday=2]="Tuesday",t[t.Wednesday=3]="Wednesday",t[t.Thursday=4]="Thursday",t[t.Friday=5]="Friday",t[t.Saturday=6]="Saturday"})(Ue||(Ue={}));var gi;(function(t){t[t.January=0]="January",t[t.February=1]="February",t[t.March=2]="March",t[t.April=3]="April",t[t.May=4]="May",t[t.June=5]="June",t[t.July=6]="July",t[t.August=7]="August",t[t.September=8]="September",t[t.October=9]="October",t[t.November=10]="November",t[t.December=11]="December"})(gi||(gi={}));var Ot;(function(t){t[t.FirstDay=0]="FirstDay",t[t.FirstFullWeek=1]="FirstFullWeek",t[t.FirstFourDayWeek=2]="FirstFourDayWeek"})(Ot||(Ot={}));var ze;(function(t){t[t.Day=0]="Day",t[t.Week=1]="Week",t[t.Month=2]="Month",t[t.WorkWeek=3]="WorkWeek"})(ze||(ze={}));var on=7,Ce={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12,HoursInOneDay:24,SecondsInOneMinute:60,OffsetTo24HourFormat:12,TimeFormatRegex:/^(\d\d?):(\d\d):?(\d\d)? ?([ap]m)?/i};function ot(t,i){var n=new Date(t.getTime());return n.setDate(n.getDate()+i),n}function ro(t,i){return ot(t,i*Ce.DaysInOneWeek)}function yt(t,i){var n=new Date(t.getTime()),e=n.getMonth()+i;return n.setMonth(e),n.getMonth()!==(e%Ce.MonthInOneYear+Ce.MonthInOneYear)%Ce.MonthInOneYear&&(n=ot(n,-n.getDate())),n}function Ft(t,i){var n=new Date(t.getTime());return n.setFullYear(t.getFullYear()+i),n.getMonth()!==(t.getMonth()%Ce.MonthInOneYear+Ce.MonthInOneYear)%Ce.MonthInOneYear&&(n=ot(n,-n.getDate())),n}function Xo(t){return new Date(t.getFullYear(),t.getMonth(),1,0,0,0,0)}function Jo(t){return new Date(t.getFullYear(),t.getMonth()+1,0,0,0,0,0)}function Ll(t){return new Date(t.getFullYear(),0,1,0,0,0,0)}function zl(t){return new Date(t.getFullYear()+1,0,0,0,0,0,0)}function mn(t,i){return yt(t,i-t.getMonth())}function kt(t,i){return!t&&!i?!0:!t||!i?!1:t.getFullYear()===i.getFullYear()&&t.getMonth()===i.getMonth()&&t.getDate()===i.getDate()}function Xe(t,i){return qt(t)-qt(i)}function Tn(t,i,n,e,r){r===void 0&&(r=1);var a=[],s,l=null;switch(e||(e=[Ue.Monday,Ue.Tuesday,Ue.Wednesday,Ue.Thursday,Ue.Friday]),r=Math.max(r,1),i){case ze.Day:s=ao(t),l=ot(s,r);break;case ze.Week:case ze.WorkWeek:s=Gl(ao(t),n),l=ot(s,Ce.DaysInOneWeek);break;case ze.Month:s=new Date(t.getFullYear(),t.getMonth(),1),l=yt(s,1);break;default:throw new Error("Unexpected object: "+i)}var c=s;do(i!==ze.WorkWeek||e.indexOf(c.getDay())!==-1)&&a.push(c),c=ot(c,1);while(!kt(c,l));return a}function Bl(t,i){for(var n=0,e=i;n<e.length;n++){var r=e[n];if(kt(t,r))return!0}return!1}function Ol(t,i,n,e){var r=e.getFullYear(),a=e.getMonth(),s=1,l=new Date(r,a,s),c=s+(i+Ce.DaysInOneWeek-1)-Kl(i,l.getDay()),d=new Date(r,a,c);s=d.getDate();for(var g=[],m=0;m<t;m++)g.push(Wl(d,i,n)),s+=Ce.DaysInOneWeek,d=new Date(r,a,s);return g}function Wl(t,i,n){var e=4;switch(n){case Ot.FirstFullWeek:return so(t,i,Ce.DaysInOneWeek);case Ot.FirstFourDayWeek:return so(t,i,e);default:return Vl(t,i)}}function Gl(t,i){var n=i-t.getDay();return n>0&&(n-=Ce.DaysInOneWeek),ot(t,n)}function ao(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function qt(t){return t.getDate()+(t.getMonth()<<5)+(t.getFullYear()<<9)}function so(t,i,n){var e=hi(t)-1,r=t.getDay()-e%Ce.DaysInOneWeek,a=new Date(t.getFullYear()-1,gi.December,31),s=hi(a)-1,l=(i-r+2*Ce.DaysInOneWeek)%Ce.DaysInOneWeek;l!==0&&l>=n&&(l-=Ce.DaysInOneWeek);var c=e-l;return c<0&&(r-=s%Ce.DaysInOneWeek,l=(i-r+2*Ce.DaysInOneWeek)%Ce.DaysInOneWeek,l!==0&&l+1>=n&&(l-=Ce.DaysInOneWeek),c=s-l),Math.floor(c/Ce.DaysInOneWeek+1)}function Vl(t,i){var n=hi(t)-1,e=t.getDay()-n%Ce.DaysInOneWeek,r=(e-i+2*Ce.DaysInOneWeek)%Ce.DaysInOneWeek;return Math.floor((n+r)/Ce.DaysInOneWeek+1)}function Kl(t,i){return t!==Ue.Sunday&&i<t?i+Ce.DaysInOneWeek:i}function hi(t){for(var i=t.getMonth(),n=t.getFullYear(),e=0,r=0;r<i;r++)e+=Ul(r+1,n);return e+=t.getDate(),e}function Ul(t,i){return new Date(i,t,0).getDate()}var Yl=function(t){return t.getDate().toString()},$l=function(t,i){return i.months[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()},jl=function(t,i){return i.months[t.getMonth()]+" "+t.getFullYear()},Zl=function(t,i){return i.months[t.getMonth()]},ql=function(t){return t.getFullYear().toString()},Xl={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"]},Qo={formatDay:Yl,formatMonth:Zl,formatYear:ql,formatMonthDayYear:$l,formatMonthYear:jl},er=o.__assign(o.__assign({},Xl),{goToToday:"Go to today",weekNumberFormatString:"Week number {0}",prevMonthAriaLabel:"Previous month",nextMonthAriaLabel:"Next month",prevYearAriaLabel:"Previous year",nextYearAriaLabel:"Next year",prevYearRangeAriaLabel:"Previous year range",nextYearRangeAriaLabel:"Next year range",closeButtonAriaLabel:"Close",selectedDateFormatString:"Selected date {0}",todayDateFormatString:"Today's date {0}",monthPickerHeaderAriaLabel:"{0}, change year",yearPickerHeaderAriaLabel:"{0}, change month",dayMarkedAriaLabel:"marked"}),tr=function(t,i){var n=i.minDate;return n?Xe(n,t)>=1:!1},nr=function(t,i){var n=i.maxDate;return n?Xe(t,n)>=1:!1},Xt=function(t,i){var n=i.restrictedDates,e=i.minDate,r=i.maxDate;if(!n&&!e&&!r)return!1;var a=n&&n.some(function(s){return kt(s,t)});return a||tr(t,i)||nr(t,i)},lo=function(t){var i=t.targetDate,n=t.initialDate,e=t.direction,r=o.__rest(t,["targetDate","initialDate","direction"]),a=i;if(!Xt(i,r))return i;for(;Xe(n,a)!==0&&Xt(a,r)&&!nr(a,r)&&!tr(a,r);)a=ot(a,e);if(Xe(n,a)!==0&&!Xt(a,r))return a},ir=function(t,i,n){var e=o.__spreadArray([],t);return i&&(e=e.filter(function(r){return Xe(r,i)>=0})),n&&(e=e.filter(function(r){return Xe(r,n)<=0})),e},Jl=function(t,i,n){for(var e=new Set(t),r=0,a=0,s=t;a<s.length;a++){var l=s[a],c=(l+1)%7;e.has(c)&&(!i||n!==c)||r++}return r<2},Ql=function(t,i,n){return i&&t===ze.WorkWeek&&(!Jl(i,!0,n)||i.length===0)?ze.Week:t},ec=function(t){var i=t.selectedDate,n=t.dateRangeType,e=t.firstDayOfWeek,r=t.today,a=t.minDate,s=t.maxDate,l=t.weeksToShow,c=t.workWeekDays,d=t.daysToSelectInDayView,g=t.restrictedDates,m=t.markedDays,u={minDate:a,maxDate:s,restrictedDates:g},f=r||new Date,p=t.navigatedDate?t.navigatedDate:f,_;l&&l<=4?_=new Date(p.getFullYear(),p.getMonth(),p.getDate()):_=new Date(p.getFullYear(),p.getMonth(),1);for(var v=[];_.getDay()!==e;)_.setDate(_.getDate()-1);_=ot(_,-on);var b=!1,y=Ql(n,c,e),C=[];i&&(C=Tn(i,y,e,c,d),C=ir(C,a,s));for(var x=!0,R=0;x;R++){var D=[];b=!0;for(var S=function(N){var k=new Date(_.getTime()),w={key:_.toString(),date:_.getDate().toString(),originalDate:k,isInMonth:_.getMonth()===p.getMonth(),isToday:kt(f,_),isSelected:Bl(_,C),isInBounds:!Xt(_,u),isMarked:(m==null?void 0:m.some(function(E){return kt(k,E)}))||!1};D.push(w),w.isInMonth&&(b=!1),_.setDate(_.getDate()+1)},I=0;I<on;I++)S(I);x=l?R<l+1:!b||R===0,v.push(D)}return v},tc=function(t){var i=t.showWeekNumbers,n=t.strings,e=t.firstDayOfWeek,r=t.allFocusable,a=t.weeksToShow,s=t.weeks,l=t.classNames,c=n.shortDays.slice(),d=o.findIndex(s[1],function(m){return m.originalDate.getDate()===1});if(a===1&&d>=0){var g=(d+e)%on;c[g]=n.shortMonths[s[1][d].originalDate.getMonth()]}return h.createElement("tr",null,i&&h.createElement("th",{className:l.dayCell}),c.map(function(m,u){var f=(u+e)%on,p=u===d?n.days[f]+" "+c[f]:n.days[f];return h.createElement("th",{className:o.css(l.dayCell,l.weekDayLabelCell),scope:"col",key:c[f]+" "+u,title:p,"aria-label":p,"data-is-focusable":r?!0:void 0},c[f])}))},nc=function(t){var i,n=t.navigatedDate,e=t.dateTimeFormatter,r=t.allFocusable,a=t.strings,s=t.activeDescendantId,l=t.navigatedDayRef,c=t.calculateRoundedStyles,d=t.weeks,g=t.classNames,m=t.day,u=t.dayIndex,f=t.weekIndex,p=t.weekCorners,_=t.ariaHidden,v=t.customDayCellRef,b=t.dateRangeType,y=t.daysToSelectInDayView,C=t.onSelectDate,x=t.restrictedDates,R=t.minDate,D=t.maxDate,S=t.onNavigateDate,I=t.getDayInfosInRangeOfDay,N=t.getRefsFromDayInfos,k=(i=p==null?void 0:p[f+"_"+u])!==null&&i!==void 0?i:"",w=kt(n,m.originalDate),E=function(H,O){var V=void 0,W=1;if(H.which===o.KeyCodes.up?(V=ro(O,-1),W=-1):H.which===o.KeyCodes.down?V=ro(O,1):H.which===o.getRTLSafeKeyCode(o.KeyCodes.left)?(V=ot(O,-1),W=-1):H.which===o.getRTLSafeKeyCode(o.KeyCodes.right)&&(V=ot(O,1)),!!V){var G={initialDate:O,targetDate:V,direction:W,restrictedDates:x,minDate:R,maxDate:D},A=lo(G);A||(G.direction=-W,A=lo(G));var F=d&&A&&d.slice(1,d.length-1).some(function(Y){return Y.some(function(ee){return kt(ee.originalDate,A)})});F||A&&(S(A,!0),H.preventDefault())}},P=function(H){var O=I(m),V=N(O);V.forEach(function(W,G){var A;if(W&&(W.classList.add("ms-CalendarDay-hoverStyle"),!O[G].isSelected&&b===ze.Day&&y&&y>1)){W.classList.remove(g.bottomLeftCornerDate,g.bottomRightCornerDate,g.topLeftCornerDate,g.topRightCornerDate);var F=c(g,!1,!1,G>0,G<V.length-1).trim();F&&(A=W.classList).add.apply(A,F.split(" "))}})},T=function(H){var O=I(m),V=N(O);V.forEach(function(W){W&&W.classList.add("ms-CalendarDay-pressedStyle")})},M=function(H){var O=I(m),V=N(O);V.forEach(function(W){W&&W.classList.remove("ms-CalendarDay-pressedStyle")})},L=function(H){var O=I(m),V=N(O);V.forEach(function(W,G){var A;if(W&&(W.classList.remove("ms-CalendarDay-hoverStyle"),W.classList.remove("ms-CalendarDay-pressedStyle"),!O[G].isSelected&&b===ze.Day&&y&&y>1)){var F=c(g,!1,!1,G>0,G<V.length-1).trim();F&&(A=W.classList).remove.apply(A,F.split(" "))}})},B=function(H){H.which===o.KeyCodes.enter?C==null||C(m.originalDate):E(H,m.originalDate)},z=m.originalDate.getDate()+", "+a.months[m.originalDate.getMonth()]+", "+m.originalDate.getFullYear();return m.isMarked&&(z=z+", "+a.dayMarkedAriaLabel),h.createElement("td",{className:o.css(g.dayCell,p&&k,m.isSelected&&g.daySelected,m.isSelected&&"ms-CalendarDay-daySelected",!m.isInBounds&&g.dayOutsideBounds,!m.isInMonth&&g.dayOutsideNavigatedMonth),ref:function(H){v==null||v(H,m.originalDate,g),m.setRef(H),w&&(l.current=H)},"aria-hidden":_,"aria-disabled":!_&&!m.isInBounds,onClick:m.isInBounds&&!_?m.onSelected:void 0,onMouseOver:_?void 0:P,onMouseDown:_?void 0:T,onMouseUp:_?void 0:M,onMouseOut:_?void 0:L,onKeyDown:_?void 0:B,role:"gridcell",tabIndex:w?0:void 0,"aria-current":m.isSelected?"date":void 0,"aria-selected":m.isInBounds?m.isSelected:void 0,"data-is-focusable":!_&&(r||(m.isInBounds?!0:void 0))},h.createElement("button",{key:m.key+"button","aria-hidden":_,className:o.css(g.dayButton,m.isToday&&g.dayIsToday,m.isToday&&"ms-CalendarDay-dayIsToday"),"aria-label":z,id:w?s:void 0,disabled:!_&&!m.isInBounds,type:"button",tabIndex:-1,"data-is-focusable":"false"},h.createElement("span",{"aria-hidden":"true"},e.formatDay(m.originalDate)),m.isMarked&&h.createElement("div",{"aria-hidden":"true",className:g.dayMarker})))},jn=function(t){var i=t.classNames,n=t.week,e=t.weeks,r=t.weekIndex,a=t.rowClassName,s=t.ariaRole,l=t.showWeekNumbers,c=t.firstDayOfWeek,d=t.firstWeekOfYear,g=t.navigatedDate,m=t.strings,u=l?Ol(e.length,c,d,g):null,f=u?m.weekNumberFormatString&&St(m.weekNumberFormatString,u[r]):"";return h.createElement("tr",{role:s,className:a,key:r+"_"+n[0].key},l&&u&&h.createElement("th",{className:i.weekNumberCell,key:r,title:f,"aria-label":f,scope:"row"},h.createElement("span",null,u[r])),n.map(function(p,_){return h.createElement(nc,o.__assign({},t,{key:p.key,day:p,dayIndex:_}))}))},ic=o.classNamesFunction();function oc(){var t=h.useRef({}),i=function(n){return function(e){e===null?delete t.current[n]:t.current[n]=e}};return[t,i]}function rc(t,i,n){var e=h.useMemo(function(){for(var r,a=ec(t),s=a[1][0].originalDate,l=a[a.length-1][6].originalDate,c=((r=t.getMarkedDays)===null||r===void 0?void 0:r.call(t,s,l))||[],d=[],g=0;g<a.length;g++){for(var m=[],u=function(p){var _=a[g][p],v=o.__assign(o.__assign({onSelected:function(){return i(_.originalDate)},setRef:n(_.key)},_),{isMarked:_.isMarked||(c==null?void 0:c.some(function(b){return kt(_.originalDate,b)}))});m.push(v)},f=0;f<on;f++)u(f);d.push(m)}return d},[t]);return e}function ac(t){var i=o.usePrevious(t[0][0].originalDate);if(!(!i||i.getTime()===t[0][0].originalDate.getTime()))return!(i<=t[0][0].originalDate)}function sc(t){var i=function(a,s){var l={},c=s.slice(1,s.length-1);return c.forEach(function(d,g){d.forEach(function(m,u){var f=c[g-1]&&c[g-1][u]&&r(c[g-1][u].originalDate,m.originalDate,c[g-1][u].isSelected,m.isSelected),p=c[g+1]&&c[g+1][u]&&r(c[g+1][u].originalDate,m.originalDate,c[g+1][u].isSelected,m.isSelected),_=c[g][u-1]&&r(c[g][u-1].originalDate,m.originalDate,c[g][u-1].isSelected,m.isSelected),v=c[g][u+1]&&r(c[g][u+1].originalDate,m.originalDate,c[g][u+1].isSelected,m.isSelected),b=[];b.push(n(a,f,p,_,v)),b.push(e(a,f,p,_,v)),l[g+"_"+u]=b.join(" ")})}),l},n=function(a,s,l,c,d){var g=[],m=!s&&!c,u=!s&&!d,f=!l&&!c,p=!l&&!d;return m&&g.push(o.getRTL()?a.topRightCornerDate:a.topLeftCornerDate),u&&g.push(o.getRTL()?a.topLeftCornerDate:a.topRightCornerDate),f&&g.push(o.getRTL()?a.bottomRightCornerDate:a.bottomLeftCornerDate),p&&g.push(o.getRTL()?a.bottomLeftCornerDate:a.bottomRightCornerDate),g.join(" ")},e=function(a,s,l,c,d){var g=[];return s||g.push(a.datesAbove),l||g.push(a.datesBelow),c||g.push(o.getRTL()?a.datesRight:a.datesLeft),d||g.push(o.getRTL()?a.datesLeft:a.datesRight),g.join(" ")},r=function(a,s,l,c){var d=t.dateRangeType,g=t.firstDayOfWeek,m=t.workWeekDays,u=d===ze.WorkWeek?ze.Week:d,f=Tn(a,u,g,m);return l!==c?!1:l&&c?!0:f.filter(function(p){return p.getTime()===s.getTime()}).length>0};return[i,n]}var or=function(t){var i=h.useRef(null),n=o.useId(),e=function(N){var k,w,E=t.firstDayOfWeek,P=t.minDate,T=t.maxDate,M=t.workWeekDays,L=t.daysToSelectInDayView,B=t.restrictedDates,z={minDate:P,maxDate:T,restrictedDates:B},H=Tn(N,b,E,M,L);H=ir(H,P,T),H=H.filter(function(O){return!Xt(O,z)}),(k=t.onSelectDate)===null||k===void 0||k.call(t,N,H),(w=t.onNavigateDate)===null||w===void 0||w.call(t,N,!0)},r=oc(),a=r[0],s=r[1],l=rc(t,e,s),c=ac(l),d=sc(t),g=d[0],m=d[1];h.useImperativeHandle(t.componentRef,function(){return{focus:function(){var N,k;(k=(N=i.current)===null||N===void 0?void 0:N.focus)===null||k===void 0||k.call(N)}}},[]);var u=function(N){var k=lc(t.dateRangeType,t.workWeekDays),w=Tn(N.originalDate,k,t.firstDayOfWeek,t.workWeekDays,t.daysToSelectInDayView).map(function(P){return P.getTime()}),E=l.reduce(function(P,T){return P.concat(T.filter(function(M){return w.indexOf(M.originalDate.getTime())!==-1}))},[]);return E},f=function(N){var k=[];return k=N.map(function(w){return a.current[w.key]}),k},p=t.styles,_=t.theme,v=t.className,b=t.dateRangeType,y=t.showWeekNumbers,C=t.labelledBy,x=t.lightenDaysOutsideNavigatedMonth,R=t.animationDirection,D=ic(p,{theme:_,className:v,dateRangeType:b,showWeekNumbers:y,lightenDaysOutsideNavigatedMonth:x===void 0?!0:x,animationDirection:R,animateBackwards:c}),S=g(D,l),I={weeks:l,navigatedDayRef:i,calculateRoundedStyles:m,activeDescendantId:n,classNames:D,weekCorners:S,getDayInfosInRangeOfDay:u,getRefsFromDayInfos:f};return h.createElement(o.FocusZone,{className:D.wrapper},h.createElement("table",{className:D.table,"aria-multiselectable":"false","aria-labelledby":C,"aria-activedescendant":n,role:"grid"},h.createElement("tbody",null,h.createElement(tc,o.__assign({},t,{classNames:D,weeks:l})),h.createElement(jn,o.__assign({},t,I,{week:l[0],weekIndex:-1,rowClassName:D.firstTransitionWeek,ariaRole:"presentation",ariaHidden:!0})),l.slice(1,l.length-1).map(function(N,k){return h.createElement(jn,o.__assign({},t,I,{key:k,week:N,weekIndex:k,rowClassName:D.weekRow}))}),h.createElement(jn,o.__assign({},t,I,{week:l[l.length-1],weekIndex:-2,rowClassName:D.lastTransitionWeek,ariaRole:"presentation",ariaHidden:!0})))))};or.displayName="CalendarDayGridBase";function lc(t,i){if(i&&t===ze.WorkWeek){for(var n=i.slice().sort(),e=!0,r=1;r<n.length;r++)if(n[r]!==n[r-1]+1){e=!1;break}if(!e||i.length===0)return ze.Week}return t}var rn;(function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"})(rn||(rn={}));var cc={hoverStyle:"ms-CalendarDay-hoverStyle",pressedStyle:"ms-CalendarDay-pressedStyle",dayIsTodayStyle:"ms-CalendarDay-dayIsToday",daySelectedStyle:"ms-CalendarDay-daySelected"},co=o.keyframes({"100%":{width:0,height:0,overflow:"hidden"},"99.9%":{width:"100%",height:28,overflow:"visible"},"0%":{width:"100%",height:28,overflow:"visible"}}),dc=function(t){var i,n,e,r,a,s,l,c,d,g,m=t.theme,u=t.dateRangeType,f=t.showWeekNumbers,p=t.lightenDaysOutsideNavigatedMonth,_=t.animateBackwards,v=t.animationDirection,b=m.palette,y=o.getGlobalClassNames(cc,m),C={};_!==void 0&&(v===rn.Horizontal?C=_?o.AnimationStyles.slideRightIn20:o.AnimationStyles.slideLeftIn20:C=_?o.AnimationStyles.slideDownIn20:o.AnimationStyles.slideUpIn20);var x={},R={};_!==void 0&&v!==rn.Horizontal&&(x=_?{animationName:""}:o.AnimationStyles.slideUpOut20,R=_?o.AnimationStyles.slideDownOut20:{animationName:""});var D={selectors:{"&, &:disabled, & button":{color:b.neutralTertiaryAlt,pointerEvents:"none"}}};return{wrapper:{paddingBottom:10},table:[{textAlign:"center",borderCollapse:"collapse",borderSpacing:"0",tableLayout:"fixed",fontSize:"inherit",marginTop:4,width:196,position:"relative",paddingBottom:10},f&&{width:226}],dayCell:{margin:0,padding:0,width:28,height:28,lineHeight:28,fontSize:o.FontSizes.small,fontWeight:o.FontWeights.regular,color:b.neutralPrimary,cursor:"pointer",position:"relative",selectors:(i={},i[o.HighContrastSelector]=o.__assign({color:"WindowText",backgroundColor:"Window",zIndex:0},o.getHighContrastNoAdjustStyle()),i["&."+y.hoverStyle]={backgroundColor:b.neutralLighter,selectors:(n={},n[o.HighContrastSelector]={zIndex:3,backgroundColor:"Window",outline:"1px solid Highlight"},n)},i["&."+y.pressedStyle]={backgroundColor:b.neutralLight,selectors:(e={},e[o.HighContrastSelector]={borderColor:"Highlight",color:"Highlight",backgroundColor:"Window"},e)},i["&."+y.pressedStyle+"."+y.hoverStyle]={selectors:(r={},r[o.HighContrastSelector]={backgroundColor:"Window",outline:"1px solid Highlight"},r)},i)},daySelected:[u!==ze.Month&&{backgroundColor:b.neutralLight+"!important",selectors:(a={"&:after":{content:'""',position:"absolute",top:0,bottom:0,left:0,right:0}},a["&:hover, &."+y.hoverStyle+", &."+y.pressedStyle]=(s={backgroundColor:b.neutralLight+"!important"},s[o.HighContrastSelector]={color:"HighlightText!important",background:"Highlight!important"},s),a[o.HighContrastSelector]=o.__assign({background:"Highlight!important",color:"HighlightText!important",borderColor:"Highlight!important"},o.getHighContrastNoAdjustStyle()),a)}],weekRow:C,weekDayLabelCell:o.AnimationStyles.fadeIn200,weekNumberCell:{margin:0,padding:0,borderRight:"1px solid",borderColor:b.neutralLight,backgroundColor:b.neutralLighterAlt,color:b.neutralSecondary,boxSizing:"border-box",width:28,height:28,fontWeight:o.FontWeights.regular,fontSize:o.FontSizes.small},dayOutsideBounds:D,dayOutsideNavigatedMonth:p&&{color:b.neutralSecondary,fontWeight:o.FontWeights.regular},dayButton:[o.getFocusStyle(m,{inset:-3}),{width:24,height:24,lineHeight:24,fontSize:o.FontSizes.small,fontWeight:"inherit",borderRadius:2,border:"none",padding:0,color:"inherit",backgroundColor:"transparent",cursor:"pointer",overflow:"visible",selectors:{span:{height:"inherit",lineHeight:"inherit"}}}],dayIsToday:{backgroundColor:b.themePrimary+"!important",borderRadius:"100%",color:b.white+"!important",fontWeight:o.FontWeights.semibold+"!important",selectors:(l={},l[o.HighContrastSelector]=o.__assign({background:"WindowText!important",color:"Window!important",borderColor:"WindowText!important"},o.getHighContrastNoAdjustStyle()),l)},firstTransitionWeek:o.__assign(o.__assign({position:"absolute",opacity:0,width:0,height:0,overflow:"hidden"},x),{animationName:x.animationName+","+co}),lastTransitionWeek:o.__assign(o.__assign({position:"absolute",opacity:0,width:0,height:0,overflow:"hidden",marginTop:-28},R),{animationName:R.animationName+","+co}),dayMarker:{width:4,height:4,backgroundColor:b.neutralSecondary,borderRadius:"100%",bottom:1,left:0,right:0,position:"absolute",margin:"auto",selectors:(c={},c["."+y.dayIsTodayStyle+" &"]={backgroundColor:b.white,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"Window"},d)},c["."+y.daySelectedStyle+" &"]={selectors:(g={},g[o.HighContrastSelector]={backgroundColor:"HighlightText"},g)},c[o.HighContrastSelector]=o.__assign({backgroundColor:"WindowText"},o.getHighContrastNoAdjustStyle()),c)},topRightCornerDate:{borderTopRightRadius:"2px"},topLeftCornerDate:{borderTopLeftRadius:"2px"},bottomRightCornerDate:{borderBottomRightRadius:"2px"},bottomLeftCornerDate:{borderBottomLeftRadius:"2px"},datesAbove:{"&:after":{borderTop:"1px solid "+b.neutralSecondary}},datesBelow:{"&:after":{borderBottom:"1px solid "+b.neutralSecondary}},datesLeft:{"&:after":{borderLeft:"1px solid "+b.neutralSecondary}},datesRight:{"&:after":{borderRight:"1px solid "+b.neutralSecondary}}}},uc=o.styled(or,dc,void 0,{scope:"CalendarDayGrid"}),gc=o.classNamesFunction(),rr=function(t){var i=h.useRef(null);h.useImperativeHandle(t.componentRef,function(){return{focus:function(){var D,S;(S=(D=i.current)===null||D===void 0?void 0:D.focus)===null||S===void 0||S.call(D)}}},[]);var n=t.strings,e=t.navigatedDate,r=t.dateTimeFormatter,a=t.styles,s=t.theme,l=t.className,c=t.onHeaderSelect,d=t.showSixWeeksByDefault,g=t.minDate,m=t.maxDate,u=t.restrictedDates,f=t.onNavigateDate,p=t.showWeekNumbers,_=t.dateRangeType,v=t.animationDirection,b=o.useId(),y=gc(a,{theme:s,className:l,headerIsClickable:!!c,showWeekNumbers:p,animationDirection:v}),C=r.formatMonthYear(e,n),x=c?"button":"div",R=n.yearPickerHeaderAriaLabel?St(n.yearPickerHeaderAriaLabel,C):C;return h.createElement("div",{className:y.root},h.createElement("div",{className:y.header},h.createElement(x,{"aria-live":"polite","aria-atomic":"true","aria-label":c?R:void 0,key:C,className:y.monthAndYear,onClick:c,"data-is-focusable":!!c,tabIndex:c?0:-1,onKeyDown:xn(c),type:"button"},h.createElement("span",{id:b},C)),h.createElement(ar,o.__assign({},t,{classNames:y}))),h.createElement(uc,o.__assign({},t,{styles:a,componentRef:i,strings:n,navigatedDate:e,weeksToShow:d?6:void 0,dateTimeFormatter:r,minDate:g,maxDate:m,restrictedDates:u,onNavigateDate:f,labelledBy:b,dateRangeType:_})))};rr.displayName="CalendarDayBase";var ar=function(t){var i,n,e=t.minDate,r=t.maxDate,a=t.navigatedDate,s=t.allFocusable,l=t.strings,c=t.navigationIcons,d=t.showCloseButton,g=t.classNames,m=t.onNavigateDate,u=t.onDismiss,f=function(){m(yt(a,1),!1)},p=function(){m(yt(a,-1),!1)},_=c.leftNavigation,v=c.rightNavigation,b=c.closeIcon,y=e?Xe(e,Xo(a))<0:!0,C=r?Xe(Jo(a),r)<0:!0;return h.createElement("div",{className:g.monthComponents},h.createElement("button",{className:o.css(g.headerIconButton,(i={},i[g.disabledStyle]=!y,i)),tabIndex:y?void 0:s?0:-1,"aria-disabled":!y,onClick:y?p:void 0,onKeyDown:y?xn(p):void 0,title:l.prevMonthAriaLabel?l.prevMonthAriaLabel+" "+l.months[yt(a,-1).getMonth()]:void 0,type:"button"},h.createElement(o.Icon,{iconName:_})),h.createElement("button",{className:o.css(g.headerIconButton,(n={},n[g.disabledStyle]=!C,n)),tabIndex:C?void 0:s?0:-1,"aria-disabled":!C,onClick:C?f:void 0,onKeyDown:C?xn(f):void 0,title:l.nextMonthAriaLabel?l.nextMonthAriaLabel+" "+l.months[yt(a,1).getMonth()]:void 0,type:"button"},h.createElement(o.Icon,{iconName:v})),d&&h.createElement("button",{className:o.css(g.headerIconButton),onClick:u,onKeyDown:xn(u),title:l.closeButtonAriaLabel,type:"button"},h.createElement(o.Icon,{iconName:b})))};ar.displayName="CalendarDayNavigationButtons";var xn=function(t){return function(i){switch(i.which){case o.KeyCodes.enter:t==null||t();break}}},hc=function(t){var i,n=t.className,e=t.theme,r=t.headerIsClickable,a=t.showWeekNumbers,s=e.palette,l={selectors:(i={"&, &:disabled, & button":{color:s.neutralTertiaryAlt,pointerEvents:"none"}},i[o.HighContrastSelector]={color:"GrayText",forcedColorAdjust:"none"},i)};return{root:[ne.normalize,{width:196,padding:12,boxSizing:"content-box"},a&&{width:226},n],header:{position:"relative",display:"inline-flex",height:28,lineHeight:44,width:"100%"},monthAndYear:[o.getFocusStyle(e,{inset:1}),o.__assign(o.__assign({},o.AnimationStyles.fadeIn200),{alignItems:"center",fontSize:o.FontSizes.medium,fontFamily:"inherit",color:s.neutralPrimary,display:"inline-block",flexGrow:1,fontWeight:o.FontWeights.semibold,padding:"0 4px 0 10px",border:"none",backgroundColor:"transparent",borderRadius:2,lineHeight:28,overflow:"hidden",whiteSpace:"nowrap",textAlign:"left",textOverflow:"ellipsis"}),r&&{selectors:{"&:hover":{cursor:"pointer",background:s.neutralLight,color:s.black}}}],monthComponents:{display:"inline-flex",alignSelf:"flex-end"},headerIconButton:[o.getFocusStyle(e,{inset:-1}),{width:28,height:28,display:"block",textAlign:"center",lineHeight:28,fontSize:o.FontSizes.small,fontFamily:"inherit",color:s.neutralPrimary,borderRadius:2,position:"relative",backgroundColor:"transparent",border:"none",padding:0,overflow:"visible",selectors:{"&:hover":{color:s.neutralDark,backgroundColor:s.neutralLight,cursor:"pointer",outline:"1px solid transparent"}}}],disabledStyle:l}},mc=o.styled(rr,hc,void 0,{scope:"CalendarDay"}),sr=function(t){var i,n,e,r,a,s,l,c=t.className,d=t.theme,g=t.hasHeaderClickCallback,m=t.highlightCurrent,u=t.highlightSelected,f=t.animateBackwards,p=t.animationDirection,_=d.palette,v={};f!==void 0&&(p===rn.Horizontal?v=f?o.AnimationStyles.slideRightIn20:o.AnimationStyles.slideLeftIn20:v=f?o.AnimationStyles.slideDownIn20:o.AnimationStyles.slideUpIn20);var b=f!==void 0?o.AnimationStyles.fadeIn200:{};return{root:[ne.normalize,{width:196,padding:12,boxSizing:"content-box",overflow:"hidden"},c],headerContainer:{display:"flex"},currentItemButton:[o.getFocusStyle(d,{inset:-1}),o.__assign(o.__assign({},b),{fontSize:o.FontSizes.medium,fontWeight:o.FontWeights.semibold,fontFamily:"inherit",textAlign:"left",backgroundColor:"transparent",flexGrow:1,padding:"0 4px 0 10px",border:"none",overflow:"visible"}),g&&{selectors:{"&:hover, &:active":{cursor:g?"pointer":"default",color:_.neutralDark,outline:"1px solid transparent",backgroundColor:_.neutralLight}}}],navigationButtonsContainer:{display:"flex",alignItems:"center"},navigationButton:[o.getFocusStyle(d,{inset:-1}),{fontFamily:"inherit",width:28,minWidth:28,height:28,minHeight:28,display:"block",textAlign:"center",lineHeight:28,fontSize:o.FontSizes.small,color:_.neutralPrimary,borderRadius:2,position:"relative",backgroundColor:"transparent",border:"none",padding:0,overflow:"visible",selectors:{"&:hover":{color:_.neutralDark,cursor:"pointer",outline:"1px solid transparent",backgroundColor:_.neutralLight}}}],gridContainer:{marginTop:4},buttonRow:o.__assign(o.__assign({},v),{marginBottom:16,selectors:{"&:nth-child(n + 3)":{marginBottom:0}}}),itemButton:[o.getFocusStyle(d,{inset:-1}),{width:40,height:40,minWidth:40,minHeight:40,lineHeight:40,fontSize:o.FontSizes.small,fontFamily:"inherit",padding:0,margin:"0 12px 0 0",color:_.neutralPrimary,backgroundColor:"transparent",border:"none",borderRadius:2,overflow:"visible",selectors:{"&:nth-child(4n + 4)":{marginRight:0},"&:nth-child(n + 9)":{marginBottom:0},"& div":{fontWeight:o.FontWeights.regular},"&:hover":{color:_.neutralDark,backgroundColor:_.neutralLight,cursor:"pointer",outline:"1px solid transparent",selectors:(i={},i[o.HighContrastSelector]=o.__assign({background:"Window",color:"WindowText",outline:"1px solid Highlight"},o.getHighContrastNoAdjustStyle()),i)},"&:active":{backgroundColor:_.themeLight,selectors:(n={},n[o.HighContrastSelector]=o.__assign({background:"Window",color:"Highlight"},o.getHighContrastNoAdjustStyle()),n)}}}],current:m?{color:_.white,backgroundColor:_.themePrimary,selectors:(e={"& div":{fontWeight:o.FontWeights.semibold},"&:hover":{backgroundColor:_.themePrimary,selectors:(r={},r[o.HighContrastSelector]=o.__assign({backgroundColor:"WindowText",color:"Window"},o.getHighContrastNoAdjustStyle()),r)}},e[o.HighContrastSelector]=o.__assign({backgroundColor:"WindowText",color:"Window"},o.getHighContrastNoAdjustStyle()),e)}:{},selected:u?{color:_.neutralPrimary,backgroundColor:_.themeLight,fontWeight:o.FontWeights.semibold,selectors:(a={"& div":{fontWeight:o.FontWeights.semibold},"&:hover, &:active":{backgroundColor:_.themeLight,selectors:(s={},s[o.HighContrastSelector]=o.__assign({color:"Window",background:"Highlight"},o.getHighContrastNoAdjustStyle()),s)}},a[o.HighContrastSelector]=o.__assign({background:"Highlight",color:"Window"},o.getHighContrastNoAdjustStyle()),a)}:{},disabled:{selectors:(l={"&, &:disabled, & button":{color:_.neutralTertiaryAlt,pointerEvents:"none"}},l[o.HighContrastSelector]={color:"GrayText",forcedColorAdjust:"none"},l)}}},lr=function(t){return sr(t)},fc=function(t){return sr(t)},vc=er,yi={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"},It=o.classNamesFunction(),Mt=12,uo=4,cr={prevRangeAriaLabel:void 0,nextRangeAriaLabel:void 0},dr=function(t){var i,n,e=t.styles,r=t.theme,a=t.className,s=t.highlightCurrentYear,l=t.highlightSelectedYear,c=t.year,d=t.selected,g=t.disabled,m=t.componentRef,u=t.onSelectYear,f=t.onRenderYear,p=h.useRef(null);h.useImperativeHandle(m,function(){return{focus:function(){var y,C;(C=(y=p.current)===null||y===void 0?void 0:y.focus)===null||C===void 0||C.call(y)}}},[]);var _=function(){u==null||u(c)},v=function(y){y.which===o.KeyCodes.enter&&(u==null||u(c))},b=It(e,{theme:r,className:a,highlightCurrent:s,highlightSelected:l});return h.createElement("button",{className:o.css(b.itemButton,(i={},i[b.selected]=d,i[b.disabled]=g,i)),type:"button",role:"gridcell",onClick:g?void 0:_,onKeyDown:g?void 0:v,disabled:g,"aria-selected":d,ref:p},(n=f==null?void 0:f(c))!==null&&n!==void 0?n:c)};dr.displayName="CalendarYearGridCell";var ur=function(t){var i=t.styles,n=t.theme,e=t.className,r=t.fromYear,a=t.toYear,s=t.animationDirection,l=t.animateBackwards,c=t.minYear,d=t.maxYear,g=t.onSelectYear,m=t.selectedYear,u=t.componentRef,f=h.useRef(null),p=h.useRef(null);h.useImperativeHandle(u,function(){return{focus:function(){var S,I;(I=(S=f.current||p.current)===null||S===void 0?void 0:S.focus)===null||I===void 0||I.call(S)}}},[]);for(var _=function(S){var I=S===m,N=c!==void 0&&S<c||d!==void 0&&S>d,k=S===new Date().getFullYear();return h.createElement(dr,o.__assign({},t,{key:S,year:S,selected:I,current:k,disabled:N,onSelectYear:g,componentRef:I?f:k?p:void 0,theme:n}))},v=It(i,{theme:n,className:e,animateBackwards:l,animationDirection:s}),b=function(S){var I,N;return(N=(I=t.onRenderYear)===null||I===void 0?void 0:I.call(t,S))!==null&&N!==void 0?N:S},y=b(r)+" - "+b(a),C=r,x=[],R=0;R<(a-r+1)/uo;R++){x.push([]);for(var D=0;D<uo;D++)x[R].push(_(C)),C++}return h.createElement(o.FocusZone,null,h.createElement("div",{className:v.gridContainer,role:"grid","aria-label":y},x.map(function(S,I){return h.createElement("div",{key:"yearPickerRow_"+I+"_"+r,role:"row",className:v.buttonRow},S)})))};ur.displayName="CalendarYearGrid";var lt;(function(t){t[t.Previous=0]="Previous",t[t.Next=1]="Next"})(lt||(lt={}));var mi=function(t){var i,n=t.styles,e=t.theme,r=t.className,a=t.navigationIcons,s=a===void 0?yi:a,l=t.strings,c=l===void 0?cr:l,d=t.direction,g=t.onSelectPrev,m=t.onSelectNext,u=t.fromYear,f=t.toYear,p=t.maxYear,_=t.minYear,v=It(n,{theme:e,className:r}),b=d===lt.Previous?c.prevRangeAriaLabel:c.nextRangeAriaLabel,y=d===lt.Previous?-Mt:Mt,C={fromYear:u+y,toYear:f+y},x=b?typeof b=="string"?b:b(C):void 0,R=d===lt.Previous?_!==void 0&&u<_:p!==void 0&&t.fromYear+Mt>p,D=function(){d===lt.Previous?g==null||g():m==null||m()},S=function(N){N.which===o.KeyCodes.enter&&D()},I=o.getRTL()?d===lt.Next:d===lt.Previous;return h.createElement("button",{className:o.css(v.navigationButton,(i={},i[v.disabled]=R,i)),onClick:R?void 0:D,onKeyDown:R?void 0:S,type:"button",title:x,disabled:R},h.createElement(o.Icon,{iconName:I?s.leftNavigation:s.rightNavigation}))};mi.displayName="CalendarYearNavArrow";var gr=function(t){var i=t.styles,n=t.theme,e=t.className,r=It(i,{theme:n,className:e});return h.createElement("div",{className:r.navigationButtonsContainer},h.createElement(mi,o.__assign({},t,{direction:lt.Previous})),h.createElement(mi,o.__assign({},t,{direction:lt.Next})))};gr.displayName="CalendarYearNav";var hr=function(t){var i=t.styles,n=t.theme,e=t.className,r=t.fromYear,a=t.toYear,s=t.strings,l=s===void 0?cr:s,c=t.animateBackwards,d=t.animationDirection,g=function(){var y;(y=t.onHeaderSelect)===null||y===void 0||y.call(t,!0)},m=function(y){(y.which===o.KeyCodes.enter||y.which===o.KeyCodes.space)&&g()},u=function(y){var C,x;return(x=(C=t.onRenderYear)===null||C===void 0?void 0:C.call(t,y))!==null&&x!==void 0?x:y},f=It(i,{theme:n,className:e,hasHeaderClickCallback:!!t.onHeaderSelect,animateBackwards:c,animationDirection:d});if(t.onHeaderSelect){var p=l.rangeAriaLabel,_=l.headerAriaLabelFormatString,v=p?typeof p=="string"?p:p(t):void 0,b=_?St(_,v):v;return h.createElement("button",{className:f.currentItemButton,onClick:g,onKeyDown:m,"aria-label":b,role:"button",type:"button","aria-atomic":!0,"aria-live":"polite"},u(r)," - ",u(a))}return h.createElement("div",{className:f.current},u(r)," - ",u(a))};hr.displayName="CalendarYearTitle";var mr=function(t){var i,n=t.styles,e=t.theme,r=t.className,a=t.animateBackwards,s=t.animationDirection,l=t.onRenderTitle,c=It(n,{theme:e,className:r,hasHeaderClickCallback:!!t.onHeaderSelect,animateBackwards:a,animationDirection:s});return h.createElement("div",{className:c.headerContainer},(i=l==null?void 0:l(t))!==null&&i!==void 0?i:h.createElement(hr,o.__assign({},t)),h.createElement(gr,o.__assign({},t)))};mr.displayName="CalendarYearHeader";function pc(t){var i=t.selectedYear,n=t.navigatedYear,e=i||n||new Date().getFullYear(),r=Math.floor(e/10)*10,a=o.usePrevious(r);if(!(!a||a===r))return a>r}var Jt;(function(t){t[t.Previous=0]="Previous",t[t.Next=1]="Next"})(Jt||(Jt={}));function _c(t){var i=t.selectedYear,n=t.navigatedYear,e=h.useReducer(function(d,g){return d+(g===Jt.Next?Mt:-Mt)},void 0,function(){var d=i||n||new Date().getFullYear();return Math.floor(d/10)*10}),r=e[0],a=e[1],s=r+Mt-1,l=function(){return a(Jt.Next)},c=function(){return a(Jt.Previous)};return[r,s,l,c]}var fr=function(t){var i=pc(t),n=_c(t),e=n[0],r=n[1],a=n[2],s=n[3],l=h.useRef(null);h.useImperativeHandle(t.componentRef,function(){return{focus:function(){var u,f;(f=(u=l.current)===null||u===void 0?void 0:u.focus)===null||f===void 0||f.call(u)}}});var c=t.styles,d=t.theme,g=t.className,m=It(c,{theme:d,className:g});return h.createElement("div",{className:m.root},h.createElement(mr,o.__assign({},t,{fromYear:e,toYear:r,onSelectPrev:s,onSelectNext:a,animateBackwards:i})),h.createElement(ur,o.__assign({},t,{fromYear:e,toYear:r,animateBackwards:i,componentRef:l})))};fr.displayName="CalendarYearBase";var bc=o.styled(fr,fc,void 0,{scope:"CalendarYear"}),fn=4,yc=o.classNamesFunction(),Cc={styles:lr,strings:void 0,navigationIcons:yi,dateTimeFormatter:Qo,yearPickerHidden:!1};function Sc(t){var i=t.navigatedDate,n=i.getFullYear(),e=o.usePrevious(n);if(!(e===void 0||e===n))return e>n}function kc(t){var i=t.componentRef,n=h.useRef(null),e=h.useRef(null),r=h.useRef(!1),a=h.useCallback(function(){e.current?e.current.focus():n.current&&n.current.focus()},[]);h.useImperativeHandle(i,function(){return{focus:a}},[a]),h.useEffect(function(){r.current&&(a(),r.current=!1)});var s=function(){r.current=!0};return[n,e,s]}var vr=function(t){var i,n,e=o.getPropsWithDefaults(Cc,t),r=kc(e),a=r[0],s=r[1],l=r[2],c=h.useState(!1),d=c[0],g=c[1],m=Sc(e),u=e.navigatedDate,f=e.selectedDate,p=e.strings,_=e.today,v=_===void 0?new Date:_,b=e.navigationIcons,y=e.dateTimeFormatter,C=e.minDate,x=e.maxDate,R=e.theme,D=e.styles,S=e.className,I=e.allFocusable,N=e.highlightCurrentMonth,k=e.highlightSelectedMonth,w=e.animationDirection,E=e.yearPickerHidden,P=e.onNavigateDate,T=function(se){return function(){return B(se)}},M=function(){P(Ft(u,1),!1)},L=function(){P(Ft(u,-1),!1)},B=function(se){var fe;(fe=e.onHeaderSelect)===null||fe===void 0||fe.call(e),P(mn(u,se),!0)},z=function(){var se;E?(se=e.onHeaderSelect)===null||se===void 0||se.call(e):(l(),g(!0))},H=function(se){l();var fe=u.getFullYear();if(fe!==se){var oe=new Date(u.getTime());oe.setFullYear(se),x&&oe>x?oe=mn(oe,x.getMonth()):C&&oe<C&&(oe=mn(oe,C.getMonth())),P(oe,!0)}g(!1)},O=function(se){l(),g(!1)},V=b.leftNavigation,W=b.rightNavigation,G=y,A=C?Xe(C,Ll(u))<0:!0,F=x?Xe(zl(u),x)<0:!0,Y=yc(D,{theme:R,className:S,hasHeaderClickCallback:!!e.onHeaderSelect||!E,highlightCurrent:N,highlightSelected:k,animateBackwards:m,animationDirection:w});if(d){var ee=Dc(e),q=ee[0],he=ee[1];return h.createElement(bc,{key:"calendarYear",minYear:C?C.getFullYear():void 0,maxYear:x?x.getFullYear():void 0,onSelectYear:H,navigationIcons:b,onHeaderSelect:O,selectedYear:f?f.getFullYear():u?u.getFullYear():void 0,onRenderYear:q,strings:he,componentRef:s,styles:D,highlightCurrentYear:N,highlightSelectedYear:k,animationDirection:w})}for(var ce=[],re=0;re<p.shortMonths.length/fn;re++)ce.push(re);var ye=G.formatYear(u),me=p.monthPickerHeaderAriaLabel?St(p.monthPickerHeaderAriaLabel,ye):ye;return h.createElement("div",{className:Y.root},h.createElement("div",{className:Y.headerContainer},h.createElement("button",{className:Y.currentItemButton,onClick:z,onKeyDown:vn(z),"aria-label":me,"data-is-focusable":!!e.onHeaderSelect||!E,tabIndex:!!e.onHeaderSelect||!E?0:-1,type:"button","aria-atomic":!0,"aria-live":"polite"},ye),h.createElement("div",{className:Y.navigationButtonsContainer},h.createElement("button",{className:o.css(Y.navigationButton,(i={},i[Y.disabled]=!A,i)),"aria-disabled":!A,tabIndex:A?void 0:I?0:-1,onClick:A?L:void 0,onKeyDown:A?vn(L):void 0,title:p.prevYearAriaLabel?p.prevYearAriaLabel+" "+G.formatYear(Ft(u,-1)):void 0,type:"button"},h.createElement(o.Icon,{iconName:o.getRTL()?W:V})),h.createElement("button",{className:o.css(Y.navigationButton,(n={},n[Y.disabled]=!F,n)),"aria-disabled":!F,tabIndex:F?void 0:I?0:-1,onClick:F?M:void 0,onKeyDown:F?vn(M):void 0,title:p.nextYearAriaLabel?p.nextYearAriaLabel+" "+G.formatYear(Ft(u,1)):void 0,type:"button"},h.createElement(o.Icon,{iconName:o.getRTL()?V:W})))),h.createElement(o.FocusZone,null,h.createElement("div",{className:Y.gridContainer,role:"grid","aria-label":ye},ce.map(function(se){var fe=p.shortMonths.slice(se*fn,(se+1)*fn);return h.createElement("div",{key:"monthRow_"+se+u.getFullYear(),role:"row",className:Y.buttonRow},fe.map(function(oe,_e){var te,ve=se*fn+_e,Ye=mn(u,ve),Be=u.getMonth()===ve,Oe=f.getMonth()===ve,$e=f.getFullYear()===u.getFullYear(),Te=(C?Xe(C,Jo(Ye))<1:!0)&&(x?Xe(Xo(Ye),x)<1:!0);return h.createElement("button",{ref:Be?a:void 0,role:"gridcell",className:o.css(Y.itemButton,(te={},te[Y.current]=N&&xc(ve,u.getFullYear(),v),te[Y.selected]=k&&Oe&&$e,te[Y.disabled]=!Te,te)),disabled:!I&&!Te,key:ve,onClick:Te?T(ve):void 0,onKeyDown:Te?vn(T(ve)):void 0,"aria-label":G.formatMonth(Ye,p),"aria-selected":Be,"data-is-focusable":Te?!0:void 0,type:"button"},oe)}))}))))};vr.displayName="CalendarMonthBase";function Dc(t){var i=t.strings,n=t.navigatedDate,e=t.dateTimeFormatter,r=function(c){if(e){var d=new Date(n.getTime());return d.setFullYear(c),e.formatYear(d)}return String(c)},a=function(c){return r(c.fromYear)+" - "+r(c.toYear)},s=function(c){return i.nextYearRangeAriaLabel?i.nextYearRangeAriaLabel+" "+a(c):""},l=function(c){return i.prevYearRangeAriaLabel?i.prevYearRangeAriaLabel+" "+a(c):""};return[r,{rangeAriaLabel:a,prevRangeAriaLabel:l,nextRangeAriaLabel:s,headerAriaLabelFormatString:i.yearPickerHeaderAriaLabel}]}function xc(t,i,n){return n.getFullYear()===i&&n.getMonth()===t}function vn(t){return function(i){switch(i.which){case o.KeyCodes.enter:t();break}}}var wc=o.styled(vr,lr,void 0,{scope:"CalendarMonth"}),Ic=440,Rc=o.classNamesFunction(),Nc=[Ue.Monday,Ue.Tuesday,Ue.Wednesday,Ue.Thursday,Ue.Friday],Ec={isMonthPickerVisible:!0,isDayPickerVisible:!0,showMonthPickerAsOverlay:!1,today:new Date,firstDayOfWeek:Ue.Sunday,dateRangeType:ze.Day,showGoToToday:!0,strings:er,highlightCurrentMonth:!1,highlightSelectedMonth:!1,navigationIcons:yi,showWeekNumbers:!1,firstWeekOfYear:Ot.FirstDay,dateTimeFormatter:Qo,showSixWeeksByDefault:!1,workWeekDays:Nc,showCloseButton:!1,allFocusable:!1};function Tc(t){var i=t.value,n=t.today,e=n===void 0?new Date:n,r=t.onSelectDate,a=ht(i,e),s=a[0],l=s===void 0?e:s,c=a[1],d=h.useState(i),g=d[0],m=g===void 0?e:g,u=d[1],f=h.useState(i),p=f[0],_=p===void 0?e:p,v=f[1],b=h.useState(i),y=b[0],C=y===void 0?e:y,x=b[1];i&&C.valueOf()!==i.valueOf()&&(u(i),v(i),x(i));var R=function(I){v(I)},D=function(I){v(I),u(I)},S=function(I,N){v(I),u(I),c(I),r==null||r(I,N)};return[l,m,_,S,D,R]}function Pc(t){var i=ht(Pn(t)?void 0:t.isMonthPickerVisible,!1),n=i[0],e=n===void 0?!0:n,r=i[1],a=ht(Pn(t)?void 0:t.isDayPickerVisible,!0),s=a[0],l=s===void 0?!0:s,c=a[1],d=function(){r(!e),c(!l)};return[e,l,d]}function Ac(t,i,n){var e=t.componentRef,r=h.useRef(null),a=h.useRef(null),s=h.useRef(!1),l=h.useCallback(function(){i&&r.current?o.focusAsync(r.current):n&&a.current&&o.focusAsync(a.current)},[i,n]);h.useImperativeHandle(e,function(){return{focus:l}},[l]),h.useEffect(function(){s.current&&(l(),s.current=!1)});var c=function(){s.current=!0};return[r,a,c]}var pr=h.forwardRef(function(t,i){var n=o.getPropsWithDefaults(Ec,t),e=Tc(n),r=e[0],a=e[1],s=e[2],l=e[3],c=e[4],d=e[5],g=Pc(n),m=g[0],u=g[1],f=g[2],p=Ac(n,u,m),_=p[0],v=p[1],b=p[2],y=function(){var te=P;return te&&ce&&(te=a.getFullYear()!==ce.getFullYear()||a.getMonth()!==ce.getMonth()||s.getFullYear()!==ce.getFullYear()||s.getMonth()!==ce.getMonth()),P&&h.createElement("button",{className:o.css("js-goToday",se.goTodayButton),onClick:D,onKeyDown:S(D),type:"button",disabled:!te},E.goToToday)},C=function(te,ve){c(te),ve&&b()},x=function(te,ve){if(ve&&b(),!ve){d(te);return}ye&&l(te),c(te)},R=Pn(n)?function(){f(),b()}:void 0,D=function(){c(ce),b()},S=function(te){return function(ve){switch(ve.which){case o.KeyCodes.enter:case o.KeyCodes.space:te();break}}},I=function(te){var ve;switch(te.which){case o.KeyCodes.enter:te.preventDefault();break;case o.KeyCodes.backspace:te.preventDefault();break;case o.KeyCodes.escape:(ve=n.onDismiss)===null||ve===void 0||ve.call(n);break;case o.KeyCodes.pageUp:te.ctrlKey?c(Ft(a,1)):c(yt(a,1)),te.preventDefault();break;case o.KeyCodes.pageDown:te.ctrlKey?c(Ft(a,-1)):c(yt(a,-1)),te.preventDefault();break}},N="ms-DatePicker",k=n.firstDayOfWeek,w=n.dateRangeType,E=n.strings,P=n.showGoToToday,T=n.highlightCurrentMonth,M=n.highlightSelectedMonth,L=n.navigationIcons,B=n.minDate,z=n.maxDate,H=n.restrictedDates,O=n.className,V=n.showCloseButton,W=n.allFocusable,G=n.styles,A=n.showWeekNumbers,F=n.theme,Y=n.calendarDayProps,ee=n.calendarMonthProps,q=n.dateTimeFormatter,he=n.today,ce=he===void 0?new Date:he,re=Pn(n),ye=!re&&!u,me=re&&P,se=Rc(G,{theme:F,className:O,isMonthPickerVisible:m,isDayPickerVisible:u,monthPickerOnly:ye,showMonthPickerAsOverlay:re,overlaidWithButton:me,overlayedWithButton:me,showGoToToday:P,showWeekNumbers:A}),fe="",oe="";q&&E.todayDateFormatString&&(fe=St(E.todayDateFormatString,q.formatMonthDayYear(ce,E))),q&&E.selectedDateFormatString&&(oe=St(E.selectedDateFormatString,q.formatMonthDayYear(r,E)));var _e=oe+", "+fe;return h.createElement("div",{ref:i,role:"group","aria-label":_e,className:o.css(N,se.root,O,"ms-slideDownIn10"),onKeyDown:I},h.createElement("div",{className:se.liveRegion,"aria-live":"polite","aria-atomic":"true"},h.createElement("span",null,oe)),u&&h.createElement(mc,o.__assign({selectedDate:r,navigatedDate:a,today:n.today,onSelectDate:l,onNavigateDate:C,onDismiss:n.onDismiss,firstDayOfWeek:k,dateRangeType:w,strings:E,onHeaderSelect:R,navigationIcons:L,showWeekNumbers:n.showWeekNumbers,firstWeekOfYear:n.firstWeekOfYear,dateTimeFormatter:n.dateTimeFormatter,showSixWeeksByDefault:n.showSixWeeksByDefault,minDate:B,maxDate:z,restrictedDates:H,workWeekDays:n.workWeekDays,componentRef:_,showCloseButton:V,allFocusable:W},Y)),u&&m&&h.createElement("div",{className:se.divider}),m?h.createElement("div",{className:se.monthPickerWrapper},h.createElement(wc,o.__assign({navigatedDate:s,selectedDate:a,strings:E,onNavigateDate:x,today:n.today,highlightCurrentMonth:T,highlightSelectedMonth:M,onHeaderSelect:R,navigationIcons:L,dateTimeFormatter:n.dateTimeFormatter,minDate:B,maxDate:z,componentRef:v},ee)),y()):y(),h.createElement(o.FocusRects,null))});pr.displayName="CalendarBase";function Pn(t){var i=o.getWindow();return t.showMonthPickerAsOverlay||i&&i.innerWidth<=Ic}var Fc=function(t){var i=t.className,n=t.theme,e=t.isDayPickerVisible,r=t.isMonthPickerVisible,a=t.showWeekNumbers,s=n.palette,l=e&&r?440:220;return a&&e&&(l+=30),{root:[ne.normalize,{display:"flex",width:l},!r&&{flexDirection:"column"},i],divider:{top:0,borderRight:"1px solid",borderColor:s.neutralLight},monthPickerWrapper:[{display:"flex",flexDirection:"column"}],goTodayButton:[o.getFocusStyle(n,{inset:-1}),{bottom:0,color:s.neutralPrimary,height:30,lineHeight:30,backgroundColor:"transparent",border:"none",boxSizing:"content-box",padding:"0 4px",alignSelf:"flex-end",marginRight:16,marginTop:3,fontSize:o.FontSizes.small,fontFamily:"inherit",overflow:"visible",selectors:{"& div":{fontSize:o.FontSizes.small},"&:hover":{color:s.themePrimary,backgroundColor:"transparent",cursor:"pointer"},"&:active":{color:s.themeDark},"&:disabled":{color:s.neutralTertiaryAlt,pointerEvents:"none"}}}],liveRegion:{border:0,height:"1px",margin:"-1px",overflow:"hidden",padding:0,width:"1px",position:"absolute"}}},Hc=o.styled(pr,Fc,void 0,{scope:"Calendar"}),Mc=o.classNamesFunction(),_r=h.forwardRef(function(t,i){var n=t.disabled,e=t.required,r=t.inputProps,a=t.name,s=t.ariaLabel,l=t.ariaLabelledBy,c=t.ariaDescribedBy,d=t.ariaPositionInSet,g=t.ariaSetSize,m=t.title,u=t.checkmarkIconProps,f=t.styles,p=t.theme,_=t.className,v=t.boxSide,b=v===void 0?"start":v,y=o.useId("checkbox-",t.id),C=h.useRef(null),x=o.useMergedRefs(C,i),R=h.useRef(null),D=ht(t.checked,t.defaultChecked,t.onChange),S=D[0],I=D[1],N=ht(t.indeterminate,t.defaultIndeterminate),k=N[0],w=N[1];o.useFocusRects(C),Lc(t),zc(t,S,k,R);var E=Mc(f,{theme:p,className:_,disabled:n,indeterminate:k,checked:S,reversed:b!=="start",isUsingCustomLabelRender:!!t.onRenderLabel}),P=function(z){k?(I(!!S,z),w(!1)):I(!S,z)},T=h.useCallback(function(z){return z&&z.label?h.createElement("span",{className:E.text,title:z.title},z.label):null},[E.text]),M=t.onRenderLabel||T,L=k?"mixed":void 0,B=o.__assign(o.__assign({className:E.input,type:"checkbox"},r),{checked:!!S,disabled:n,required:e,name:a,id:y,title:m,onChange:P,"aria-disabled":n,"aria-label":s,"aria-labelledby":l,"aria-describedby":c,"aria-posinset":d,"aria-setsize":g,"aria-checked":L});return h.createElement("div",{className:E.root,title:m,ref:x},h.createElement("input",o.__assign({},B,{ref:R,title:m,"data-ktp-execute-target":!0})),h.createElement("label",{className:E.label,htmlFor:y},h.createElement("div",{className:E.checkbox,"data-ktp-target":!0},h.createElement(o.Icon,o.__assign({iconName:"CheckMark"},u,{className:E.checkmark}))),M(t,T)))});_r.displayName="CheckboxBase";function Lc(t){process.env.NODE_ENV!=="production"&&o.useWarnings({name:"Checkbox",props:t,mutuallyExclusive:{checked:"defaultChecked",indeterminate:"defaultIndeterminate"}})}function zc(t,i,n,e){h.useImperativeHandle(t.componentRef,function(){return{get checked(){return!!i},get indeterminate(){return!!n},focus:function(){e.current&&e.current.focus()}}},[e,i,n])}var Bc={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},go="20px",ho="200ms",mo="cubic-bezier(.4, 0, .23, 1)",Oc=function(t){var i,n,e,r,a,s,l,c,d,g,m,u,f,p,_,v,b,y,C=t.className,x=t.theme,R=t.reversed,D=t.checked,S=t.disabled,I=t.isUsingCustomLabelRender,N=t.indeterminate,k=x.semanticColors,w=x.effects,E=x.palette,P=x.fonts,T=o.getGlobalClassNames(Bc,x),M=k.inputForegroundChecked,L=E.neutralSecondary,B=E.neutralPrimary,z=k.inputBackgroundChecked,H=k.inputBackgroundChecked,O=k.disabledBodySubtext,V=k.inputBorderHovered,W=k.inputBackgroundCheckedHovered,G=k.inputBackgroundChecked,A=k.inputBackgroundCheckedHovered,F=k.inputBackgroundCheckedHovered,Y=k.inputTextHovered,ee=k.disabledBodySubtext,q=k.bodyText,he=k.disabledText,ce=[(i={content:'""',borderRadius:w.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:S?O:z,transitionProperty:"border-width, border, border-color",transitionDuration:ho,transitionTimingFunction:mo},i[o.HighContrastSelector]={borderColor:"WindowText"},i)];return{root:[T.root,{position:"relative",display:"flex"},R&&"reversed",D&&"is-checked",!S&&"is-enabled",S&&"is-disabled",!S&&[!D&&(n={},n[":hover ."+T.checkbox]=(e={borderColor:V},e[o.HighContrastSelector]={borderColor:"Highlight"},e),n[":focus ."+T.checkbox]={borderColor:V},n[":hover ."+T.checkmark]=(r={color:L,opacity:"1"},r[o.HighContrastSelector]={color:"Highlight"},r),n),D&&!N&&(a={},a[":hover ."+T.checkbox]={background:A,borderColor:F},a[":focus ."+T.checkbox]={background:A,borderColor:F},a[o.HighContrastSelector]=(s={},s[":hover ."+T.checkbox]={background:"Highlight",borderColor:"Highlight"},s[":focus ."+T.checkbox]={background:"Highlight"},s[":focus:hover ."+T.checkbox]={background:"Highlight"},s[":focus:hover ."+T.checkmark]={color:"Window"},s[":hover ."+T.checkmark]={color:"Window"},s),a),N&&(l={},l[":hover ."+T.checkbox+", :hover ."+T.checkbox+":after"]=(c={borderColor:W},c[o.HighContrastSelector]={borderColor:"WindowText"},c),l[":focus ."+T.checkbox]={borderColor:W},l[":hover ."+T.checkmark]={opacity:"0"},l),(d={},d[":hover ."+T.text+", :focus ."+T.text]=(g={color:Y},g[o.HighContrastSelector]={color:S?"GrayText":"WindowText"},g),d)],C],input:(m={position:"absolute",background:"none",opacity:0},m["."+o.IsFocusVisibleClassName+" &:focus + label::before"]=(u={outline:"1px solid "+x.palette.neutralSecondary,outlineOffset:"2px"},u[o.HighContrastSelector]={outline:"1px solid WindowText"},u),m),label:[T.label,x.fonts.medium,{display:"flex",alignItems:I?"center":"flex-start",cursor:S?"default":"pointer",position:"relative",userSelect:"none"},R&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[T.checkbox,(f={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:go,width:go,border:"1px solid "+B,borderRadius:w.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:ho,transitionTimingFunction:mo,overflow:"hidden",":after":N?ce:null},f[o.HighContrastSelector]=o.__assign({borderColor:"WindowText"},o.getHighContrastNoAdjustStyle()),f),N&&{borderColor:z},R?{marginLeft:4}:{marginRight:4},!S&&!N&&D&&(p={background:G,borderColor:H},p[o.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},p),S&&(_={borderColor:O},_[o.HighContrastSelector]={borderColor:"GrayText"},_),D&&S&&(v={background:ee,borderColor:O},v[o.HighContrastSelector]={background:"Window"},v)],checkmark:[T.checkmark,(b={opacity:D&&!N?"1":"0",color:M},b[o.HighContrastSelector]=o.__assign({color:S?"GrayText":"Window"},o.getHighContrastNoAdjustStyle()),b)],text:[T.text,(y={color:S?he:q,fontSize:P.medium.fontSize,lineHeight:"20px"},y[o.HighContrastSelector]=o.__assign({color:S?"GrayText":"WindowText"},o.getHighContrastNoAdjustStyle()),y),R?{marginRight:4}:{marginLeft:4}]}},Wc=o.styled(_r,Oc,void 0,{scope:"Checkbox"}),Gc=o.classNamesFunction(),fo=71,Vc={imageSize:{width:32,height:32}},br=function(t){var i=o.getPropsWithDefaults(o.__assign(o.__assign({},Vc),{key:t.itemKey}),t),n=i.ariaLabel,e=i.focused,r=i.required,a=i.theme,s=i.iconProps,l=i.imageSrc,c=i.imageSize,d=i.disabled,g=i.checked,m=i.id,u=i.styles,f=i.name,p=o.__rest(i,["ariaLabel","focused","required","theme","iconProps","imageSrc","imageSize","disabled","checked","id","styles","name"]),_=Gc(u,{theme:a,hasIcon:!!s,hasImage:!!l,checked:g,disabled:d,imageIsLarge:!!l&&(c.width>fo||c.height>fo),imageSize:c,focused:e}),v=o.getNativeProps(p,o.inputProperties),b=v.className,y=o.__rest(v,["className"]),C=function(){return h.createElement("span",{id:i.labelId,className:"ms-ChoiceFieldLabel"},i.text)},x=function(){var k=i.imageAlt,w=k===void 0?"":k,E=i.selectedImageSrc,P=i.onRenderLabel?o.composeRenderFunction(i.onRenderLabel,C):C,T=P(i);return h.createElement("label",{htmlFor:m,className:_.field},l&&h.createElement("div",{className:_.innerField},h.createElement("div",{className:_.imageWrapper},h.createElement(o.Image,o.__assign({src:l,alt:w},c))),h.createElement("div",{className:_.selectedImageWrapper},h.createElement(o.Image,o.__assign({src:E,alt:w},c)))),s&&h.createElement("div",{className:_.innerField},h.createElement("div",{className:_.iconWrapper},h.createElement(o.Icon,o.__assign({},s)))),l||s?h.createElement("div",{className:_.labelWrapper},T):T)},R=i.onRenderField,D=R===void 0?x:R,S=function(k){var w;(w=i.onChange)===null||w===void 0||w.call(i,k,i)},I=function(k){var w;(w=i.onBlur)===null||w===void 0||w.call(i,k)},N=function(k){var w;(w=i.onFocus)===null||w===void 0||w.call(i,k,i)};return h.createElement("div",{className:_.root},h.createElement("div",{className:_.choiceFieldWrapper},h.createElement("input",o.__assign({"aria-label":n,id:m,className:o.css(_.input,b),type:"radio",name:f,disabled:d,checked:g,required:r},y,{onChange:S,onFocus:N,onBlur:I})),D(i,x)))};br.displayName="ChoiceGroupOption";var Kc={root:"ms-ChoiceField",choiceFieldWrapper:"ms-ChoiceField-wrapper",input:"ms-ChoiceField-input",field:"ms-ChoiceField-field",innerField:"ms-ChoiceField-innerField",imageWrapper:"ms-ChoiceField-imageWrapper",iconWrapper:"ms-ChoiceField-iconWrapper",labelWrapper:"ms-ChoiceField-labelWrapper",checked:"is-checked"},yr=15,Uc=yr*2+2,Zn=32,qn=20,wn="200ms",vo="cubic-bezier(.4, 0, .23, 1)",pn=3,po=5;function Yc(t,i){var n,e;return["is-inFocus",{selectors:(n={},n["."+o.IsFocusVisibleClassName+" &"]={position:"relative",outline:"transparent",selectors:{"::-moz-focus-inner":{border:0},":after":{content:'""',top:-2,right:-2,bottom:-2,left:-2,pointerEvents:"none",border:"1px solid "+t,position:"absolute",selectors:(e={},e[o.HighContrastSelector]={borderColor:"WindowText",borderWidth:i?1:2},e)}}},n)}]}function _o(t,i,n){return[i,{paddingBottom:2,transitionProperty:"opacity",transitionDuration:wn,transitionTimingFunction:"ease",selectors:{".ms-Image":{display:"inline-block",borderStyle:"none"}}},(n?!t:t)&&["is-hidden",{position:"absolute",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",opacity:0}]]}var $c=function(t){var i,n,e,r,a,s=t.theme,l=t.hasIcon,c=t.hasImage,d=t.checked,g=t.disabled,m=t.imageIsLarge,u=t.focused,f=t.imageSize,p=s.palette,_=s.semanticColors,v=s.fonts,b=o.getGlobalClassNames(Kc,s),y=p.neutralPrimary,C=_.inputBorderHovered,x=_.inputBackgroundChecked,R=p.themeDark,D=_.disabledBodySubtext,S=_.bodyBackground,I=p.neutralSecondary,N=_.inputBackgroundChecked,k=p.themeDark,w=_.disabledBodySubtext,E=p.neutralDark,P=_.focusBorder,T=_.inputBorderHovered,M=_.inputBackgroundChecked,L=p.themeDark,B=p.neutralLighter,z={selectors:{".ms-ChoiceFieldLabel":{color:E},":before":{borderColor:d?R:C},":after":[!l&&!c&&!d&&{content:'""',transitionProperty:"background-color",left:5,top:5,width:10,height:10,backgroundColor:I},d&&{borderColor:k,background:k}]}},H={borderColor:d?L:T,selectors:{":before":{opacity:1,borderColor:d?R:C}}},O=[{content:'""',display:"inline-block",backgroundColor:S,borderWidth:1,borderStyle:"solid",borderColor:y,width:qn,height:qn,fontWeight:"normal",position:"absolute",top:0,left:0,boxSizing:"border-box",transitionProperty:"border-color",transitionDuration:wn,transitionTimingFunction:vo,borderRadius:"50%"},g&&{borderColor:D,selectors:(i={},i[o.HighContrastSelector]=o.__assign({borderColor:"GrayText",background:"Window"},o.getHighContrastNoAdjustStyle()),i)},d&&{borderColor:g?D:x,selectors:(n={},n[o.HighContrastSelector]={borderColor:"Highlight",background:"Window",forcedColorAdjust:"none"},n)},(l||c)&&{top:pn,right:pn,left:"auto",opacity:d?1:0}],V=[{content:'""',width:0,height:0,borderRadius:"50%",position:"absolute",left:qn/2,right:0,transitionProperty:"border-width",transitionDuration:wn,transitionTimingFunction:vo,boxSizing:"border-box"},d&&{borderWidth:5,borderStyle:"solid",borderColor:g?w:N,background:N,left:5,top:5,width:10,height:10,selectors:(e={},e[o.HighContrastSelector]={borderColor:"Highlight",forcedColorAdjust:"none"},e)},d&&(l||c)&&{top:pn+po,right:pn+po,left:"auto"}];return{root:[b.root,s.fonts.medium,{display:"flex",alignItems:"center",boxSizing:"border-box",color:_.bodyText,minHeight:26,border:"none",position:"relative",marginTop:8,selectors:{".ms-ChoiceFieldLabel":{display:"inline-block"}}},!l&&!c&&{selectors:{".ms-ChoiceFieldLabel":{paddingLeft:"26px"}}},c&&"ms-ChoiceField--image",l&&"ms-ChoiceField--icon",(l||c)&&{display:"inline-flex",fontSize:0,margin:"0 4px 4px 0",paddingLeft:0,backgroundColor:B,height:"100%"}],choiceFieldWrapper:[b.choiceFieldWrapper,u&&Yc(P,l||c)],input:[b.input,{position:"absolute",opacity:0,top:0,right:0,width:"100%",height:"100%",margin:0},g&&"is-disabled"],field:[b.field,d&&b.checked,{display:"inline-block",cursor:"pointer",marginTop:0,position:"relative",verticalAlign:"top",userSelect:"none",minHeight:20,selectors:{":hover":!g&&z,":focus":!g&&z,":before":O,":after":V}},l&&"ms-ChoiceField--icon",c&&"ms-ChoiceField-field--image",(l||c)&&{boxSizing:"content-box",cursor:"pointer",paddingTop:22,margin:0,textAlign:"center",transitionProperty:"all",transitionDuration:wn,transitionTimingFunction:"ease",border:"1px solid transparent",justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"},d&&{borderColor:M},(l||c)&&!g&&{selectors:{":hover":H,":focus":H}},g&&{cursor:"default",selectors:{".ms-ChoiceFieldLabel":{color:_.disabledBodyText,selectors:(r={},r[o.HighContrastSelector]=o.__assign({color:"GrayText"},o.getHighContrastNoAdjustStyle()),r)}}},d&&g&&{borderColor:B}],innerField:[b.innerField,c&&{height:f.height,width:f.width},(l||c)&&{position:"relative",display:"inline-block",paddingLeft:30,paddingRight:30},(l||c)&&m&&{paddingLeft:24,paddingRight:24},(l||c)&&g&&{opacity:.25,selectors:(a={},a[o.HighContrastSelector]={color:"GrayText",opacity:1},a)}],imageWrapper:_o(!1,b.imageWrapper,d),selectedImageWrapper:_o(!0,b.imageWrapper,d),iconWrapper:[b.iconWrapper,{fontSize:Zn,lineHeight:Zn,height:Zn}],labelWrapper:[b.labelWrapper,v.medium,(l||c)&&{display:"block",position:"relative",margin:"4px 8px 2px 8px",height:Uc,lineHeight:yr,maxWidth:f.width*2,overflow:"hidden",whiteSpace:"pre-wrap"}]}},jc=o.styled(br,$c,void 0,{scope:"ChoiceGroupOption"}),Zc=o.classNamesFunction(),Cr=function(t,i){return i+"-"+t.key},Ci=function(t,i){return i===void 0?void 0:o.find(t,function(n){return n.key===i})},Sr=function(t,i,n){var e=Ci(t,i)||t.filter(function(a){return!a.disabled})[0],r=e&&document.getElementById(Cr(e,n));r&&(r.focus(),o.setFocusVisibility(!0,r))},qc=function(t){return t.relatedTarget instanceof HTMLElement&&t.relatedTarget.dataset.isFocusTrapZoneBumper==="true"},Xc=function(t,i,n,e){h.useImperativeHandle(e,function(){return{get checkedOption(){return Ci(t,i)},focus:function(){Sr(t,i,n)}}},[t,i,n])},kr="ChoiceGroup",Dr=h.forwardRef(function(t,i){var n=t.className,e=t.theme,r=t.styles,a=t.options,s=a===void 0?[]:a,l=t.label,c=t.required,d=t.disabled,g=t.name,m=t.defaultSelectedKey,u=t.componentRef,f=t.onChange,p=o.useId("ChoiceGroup"),_=o.useId("ChoiceGroupLabel"),v=o.getNativeProps(t,o.divProperties,["onChange","className","required"]),b=Zc(r,{theme:e,className:n,optionsContainIconOrImage:s.some(function(M){return!!(M.iconProps||M.imageSrc)})}),y=t.ariaLabelledBy||(l?_:t["aria-labelledby"]),C=ht(t.selectedKey,m),x=C[0],R=C[1],D=h.useState(),S=D[0],I=D[1],N=h.useRef(null),k=o.useMergedRefs(N,i);Jc(t),Xc(s,x,p,u),o.useFocusRects(N);var w=h.useCallback(function(M,L){var B;L&&(I(L.itemKey),(B=L.onFocus)===null||B===void 0||B.call(L,M))},[]),E=h.useCallback(function(M,L){var B;I(void 0),(B=L==null?void 0:L.onBlur)===null||B===void 0||B.call(L,M)},[]),P=h.useCallback(function(M,L){var B;!L||(R(L.itemKey),(B=L.onChange)===null||B===void 0||B.call(L,M),f==null||f(M,Ci(s,L.itemKey)))},[f,s,R]),T=h.useCallback(function(M){qc(M)&&Sr(s,x,p)},[s,x,p]);return h.createElement("div",o.__assign({className:b.root},v,{ref:k}),h.createElement("div",o.__assign({role:"radiogroup"},y&&{"aria-labelledby":y},{onFocus:T}),l&&h.createElement(ne.Label,{className:b.label,required:c,id:_,disabled:d},l),h.createElement("div",{className:b.flexContainer},s.map(function(M){return h.createElement(jc,o.__assign({itemKey:M.key},M,{key:M.key,onBlur:E,onFocus:w,onChange:P,focused:M.key===S,checked:M.key===x,disabled:M.disabled||d,id:Cr(M,p),labelId:M.labelId||_+"-"+M.key,name:g||p,required:c}))}))))});Dr.displayName=kr;function Jc(t){process.env.NODE_ENV!=="production"&&o.useWarnings({name:kr,props:t,mutuallyExclusive:{selectedKey:"defaultSelectedKey"}})}var Qc={root:"ms-ChoiceFieldGroup",flexContainer:"ms-ChoiceFieldGroup-flexContainer"},ed=function(t){var i=t.className,n=t.optionsContainIconOrImage,e=t.theme,r=o.getGlobalClassNames(Qc,e);return{root:[i,r.root,e.fonts.medium,{display:"block"}],flexContainer:[r.flexContainer,n&&{display:"flex",flexDirection:"row",flexWrap:"wrap"}]}},td=o.styled(Dr,ed,void 0,{scope:"ChoiceGroup"});function bo(t,i){for(var n=[],e=0,r=i;e<r.length;e++){var a=r[e],s=t[a];s&&n.push(s)}return n}var ct;(function(t){t[t.Normal=0]="Normal",t[t.Divider=1]="Divider",t[t.Header=2]="Header",t[t.SelectAll=3]="SelectAll"})(ct||(ct={}));var nd=o.__assign(o.__assign({},vc),{prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",closeButtonAriaLabel:"Close date picker",isRequiredErrorMessage:"Field is required",invalidInputErrorMessage:"Invalid date format",isResetStatusMessage:'Invalid entry "{0}", date reset to "{1}"'}),id=o.classNamesFunction(),od={allowTextInput:!1,formatDate:function(t){return t?t.toDateString():""},parseDateFromString:function(t){var i=Date.parse(t);return i?new Date(i):null},firstDayOfWeek:Ue.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:nd,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calendar",showWeekNumbers:!1,firstWeekOfYear:Ot.FirstDay,showGoToToday:!0,showCloseButton:!1,underlined:!1,allFocusable:!1};function rd(){var t=h.useRef(null),i=h.useRef(!1),n=function(){var r,a;(a=(r=t.current)===null||r===void 0?void 0:r.focus)===null||a===void 0||a.call(r)},e=function(){i.current=!0};return[t,n,i,e]}function ad(t,i){var n=t.allowTextInput,e=t.onAfterMenuDismiss,r=h.useState(!1),a=r[0],s=r[1],l=h.useRef(!1),c=o.useAsync();return h.useEffect(function(){l.current&&!a&&(n&&c.requestAnimationFrame(i),e==null||e()),l.current=!0},[a]),[a,s]}function sd(t){var i=t.formatDate,n=t.value,e=t.onSelectDate,r=ht(n,void 0,function(m,u){return e==null?void 0:e(u)}),a=r[0],s=r[1],l=h.useState(function(){return n&&i?i(n):""}),c=l[0],d=l[1],g=function(m){s(m),d(m&&i?i(m):"")};return h.useEffect(function(){d(n&&i?i(n):"")},[i,n]),[a,c,g,d]}function ld(t,i,n,e,r){var a=t.isRequired,s=t.allowTextInput,l=t.strings,c=t.parseDateFromString,d=t.onSelectDate,g=t.formatDate,m=t.minDate,u=t.maxDate,f=h.useState(),p=f[0],_=f[1],v=h.useState(),b=v[0],y=v[1],C=function(x){if(x===void 0&&(x=null),s)if(e||x){if(i&&!p&&g&&g(x!=null?x:i)===e)return;if(x=x||c(e),!x||isNaN(x.getTime())){n(i);var R=g?g(i):"",D=l.isResetStatusMessage?St(l.isResetStatusMessage,e,R):l.invalidInputErrorMessage||"";y(D)}else yo(x,m,u)?_(l.isOutOfBoundsErrorMessage||" "):(n(x),_(void 0),y(void 0))}else _(a?l.isRequiredErrorMessage||" ":void 0),d==null||d(x);else a&&!e?_(l.isRequiredErrorMessage||" "):(_(void 0),y(void 0))};return h.useEffect(function(){a&&!i?_(l.isRequiredErrorMessage||" "):i&&yo(i,m,u)?_(l.isOutOfBoundsErrorMessage||" "):_(void 0)},[m&&qt(m),u&&qt(u),i&&qt(i),a]),[r?void 0:p,C,_,r?void 0:b,y]}var xr=h.forwardRef(function(t,i){var n=o.getPropsWithDefaults(od,t),e=n.firstDayOfWeek,r=n.strings,a=n.label,s=n.theme,l=n.className,c=n.styles,d=n.initialPickerDate,g=n.isRequired,m=n.disabled,u=n.ariaLabel,f=n.pickerAriaLabel,p=n.placeholder,_=n.allowTextInput,v=n.borderless,b=n.minDate,y=n.maxDate,C=n.showCloseButton,x=n.calendarProps,R=n.calloutProps,D=n.textField,S=n.underlined,I=n.allFocusable,N=n.calendarAs,k=N===void 0?Hc:N,w=n.tabIndex,E=n.disableAutoFocus,P=E===void 0?!0:E,T=o.useId("DatePicker",n.id),M=o.useId("DatePicker-Callout"),L=h.useRef(null),B=h.useRef(null),z=rd(),H=z[0],O=z[1],V=z[2],W=z[3],G=ad(n,O),A=G[0],F=G[1],Y=sd(n),ee=Y[0],q=Y[1],he=Y[2],ce=Y[3],re=ld(n,ee,he,q,A),ye=re[0],me=re[1],se=re[2],fe=re[3],oe=re[4],_e=h.useCallback(function(){A||(W(),F(!0))},[A,W,F]);h.useImperativeHandle(n.componentRef,function(){return{focus:O,reset:function(){F(!1),he(void 0),se(void 0),oe(void 0)},showDatePickerPopup:_e}},[O,se,F,he,oe,_e]);var te=function(){P||_||(V.current||_e(),V.current=!1)},ve=function(ae){n.calendarProps&&n.calendarProps.onSelectDate&&n.calendarProps.onSelectDate(ae),ie(ae)},Ye=function(){var ae=!0;n.calloutProps&&n.calloutProps.setInitialFocus!==void 0&&(ae=n.calloutProps.setInitialFocus),L.current&&ae&&L.current.focus()},Be=function(ae){me()},Oe=function(ae,je){var ft,at=n.textField;_&&(A&&Pe(),ce(je)),(ft=at==null?void 0:at.onChange)===null||ft===void 0||ft.call(at,ae,je)},$e=function(ae){switch(ae.which){case o.KeyCodes.enter:ae.preventDefault(),ae.stopPropagation(),A?n.allowTextInput&&Pe():(me(),_e());break;case o.KeyCodes.escape:ke(ae);break;case o.KeyCodes.down:ae.altKey&&!A&&_e();break}},Te=function(ae){var je=n.openOnClick||!n.disableAutoFocus;if(je&&!A&&!n.disabled){_e();return}n.allowTextInput&&Pe()},rt=function(ae){ae.stopPropagation(),!A&&!n.disabled?_e():n.allowTextInput&&Pe()},Pe=function(ae){A&&(F(!1),me(ae),!_&&ae&&he(ae))},X=function(ae,je){return h.createElement(h.Fragment,null,ae.description?je(ae):null,h.createElement("div",{"aria-live":"assertive",className:Ie.statusMessage},fe))},xe=function(ae){var je=o.getNativeProps(ae,o.divProperties);return h.createElement("div",o.__assign({},je,{className:o.css(je.className,Ie.readOnlyTextField),tabIndex:w||0}),q||h.createElement("span",{className:Ie.readOnlyPlaceholder},p))},ie=function(ae){W(),Pe(ae)},J=function(ae){ie()},ke=function(ae){ae.stopPropagation(),ie()},Ie=id(c,{theme:s,className:l,disabled:m,underlined:S,label:!!a,isDatePickerShown:A}),Ge=o.getNativeProps(n,o.divProperties,["value"]),Re=D&&D.iconProps,ue=D&&D.id&&D.id!==T?D.id:T+"-label",pe=!_&&!m;return h.createElement("div",o.__assign({},Ge,{className:Ie.root,ref:i}),h.createElement("div",{ref:B,"aria-owns":A?M:void 0,className:Ie.wrapper},h.createElement(ne.TextField,o.__assign({role:"combobox",label:a,"aria-expanded":A,ariaLabel:u,"aria-haspopup":"dialog","aria-controls":A?M:void 0,required:g,disabled:m,errorMessage:ye,placeholder:p,borderless:v,value:q,componentRef:H,underlined:S,tabIndex:w,readOnly:!_},D,{id:ue,className:o.css(Ie.textField,D&&D.className),iconProps:o.__assign(o.__assign({iconName:"Calendar"},Re),{className:o.css(Ie.icon,Re&&Re.className),onClick:rt}),onRenderDescription:X,onKeyDown:$e,onFocus:te,onBlur:Be,onClick:Te,onChange:Oe,onRenderInput:pe?xe:void 0}))),A&&h.createElement(o.Callout,o.__assign({id:M,role:"dialog",ariaLabel:f,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:B.current,directionalHint:o.DirectionalHint.bottomLeftEdge},R,{className:o.css(Ie.callout,R&&R.className),onDismiss:J,onPositioned:Ye}),h.createElement(ne.FocusTrapZone,{isClickableOutsideFocusTrap:!0,disableFirstFocus:P},h.createElement(k,o.__assign({},x,{onSelectDate:ve,onDismiss:ie,isMonthPickerVisible:n.isMonthPickerVisible,showMonthPickerAsOverlay:n.showMonthPickerAsOverlay,today:n.today,value:ee||d,firstDayOfWeek:e,strings:r,highlightCurrentMonth:n.highlightCurrentMonth,highlightSelectedMonth:n.highlightSelectedMonth,showWeekNumbers:n.showWeekNumbers,firstWeekOfYear:n.firstWeekOfYear,showGoToToday:n.showGoToToday,dateTimeFormatter:n.dateTimeFormatter,minDate:b,maxDate:y,componentRef:L,showCloseButton:C,allFocusable:I})))))});xr.displayName="DatePickerBase";function yo(t,i,n){return!!i&&Xe(i,t)>0||!!n&&Xe(n,t)<0}var cd={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "},Xn=32,dd=function(t){var i,n=t.className,e=t.theme,r=t.disabled,a=t.underlined,s=t.label,l=t.isDatePickerShown,c=e.palette,d=e.semanticColors,g=e.fonts,m=o.getGlobalClassNames(cd,e),u={color:c.neutralSecondary,fontSize:o.FontSizes.icon,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"4px",padding:"5px"};return{root:[m.root,e.fonts.large,l&&"is-open",ne.normalize,n],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}},r&&{selectors:{"& input[readonly]":{cursor:"default"}}}],callout:[m.callout],icon:[u,s?m.withLabel:m.withoutLabel,{paddingTop:"7px"},!r&&[m.disabled,{pointerEvents:"initial",cursor:"pointer"}],r&&{color:d.disabledText,cursor:"default"}],statusMessage:[g.small,{color:d.errorText,marginTop:5}],readOnlyTextField:[{cursor:"pointer",height:Xn,lineHeight:Xn-2,overflow:"hidden",textOverflow:"ellipsis"},a&&{lineHeight:Xn+2}],readOnlyPlaceholder:(i={color:d.inputPlaceholderText},i[o.HighContrastSelector]={color:"GrayText"},i)}},Co=o.styled(xr,dd,void 0,{scope:"DatePicker"}),ud=function(){function t(){this._size=0}return t.prototype.updateOptions=function(i){for(var n=[],e=0,r=0;r<i.length;r++)i[r].itemType===ct.Divider||i[r].itemType===ct.Header?n.push(r):i[r].hidden||e++;this._size=e,this._displayOnlyOptionsCache=n,this._cachedOptions=o.__spreadArray([],i)},Object.defineProperty(t.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cachedOptions",{get:function(){return this._cachedOptions},enumerable:!1,configurable:!0}),t.prototype.positionInSet=function(i){if(i!==void 0){for(var n=0;i>this._displayOnlyOptionsCache[n];)n++;if(this._displayOnlyOptionsCache[n]===i)throw new Error("Unexpected: Option at index "+i+" is not a selectable element.");return i-n+1}},t}(),He;(function(t){t[t.smallFluid=0]="smallFluid",t[t.smallFixedFar=1]="smallFixedFar",t[t.smallFixedNear=2]="smallFixedNear",t[t.medium=3]="medium",t[t.large=4]="large",t[t.largeFixed=5]="largeFixed",t[t.extraLarge=6]="extraLarge",t[t.custom=7]="custom",t[t.customNear=8]="customNear"})(He||(He={}));var gd=o.classNamesFunction(),hd="Panel",De;(function(t){t[t.closed=0]="closed",t[t.animatingOpen=1]="animatingOpen",t[t.open=2]="open",t[t.animatingClosed=3]="animatingClosed"})(De||(De={}));var md=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;e._panel=h.createRef(),e._animationCallback=null,e._hasCustomNavigation=!!(e.props.onRenderNavigation||e.props.onRenderNavigationContent),e.dismiss=function(s){e.props.onDismiss&&e.isActive&&e.props.onDismiss(s),(!s||s&&!s.defaultPrevented)&&e.close()},e._allowScrollOnPanel=function(s){s?e._allowTouchBodyScroll?o.allowOverscrollOnElement(s,e._events):o.allowScrollOnElement(s,e._events):e._events.off(e._scrollableContent),e._scrollableContent=s},e._onRenderNavigation=function(s){if(!e.props.onRenderNavigationContent&&!e.props.onRenderNavigation&&!e.props.hasCloseButton)return null;var l=e.props.onRenderNavigationContent,c=l===void 0?e._onRenderNavigationContent:l;return h.createElement("div",{className:e._classNames.navigation},c(s,e._onRenderNavigationContent))},e._onRenderNavigationContent=function(s){var l,c=s.closeButtonAriaLabel,d=s.hasCloseButton,g=s.onRenderHeader,m=g===void 0?e._onRenderHeader:g;if(d){var u=(l=e._classNames.subComponentStyles)===null||l===void 0?void 0:l.closeButton();return h.createElement(h.Fragment,null,!e._hasCustomNavigation&&m(e.props,e._onRenderHeader,e._headerTextId),h.createElement(o.IconButton,{styles:u,className:e._classNames.closeButton,onClick:e._onPanelClick,ariaLabel:c,title:c,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},e._onRenderHeader=function(s,l,c){var d=s.headerText,g=s.headerTextProps,m=g===void 0?{}:g;return d?h.createElement("div",{className:e._classNames.header},h.createElement("div",o.__assign({id:c,role:"heading","aria-level":1},m,{className:o.css(e._classNames.headerText,m.className)}),d)):null},e._onRenderBody=function(s){return h.createElement("div",{className:e._classNames.content},s.children)},e._onRenderFooter=function(s){var l=e.props.onRenderFooterContent,c=l===void 0?null:l;return c?h.createElement("div",{className:e._classNames.footer},h.createElement("div",{className:e._classNames.footerInner},c())):null},e._animateTo=function(s){s===De.open&&e.props.onOpen&&e.props.onOpen(),e._animationCallback=e._async.setTimeout(function(){e.setState({visibility:s}),e._onTransitionComplete()},200)},e._clearExistingAnimationTimer=function(){e._animationCallback!==null&&e._async.clearTimeout(e._animationCallback)},e._onPanelClick=function(s){e.dismiss(s)},e._onTransitionComplete=function(){e._updateFooterPosition(),e.state.visibility===De.open&&e.props.onOpened&&e.props.onOpened(),e.state.visibility===De.closed&&e.props.onDismissed&&e.props.onDismissed()};var r=e.props.allowTouchBodyScroll,a=r===void 0?!1:r;return e._allowTouchBodyScroll=a,e._async=new o.Async(e),e._events=new o.EventGroup(e),o.initializeComponentRef(e),o.warnDeprecations(hd,n,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),e.state={isFooterSticky:!1,visibility:De.closed,id:o.getId("Panel")},e}return i.getDerivedStateFromProps=function(n,e){return n.isOpen===void 0?null:n.isOpen&&(e.visibility===De.closed||e.visibility===De.animatingClosed)?{visibility:De.animatingOpen}:!n.isOpen&&(e.visibility===De.open||e.visibility===De.animatingOpen)?{visibility:De.animatingClosed}:null},i.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:De.animatingOpen})},i.prototype.componentDidUpdate=function(n,e){var r=this._shouldListenForOuterClick(this.props),a=this._shouldListenForOuterClick(n);this.state.visibility!==e.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===De.animatingOpen?this._animateTo(De.open):this.state.visibility===De.animatingClosed&&this._animateTo(De.closed)),r&&!a?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!r&&a&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)},i.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},i.prototype.render=function(){var n=this.props,e=n.className,r=e===void 0?"":e,a=n.elementToFocusOnDismiss,s=n.firstFocusableSelector,l=n.focusTrapZoneProps,c=n.forceFocusInsideTrap,d=n.hasCloseButton,g=n.headerText,m=n.headerClassName,u=m===void 0?"":m,f=n.ignoreExternalFocusing,p=n.isBlocking,_=n.isFooterAtBottom,v=n.isLightDismiss,b=n.isHiddenOnDismiss,y=n.layerProps,C=n.overlayProps,x=n.popupProps,R=n.type,D=n.styles,S=n.theme,I=n.customWidth,N=n.onLightDismissClick,k=N===void 0?this._onPanelClick:N,w=n.onRenderNavigation,E=w===void 0?this._onRenderNavigation:w,P=n.onRenderHeader,T=P===void 0?this._onRenderHeader:P,M=n.onRenderBody,L=M===void 0?this._onRenderBody:M,B=n.onRenderFooter,z=B===void 0?this._onRenderFooter:B,H=this.state,O=H.isFooterSticky,V=H.visibility,W=H.id,G=R===He.smallFixedNear||R===He.customNear,A=o.getRTL(S),F=A?G:!G,Y=R===He.custom||R===He.customNear?{width:I}:{},ee=o.getNativeProps(this.props,o.divProperties),q=this.isActive,he=V===De.animatingClosed||V===De.animatingOpen;if(this._headerTextId=g&&W+"-headerText",!q&&!he&&!b)return null;this._classNames=gd(D,{theme:S,className:r,focusTrapZoneClassName:l?l.className:void 0,hasCloseButton:d,headerClassName:u,isAnimating:he,isFooterSticky:O,isFooterAtBottom:_,isOnRightSide:F,isOpen:q,isHiddenOnDismiss:b,type:R,hasCustomNavigation:this._hasCustomNavigation});var ce=this,re=ce._classNames,ye=ce._allowTouchBodyScroll,me;return p&&q&&(me=h.createElement(ne.Overlay,o.__assign({className:re.overlay,isDarkThemed:!1,onClick:v?k:void 0,allowTouchBodyScroll:ye},C))),h.createElement(o.Layer,o.__assign({},y),h.createElement(o.Popup,o.__assign({role:"dialog","aria-modal":p?"true":void 0,ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:re.hiddenPanel},x),h.createElement("div",o.__assign({"aria-hidden":!q&&he},ee,{ref:this._panel,className:re.root}),me,h.createElement(ne.FocusTrapZone,o.__assign({ignoreExternalFocusing:f,forceFocusInsideTrap:!p||b&&!q?!1:c,firstFocusableSelector:s,isClickableOutsideFocusTrap:!0},l,{className:re.main,style:Y,elementToFocusOnDismiss:a}),h.createElement("div",{className:re.contentInner},h.createElement("div",{ref:this._allowScrollOnPanel,className:re.scrollableContent,"data-is-scrollable":!0},h.createElement("div",{className:re.commands,"data-is-visible":!0},E(this.props,this._onRenderNavigation)),(this._hasCustomNavigation||!d)&&T(this.props,this._onRenderHeader,this._headerTextId),L(this.props,this._onRenderBody),z(this.props,this._onRenderFooter)))))))},i.prototype.open=function(){this.props.isOpen===void 0&&(this.isActive||this.setState({visibility:De.animatingOpen}))},i.prototype.close=function(){this.props.isOpen===void 0&&(!this.isActive||this.setState({visibility:De.animatingClosed}))},Object.defineProperty(i.prototype,"isActive",{get:function(){return this.state.visibility===De.open||this.state.visibility===De.animatingOpen},enumerable:!1,configurable:!0}),i.prototype._shouldListenForOuterClick=function(n){return!!n.isBlocking&&!!n.isOpen},i.prototype._updateFooterPosition=function(){var n=this._scrollableContent;if(n){var e=n.clientHeight,r=n.scrollHeight;this.setState({isFooterSticky:e<r})}},i.prototype._dismissOnOuterClick=function(n){var e=this._panel.current;this.isActive&&e&&!n.defaultPrevented&&(o.elementContains(e,n.target)||(this.props.onOuterClick?this.props.onOuterClick(n):this.dismiss(n)))},i.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:He.smallFixedFar},i}(h.Component),Jn,_n,bn,Qn,ei,fd={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},wt={full:"100%",auto:"auto",xs:272,sm:340,md1:592,md2:644,lg:940},ut={auto:"auto",none:0,md:48,lg:428,xl:176},jt=(Jn={},Jn["@media (min-width: "+o.ScreenWidthMinMedium+"px)"]={width:wt.sm},Jn),yn=(_n={},_n["@media (min-width: "+o.ScreenWidthMinLarge+"px)"]={width:wt.md1},_n["@media (min-width: "+o.ScreenWidthMinXLarge+"px)"]={width:wt.md2},_n),ti=(bn={},bn["@media (min-width: "+o.ScreenWidthMinUhfMobile+"px)"]={left:ut.md,width:wt.auto},bn["@media (min-width: "+o.ScreenWidthMinXXLarge+"px)"]={left:ut.lg},bn),vd=(Qn={},Qn["@media (min-width: "+o.ScreenWidthMinXXLarge+"px)"]={left:ut.auto,width:wt.lg},Qn),pd=(ei={},ei["@media (min-width: "+o.ScreenWidthMinXXLarge+"px)"]={left:ut.xl},ei),_d=function(t){var i;switch(t){case He.smallFixedFar:i=o.__assign({},jt);break;case He.medium:i=o.__assign(o.__assign({},jt),yn);break;case He.large:i=o.__assign(o.__assign(o.__assign({},jt),yn),ti);break;case He.largeFixed:i=o.__assign(o.__assign(o.__assign(o.__assign({},jt),yn),ti),vd);break;case He.extraLarge:i=o.__assign(o.__assign(o.__assign(o.__assign({},jt),yn),ti),pd);break}return i},bd="44px",ni={paddingLeft:"24px",paddingRight:"24px"},yd=function(t){var i,n,e,r,a=t.className,s=t.focusTrapZoneClassName,l=t.hasCloseButton,c=t.headerClassName,d=t.isAnimating,g=t.isFooterSticky,m=t.isFooterAtBottom,u=t.isOnRightSide,f=t.isOpen,p=t.isHiddenOnDismiss,_=t.hasCustomNavigation,v=t.theme,b=t.type,y=b===void 0?He.smallFixedFar:b,C=v.effects,x=v.fonts,R=v.semanticColors,D=o.getGlobalClassNames(fd,v),S=y===He.custom||y===He.customNear;return{root:[D.root,v.fonts.medium,f&&D.isOpen,l&&D.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},S&&u&&D.custom,S&&!u&&D.customNear,a],overlay:[{pointerEvents:"auto",cursor:"pointer"},f&&d&&o.AnimationClassNames.fadeIn100,!f&&d&&o.AnimationClassNames.fadeOut100],hiddenPanel:[!f&&!d&&p&&{visibility:"hidden"}],main:[D.main,{backgroundColor:R.bodyBackground,boxShadow:C.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:ut.auto,right:ut.none,width:wt.full,selectors:o.__assign((i={},i[o.HighContrastSelector]={borderLeft:"3px solid "+R.variantBorder,borderRight:"3px solid "+R.variantBorder},i),_d(y))},y===He.smallFluid&&{left:ut.none},y===He.smallFixedNear&&{left:ut.none,right:ut.auto,width:wt.xs},y===He.customNear&&{right:"auto",left:0},S&&{maxWidth:"100vw"},f&&d&&!u&&o.AnimationClassNames.slideRightIn40,f&&d&&u&&o.AnimationClassNames.slideLeftIn40,!f&&d&&!u&&o.AnimationClassNames.slideLeftOut40,!f&&d&&u&&o.AnimationClassNames.slideRightOut40,s],commands:[D.commands,{marginTop:18,background:"inherit",selectors:(n={},n["@media (min-height: "+o.ScreenWidthMinMedium+"px)"]={position:"sticky",top:0,zIndex:1},n)},_&&{marginTop:"inherit"}],navigation:[D.navigation,{display:"flex",justifyContent:"flex-end"},_&&{height:bd}],contentInner:[D.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden",background:"inherit"}],header:[D.header,ni,{alignSelf:"flex-start"},l&&!_&&{flexGrow:1},_&&{flexShrink:0}],headerText:[D.headerText,x.xLarge,{color:R.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},c],scrollableContent:[D.scrollableContent,{overflowY:"auto",background:"inherit"},m&&{flexGrow:1,display:"inherit",flexDirection:"inherit"}],content:[D.content,ni,{paddingBottom:20},m&&{selectors:(e={},e["@media (min-height: "+o.ScreenWidthMinMedium+"px)"]={flexGrow:1},e)}],footer:[D.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity "+o.AnimationVariables.durationValue3+" "+o.AnimationVariables.easeFunction2,selectors:(r={},r["@media (min-height: "+o.ScreenWidthMinMedium+"px)"]={position:"sticky",bottom:0},r)},g&&{background:R.bodyBackground,borderTopColor:R.variantBorder}],footerInner:[D.footerInner,ni,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[D.closeButton,{marginRight:14,color:v.palette.neutralSecondary,fontSize:o.IconFontSizes.large},_&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:v.palette.neutralPrimary}}}}},Si=o.styled(md,yd,void 0,{scope:"Panel"}),So="Dropdown",Cd=o.classNamesFunction(),Sd={options:[]};function kd(t){var i=t.defaultSelectedKeys,n=t.selectedKeys,e=t.defaultSelectedKey,r=t.selectedKey,a=t.options,s=t.multiSelect,l=o.usePrevious(a),c=h.useState([]),d=c[0],g=c[1],m,u=a!==l;s?u&&i!==void 0?m=i:m=n:u&&e!==void 0?m=e:m=r;var f=o.usePrevious(m);return h.useEffect(function(){var p=function(){if(m===void 0){if(s)return _();var b=v(null);return b!==-1?[b]:[]}else if(!Array.isArray(m)){var b=v(m);return b!==-1?[b]:[]}for(var y=[],C=0,x=m;C<x.length;C++){var R=x[C],b=v(R);b!==-1&&y.push(b)}return y},_=function(){return a.map(function(b,y){return b.selected?y:-1}).filter(function(b){return b!==-1})},v=function(b){return o.findIndex(a,function(y){return b!=null?y.key===b:!!y.selected||!!y.isSelected})};(m!==void 0||!l)&&(m!==f||u)&&g(p())},[u,s,l,f,a,m]),[d,g]}var wr=h.forwardRef(function(t,i){var n=o.getPropsWithDefaults(Sd,t),e=h.useRef(null),r=o.useMergedRefs(i,e),a=o.useResponsiveMode(e,n.responsiveMode),s=kd(n),l=s[0],c=s[1];return h.createElement(Dd,o.__assign({},n,{responsiveMode:a,hoisted:{rootRef:r,selectedIndices:l,setSelectedIndices:c}}))});wr.displayName="DropdownBase";var Dd=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;e._host=h.createRef(),e._focusZone=h.createRef(),e._dropDown=h.createRef(),e._scrollIdleDelay=250,e._sizePosCache=new ud,e._requestAnimationFrame=aa(e),e._onChange=function(u,f,p,_,v){var b=e.props,y=b.onChange,C=b.onChanged;if(y||C){var x=v?o.__assign(o.__assign({},f[p]),{selected:!_}):f[p];y&&y(o.__assign(o.__assign({},u),{target:e._dropDown.current}),x,p),C&&C(x,p)}},e._getPlaceholder=function(){return e.props.placeholder||e.props.placeHolder},e._getTitle=function(u,f){var p=e.props.multiSelectDelimiter,_=p===void 0?", ":p;return u.map(function(v){return v.text}).join(_)},e._onRenderTitle=function(u){return h.createElement(h.Fragment,null,e._getTitle(u))},e._onRenderPlaceholder=function(u){return e._getPlaceholder()?h.createElement(h.Fragment,null,e._getPlaceholder()):null},e._onRenderContainer=function(u){var f=u.calloutProps,p=u.panelProps,_=e.props,v=_.responsiveMode,b=_.dropdownWidth,y=v<=o.ResponsiveMode.medium,C=e._classNames.subComponentStyles?e._classNames.subComponentStyles.panel:void 0,x=void 0,R=void 0;return b==="auto"?R=e._dropDown.current?e._dropDown.current.clientWidth:0:x=b||(e._dropDown.current?e._dropDown.current.clientWidth:0),y?h.createElement(Si,o.__assign({isOpen:!0,isLightDismiss:!0,onDismiss:e._onDismiss,hasCloseButton:!1,styles:C},p),e._renderFocusableList(u)):h.createElement(o.Callout,o.__assign({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:o.DirectionalHint.bottomLeftEdge,calloutWidth:x,calloutMinWidth:R},f,{className:e._classNames.callout,target:e._dropDown.current,onDismiss:e._onDismiss,onScroll:e._onScroll,onPositioned:e._onPositioned}),e._renderFocusableList(u))},e._onRenderCaretDown=function(u){return h.createElement(o.Icon,{className:e._classNames.caretDown,iconName:"ChevronDown","aria-hidden":!0})},e._onRenderList=function(u){var f=u.onRenderItem,p=f===void 0?e._onRenderItem:f,_={items:[]},v=[],b=function(){var C=_.id?[h.createElement("div",{role:"group",key:_.id,"aria-labelledby":_.id},_.items)]:_.items;v=o.__spreadArray(o.__spreadArray([],v),C),_={items:[]}},y=function(C,x){switch(C.itemType){case ct.Header:_.items.length>0&&b();var R=e._id+C.key;_.items.push(p(o.__assign(o.__assign({id:R},C),{index:x}),e._onRenderItem)),_.id=R;break;case ct.Divider:x>0&&_.items.push(p(o.__assign(o.__assign({},C),{index:x}),e._onRenderItem)),_.items.length>0&&b();break;default:_.items.push(p(o.__assign(o.__assign({},C),{index:x}),e._onRenderItem))}};return u.options.forEach(function(C,x){y(C,x)}),_.items.length>0&&b(),h.createElement(h.Fragment,null,v)},e._onRenderItem=function(u){switch(u.itemType){case ct.Divider:return e._renderSeparator(u);case ct.Header:return e._renderHeader(u);default:return e._renderOption(u)}},e._renderOption=function(u){var f=e.props,p=f.onRenderOption,_=p===void 0?e._onRenderOption:p,v=f.hoisted.selectedIndices,b=v===void 0?[]:v,y=u.index!==void 0&&b?b.indexOf(u.index)>-1:!1,C=u.hidden?e._classNames.dropdownItemHidden:y&&u.disabled===!0?e._classNames.dropdownItemSelectedAndDisabled:y?e._classNames.dropdownItemSelected:u.disabled===!0?e._classNames.dropdownItemDisabled:e._classNames.dropdownItem,x=u.title,R=e._classNames.subComponentStyles?e._classNames.subComponentStyles.multiSelectItem:void 0;return e.props.multiSelect?h.createElement(Wc,{id:e._listId+u.index,key:u.key,disabled:u.disabled,onChange:e._onItemClick(u),inputProps:o.__assign({"aria-selected":y,onMouseEnter:e._onItemMouseEnter.bind(e,u),onMouseLeave:e._onMouseItemLeave.bind(e,u),onMouseMove:e._onItemMouseMove.bind(e,u),role:"option"},{"data-index":u.index,"data-is-focusable":!u.disabled}),label:u.text,title:x,onRenderLabel:e._onRenderItemLabel.bind(e,u),className:C,checked:y,styles:R,ariaPositionInSet:e._sizePosCache.positionInSet(u.index),ariaSetSize:e._sizePosCache.optionSetSize,ariaLabel:u.ariaLabel}):h.createElement(En,{id:e._listId+u.index,key:u.key,"data-index":u.index,"data-is-focusable":!u.disabled,disabled:u.disabled,className:C,onClick:e._onItemClick(u),onMouseEnter:e._onItemMouseEnter.bind(e,u),onMouseLeave:e._onMouseItemLeave.bind(e,u),onMouseMove:e._onItemMouseMove.bind(e,u),role:"option","aria-selected":y?"true":"false",ariaLabel:u.ariaLabel,title:x,"aria-posinset":e._sizePosCache.positionInSet(u.index),"aria-setsize":e._sizePosCache.optionSetSize},_(u,e._onRenderOption))},e._onRenderOption=function(u){return h.createElement("span",{className:e._classNames.dropdownOptionText},u.text)},e._onRenderItemLabel=function(u){var f=e.props.onRenderOption,p=f===void 0?e._onRenderOption:f;return p(u,e._onRenderOption)},e._onPositioned=function(u){e._focusZone.current&&e._requestAnimationFrame(function(){var f=e.props.hoisted.selectedIndices;if(e._focusZone.current)if(!e._hasBeenPositioned&&f&&f[0]&&!e.props.options[f[0]].disabled){var p=o.getDocument().getElementById(e._id+"-list"+f[0]);p&&e._focusZone.current.focusElement(p),e._hasBeenPositioned=!0}else e._focusZone.current.focus()}),(!e.state.calloutRenderEdge||e.state.calloutRenderEdge!==u.targetEdge)&&e.setState({calloutRenderEdge:u.targetEdge})},e._onItemClick=function(u){return function(f){u.disabled||(e.setSelectedIndex(f,u.index),e.props.multiSelect||e.setState({isOpen:!1}))}},e._onScroll=function(){!e._isScrollIdle&&e._scrollIdleTimeoutId!==void 0?(clearTimeout(e._scrollIdleTimeoutId),e._scrollIdleTimeoutId=void 0):e._isScrollIdle=!1,e._scrollIdleTimeoutId=window.setTimeout(function(){e._isScrollIdle=!0},e._scrollIdleDelay)},e._onMouseItemLeave=function(u,f){if(!e._shouldIgnoreMouseEvent()&&e._host.current)if(e._host.current.setActive)try{e._host.current.setActive()}catch{}else e._host.current.focus()},e._onDismiss=function(){e.setState({isOpen:!1})},e._onDropdownBlur=function(u){var f=e._isDisabled();f||e.state.isOpen||(e.setState({hasFocus:!1}),e.props.onBlur&&e.props.onBlur(u))},e._onDropdownKeyDown=function(u){var f=e._isDisabled();if(!f&&(e._lastKeyDownWasAltOrMeta=e._isAltOrMeta(u),!(e.props.onKeyDown&&(e.props.onKeyDown(u),u.defaultPrevented)))){var p,_=e.props.hoisted.selectedIndices.length?e.props.hoisted.selectedIndices[0]:-1,v=u.altKey||u.metaKey,b=e.state.isOpen;switch(u.which){case o.KeyCodes.enter:e.setState({isOpen:!b});break;case o.KeyCodes.escape:if(!b)return;e.setState({isOpen:!1});break;case o.KeyCodes.up:if(v){if(b){e.setState({isOpen:!1});break}return}e.props.multiSelect?e.setState({isOpen:!0}):e._isDisabled()||(p=e._moveIndex(u,-1,_-1,_));break;case o.KeyCodes.down:v&&(u.stopPropagation(),u.preventDefault()),v&&!b||e.props.multiSelect?e.setState({isOpen:!0}):e._isDisabled()||(p=e._moveIndex(u,1,_+1,_));break;case o.KeyCodes.home:e.props.multiSelect||(p=e._moveIndex(u,1,0,_));break;case o.KeyCodes.end:e.props.multiSelect||(p=e._moveIndex(u,-1,e.props.options.length-1,_));break;case o.KeyCodes.space:break;default:return}p!==_&&(u.stopPropagation(),u.preventDefault())}},e._onDropdownKeyUp=function(u){var f=e._isDisabled();if(!f){var p=e._shouldHandleKeyUp(u),_=e.state.isOpen;if(!(e.props.onKeyUp&&(e.props.onKeyUp(u),u.defaultPrevented))){switch(u.which){case o.KeyCodes.space:e.setState({isOpen:!_});break;default:p&&_&&e.setState({isOpen:!1});return}u.stopPropagation(),u.preventDefault()}}},e._onZoneKeyDown=function(u){var f;e._lastKeyDownWasAltOrMeta=e._isAltOrMeta(u);var p=u.altKey||u.metaKey;switch(u.which){case o.KeyCodes.up:p?e.setState({isOpen:!1}):e._host.current&&(f=o.getLastFocusable(e._host.current,e._host.current.lastChild,!0));break;case o.KeyCodes.home:case o.KeyCodes.end:case o.KeyCodes.pageUp:case o.KeyCodes.pageDown:break;case o.KeyCodes.down:!p&&e._host.current&&(f=o.getFirstFocusable(e._host.current,e._host.current.firstChild,!0));break;case o.KeyCodes.escape:e.setState({isOpen:!1});break;case o.KeyCodes.tab:e.setState({isOpen:!1});return;default:return}f&&f.focus(),u.stopPropagation(),u.preventDefault()},e._onZoneKeyUp=function(u){var f=e._shouldHandleKeyUp(u);f&&e.state.isOpen&&(e.setState({isOpen:!1}),u.preventDefault())},e._onDropdownClick=function(u){if(!(e.props.onClick&&(e.props.onClick(u),u.defaultPrevented))){var f=e.state.isOpen,p=e._isDisabled();!p&&!e._shouldOpenOnFocus()&&e.setState({isOpen:!f}),e._isFocusedByClick=!1}},e._onDropdownMouseDown=function(){e._isFocusedByClick=!0},e._onFocus=function(u){var f=e._isDisabled();if(!f){e.props.onFocus&&e.props.onFocus(u);var p={hasFocus:!0};e._shouldOpenOnFocus()&&(p.isOpen=!0),e.setState(p)}},e._isDisabled=function(){var u=e.props.disabled,f=e.props.isDisabled;return u===void 0&&(u=f),u},e._onRenderLabel=function(u){var f=u.label,p=u.required,_=u.disabled,v=e._classNames.subComponentStyles?e._classNames.subComponentStyles.label:void 0;return f?h.createElement(ne.Label,{className:e._classNames.label,id:e._labelId,required:p,styles:v,disabled:_},f):null},o.initializeComponentRef(e);var r=n.multiSelect,a=n.selectedKey,s=n.selectedKeys,l=n.defaultSelectedKey,c=n.defaultSelectedKeys,d=n.options;if(process.env.NODE_ENV!=="production")if(o.warnDeprecations(So,n,{isDisabled:"disabled",onChanged:"onChange",placeHolder:"placeholder",onRenderPlaceHolder:"onRenderPlaceholder"}),o.warnMutuallyExclusive(So,n,{defaultSelectedKey:"selectedKey",defaultSelectedKeys:"selectedKeys",selectedKeys:"selectedKey"}),r){var g=function(u){return o.warn("Dropdown property '"+u+"' cannot be used when 'multiSelect' is true. Use '"+u+"s' instead.")};a!==void 0&&g("selectedKey"),l!==void 0&&g("defaultSelectedKey")}else{var m=function(u){return o.warn("Dropdown property '"+u+"s' cannot be used when 'multiSelect' is false/unset. Use '"+u+"' instead.")};s!==void 0&&m("selectedKey"),c!==void 0&&m("defaultSelectedKey")}return e._id=n.id||o.getId("Dropdown"),e._labelId=e._id+"-label",e._listId=e._id+"-list",e._optionId=e._id+"-option",e._isScrollIdle=!0,e._hasBeenPositioned=!1,e._sizePosCache.updateOptions(d),e.state={isOpen:!1,hasFocus:!1,calloutRenderEdge:void 0},e}return Object.defineProperty(i.prototype,"selectedOptions",{get:function(){var n=this.props,e=n.options,r=n.hoisted.selectedIndices;return bo(e,r)},enumerable:!1,configurable:!0}),i.prototype.componentWillUnmount=function(){clearTimeout(this._scrollIdleTimeoutId)},i.prototype.componentDidUpdate=function(n,e){e.isOpen===!0&&this.state.isOpen===!1&&(this._gotMouseMove=!1,this._hasBeenPositioned=!1,this.props.onDismiss&&this.props.onDismiss())},i.prototype.render=function(){var n=this._id,e=this.props,r=e.className,a=e.label,s=e.options,l=e.ariaLabel,c=e.required,d=e.errorMessage,g=e.styles,m=e.theme,u=e.panelProps,f=e.calloutProps,p=e.onRenderTitle,_=p===void 0?this._getTitle:p,v=e.onRenderContainer,b=v===void 0?this._onRenderContainer:v,y=e.onRenderCaretDown,C=y===void 0?this._onRenderCaretDown:y,x=e.onRenderLabel,R=x===void 0?this._onRenderLabel:x,D=e.hoisted.selectedIndices,S=this.state,I=S.isOpen,N=S.calloutRenderEdge,k=S.hasFocus,w=e.onRenderPlaceholder||e.onRenderPlaceHolder||this._getPlaceholder;s!==this._sizePosCache.cachedOptions&&this._sizePosCache.updateOptions(s);var E=bo(s,D),P=o.getNativeProps(e,o.divProperties),T=this._isDisabled(),M=n+"-errorMessage",L=T?void 0:I&&D.length===1&&D[0]>=0?this._listId+D[0]:void 0;this._classNames=Cd(g,{theme:m,className:r,hasError:!!(d&&d.length>0),hasLabel:!!a,isOpen:I,required:c,disabled:T,isRenderingPlaceholder:!E.length,panelClassName:u?u.className:void 0,calloutClassName:f?f.className:void 0,calloutRenderEdge:N});var B=!!d&&d.length>0;return h.createElement("div",{className:this._classNames.root,ref:this.props.hoisted.rootRef,"aria-owns":I?this._listId:void 0},R(this.props,this._onRenderLabel),h.createElement("div",o.__assign({"data-is-focusable":!T,"data-ktp-target":!0,ref:this._dropDown,id:n,tabIndex:T?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":I?"true":"false","aria-label":l,"aria-labelledby":a&&!l?o.mergeAriaAttributeValues(this._labelId,this._optionId):void 0,"aria-describedby":B?this._id+"-errorMessage":void 0,"aria-activedescendant":L,"aria-required":c,"aria-disabled":T,"aria-controls":I?this._listId:void 0},P,{className:this._classNames.dropdown,onBlur:this._onDropdownBlur,onKeyDown:this._onDropdownKeyDown,onKeyUp:this._onDropdownKeyUp,onClick:this._onDropdownClick,onMouseDown:this._onDropdownMouseDown,onFocus:this._onFocus}),h.createElement("span",{id:this._optionId,className:this._classNames.title,"aria-live":k?"polite":void 0,"aria-atomic":k?!0:void 0,"aria-invalid":B},E.length?_(E,this._onRenderTitle):w(e,this._onRenderPlaceholder)),h.createElement("span",{className:this._classNames.caretDownWrapper},C(e,this._onRenderCaretDown))),I&&b(o.__assign(o.__assign({},e),{onDismiss:this._onDismiss}),this._onRenderContainer),B&&h.createElement("div",{role:"alert",id:M,className:this._classNames.errorMessage},d))},i.prototype.focus=function(n){this._dropDown.current&&(this._dropDown.current.focus(),n&&this.setState({isOpen:!0}))},i.prototype.setSelectedIndex=function(n,e){var r=this.props,a=r.options,s=r.selectedKey,l=r.selectedKeys,c=r.multiSelect,d=r.notifyOnReselect,g=r.hoisted.selectedIndices,m=g===void 0?[]:g,u=m?m.indexOf(e)>-1:!1,f=[];if(e=Math.max(0,Math.min(a.length-1,e)),s!==void 0||l!==void 0){this._onChange(n,a,e,u,c);return}if(!(!c&&!d&&e===m[0])){if(c)if(f=m?this._copyArray(m):[],u){var p=f.indexOf(e);p>-1&&f.splice(p,1)}else f.push(e);else f=[e];n.persist(),this.props.hoisted.setSelectedIndices(f),this._onChange(n,a,e,u,c)}},i.prototype._copyArray=function(n){for(var e=[],r=0,a=n;r<a.length;r++){var s=a[r];e.push(s)}return e},i.prototype._moveIndex=function(n,e,r,a){var s=this.props.options;if(a===r||s.length===0)return a;r>=s.length?r=0:r<0&&(r=s.length-1);for(var l=0;s[r].itemType===ct.Header||s[r].itemType===ct.Divider||s[r].disabled;){if(l>=s.length)return a;r+e<0?r=s.length:r+e>=s.length&&(r=-1),r=r+e,l++}return this.setSelectedIndex(n,r),r},i.prototype._renderFocusableList=function(n){var e=n.onRenderList,r=e===void 0?this._onRenderList:e,a=n.label,s=n.ariaLabel,l=n.multiSelect;return h.createElement("div",{className:this._classNames.dropdownItemsWrapper,onKeyDown:this._onZoneKeyDown,onKeyUp:this._onZoneKeyUp,ref:this._host,tabIndex:0},h.createElement(o.FocusZone,{ref:this._focusZone,direction:o.FocusZoneDirection.vertical,id:this._listId,className:this._classNames.dropdownItems,role:"listbox","aria-label":s,"aria-labelledby":a&&!s?this._labelId:void 0,"aria-multiselectable":l},r(n,this._onRenderList)))},i.prototype._renderSeparator=function(n){var e=n.index,r=n.key;return e>0?h.createElement("div",{role:"separator",key:r,className:this._classNames.dropdownDivider}):null},i.prototype._renderHeader=function(n){var e=this.props.onRenderOption,r=e===void 0?this._onRenderOption:e,a=n.key,s=n.id;return h.createElement("div",{id:s,key:a,className:this._classNames.dropdownItemHeader},r(n,this._onRenderOption))},i.prototype._onItemMouseEnter=function(n,e){if(!this._shouldIgnoreMouseEvent()){var r=e.currentTarget;r.focus()}},i.prototype._onItemMouseMove=function(n,e){var r=e.currentTarget;this._gotMouseMove=!0,!(!this._isScrollIdle||document.activeElement===r)&&r.focus()},i.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},i.prototype._isAltOrMeta=function(n){return n.which===o.KeyCodes.alt||n.key==="Meta"},i.prototype._shouldHandleKeyUp=function(n){var e=this._lastKeyDownWasAltOrMeta&&this._isAltOrMeta(n);return this._lastKeyDownWasAltOrMeta=!1,!!e&&!(o.isMac()||o.isIOS())},i.prototype._shouldOpenOnFocus=function(){var n=this.state.hasFocus,e=this.props.openOnKeyboardFocus;return!this._isFocusedByClick&&e===!0&&!n},i.defaultProps={options:[]},i}(h.Component),ii,oi,ri,xd={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},Cn=32,ai=36,wd=(ii={},ii[o.HighContrastSelector+", "+o.HighContrastSelectorWhite.replace("@media ","")]=o.__assign({},o.getHighContrastNoAdjustStyle()),ii),Sn={selectors:o.__assign((oi={},oi[o.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},oi),wd)},ko={selectors:(ri={},ri[o.HighContrastSelector]={borderColor:"Highlight"},ri)},Id=o.getScreenSelector(0,o.ScreenWidthMinMedium),Rd=function(t){var i,n,e,r,a,s,l,c,d,g,m,u,f=t.theme,p=t.hasError,_=t.hasLabel,v=t.className,b=t.isOpen,y=t.disabled,C=t.required,x=t.isRenderingPlaceholder,R=t.panelClassName,D=t.calloutClassName,S=t.calloutRenderEdge;if(!f)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var I=o.getGlobalClassNames(xd,f),N=f.palette,k=f.semanticColors,w=f.effects,E=f.fonts,P={color:k.menuItemTextHovered},T={color:k.menuItemText},M={borderColor:k.errorText},L=[I.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",width:"100%",minHeight:ai,lineHeight:20,height:0,position:"relative",border:"1px solid transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",".ms-Button-flexContainer":{width:"100%"}}],B=k.menuItemBackgroundPressed,z=function(G){var A;return G===void 0&&(G=!1),{selectors:(A={"&:hover:focus":[{color:k.menuItemTextHovered,backgroundColor:G?B:k.menuItemBackgroundHovered},Sn],"&:focus":[{backgroundColor:G?B:"transparent"},Sn],"&:active":[{color:k.menuItemTextHovered,backgroundColor:G?k.menuItemBackgroundHovered:k.menuBackground},Sn]},A["."+o.IsFocusVisibleClassName+" &:focus:after"]={left:0,top:0,bottom:0,right:0},A[o.HighContrastSelector]={border:"none"},A)}},H=o.__spreadArray(o.__spreadArray([],L),[{backgroundColor:B,color:k.menuItemTextHovered},z(!0),Sn]),O=o.__spreadArray(o.__spreadArray([],L),[{color:k.disabledText,cursor:"default",selectors:(i={},i[o.HighContrastSelector]={color:"GrayText",border:"none"},i)}]),V=S===o.RectangleEdge.bottom?w.roundedCorner2+" "+w.roundedCorner2+" 0 0":"0 0 "+w.roundedCorner2+" "+w.roundedCorner2,W=S===o.RectangleEdge.bottom?"0 0 "+w.roundedCorner2+" "+w.roundedCorner2:w.roundedCorner2+" "+w.roundedCorner2+" 0 0";return{root:[I.root,v],label:I.label,dropdown:[I.dropdown,ne.normalize,E.medium,{color:k.menuItemText,borderColor:k.focusBorder,position:"relative",outline:0,userSelect:"none",selectors:(n={},n["&:hover ."+I.title]=[!y&&P,{borderColor:b?N.neutralSecondary:N.neutralPrimary},ko],n["&:focus ."+I.title]=[!y&&P,{selectors:(e={},e[o.HighContrastSelector]={color:"Highlight"},e)}],n["&:focus:after"]=[{pointerEvents:"none",content:"''",position:"absolute",boxSizing:"border-box",top:"0px",left:"0px",width:"100%",height:"100%",border:y?"none":"2px solid "+N.themePrimary,borderRadius:"2px",selectors:(r={},r[o.HighContrastSelector]={color:"Highlight"},r)}],n["&:active ."+I.title]=[!y&&P,{borderColor:N.themePrimary},ko],n["&:hover ."+I.caretDown]=!y&&T,n["&:focus ."+I.caretDown]=[!y&&T,{selectors:(a={},a[o.HighContrastSelector]={color:"Highlight"},a)}],n["&:active ."+I.caretDown]=!y&&T,n["&:hover ."+I.titleIsPlaceHolder]=!y&&T,n["&:focus ."+I.titleIsPlaceHolder]=!y&&T,n["&:active ."+I.titleIsPlaceHolder]=!y&&T,n["&:hover ."+I.titleHasError]=M,n["&:active ."+I.titleHasError]=M,n)},b&&"is-open",y&&"is-disabled",C&&"is-required",C&&!_&&{selectors:(s={":before":{content:"'*'",color:k.errorText,position:"absolute",top:-5,right:-10}},s[o.HighContrastSelector]={selectors:{":after":{right:-14}}},s)}],title:[I.title,ne.normalize,{backgroundColor:k.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:k.inputBorder,borderRadius:b?V:w.roundedCorner2,cursor:"pointer",display:"block",height:Cn,lineHeight:Cn-2,padding:"0 28px 0 8px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},x&&[I.titleIsPlaceHolder,{color:k.inputPlaceholderText}],p&&[I.titleHasError,M],y&&{backgroundColor:k.disabledBackground,border:"none",color:k.disabledText,cursor:"default",selectors:(l={},l[o.HighContrastSelector]=o.__assign({border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},o.getHighContrastNoAdjustStyle()),l)}],caretDownWrapper:[I.caretDownWrapper,{height:Cn,lineHeight:Cn-2,paddingTop:1,position:"absolute",right:8,top:0},!y&&{cursor:"pointer"}],caretDown:[I.caretDown,{color:N.neutralSecondary,fontSize:E.small.fontSize,pointerEvents:"none"},y&&{color:k.disabledText,selectors:(c={},c[o.HighContrastSelector]=o.__assign({color:"GrayText"},o.getHighContrastNoAdjustStyle()),c)}],errorMessage:o.__assign(o.__assign({color:k.errorText},f.fonts.small),{paddingTop:5}),callout:[I.callout,{boxShadow:w.elevation8,borderRadius:W,selectors:(d={},d[".ms-Callout-main"]={borderRadius:W},d)},D],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[I.dropdownItems,{display:"block"}],dropdownItem:o.__spreadArray(o.__spreadArray([],L),[z()]),dropdownItemSelected:H,dropdownItemDisabled:O,dropdownItemSelectedAndDisabled:[H,O,{backgroundColor:"transparent"}],dropdownItemHidden:o.__spreadArray(o.__spreadArray([],L),[{display:"none"}]),dropdownDivider:[I.dropdownDivider,{height:1,backgroundColor:k.bodyDivider}],dropdownOptionText:[I.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:[I.dropdownItemHeader,o.__assign(o.__assign({},E.medium),{fontWeight:o.FontWeights.semibold,color:k.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:ai,lineHeight:ai,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(g={},g[o.HighContrastSelector]=o.__assign({color:"GrayText"},o.getHighContrastNoAdjustStyle()),g)})],subComponentStyles:{label:{root:{display:"inline-block"}},multiSelectItem:{root:{padding:0},label:{alignSelf:"stretch",padding:"0 8px",width:"100%"},input:{selectors:(m={},m["."+o.IsFocusVisibleClassName+" &:focus + label::before"]={outlineOffset:"0px"},m)}},panel:{root:[R],main:{selectors:(u={},u[Id]={width:272},u)},contentInner:{padding:"0 0 20px"}}}}},Ir=o.styled(wr,Rd,void 0,{scope:"Dropdown"});Ir.displayName="Dropdown";var de;(function(t){t[t.none=0]="none",t[t.forceResolve=1]="forceResolve",t[t.searchMore=2]="searchMore"})(de||(de={}));o.loadStyles([{rawString:".root_2f55324e{min-width:260px}.suggestionsItem_2f55324e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;position:relative;overflow:hidden}.suggestionsItem_2f55324e:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.suggestionsItem_2f55324e:hover .closeButton_2f55324e{display:block}.suggestionsItem_2f55324e.suggestionsItemIsSuggested_2f55324e{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsItem_2f55324e.suggestionsItemIsSuggested_2f55324e:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active){.suggestionsItem_2f55324e.suggestionsItemIsSuggested_2f55324e:hover{background:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast:active){.suggestionsItem_2f55324e.suggestionsItemIsSuggested_2f55324e{background:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsItem_2f55324e.suggestionsItemIsSuggested_2f55324e .closeButton_2f55324e:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active){.suggestionsItem_2f55324e.suggestionsItemIsSuggested_2f55324e .itemButton_2f55324e{color:HighlightText}}.suggestionsItem_2f55324e .closeButton_2f55324e{display:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.suggestionsItem_2f55324e .closeButton_2f55324e:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.actionButton_2f55324e{background-color:transparent;border:0;cursor:pointer;margin:0;position:relative;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:40px;width:100%;font-size:12px}[dir=ltr] .actionButton_2f55324e{padding-left:8px}[dir=rtl] .actionButton_2f55324e{padding-right:8px}html[dir=ltr] .actionButton_2f55324e{text-align:left}html[dir=rtl] .actionButton_2f55324e{text-align:right}.actionButton_2f55324e:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.actionButton_2f55324e:active,.actionButton_2f55324e:focus{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_2f55324e .ms-Button-icon{font-size:16px;width:25px}.actionButton_2f55324e .ms-Button-label{margin:0 4px 0 9px}html[dir=rtl] .actionButton_2f55324e .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_2f55324e{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.suggestionsTitle_2f55324e{padding:0 12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsContainer_2f55324e{overflow-y:auto;overflow-x:hidden;max-height:300px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsNone_2f55324e{text-align:center;color:#797775;font-size:12px;line-height:30px}.suggestionsSpinner_2f55324e{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir=ltr] .suggestionsSpinner_2f55324e{padding-left:14px}html[dir=rtl] .suggestionsSpinner_2f55324e{padding-right:14px}html[dir=ltr] .suggestionsSpinner_2f55324e{text-align:left}html[dir=rtl] .suggestionsSpinner_2f55324e{text-align:right}.suggestionsSpinner_2f55324e .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_2f55324e .ms-Spinner-label{display:inline-block;margin:0 10px 0 16px;vertical-align:middle}html[dir=rtl] .suggestionsSpinner_2f55324e .ms-Spinner-label{margin:0 16px 0 10px}.itemButton_2f55324e.itemButton_2f55324e{width:100%;padding:0;min-width:0;height:100%}@media screen and (-ms-high-contrast:active){.itemButton_2f55324e.itemButton_2f55324e{color:WindowText}}.itemButton_2f55324e.itemButton_2f55324e:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.closeButton_2f55324e.closeButton_2f55324e{padding:0 4px;height:auto;width:32px}@media screen and (-ms-high-contrast:active){.closeButton_2f55324e.closeButton_2f55324e{color:WindowText}}.closeButton_2f55324e.closeButton_2f55324e:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.suggestionsAvailable_2f55324e{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var Nd="root_2f55324e",Ed="suggestionsItem_2f55324e",Td="closeButton_2f55324e",Pd="suggestionsItemIsSuggested_2f55324e",Ad="itemButton_2f55324e",Fd="actionButton_2f55324e",Hd="buttonSelected_2f55324e",Md="suggestionsTitle_2f55324e",Ld="suggestionsContainer_2f55324e",zd="suggestionsNone_2f55324e",Bd="suggestionsSpinner_2f55324e",Od="suggestionsAvailable_2f55324e";const Rr=Object.freeze(Object.defineProperty({__proto__:null,root:Nd,suggestionsItem:Ed,closeButton:Td,suggestionsItemIsSuggested:Pd,itemButton:Ad,actionButton:Fd,buttonSelected:Hd,suggestionsTitle:Md,suggestionsContainer:Ld,suggestionsNone:zd,suggestionsSpinner:Bd,suggestionsAvailable:Od},Symbol.toStringTag,{value:"Module"}));var kn=Rr,Wd=o.classNamesFunction(),Gd=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return o.initializeComponentRef(e),e}return i.prototype.render=function(){var n,e=this.props,r=e.suggestionModel,a=e.RenderSuggestion,s=e.onClick,l=e.className,c=e.id,d=e.onRemoveItem,g=e.isSelectedOverride,m=e.removeButtonAriaLabel,u=e.styles,f=e.theme,p=e.removeButtonIconProps,_=u?Wd(u,{theme:f,className:l,suggested:r.selected||g}):{root:o.css("ms-Suggestions-item",kn.suggestionsItem,(n={},n["is-suggested "+kn.suggestionsItemIsSuggested]=r.selected||g,n),l),itemButton:o.css("ms-Suggestions-itemButton",kn.itemButton),closeButton:o.css("ms-Suggestions-closeButton",kn.closeButton)};return h.createElement("div",{className:_.root,role:"presentation"},h.createElement(En,{onClick:s,className:_.itemButton,id:c,"aria-selected":r.selected,role:"option","aria-label":r.ariaLabel},a(r.item,this.props)),this.props.showRemoveButton?h.createElement(o.IconButton,{iconProps:p!=null?p:{iconName:"Cancel"},styles:{icon:{fontSize:"12px"}},title:m,ariaLabel:m,onClick:d,className:_.closeButton}):null)},i}(h.Component),Nr={root:"ms-Suggestions-item",itemButton:"ms-Suggestions-itemButton",closeButton:"ms-Suggestions-closeButton",isSuggested:"is-suggested"};function Vd(t){var i,n,e,r,a,s,l=t.className,c=t.theme,d=t.suggested,g=c.palette,m=c.semanticColors,u=o.getGlobalClassNames(Nr,c);return{root:[u.root,{display:"flex",alignItems:"stretch",boxSizing:"border-box",width:"100%",position:"relative",selectors:{"&:hover":{background:m.menuItemBackgroundHovered},"&:hover .ms-Suggestions-closeButton":{display:"block"}}},d&&{selectors:(i={},i["."+o.IsFocusVisibleClassName+" &"]={selectors:(n={},n["."+u.closeButton]={display:"block",background:m.menuItemBackgroundPressed},n)},i[":after"]={pointerEvents:"none",content:'""',position:"absolute",left:0,top:0,bottom:0,right:0,border:"1px solid "+c.semanticColors.focusBorder},i)},l],itemButton:[u.itemButton,{width:"100%",padding:0,border:"none",height:"100%",minWidth:0,overflow:"hidden",selectors:(e={},e[o.HighContrastSelector]={color:"WindowText",selectors:{":hover":o.__assign({background:"Highlight",color:"HighlightText"},o.getHighContrastNoAdjustStyle())}},e[":hover"]={color:m.menuItemTextHovered},e)},d&&[u.isSuggested,{background:m.menuItemBackgroundPressed,selectors:(r={":hover":{background:m.menuDivider}},r[o.HighContrastSelector]=o.__assign({background:"Highlight",color:"HighlightText"},o.getHighContrastNoAdjustStyle()),r)}]],closeButton:[u.closeButton,{display:"none",color:g.neutralSecondary,padding:"0 4px",height:"auto",width:32,selectors:(a={":hover, :active":{background:g.neutralTertiaryAlt,color:g.neutralDark}},a[o.HighContrastSelector]={color:"WindowText"},a)},d&&(s={},s["."+o.IsFocusVisibleClassName+" &"]={selectors:{":hover, :active":{background:g.neutralTertiary}}},s.selectors={":hover, :active":{background:g.neutralTertiary,color:g.neutralPrimary}},s)]}}var st=Rr,Kd=o.classNamesFunction(),Ud=o.styled(Gd,Vd,void 0,{scope:"SuggestionItem"}),Yd=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return e._forceResolveButton=h.createRef(),e._searchForMoreButton=h.createRef(),e._selectedElement=h.createRef(),e._scrollContainer=h.createRef(),e.tryHandleKeyDown=function(r,a){var s=!1,l=null,c=e.state.selectedActionType,d=e.props.suggestions.length;if(r===o.KeyCodes.down)switch(c){case de.forceResolve:d>0?(e._refocusOnSuggestions(r),l=de.none):e._searchForMoreButton.current?l=de.searchMore:l=de.forceResolve;break;case de.searchMore:e._forceResolveButton.current?l=de.forceResolve:d>0?(e._refocusOnSuggestions(r),l=de.none):l=de.searchMore;break;case de.none:a===-1&&e._forceResolveButton.current&&(l=de.forceResolve);break}else if(r===o.KeyCodes.up)switch(c){case de.forceResolve:e._searchForMoreButton.current?l=de.searchMore:d>0&&(e._refocusOnSuggestions(r),l=de.none);break;case de.searchMore:d>0?(e._refocusOnSuggestions(r),l=de.none):e._forceResolveButton.current&&(l=de.forceResolve);break;case de.none:a===-1&&e._searchForMoreButton.current&&(l=de.searchMore);break}return l!==null&&(e.setState({selectedActionType:l}),s=!0),s},e._getAlertText=function(){var r=e.props,a=r.isLoading,s=r.isSearching,l=r.suggestions,c=r.suggestionsAvailableAlertText,d=r.noResultsFoundText;if(!a&&!s){if(l.length>0)return c||"";if(d)return d}return""},e._getMoreResults=function(){e.props.onGetMoreResults&&(e.props.onGetMoreResults(),e.setState({selectedActionType:de.none}))},e._forceResolve=function(){e.props.createGenericItem&&e.props.createGenericItem()},e._shouldShowForceResolve=function(){return e.props.showForceResolve?e.props.showForceResolve():!1},e._onClickTypedSuggestionsItem=function(r,a){return function(s){e.props.onSuggestionClick(s,r,a)}},e._refocusOnSuggestions=function(r){typeof e.props.refocusSuggestions=="function"&&e.props.refocusSuggestions(r)},e._onRemoveTypedSuggestionsItem=function(r,a){return function(s){var l=e.props.onSuggestionRemove;l(s,r,a),s.stopPropagation()}},o.initializeComponentRef(e),e.state={selectedActionType:de.none},e}return i.prototype.componentDidMount=function(){this.scrollSelected(),this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null},i.prototype.componentDidUpdate=function(){this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current&&(this.scrollSelected(),this.activeSelectedElement=this._selectedElement.current)},i.prototype.render=function(){var n,e,r=this,a=this.props,s=a.forceResolveText,l=a.mostRecentlyUsedHeaderText,c=a.searchForMoreIcon,d=a.searchForMoreText,g=a.className,m=a.moreSuggestionsAvailable,u=a.noResultsFoundText,f=a.suggestions,p=a.isLoading,_=a.isSearching,v=a.loadingText,b=a.onRenderNoResultFound,y=a.searchingText,C=a.isMostRecentlyUsedVisible,x=a.resultsMaximumNumber,R=a.resultsFooterFull,D=a.resultsFooter,S=a.isResultsFooterVisible,I=S===void 0?!0:S,N=a.suggestionsHeaderText,k=a.suggestionsClassName,w=a.theme,E=a.styles,P=a.suggestionsListId,T=a.suggestionsContainerAriaLabel;this._classNames=E?Kd(E,{theme:w,className:g,suggestionsClassName:k,forceResolveButtonSelected:this.state.selectedActionType===de.forceResolve,searchForMoreButtonSelected:this.state.selectedActionType===de.searchMore}):{root:o.css("ms-Suggestions",g,st.root),title:o.css("ms-Suggestions-title",st.suggestionsTitle),searchForMoreButton:o.css("ms-SearchMore-button",st.actionButton,(n={},n["is-selected "+st.buttonSelected]=this.state.selectedActionType===de.searchMore,n)),forceResolveButton:o.css("ms-forceResolve-button",st.actionButton,(e={},e["is-selected "+st.buttonSelected]=this.state.selectedActionType===de.forceResolve,e)),suggestionsAvailable:o.css("ms-Suggestions-suggestionsAvailable",st.suggestionsAvailable),suggestionsContainer:o.css("ms-Suggestions-container",st.suggestionsContainer,k),noSuggestions:o.css("ms-Suggestions-none",st.suggestionsNone)};var M=this._classNames.subComponentStyles?this._classNames.subComponentStyles.spinner:void 0,L=E?{styles:M}:{className:o.css("ms-Suggestions-spinner",st.suggestionsSpinner)},B=function(){return h.createElement("div",{id:"sug-noResultsFound",role:"option"},b?b(void 0,B):h.createElement("div",{className:r._classNames.noSuggestions},u))},z=N;C&&l&&(z=l);var H=void 0;I&&(H=f.length>=x?R:D);var O=(!f||!f.length)&&!p,V=this.state.selectedActionType===de.forceResolve?"sug-selectedAction":void 0,W=this.state.selectedActionType===de.searchMore?"sug-selectedAction":void 0;return h.createElement("div",{className:this._classNames.root,"aria-label":T||z,id:P,role:"listbox"},h.createElement(Pl,{message:this._getAlertText(),"aria-live":"polite"}),z?h.createElement("div",{className:this._classNames.title},z):null,s&&this._shouldShowForceResolve()&&h.createElement(En,{componentRef:this._forceResolveButton,className:this._classNames.forceResolveButton,id:V,onClick:this._forceResolve,"data-automationid":"sug-forceResolve"},s),p&&h.createElement(di,o.__assign({},L,{label:v})),O?B():this._renderSuggestions(),d&&m&&h.createElement(En,{componentRef:this._searchForMoreButton,className:this._classNames.searchForMoreButton,iconProps:c||{iconName:"Search"},id:W,onClick:this._getMoreResults,"data-automationid":"sug-searchForMore",role:"option"},d),_?h.createElement(di,o.__assign({},L,{label:y})):null,H&&!m&&!C&&!_?h.createElement("div",{className:this._classNames.title},H(this.props)):null)},i.prototype.hasSuggestedAction=function(){return!!this._searchForMoreButton.current||!!this._forceResolveButton.current},i.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==de.none},i.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case de.forceResolve:this._forceResolve();break;case de.searchMore:this._getMoreResults();break}},i.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:de.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:de.searchMore})},i.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:de.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:de.forceResolve})},i.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()},i.prototype.scrollSelected=function(){if(this._selectedElement.current&&this._scrollContainer.current&&this._scrollContainer.current.scrollTo!==void 0){var n=this._selectedElement.current,e=n.offsetHeight,r=n.offsetTop,a=this._scrollContainer.current,s=a.offsetHeight,l=a.scrollTop,c=r<l,d=r+e>l+s;c?this._scrollContainer.current.scrollTo(0,r):d&&this._scrollContainer.current.scrollTo(0,r-s+e)}},i.prototype._renderSuggestions=function(){var n=this,e=this.props,r=e.onRenderSuggestion,a=e.removeSuggestionAriaLabel,s=e.suggestionsItemClassName,l=e.resultsMaximumNumber,c=e.showRemoveButtons,d=e.removeButtonIconProps,g=this.props.suggestions,m=Ud,u=-1;return g.some(function(f,p){return f.selected?(u=p,!0):!1}),l&&(g=u>=l?g.slice(u-l+1,u+1):g.slice(0,l)),g.length===0?null:h.createElement("div",{className:this._classNames.suggestionsContainer,ref:this._scrollContainer,role:"presentation"},g.map(function(f,p){return h.createElement("div",{ref:f.selected?n._selectedElement:void 0,key:f.item.key?f.item.key:p,role:"presentation"},h.createElement(m,{suggestionModel:f,RenderSuggestion:r,onClick:n._onClickTypedSuggestionsItem(f.item,p),className:s,showRemoveButton:c,removeButtonAriaLabel:a,onRemoveItem:n._onRemoveTypedSuggestionsItem(f.item,p),id:"sug-"+p,removeButtonIconProps:d}))}))},i}(h.Component),$d=function(){function t(){var i=this;this._isSuggestionModel=function(n){return n.item!==void 0},this._ensureSuggestionModel=function(n){return i._isSuggestionModel(n)?n:{item:n,selected:!1,ariaLabel:n.name||n.primaryText}},this.suggestions=[],this.currentIndex=-1}return t.prototype.updateSuggestions=function(i,n){i&&i.length>0?(this.suggestions=this.convertSuggestionsToSuggestionItems(i),this.currentIndex=n||0,n===-1?this.currentSuggestion=void 0:n!==void 0&&(this.suggestions[n].selected=!0,this.currentSuggestion=this.suggestions[n])):(this.suggestions=[],this.currentIndex=-1,this.currentSuggestion=void 0)},t.prototype.nextSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex<this.suggestions.length-1)return this.setSelectedSuggestion(this.currentIndex+1),!0;if(this.currentIndex===this.suggestions.length-1)return this.setSelectedSuggestion(0),!0}return!1},t.prototype.previousSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex>0)return this.setSelectedSuggestion(this.currentIndex-1),!0;if(this.currentIndex===0)return this.setSelectedSuggestion(this.suggestions.length-1),!0}return!1},t.prototype.getSuggestions=function(){return this.suggestions},t.prototype.getCurrentItem=function(){return this.currentSuggestion},t.prototype.getSuggestionAtIndex=function(i){return this.suggestions[i]},t.prototype.hasSelectedSuggestion=function(){return!!this.currentSuggestion},t.prototype.removeSuggestion=function(i){this.suggestions.splice(i,1)},t.prototype.createGenericSuggestion=function(i){var n=this.convertSuggestionsToSuggestionItems([i])[0];this.currentSuggestion=n},t.prototype.convertSuggestionsToSuggestionItems=function(i){return Array.isArray(i)?i.map(this._ensureSuggestionModel):[]},t.prototype.deselectAllSuggestions=function(){this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1,this.currentIndex=-1)},t.prototype.setSelectedSuggestion=function(i){i>this.suggestions.length-1||i<0?(this.currentIndex=0,this.currentSuggestion.selected=!1,this.currentSuggestion=this.suggestions[0],this.currentSuggestion.selected=!0):(this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1),this.suggestions[i].selected=!0,this.currentIndex=i,this.currentSuggestion=this.suggestions[i])},t}(),jd={root:"ms-Suggestions",suggestionsContainer:"ms-Suggestions-container",title:"ms-Suggestions-title",forceResolveButton:"ms-forceResolve-button",searchForMoreButton:"ms-SearchMore-button",spinner:"ms-Suggestions-spinner",noSuggestions:"ms-Suggestions-none",suggestionsAvailable:"ms-Suggestions-suggestionsAvailable",isSelected:"is-selected"};function Zd(t){var i,n=t.className,e=t.suggestionsClassName,r=t.theme,a=t.forceResolveButtonSelected,s=t.searchForMoreButtonSelected,l=r.palette,c=r.semanticColors,d=r.fonts,g=o.getGlobalClassNames(jd,r),m={backgroundColor:"transparent",border:0,cursor:"pointer",margin:0,paddingLeft:8,position:"relative",borderTop:"1px solid "+l.neutralLight,height:40,textAlign:"left",width:"100%",fontSize:d.small.fontSize,selectors:{":hover":{backgroundColor:c.menuItemBackgroundPressed,cursor:"pointer"},":focus, :active":{backgroundColor:l.themeLight},".ms-Button-icon":{fontSize:d.mediumPlus.fontSize,width:25},".ms-Button-label":{margin:"0 4px 0 9px"}}},u={backgroundColor:l.themeLight,selectors:(i={},i[o.HighContrastSelector]=o.__assign({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},o.getHighContrastNoAdjustStyle()),i)};return{root:[g.root,{minWidth:260},n],suggestionsContainer:[g.suggestionsContainer,{overflowY:"auto",overflowX:"hidden",maxHeight:300,transform:"translate3d(0,0,0)"},e],title:[g.title,{padding:"0 12px",fontSize:d.small.fontSize,color:l.themePrimary,lineHeight:40,borderBottom:"1px solid "+c.menuItemBackgroundPressed}],forceResolveButton:[g.forceResolveButton,m,a&&[g.isSelected,u]],searchForMoreButton:[g.searchForMoreButton,m,s&&[g.isSelected,u]],noSuggestions:[g.noSuggestions,{textAlign:"center",color:l.neutralSecondary,fontSize:d.small.fontSize,lineHeight:30}],suggestionsAvailable:[g.suggestionsAvailable,o.hiddenContentStyle],subComponentStyles:{spinner:{root:[g.spinner,{margin:"5px 0",paddingLeft:14,textAlign:"left",whiteSpace:"nowrap",lineHeight:20,fontSize:d.small.fontSize}],circle:{display:"inline-block",verticalAlign:"middle"},label:{display:"inline-block",verticalAlign:"middle",margin:"0 10px 0 16px"}}}}}var Ct;(function(t){t[t.valid=0]="valid",t[t.warning=1]="warning",t[t.invalid=2]="invalid"})(Ct||(Ct={}));o.loadStyles([{rawString:".pickerText_15a92175{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";min-width:180px;min-height:30px}.pickerText_15a92175:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#323130"},{rawString:"}.pickerText_15a92175.inputFocused_15a92175{position:relative;border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}.pickerText_15a92175.inputFocused_15a92175:after{pointer-events:none;content:'';position:absolute;left:-1px;top:-1px;bottom:-1px;right:-1px;border:2px solid "},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast:active){.pickerText_15a92175.inputDisabled_15a92175{position:relative;border-color:GrayText}.pickerText_15a92175.inputDisabled_15a92175:after{pointer-events:none;content:'';position:absolute;left:0;top:0;bottom:0;right:0;background-color:Window}}.pickerInput_15a92175{height:34px;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:0;padding:0 6px 0;-ms-flex-item-align:end;align-self:flex-end}.pickerItems_15a92175{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;max-width:100%}.screenReaderOnly_15a92175{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var qd="pickerText_15a92175",Xd="inputFocused_15a92175",Jd="inputDisabled_15a92175",Qd="pickerInput_15a92175",eu="pickerItems_15a92175",tu="screenReaderOnly_15a92175";const nu=Object.freeze(Object.defineProperty({__proto__:null,pickerText:qd,inputFocused:Xd,inputDisabled:Jd,pickerInput:Qd,pickerItems:eu,screenReaderOnly:tu},Symbol.toStringTag,{value:"Module"}));var Je=nu,Er=o.classNamesFunction();function iu(t){return o.styled(t,Zd,void 0,{scope:"Suggestions"})}var ki=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;e.root=h.createRef(),e.input=h.createRef(),e.suggestionElement=h.createRef(),e.SuggestionOfProperType=Yd,e._styledSuggestions=iu(e.SuggestionOfProperType),e.dismissSuggestions=function(a){var s=function(){var l=!0;e.props.onDismiss&&(l=e.props.onDismiss(a,e.suggestionStore.currentSuggestion?e.suggestionStore.currentSuggestion.item:void 0)),(!a||a&&!a.defaultPrevented)&&l!==!1&&e.canAddItems()&&e.suggestionStore.hasSelectedSuggestion()&&e.state.suggestedDisplayValue&&e.addItemByIndex(0)};e.currentPromise?e.currentPromise.then(function(){return s()}):s(),e.setState({suggestionsVisible:!1})},e.refocusSuggestions=function(a){e.resetFocus(),e.suggestionStore.suggestions&&e.suggestionStore.suggestions.length>0&&(a===o.KeyCodes.up?e.suggestionStore.setSelectedSuggestion(e.suggestionStore.suggestions.length-1):a===o.KeyCodes.down&&e.suggestionStore.setSelectedSuggestion(0))},e.onInputChange=function(a){e.updateValue(a),e.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})},e.onSuggestionClick=function(a,s,l){e.addItemByIndex(l)},e.onSuggestionRemove=function(a,s,l){e.props.onRemoveSuggestion&&e.props.onRemoveSuggestion(s),e.suggestionStore.removeSuggestion(l)},e.onInputFocus=function(a){e.selection.setAllSelected(!1),e.state.isFocused||(e._userTriggeredSuggestions(),e.props.inputProps&&e.props.inputProps.onFocus&&e.props.inputProps.onFocus(a))},e.onInputBlur=function(a){e.props.inputProps&&e.props.inputProps.onBlur&&e.props.inputProps.onBlur(a)},e.onBlur=function(a){if(e.state.isFocused){var s=a.relatedTarget;a.relatedTarget===null&&(s=document.activeElement),s&&!o.elementContains(e.root.current,s)&&(e.setState({isFocused:!1}),e.props.onBlur&&e.props.onBlur(a))}},e.onClick=function(a){e.props.inputProps!==void 0&&e.props.inputProps.onClick!==void 0&&e.props.inputProps.onClick(a),a.button===0&&e._userTriggeredSuggestions()},e.onFocus=function(){e.state.isFocused||e.setState({isFocused:!0})},e.onKeyDown=function(a){var s=a.which;switch(s){case o.KeyCodes.escape:e.state.suggestionsVisible&&(e.setState({suggestionsVisible:!1}),a.preventDefault(),a.stopPropagation());break;case o.KeyCodes.tab:case o.KeyCodes.enter:e.suggestionElement.current&&e.suggestionElement.current.hasSuggestedActionSelected()?e.suggestionElement.current.executeSelectedAction():!a.shiftKey&&e.suggestionStore.hasSelectedSuggestion()&&e.state.suggestionsVisible?(e.completeSuggestion(),a.preventDefault(),a.stopPropagation()):e._completeGenericSuggestion();break;case o.KeyCodes.backspace:e.props.disabled||e.onBackspace(a),a.stopPropagation();break;case o.KeyCodes.del:e.props.disabled||(e.input.current&&a.target===e.input.current.inputElement&&e.state.suggestionsVisible&&e.suggestionStore.currentIndex!==-1?(e.props.onRemoveSuggestion&&e.props.onRemoveSuggestion(e.suggestionStore.currentSuggestion.item),e.suggestionStore.removeSuggestion(e.suggestionStore.currentIndex),e.forceUpdate()):e.onBackspace(a)),a.stopPropagation();break;case o.KeyCodes.up:e.input.current&&a.target===e.input.current.inputElement&&e.state.suggestionsVisible&&(e.suggestionElement.current&&e.suggestionElement.current.tryHandleKeyDown(s,e.suggestionStore.currentIndex)?(a.preventDefault(),a.stopPropagation(),e.forceUpdate()):e.suggestionElement.current&&e.suggestionElement.current.hasSuggestedAction()&&e.suggestionStore.currentIndex===0?(a.preventDefault(),a.stopPropagation(),e.suggestionElement.current.focusAboveSuggestions(),e.suggestionStore.deselectAllSuggestions(),e.forceUpdate()):e.suggestionStore.previousSuggestion()&&(a.preventDefault(),a.stopPropagation(),e.onSuggestionSelect()));break;case o.KeyCodes.down:e.input.current&&a.target===e.input.current.inputElement&&e.state.suggestionsVisible&&(e.suggestionElement.current&&e.suggestionElement.current.tryHandleKeyDown(s,e.suggestionStore.currentIndex)?(a.preventDefault(),a.stopPropagation(),e.forceUpdate()):e.suggestionElement.current&&e.suggestionElement.current.hasSuggestedAction()&&e.suggestionStore.currentIndex+1===e.suggestionStore.suggestions.length?(a.preventDefault(),a.stopPropagation(),e.suggestionElement.current.focusBelowSuggestions(),e.suggestionStore.deselectAllSuggestions(),e.forceUpdate()):e.suggestionStore.nextSuggestion()&&(a.preventDefault(),a.stopPropagation(),e.onSuggestionSelect()));break}},e.onItemChange=function(a,s){var l=e.state.items;if(s>=0){var c=l;c[s]=a,e._updateSelectedItems(c)}},e.onGetMoreResults=function(){e.setState({isSearching:!0},function(){if(e.props.onGetMoreResults&&e.input.current){var a=e.props.onGetMoreResults(e.input.current.value,e.state.items),s=a,l=a;Array.isArray(s)?(e.updateSuggestions(s),e.setState({isSearching:!1})):l.then&&l.then(function(c){e.updateSuggestions(c),e.setState({isSearching:!1})})}else e.setState({isSearching:!1});e.input.current&&e.input.current.focus(),e.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})})},e.completeSelection=function(a){e.addItem(a),e.updateValue(""),e.input.current&&e.input.current.clear(),e.setState({suggestionsVisible:!1})},e.addItemByIndex=function(a){e.completeSelection(e.suggestionStore.getSuggestionAtIndex(a).item)},e.addItem=function(a){var s=e.props.onItemSelected?e.props.onItemSelected(a):a;if(s!==null){var l=s,c=s;if(c&&c.then)c.then(function(g){var m=e.state.items.concat([g]);e._updateSelectedItems(m)});else{var d=e.state.items.concat([l]);e._updateSelectedItems(d)}e.setState({suggestedDisplayValue:"",selectionRemoved:void 0})}},e.removeItem=function(a){var s=e.state.items,l=s.indexOf(a);if(l>=0){var c=s.slice(0,l).concat(s.slice(l+1));e.setState({selectionRemoved:a}),e._updateSelectedItems(c)}},e.removeItems=function(a){var s=e.state.items,l=s.filter(function(c){return a.indexOf(c)===-1});e._updateSelectedItems(l)},e._shouldFocusZoneEnterInnerZone=function(a){if(e.state.suggestionsVisible)switch(a.which){case o.KeyCodes.up:case o.KeyCodes.down:return!0}return a.which===o.KeyCodes.enter},e._onResolveSuggestions=function(a){var s=e.props.onResolveSuggestions(a,e.state.items);s!==null&&e.updateSuggestionsList(s,a)},e._completeGenericSuggestion=function(){if(e.props.onValidateInput&&e.input.current&&e.props.onValidateInput(e.input.current.value)!==Ct.invalid&&e.props.createGenericItem){var a=e.props.createGenericItem(e.input.current.value,e.props.onValidateInput(e.input.current.value));e.suggestionStore.createGenericSuggestion(a),e.completeSuggestion()}},e._userTriggeredSuggestions=function(){if(!e.state.suggestionsVisible){var a=e.input.current?e.input.current.value:"";a?e.suggestionStore.suggestions.length===0?e._onResolveSuggestions(a):e.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0}):e.onEmptyInputFocus()}},o.initializeComponentRef(e),e._async=new o.Async(e);var r=n.selectedItems||n.defaultSelectedItems||[];return e._id=o.getId(),e._ariaMap={selectedItems:"selected-items-"+e._id,selectedSuggestionAlert:"selected-suggestion-alert-"+e._id,suggestionList:"suggestion-list-"+e._id,combobox:"combobox-"+e._id},e.suggestionStore=new $d,e.selection=new Ao({onSelectionChanged:function(){return e.onSelectionChange()}}),e.selection.setItems(r),e.state={items:r,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1,selectedIndices:[],selectionRemoved:void 0},e}return i.getDerivedStateFromProps=function(n){return n.selectedItems?{items:n.selectedItems}:null},Object.defineProperty(i.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),i.prototype.componentDidMount=function(){this.selection.setItems(this.state.items),this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)},i.prototype.componentDidUpdate=function(n,e){if(this.state.items&&this.state.items!==e.items){var r=this.selection.getSelectedIndices()[0];this.selection.setItems(this.state.items),this.state.isFocused&&(this.state.items.length<e.items.length?(this.selection.setIndexSelected(r,!1,!0),this.resetFocus(r)):this.state.items.length>e.items.length&&!this.canAddItems()&&this.resetFocus(this.state.items.length-1))}},i.prototype.componentWillUnmount=function(){this.currentPromise&&(this.currentPromise=void 0),this._async.dispose()},i.prototype.focus=function(){this.input.current&&this.input.current.focus()},i.prototype.focusInput=function(){this.input.current&&this.input.current.focus()},i.prototype.completeSuggestion=function(n){this.suggestionStore.hasSelectedSuggestion()&&this.input.current?this.completeSelection(this.suggestionStore.currentSuggestion.item):n&&this._completeGenericSuggestion()},i.prototype.render=function(){var n=this.state,e=n.suggestedDisplayValue,r=n.isFocused,a=n.items,s=this.props,l=s.className,c=s.inputProps,d=s.disabled,g=s.selectionAriaLabel,m=s.selectionRole,u=m===void 0?"list":m,f=s.theme,p=s.styles,_=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",v=p?Er(p,{theme:f,className:l,isFocused:r,disabled:d,inputClassName:c&&c.className}):{root:o.css("ms-BasePicker",l||""),text:o.css("ms-BasePicker-text",Je.pickerText,this.state.isFocused&&Je.inputFocused),itemsWrapper:Je.pickerItems,input:o.css("ms-BasePicker-input",Je.pickerInput,c&&c.className),screenReaderText:Je.screenReaderOnly},b=this.props["aria-label"]||(c==null?void 0:c["aria-label"]);return h.createElement("div",{ref:this.root,className:v.root,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur},this.renderCustomAlert(v.screenReaderText),h.createElement("span",{id:this._ariaMap.selectedItems+"-label",hidden:!0},g||b),h.createElement(_i,{selection:this.selection,selectionMode:Q.multiple},h.createElement("div",{className:v.text,"aria-owns":_},a.length>0&&h.createElement("span",{id:this._ariaMap.selectedItems,className:v.itemsWrapper,role:u,"aria-labelledby":this._ariaMap.selectedItems+"-label"},this.renderItems()),this.canAddItems()&&h.createElement(bi,o.__assign({spellCheck:!1},c,{className:v.input,componentRef:this.input,id:c!=null&&c.id?c.id:this._ariaMap.combobox,onClick:this.onClick,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:e,"aria-activedescendant":this.getActiveDescendant(),"aria-controls":_,"aria-describedby":a.length>0?this._ariaMap.selectedItems:void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"listbox","aria-label":b,role:"combobox",disabled:d,onInputChange:this.props.onInputChange})))),this.renderSuggestions())},i.prototype.canAddItems=function(){var n=this.state.items,e=this.props.itemLimit;return e===void 0||n.length<e},i.prototype.renderSuggestions=function(){var n=this._styledSuggestions;return this.state.suggestionsVisible&&this.input?h.createElement(o.Callout,o.__assign({isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:o.DirectionalHint.bottomLeftEdge,directionalHintForRTL:o.DirectionalHint.bottomRightEdge},this.props.pickerCalloutProps),h.createElement(n,o.__assign({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel,suggestionsListId:this._ariaMap.suggestionList,createGenericItem:this._completeGenericSuggestion},this.props.pickerSuggestionsProps))):null},i.prototype.renderItems=function(){var n=this,e=this.props,r=e.disabled,a=e.removeButtonAriaLabel,s=e.removeButtonIconProps,l=this.props.onRenderItem,c=this.state,d=c.items,g=c.selectedIndices;return d.map(function(m,u){return l({item:m,index:u,key:m.key?m.key:u,selected:g.indexOf(u)!==-1,onRemoveItem:function(){return n.removeItem(m)},disabled:r,onItemChange:n.onItemChange,removeButtonAriaLabel:a,removeButtonIconProps:s})})},i.prototype.resetFocus=function(n){var e=this.state.items;if(e.length&&n>=0){var r=this.root.current&&this.root.current.querySelectorAll("[data-selection-index]")[Math.min(n,e.length-1)];r&&r.focus()}else this.canAddItems()?this.input.current&&this.input.current.focus():this.resetFocus(e.length-1)},i.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var n=this.input.current?this.input.current.value:"",e=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,n);this.setState({suggestedDisplayValue:e})}},i.prototype.onSelectionChange=function(){this.setState({selectedIndices:this.selection.getSelectedIndices()})},i.prototype.updateSuggestions=function(n){this.suggestionStore.updateSuggestions(n,0),this.forceUpdate()},i.prototype.onEmptyInputFocus=function(){var n=this.props.onEmptyResolveSuggestions?this.props.onEmptyResolveSuggestions:this.props.onEmptyInputFocus;if(n){var e=n(this.state.items);this.updateSuggestionsList(e),this.setState({isMostRecentlyUsedVisible:!0,suggestionsVisible:!0,moreSuggestionsAvailable:!1})}},i.prototype.updateValue=function(n){this._onResolveSuggestions(n)},i.prototype.updateSuggestionsList=function(n,e){var r=this;Array.isArray(n)?this._updateAndResolveValue(e,n):n&&n.then&&(this.setState({suggestionsLoading:!0}),this.suggestionStore.updateSuggestions([]),e!==void 0?this.setState({suggestionsVisible:this._getShowSuggestions()}):this.setState({suggestionsVisible:this.input.current&&this.input.current.inputElement===document.activeElement}),this.currentPromise=n,n.then(function(a){n===r.currentPromise&&r._updateAndResolveValue(e,a)}))},i.prototype.resolveNewValue=function(n,e){var r=this;this.updateSuggestions(e);var a=void 0;this.suggestionStore.currentSuggestion&&(a=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,n)),this.setState({suggestedDisplayValue:a,suggestionsVisible:this._getShowSuggestions()},function(){return r.setState({suggestionsLoading:!1})})},i.prototype.onChange=function(n){this.props.onChange&&this.props.onChange(n)},i.prototype.onBackspace=function(n){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&this.input.current.cursorLocation===0)&&(this.selection.getSelectedCount()>0?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))},i.prototype.getActiveDescendant=function(){var n;if(!this.state.suggestionsLoading){var e=this.suggestionStore.currentIndex;return e<0?!((n=this.suggestionElement.current)===null||n===void 0)&&n.hasSuggestedAction()?"sug-selectedAction":this.suggestionStore.suggestions.length===0?"sug-noResultsFound":void 0:"sug-"+e}},i.prototype.getSuggestionsAlert=function(n){n===void 0&&(n=Je.screenReaderOnly);var e=this.suggestionStore.currentIndex;if(this.props.enableSelectedSuggestionAlert){var r=e>-1?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,a=r?r.ariaLabel:void 0;return h.createElement("div",{id:this._ariaMap.selectedSuggestionAlert,className:n},a+" ")}},i.prototype.renderCustomAlert=function(n){n===void 0&&(n=Je.screenReaderOnly);var e=this.props.suggestionRemovedText,r=e===void 0?"removed {0}":e,a="";if(this.state.selectionRemoved){var s=this._getTextFromItem(this.state.selectionRemoved,"");a=St(r,s)}return h.createElement("div",{className:n,id:this._ariaMap.selectedSuggestionAlert,"aria-live":"assertive"},this.getSuggestionsAlert(n),a)},i.prototype._updateAndResolveValue=function(n,e){n!==void 0?this.resolveNewValue(n,e):(this.suggestionStore.updateSuggestions(e,-1),this.state.suggestionsLoading&&this.setState({suggestionsLoading:!1}))},i.prototype._updateSelectedItems=function(n){var e=this;this.props.selectedItems?this.onChange(n):this.setState({items:n},function(){e._onSelectedItemsUpdated(n)})},i.prototype._onSelectedItemsUpdated=function(n){this.onChange(n)},i.prototype._getShowSuggestions=function(){var n=this.input.current!==void 0&&this.input.current!==null&&this.input.current.inputElement===document.activeElement&&this.input.current.value!=="";return n},i.prototype._getTextFromItem=function(n,e){return this.props.getTextFromItem?this.props.getTextFromItem(n,e):""},i}(h.Component),ou=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i.prototype.render=function(){var n=this.state,e=n.suggestedDisplayValue,r=n.isFocused,a=this.props,s=a.className,l=a.inputProps,c=a.disabled,d=a.selectionAriaLabel,g=a.selectionRole,m=g===void 0?"list":g,u=a.theme,f=a.styles,p=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",_=f?Er(f,{theme:u,className:s,isFocused:r,inputClassName:l&&l.className}):{root:o.css("ms-BasePicker",s||""),text:o.css("ms-BasePicker-text",Je.pickerText,this.state.isFocused&&Je.inputFocused,c&&Je.inputDisabled),itemsWrapper:Je.pickerItems,input:o.css("ms-BasePicker-input",Je.pickerInput,l&&l.className),screenReaderText:Je.screenReaderOnly},v=this.props["aria-label"]||(l==null?void 0:l["aria-label"]);return h.createElement("div",{ref:this.root,onBlur:this.onBlur,onFocus:this.onFocus},h.createElement("div",{className:_.root,onKeyDown:this.onKeyDown},this.renderCustomAlert(_.screenReaderText),h.createElement("div",{className:_.text,"aria-owns":p||void 0},h.createElement(bi,o.__assign({},l,{className:_.input,componentRef:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onClick:this.onClick,onInputValueChange:this.onInputChange,suggestedDisplayValue:e,"aria-activedescendant":this.getActiveDescendant(),"aria-controls":p||void 0,"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"listbox","aria-label":v,role:"combobox",id:l!=null&&l.id?l.id:this._ariaMap.combobox,disabled:c,onInputChange:this.props.onInputChange})))),this.renderSuggestions(),h.createElement(_i,{selection:this.selection,selectionMode:Q.single},h.createElement("div",{id:this._ariaMap.selectedItems,className:"ms-BasePicker-selectedItems",role:m,"aria-label":d||v},this.renderItems())))},i.prototype.onBackspace=function(n){},i}(ki),ru={root:"ms-PickerPersona-container",itemContent:"ms-PickerItem-content",removeButton:"ms-PickerItem-removeButton",isSelected:"is-selected",isInvalid:"is-invalid"},Do=24;function au(t){var i,n,e,r,a,s,l,c=t.className,d=t.theme,g=t.selected,m=t.invalid,u=t.disabled,f=d.palette,p=d.semanticColors,_=d.fonts,v=o.getGlobalClassNames(ru,d),b=[g&&!m&&!u&&{color:f.white,selectors:(i={":hover":{color:f.white}},i[o.HighContrastSelector]={color:"HighlightText"},i)},(m&&!g||m&&g&&u)&&{color:f.redDark,borderBottom:"2px dotted "+f.redDark,selectors:(n={},n["."+v.root+":hover &"]={color:f.redDark},n)},m&&g&&!u&&{color:f.white,borderBottom:"2px dotted "+f.white},u&&{selectors:(e={},e[o.HighContrastSelector]={color:"GrayText"},e)}],y=[m&&{fontSize:_.xLarge.fontSize}];return{root:[v.root,o.getFocusStyle(d,{inset:-2}),{borderRadius:15,display:"inline-flex",alignItems:"center",background:f.neutralLighter,margin:"1px 2px",cursor:"default",userSelect:"none",maxWidth:300,verticalAlign:"middle",minWidth:0,selectors:(r={":hover":{background:!g&&!u?f.neutralLight:""}},r[o.HighContrastSelector]=[{border:"1px solid WindowText"},u&&{borderColor:"GrayText"}],r)},g&&!u&&[v.isSelected,{background:f.themePrimary,selectors:(a={},a[o.HighContrastSelector]=o.__assign({borderColor:"HighLight",background:"Highlight"},o.getHighContrastNoAdjustStyle()),a)}],m&&[v.isInvalid],m&&g&&!u&&{background:f.redDark},c],itemContent:[v.itemContent,{flex:"0 1 auto",minWidth:0,maxWidth:"100%",overflow:"hidden"}],removeButton:[v.removeButton,{borderRadius:15,color:f.neutralPrimary,flex:"0 0 auto",width:Do,height:Do,selectors:{":hover":{background:f.neutralTertiaryAlt,color:f.neutralDark}}},g&&[{color:f.white,selectors:(s={":hover":{color:f.white,background:f.themeDark},":active":{color:f.white,background:f.themeDarker}},s[o.HighContrastSelector]={color:"HighlightText"},s)},m&&{selectors:{":hover":{background:f.red},":active":{background:f.redDark}}}],u&&{selectors:(l={},l["."+o.ButtonGlobalClassNames.msButtonIcon]={color:p.buttonText},l)}],subComponentStyles:{persona:{primaryText:b},personaCoin:{initials:y}}}}var su=o.classNamesFunction(),lu=function(t){var i=t.item,n=t.onRemoveItem,e=t.index,r=t.selected,a=t.removeButtonAriaLabel,s=t.styles,l=t.theme,c=t.className,d=t.disabled,g=t.removeButtonIconProps,m=o.getId(),u=su(s,{theme:l,className:c,selected:r,disabled:d,invalid:i.ValidationState===Ct.warning}),f=u.subComponentStyles?u.subComponentStyles.persona:void 0,p=u.subComponentStyles?u.subComponentStyles.personaCoin:void 0;return h.createElement("div",{className:u.root,role:"listitem"},h.createElement("div",{className:u.itemContent,id:"selectedItemPersona-"+m},h.createElement(Zo,o.__assign({size:j.size24,styles:f,coinProps:{styles:p}},i))),h.createElement(o.IconButton,{id:m,onClick:n,disabled:d,iconProps:g!=null?g:{iconName:"Cancel"},styles:{icon:{fontSize:"12px"}},className:u.removeButton,ariaLabel:a,"aria-labelledby":m+" selectedItemPersona-"+m,"data-selection-index":e}))},Di=o.styled(lu,au,void 0,{scope:"PeoplePickerItem"}),cu={root:"ms-PeoplePicker-personaContent",personaWrapper:"ms-PeoplePicker-Persona"};function du(t){var i,n,e,r=t.className,a=t.theme,s=o.getGlobalClassNames(cu,a),l={selectors:(i={},i["."+Nr.isSuggested+" &"]={selectors:(n={},n[o.HighContrastSelector]={color:"HighlightText"},n)},i["."+s.root+":hover &"]={selectors:(e={},e[o.HighContrastSelector]={color:"HighlightText"},e)},i)};return{root:[s.root,{width:"100%",padding:"4px 12px"},r],personaWrapper:[s.personaWrapper,{width:180}],subComponentStyles:{persona:{primaryText:l,secondaryText:l}}}}var uu=o.classNamesFunction(),gu=function(t){var i=t.personaProps,n=t.suggestionsProps,e=t.compact,r=t.styles,a=t.theme,s=t.className,l=uu(r,{theme:a,className:n&&n.suggestionsItemClassName||s}),c=l.subComponentStyles&&l.subComponentStyles.persona?l.subComponentStyles.persona:void 0;return h.createElement("div",{className:l.root},h.createElement(Zo,o.__assign({size:j.size24,styles:c,className:l.personaWrapper,showSecondaryText:!e,showOverflowTooltip:!1},i)))},xi=o.styled(gu,du,void 0,{scope:"PeoplePickerItemSuggestion"}),hu={root:"ms-BasePicker",text:"ms-BasePicker-text",itemsWrapper:"ms-BasePicker-itemsWrapper",input:"ms-BasePicker-input"};function Ln(t){var i,n,e,r=t.className,a=t.theme,s=t.isFocused,l=t.inputClassName,c=t.disabled;if(!a)throw new Error("theme is undefined or null in base BasePicker getStyles function.");var d=a.semanticColors,g=a.effects,m=a.fonts,u=d.inputBorder,f=d.inputBorderHovered,p=d.inputFocusBorderAlt,_=o.getGlobalClassNames(hu,a),v=[m.medium,{color:d.inputPlaceholderText,opacity:1,selectors:(i={},i[o.HighContrastSelector]={color:"GrayText"},i)}],b={color:d.disabledText,selectors:(n={},n[o.HighContrastSelector]={color:"GrayText"},n)},y="rgba(218, 218, 218, 0.29)";return{root:[_.root,r],text:[_.text,{display:"flex",position:"relative",flexWrap:"wrap",alignItems:"center",boxSizing:"border-box",minWidth:180,minHeight:30,border:"1px solid "+u,borderRadius:g.roundedCorner2},!s&&!c&&{selectors:{":hover":{borderColor:f}}},s&&!c&&o.getInputFocusStyle(p,g.roundedCorner2),c&&{borderColor:y,selectors:(e={":after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,background:y}},e[o.HighContrastSelector]={borderColor:"GrayText",selectors:{":after":{background:"none"}}},e)}],itemsWrapper:[_.itemsWrapper,{display:"flex",flexWrap:"wrap",maxWidth:"100%"}],input:[_.input,m.medium,{height:30,border:"none",flexGrow:1,outline:"none",padding:"0 6px 0",alignSelf:"flex-end",borderRadius:g.roundedCorner2,backgroundColor:"transparent",color:d.inputText,selectors:{"::-ms-clear":{display:"none"}}},ne.getPlaceholderStyles(v),c&&ne.getPlaceholderStyles(b),l],screenReaderText:o.hiddenContentStyle}}var Tr=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i}(ki),mu=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i}(ou),fu=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i.defaultProps={onRenderItem:function(n){return h.createElement(Di,o.__assign({},n))},onRenderSuggestionsItem:function(n,e){return h.createElement(xi,{personaProps:n,suggestionsProps:e})},createGenericItem:wi},i}(Tr),vu=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i.defaultProps={onRenderItem:function(n){return h.createElement(Di,o.__assign({},n))},onRenderSuggestionsItem:function(n,e){return h.createElement(xi,{personaProps:n,suggestionsProps:e,compact:!0})},createGenericItem:wi},i}(Tr),pu=function(t){o.__extends(i,t);function i(){return t!==null&&t.apply(this,arguments)||this}return i.defaultProps={onRenderItem:function(n){return h.createElement(Di,o.__assign({},n))},onRenderSuggestionsItem:function(n,e){return h.createElement(xi,{personaProps:n,suggestionsProps:e})},createGenericItem:wi},i}(mu);function wi(t,i){var n={key:t,primaryText:t,imageInitials:"!",ValidationState:i};return i!==Ct.warning&&(n.imageInitials=Po(t,o.getRTL())),n}o.styled(fu,Ln,void 0,{scope:"NormalPeoplePicker"});var _u=o.styled(vu,Ln,void 0,{scope:"CompactPeoplePicker"});o.styled(pu,Ln,void 0,{scope:"ListPeoplePickerBase"});var bu={root:"ms-TagItem",text:"ms-TagItem-text",close:"ms-TagItem-close",isSelected:"is-selected"},xo=26;function yu(t){var i,n,e,r,a=t.className,s=t.theme,l=t.selected,c=t.disabled,d=s.palette,g=s.effects,m=s.fonts,u=s.semanticColors,f=o.getGlobalClassNames(bu,s);return{root:[f.root,m.medium,o.getFocusStyle(s),{boxSizing:"content-box",flexShrink:"1",margin:2,height:xo,lineHeight:xo,cursor:"default",userSelect:"none",display:"flex",flexWrap:"nowrap",maxWidth:300,minWidth:0,borderRadius:g.roundedCorner2,color:u.inputText,background:d.neutralLighter,selectors:(i={":hover":[!c&&!l&&{color:d.neutralDark,background:d.neutralLight,selectors:{".ms-TagItem-close":{color:d.neutralPrimary}}},c&&{background:d.neutralLighter}],":focus-within":[!c&&{background:d.themePrimary,color:d.white}]},i[o.HighContrastSelector]={border:"1px solid "+(l?"WindowFrame":"WindowText")},i)},c&&{selectors:(n={},n[o.HighContrastSelector]={borderColor:"GrayText"},n)},l&&!c&&[f.isSelected],a],text:[f.text,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:30,margin:"0 8px"},c&&{selectors:(e={},e[o.HighContrastSelector]={color:"GrayText"},e)}],close:[f.close,{color:d.neutralSecondary,width:30,height:"100%",flex:"0 0 auto",borderRadius:o.getRTL(s)?g.roundedCorner2+" 0 0 "+g.roundedCorner2:"0 "+g.roundedCorner2+" "+g.roundedCorner2+" 0",selectors:{":hover":{background:d.neutralQuaternaryAlt,color:d.neutralPrimary},":focus":{color:d.white,background:d.themePrimary},":focus:hover":{color:d.white,background:d.themeDark},":active":{color:d.white,backgroundColor:d.themeDark}}},c&&{selectors:(r={},r["."+o.ButtonGlobalClassNames.msButtonIcon]={color:d.neutralSecondary},r)}]}}var Cu=o.classNamesFunction(),Su=function(t){var i=t.theme,n=t.styles,e=t.selected,r=t.disabled,a=t.enableTagFocusInDisabledPicker,s=t.children,l=t.className,c=t.index,d=t.onRemoveItem,g=t.removeButtonAriaLabel,m=t.title,u=m===void 0?typeof t.children=="string"?t.children:t.item.name:m,f=t.removeButtonIconProps,p=Cu(n,{theme:i,className:l,selected:e,disabled:r}),_=o.useId(),v=a?{"aria-disabled":r,tabindex:0}:{disabled:r};return h.createElement("div",{className:p.root,role:"listitem",key:c},h.createElement("span",{className:p.text,title:u,id:_+"-text"},s),h.createElement(o.IconButton,o.__assign({id:_,onClick:d},v,{iconProps:f!=null?f:{iconName:"Cancel"},styles:{icon:{fontSize:"12px"}},className:p.close,ariaLabel:g,"aria-labelledby":_+" "+_+"-text","data-selection-index":c})))},ku=o.styled(Su,yu,void 0,{scope:"TagItem"}),Du={suggestionTextOverflow:"ms-TagItem-TextOverflow"};function xu(t){var i=t.className,n=t.theme,e=o.getGlobalClassNames(Du,n);return{suggestionTextOverflow:[e.suggestionTextOverflow,{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"60vw",padding:"6px 12px 7px",whiteSpace:"nowrap"},i]}}var wu=o.classNamesFunction(),Iu=function(t){var i=t.styles,n=t.theme,e=t.children,r=wu(i,{theme:n});return h.createElement("div",{className:r.suggestionTextOverflow}," ",e," ")},Ru=o.styled(Iu,xu,void 0,{scope:"TagItemSuggestion"}),Nu=function(t){o.__extends(i,t);function i(n){var e=t.call(this,n)||this;return o.initializeComponentRef(e),e}return i.defaultProps={onRenderItem:function(n){return h.createElement(ku,o.__assign({},n),n.item.name)},onRenderSuggestionsItem:function(n){return h.createElement(Ru,null,n.name)}},i}(ki),Eu=o.styled(Nu,Ln,void 0,{scope:"TagPicker"}),Tu=1e3,Pu=o.classNamesFunction(),wo=function(t){return function(i){var n;return n={},n[t]=i+"%",n}},si=function(t,i,n){return n===i?0:(t-i)/(n-i)*100},Au=function(t,i,n,e){h.useImperativeHandle(t.componentRef,function(){return{get value(){return n},get range(){return e},focus:function(){i.current&&i.current.focus()}}},[i,n,e])},Fu=function(t,i){var n=t.step,e=n===void 0?1:n,r=t.className,a=t.disabled,s=a===void 0?!1:a,l=t.label,c=t.max,d=c===void 0?10:c,g=t.min,m=g===void 0?0:g,u=t.showValue,f=u===void 0?!0:u,p=t.buttonProps,_=p===void 0?{}:p,v=t.vertical,b=v===void 0?!1:v,y=t.snapToStep,C=t.valueFormat,x=t.styles,R=t.theme,D=t.originFromZero,S=t["aria-labelledby"],I=t["aria-label"],N=t.ranged,k=t.onChange,w=t.onChanged,E=h.useRef([]),P=ne.useSetTimeout(),T=P.setTimeout,M=P.clearTimeout,L=h.useRef(null),B=ht(t.value,t.defaultValue,function(U,le){return k==null?void 0:k(le,N?[F.latestLowerValue,le]:void 0,U)}),z=B[0],H=B[1],O=ht(t.lowerValue,t.defaultLowerValue,function(U,le){return k==null?void 0:k(F.latestValue,[le,F.latestValue],U)}),V=O[0],W=O[1],G=Math.max(m,Math.min(d,z||0)),A=Math.max(m,Math.min(G,V||0)),F=o.useConst({onKeyDownTimer:-1,isAdjustingLowerValue:!1,latestValue:G,latestLowerValue:A});F.latestValue=G,F.latestLowerValue=A;var Y=o.useId("Slider",t.id||(_==null?void 0:_.id)),ee=Pu(x,{className:r,disabled:s,vertical:b,showTransitions:!y&&!F.isBetweenSteps,showValue:f,ranged:N,theme:R}),q=(d-m)/e,he=function(){M(F.onKeyDownTimer),F.onKeyDownTimer=-1},ce=function(U){he(),w&&(F.onKeyDownTimer=T(function(){w(U,F.latestValue,N?[F.latestLowerValue,F.latestValue]:void 0)},Tu))},re=function(U){var le=t.ariaValueText;if(U!==void 0)return le?le(U):U.toString()},ye=function(U,le,Se){le=Math.min(d,Math.max(m,le)),Se=Se!==void 0?Math.min(d,Math.max(m,Se)):void 0;var Ve=0;if(isFinite(e))for(;Math.round(e*Math.pow(10,Ve))/Math.pow(10,Ve)!==e;)Ve++;var Ae=parseFloat(le.toFixed(Ve));F.isBetweenSteps=Se!==void 0&&Se!==Ae,N?F.isAdjustingLowerValue&&(D?Ae<=0:Ae<=F.latestValue)?W(Ae,U):!F.isAdjustingLowerValue&&(D?Ae>=0:Ae>=F.latestLowerValue)&&H(Ae,U):H(Ae,U)},me=function(U){var le=F.isAdjustingLowerValue?F.latestLowerValue:F.latestValue,Se=0;switch(U.which){case o.getRTLSafeKeyCode(o.KeyCodes.left,t.theme):case o.KeyCodes.down:Se=-e,he(),ce(U);break;case o.getRTLSafeKeyCode(o.KeyCodes.right,t.theme):case o.KeyCodes.up:Se=e,he(),ce(U);break;case o.KeyCodes.home:le=m,he(),ce(U);break;case o.KeyCodes.end:le=d,he(),ce(U);break;default:return}ye(U,le+Se),U.preventDefault(),U.stopPropagation()},se=function(U,le){var Se=0;switch(U.type){case"mousedown":case"mousemove":Se=le?U.clientY:U.clientX;break;case"touchstart":case"touchmove":Se=le?U.touches[0].clientY:U.touches[0].clientX;break}return Se},fe=function(U){var le=L.current.getBoundingClientRect(),Se=t.vertical?le.height:le.width,Ve=Se/q,Ae,Rt;if(t.vertical){var Vt=se(U,t.vertical);Rt=le.bottom-Vt,Ae=Rt/Ve}else{var Nt=se(U,t.vertical);Rt=o.getRTL(t.theme)?le.right-Nt:Nt-le.left,Ae=Rt/Ve}return Ae},oe=function(U,le){var Se=fe(U),Ve=m+e*Se,Ae=m+e*Math.round(Se);ye(U,Ae,Ve),le||(U.preventDefault(),U.stopPropagation())},_e=function(U){if(N){var le=fe(U),Se=m+e*le;F.isAdjustingLowerValue=Se<=F.latestLowerValue||Se-F.latestLowerValue<=F.latestValue-Se}U.type==="mousedown"?E.current.push(o.on(window,"mousemove",oe,!0),o.on(window,"mouseup",te,!0)):U.type==="touchstart"&&E.current.push(o.on(window,"touchmove",oe,!0),o.on(window,"touchend",te,!0)),oe(U,!0)},te=function(U){F.isBetweenSteps=void 0,w==null||w(U,F.latestValue,N?[F.latestLowerValue,F.latestValue]:void 0),Ye()},ve=function(U){F.isAdjustingLowerValue=U.target===Be.current},Ye=function(){E.current.forEach(function(U){return U()}),E.current=[]},Be=h.useRef(null),Oe=h.useRef(null);Au(t,N&&!b?Be:Oe,G,N?[A,G]:void 0);var $e=wo(b?"bottom":o.getRTL(t.theme)?"right":"left"),Te=wo(b?"height":"width"),rt=D?0:m,Pe=si(G,m,d),X=si(A,m,d),xe=si(rt,m,d),ie=N?Pe-X:Math.abs(xe-Pe),J=Math.min(100-Pe,100-xe),ke=N?X:Math.min(Pe,xe),Ie={className:ee.root,ref:i},Ge={className:ee.titleLabel,children:l,disabled:s,htmlFor:I?void 0:Y},Re=f?{className:ee.valueLabel,children:C?C(G):G,disabled:s,htmlFor:s?Y:void 0}:void 0,ue=N&&f?{className:ee.valueLabel,children:C?C(A):A,disabled:s}:void 0,pe=D?{className:ee.zeroTick,style:$e(xe)}:void 0,ae={className:o.css(ee.lineContainer,ee.activeSection),style:Te(ie)},je={className:o.css(ee.lineContainer,ee.inactiveSection),style:Te(J)},ft={className:o.css(ee.lineContainer,ee.inactiveSection),style:Te(ke)},at=o.__assign({"aria-disabled":s,role:"slider",tabIndex:s?void 0:0},{"data-is-focusable":!s}),Wt=o.__assign(o.__assign(o.__assign({id:Y,className:o.css(ee.slideBox,_.className)},!s&&{onMouseDown:_e,onTouchStart:_e,onKeyDown:me}),_&&o.getNativeProps(_,o.divProperties,["id","className"])),!N&&o.__assign(o.__assign({},at),{"aria-valuemin":m,"aria-valuemax":d,"aria-valuenow":G,"aria-valuetext":re(G),"aria-label":I||l,"aria-labelledby":S})),an=s?{}:{onFocus:ve},Me=o.__assign({ref:Oe,className:ee.thumb,style:$e(Pe)},N&&o.__assign(o.__assign(o.__assign({},at),an),{id:"max-"+Y,"aria-valuemin":A,"aria-valuemax":d,"aria-valuenow":G,"aria-valuetext":re(G),"aria-label":"max "+(I||l)})),Gt=N?o.__assign(o.__assign(o.__assign({ref:Be,className:ee.thumb,style:$e(X)},at),an),{id:"min-"+Y,"aria-valuemin":m,"aria-valuemax":G,"aria-valuenow":A,"aria-valuetext":re(A),"aria-label":"min "+(I||l)}):void 0,Dt={className:ee.container},sn={ref:L,className:ee.line};return{root:Ie,label:Ge,sliderBox:Wt,container:Dt,valueLabel:Re,lowerValueLabel:ue,thumb:Me,lowerValueThumb:Gt,zeroTick:pe,activeTrack:ae,topInactiveTrack:je,bottomInactiveTrack:ft,sliderLine:sn}},Pr="SliderBase",Ar=h.forwardRef(function(t,i){var n=Fu(t,i);return process.env.NODE_ENV!=="production"&&o.useWarnings({name:Pr,props:t,mutuallyExclusive:{value:"defaultValue"}}),h.createElement("div",o.__assign({},n.root),n&&h.createElement(ne.Label,o.__assign({},n.label)),h.createElement("div",o.__assign({},n.container),t.ranged&&(t.vertical?n.valueLabel&&h.createElement(ne.Label,o.__assign({},n.valueLabel)):n.lowerValueLabel&&h.createElement(ne.Label,o.__assign({},n.lowerValueLabel))),h.createElement("div",o.__assign({},n.sliderBox),h.createElement("div",o.__assign({},n.sliderLine),t.ranged&&h.createElement("span",o.__assign({},n.lowerValueThumb)),h.createElement("span",o.__assign({},n.thumb)),n.zeroTick&&h.createElement("span",o.__assign({},n.zeroTick)),h.createElement("span",o.__assign({},n.bottomInactiveTrack)),h.createElement("span",o.__assign({},n.activeTrack)),h.createElement("span",o.__assign({},n.topInactiveTrack)))),t.ranged&&t.vertical?n.lowerValueLabel&&h.createElement(ne.Label,o.__assign({},n.lowerValueLabel)):n.valueLabel&&h.createElement(ne.Label,o.__assign({},n.valueLabel))),h.createElement(o.FocusRects,null))});Ar.displayName=Pr;var Hu={root:"ms-Slider",enabled:"ms-Slider-enabled",disabled:"ms-Slider-disabled",row:"ms-Slider-row",column:"ms-Slider-column",container:"ms-Slider-container",slideBox:"ms-Slider-slideBox",line:"ms-Slider-line",thumb:"ms-Slider-thumb",activeSection:"ms-Slider-active",inactiveSection:"ms-Slider-inactive",valueLabel:"ms-Slider-value",showValue:"ms-Slider-showValue",showTransitions:"ms-Slider-showTransitions",zeroTick:"ms-Slider-zeroTick"},Mu=function(t){var i,n,e,r,a,s,l,c,d,g,m,u,f,p=t.className,_=t.titleLabelClassName,v=t.theme,b=t.vertical,y=t.disabled,C=t.showTransitions,x=t.showValue,R=t.ranged,D=v.semanticColors,S=o.getGlobalClassNames(Hu,v),I=D.inputBackgroundCheckedHovered,N=D.inputBackgroundChecked,k=D.inputPlaceholderBackgroundChecked,w=D.smallInputBorder,E=D.disabledBorder,P=D.disabledText,T=D.disabledBackground,M=D.inputBackground,L=D.smallInputBorder,B=D.disabledBorder,z=!y&&{backgroundColor:I,selectors:(i={},i[o.HighContrastSelector]={backgroundColor:"Highlight"},i)},H=!y&&{backgroundColor:k,selectors:(n={},n[o.HighContrastSelector]={borderColor:"Highlight"},n)},O=!y&&{backgroundColor:N,selectors:(e={},e[o.HighContrastSelector]={backgroundColor:"Highlight"},e)},V=!y&&{border:"2px solid "+I,selectors:(r={},r[o.HighContrastSelector]={borderColor:"Highlight"},r)},W=!t.disabled&&{backgroundColor:D.inputPlaceholderBackgroundChecked,selectors:(a={},a[o.HighContrastSelector]={backgroundColor:"Highlight"},a)};return{root:o.__spreadArray(o.__spreadArray(o.__spreadArray(o.__spreadArray(o.__spreadArray([S.root,v.fonts.medium,{userSelect:"none"},b&&{marginRight:8}],[y?void 0:S.enabled]),[y?S.disabled:void 0]),[b?void 0:S.row]),[b?S.column:void 0]),[p]),titleLabel:[{padding:0},_],container:[S.container,{display:"flex",flexWrap:"nowrap",alignItems:"center"},b&&{flexDirection:"column",height:"100%",textAlign:"center",margin:"8px 0"}],slideBox:o.__spreadArray(o.__spreadArray([S.slideBox,!R&&o.getFocusStyle(v),{background:"transparent",border:"none",flexGrow:1,lineHeight:28,display:"flex",alignItems:"center",selectors:(s={},s[":active ."+S.activeSection]=z,s[":hover ."+S.activeSection]=O,s[":active ."+S.inactiveSection]=H,s[":hover ."+S.inactiveSection]=H,s[":active ."+S.thumb]=V,s[":hover ."+S.thumb]=V,s[":active ."+S.zeroTick]=W,s[":hover ."+S.zeroTick]=W,s[o.HighContrastSelector]={forcedColorAdjust:"none"},s)},b?{height:"100%",width:28,padding:"8px 0"}:{height:28,width:"auto",padding:"0 8px"}],[x?S.showValue:void 0]),[C?S.showTransitions:void 0]),thumb:[S.thumb,R&&o.getFocusStyle(v,{inset:-4}),{borderWidth:2,borderStyle:"solid",borderColor:L,borderRadius:10,boxSizing:"border-box",background:M,display:"block",width:16,height:16,position:"absolute"},b?{left:-6,margin:"0 auto",transform:"translateY(8px)"}:{top:-6,transform:o.getRTL(v)?"translateX(50%)":"translateX(-50%)"},C&&{transition:"left "+o.AnimationVariables.durationValue3+" "+o.AnimationVariables.easeFunction1},y&&{borderColor:B,selectors:(l={},l[o.HighContrastSelector]={borderColor:"GrayText"},l)}],line:[S.line,{display:"flex",position:"relative"},b?{height:"100%",width:4,margin:"0 auto",flexDirection:"column-reverse"}:{width:"100%"}],lineContainer:[{borderRadius:4,boxSizing:"border-box"},b?{width:4,height:"100%"}:{height:4,width:"100%"}],activeSection:[S.activeSection,{background:w,selectors:(c={},c[o.HighContrastSelector]={backgroundColor:"WindowText"},c)},C&&{transition:"width "+o.AnimationVariables.durationValue3+" "+o.AnimationVariables.easeFunction1},y&&{background:P,selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"GrayText",borderColor:"GrayText"},d)}],inactiveSection:[S.inactiveSection,{background:E,selectors:(g={},g[o.HighContrastSelector]={border:"1px solid WindowText"},g)},C&&{transition:"width "+o.AnimationVariables.durationValue3+" "+o.AnimationVariables.easeFunction1},y&&{background:T,selectors:(m={},m[o.HighContrastSelector]={borderColor:"GrayText"},m)}],zeroTick:[S.zeroTick,{position:"absolute",background:D.disabledBorder,selectors:(u={},u[o.HighContrastSelector]={backgroundColor:"WindowText"},u)},t.disabled&&{background:D.disabledBackground,selectors:(f={},f[o.HighContrastSelector]={backgroundColor:"GrayText"},f)},t.vertical?{width:"16px",height:"1px",transform:o.getRTL(v)?"translateX(6px)":"translateX(-6px)"}:{width:"1px",height:"16px",transform:"translateY(-6px)"}],valueLabel:[S.valueLabel,{flexShrink:1,width:30,lineHeight:"1"},b?{margin:"0 auto",whiteSpace:"nowrap",width:40}:{margin:"0 8px",whiteSpace:"nowrap",width:40}]}},Lu=o.styled(Ar,Mu,void 0,{scope:"Slider"});function zu(t){var g,m,u,f,p;const[i,n]=$.useState(!1),[e,r]=$.useState(we.NONE),{dateValue:a,setFilterDate:s}=$.useContext(vi),l=_=>_===0?"Nenhum":_===1?"\xDAltima Semana":_===2?"\xDAltimo M\xEAs":_===3?"\xDAltimos Ano":"",c=(_,v)=>{if(v===we.CUSTOM?(n(!0),r(we.CUSTOM)):(n(!1),s(b=>{const y=new Map(b);return y.set(t==null?void 0:t.itemKey,{fromDate:null,toDate:new Date}),y})),v===we.NONE)t.onRecordDateRange(null,null,we.NONE),r(we.NONE),n(!1);else if(v===we.WEEK){const b=new Date;b.setDate(b.getDate()-7),r(we.WEEK),t.onRecordDateRange(b,new Date,we.WEEK)}else if(v===we.MONTH){const b=new Date;b.setMonth(b.getMonth()-1),r(we.MONTH),t.onRecordDateRange(b,new Date,we.MONTH)}else if(v===we.YEAR){const b=new Date;b.setFullYear(b.getFullYear()-1),r(we.YEAR),t.onRecordDateRange(b,new Date,we.YEAR)}};$.useEffect(()=>{r(t.defaultSliderValue)},[t==null?void 0:t.defaultSliderValue]),$.useEffect(()=>{var _,v;(a==null?void 0:a.size)>0&&e===we.CUSTOM&&t.onRecordDateRange((_=a==null?void 0:a.get(t==null?void 0:t.itemKey))==null?void 0:_.fromDate,(v=a.get(t==null?void 0:t.itemKey))==null?void 0:v.toDate,we.CUSTOM)},[e,a]),$.useEffect(()=>{(t==null?void 0:t.defaultSliderValue)===4&&!i&&n(!0)},[t==null?void 0:t.defaultSliderValue]);const d=$.useMemo(()=>({months:["Janeiro","Fevereiro","Mar\xE7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],days:["Domingo","Segunda","Ter\xE7a","Quarta","Quinta","Sexta","S\xE1bado"],shortDays:["D","S","T","Q","Q","S","S"],goToToday:"Hoje",prevMonthAriaLabel:"M\xEAs anterior",nextMonthAriaLabel:"Pr\xF3ximo m\xEAs",prevYearAriaLabel:"Ano anterior",nextYearAriaLabel:"Pr\xF3ximo ano",closeButtonAriaLabel:"Fechar",isRequiredErrorMessage:"Este campo \xE9 obrigat\xF3rio.",invalidInputErrorMessage:"Valor de entrada inv\xE1lido.",isOutOfBoundsErrorMessage:"Valor de entrada fora dos limites.",showWeekNumbers:!1,weekNumberFormatString:"",firstWeekOfYear:0,dateFormat:"d",showGoToToday:!0}),[]);return K.default.createElement(K.default.Fragment,null,K.default.createElement(Lu,{min:0,max:4,step:1,defaultValue:(g=t==null?void 0:t.defaultSliderValue)!=null?g:0,styles:{container:{display:"grid"}},valueFormat:l,onChanged:c,label:t==null?void 0:t.label}),i&&K.default.createElement("div",null,K.default.createElement(Co,{maxDate:(m=a==null?void 0:a.get(t==null?void 0:t.itemKey))==null?void 0:m.toDate,strings:d,value:(u=a==null?void 0:a.get(t==null?void 0:t.itemKey))==null?void 0:u.fromDate,formatDate:_=>_==null?void 0:_.toLocaleDateString(),onSelectDate:_=>{s(v=>{var y;const b=new Map(v);return b.set(t==null?void 0:t.itemKey,{fromDate:_,toDate:(y=a==null?void 0:a.get(t==null?void 0:t.itemKey))==null?void 0:y.toDate}),b}),r(we.CUSTOM)},label:"De"}),K.default.createElement(Co,{minDate:(f=a==null?void 0:a.get(t==null?void 0:t.itemKey))==null?void 0:f.fromDate,strings:d,formatDate:_=>_==null?void 0:_.toLocaleDateString(),onSelectDate:_=>{s(v=>{var y;const b=new Map(v);return b.set(t==null?void 0:t.itemKey,{fromDate:(y=a==null?void 0:a.get(t==null?void 0:t.itemKey))==null?void 0:y.fromDate,toDate:_}),b}),r(we.CUSTOM)},value:(p=a==null?void 0:a.get(t==null?void 0:t.itemKey))==null?void 0:p.toDate,label:"At\xE9"})))}const Bu=$.memo(zu),Ou={suggestionsHeaderText:"Pessoas sugeridas",mostRecentlyUsedHeaderText:"Pessoas mais recentes",noResultsFoundText:"Nenhum resultado encontrado",loadingText:"Carregando",showRemoveButtons:!0,suggestionsAvailableAlertText:"Sugest\xF5es dispon\xEDveis",suggestionsContainerAriaLabel:"Pessoas sugeridas"},Wu=t=>{const[i,n]=$.useState(t.people),e=$.useRef(null),r=(l,c,d)=>{if(!l)return[];let g=a(l);return g=Vu(g,c),g=d?g.slice(0,d):g,g},a=l=>i.filter(c=>Gu(c.text,l)),s=l=>{const c=i.indexOf(l);if(c>=0){const d=i.slice(0,c).concat(i.slice(c+1));n(d)}};return K.default.createElement("div",null,K.default.createElement("label",null,t.label),K.default.createElement(_u,{onResolveSuggestions:r,getTextFromItem:Uu,pickerSuggestionsProps:Ou,defaultSelectedItems:t==null?void 0:t.defaultSelectedItems,onChange:t==null?void 0:t.onChangePeople,className:"ms-PeoplePicker",onRemoveSuggestion:s,onValidateInput:Yu,componentRef:e,resolveDelay:300}))},Gu=(t,i)=>{var n;return((n=t==null?void 0:t.toLowerCase())==null?void 0:n.indexOf(i==null?void 0:i.toLowerCase()))===0},Vu=(t,i)=>t.filter(n=>!Ku(n,i));function Ku(t,i){var n;return!i||!i.length||i.length===0?!1:((n=i.filter(e=>(e==null?void 0:e.text)===(t==null?void 0:t.text)))==null?void 0:n.length)>0}const Uu=t=>t==null?void 0:t.text;function Yu(t){return t.indexOf("@")!==-1?Ct.valid:t.length>1?Ct.warning:Ct.invalid}function $u(){const{isOpen:t,onClose:i,panelTitle:n,onCancel:e,onApply:r,actualFilteredValues:a,setActualFilteredValues:s,onOpen:l,filterOptionsMatrix:c,availableFilters:d,top:g,footer:m,setFilterDate:u}=$.useContext(vi),f=$.useRef(null),p=(N,k)=>{const w=new Map(a);!k.key||(k.selected&&!w.has(k==null?void 0:k.key)?w.set(k.key,{rootItemKey:N,itemKey:k.key,data:k==null?void 0:k.data,text:k==null?void 0:k.text}):!k.selected&&w.has(k==null?void 0:k.key)?w.delete(k==null?void 0:k.key):k.selected&&w.has(k==null?void 0:k.key)&&(k==null?void 0:k.isDateComponent)&&w.set(k.key,{rootItemKey:N,itemKey:k.key,data:k==null?void 0:k.data,text:k==null?void 0:k.text}),s(w))};$.useEffect(()=>{l&&l()},[]);const _=(N,k)=>!k||!k.length||k.length===0?!1:k.some(w=>(w==null?void 0:w.key)===(N==null?void 0:N.key));return{state:{isOpen:t,actualFilteredValues:a,panelTitle:n,filterOptionsMatrix:c,availableFilters:d},handlers:{getDefaultDropdownSelectedKeys:()=>{const N=[];return a.forEach((k,w)=>{N.push(w)}),N},getDefaultSelectedTag:N=>{const k=[];return a.forEach((w,E)=>{const P=E==null?void 0:E.split("_")[1];P===N&&k.push({key:P,text:w==null?void 0:w.text,data:w==null?void 0:w.data,selected:!0,name:w==null?void 0:w.text})}),k},getDefaultSelectedSlider:N=>{var E;const k=[...a].find(([P])=>P===N),w=(E=k==null?void 0:k[1])==null?void 0:E.data;return w?w==null?void 0:w.type:we.NONE},getDefaultSelectedPeople:N=>{const k=[...a].filter(([w])=>(w==null?void 0:w.split("_")[1])===N);return(k==null?void 0:k.length)>0?k==null?void 0:k.map(([E,P])=>P):[]},onAddOrRemoveToMap:p,onClose:i,onCancel:e,onApply:r,onOpen:l,setActualFilteredValues:s,onChangeTags:N=>k=>{var E,P;const w=new Map(a);k.length===0?N.forEach(T=>{w.has(T==null?void 0:T.key)&&w.delete(T==null?void 0:T.key)}):k!=null&&k.map(T=>T==null?void 0:T.key).includes((E=f==null?void 0:f.current)==null?void 0:E.key)||(w.delete((P=f==null?void 0:f.current)==null?void 0:P.key),f.current=null),s(w)},onTagSelected:N=>k=>(p(N,{...k,selected:!0}),f.current=k,k),onResolveTagSuggestion:N=>(k,w)=>k?N.filter(P=>{var T;return((T=P==null?void 0:P.text)==null?void 0:T.toLowerCase().indexOf(k.toLowerCase()))===0&&!_(P,w)}).map(P=>({...P,name:P==null?void 0:P.text})):[],onRecordDateChange:N=>(k,w,E)=>{if((k||w)&&E!==we.NONE)p(N,{key:N,text:`${k==null?void 0:k.toISOString()} - ${w==null?void 0:w.toISOString()}`,data:{from:k,to:w,type:E},selected:!0,isDateComponent:!0,name:`${k==null?void 0:k.toISOString()} - ${w==null?void 0:w.toISOString()}`});else{const P=new Map(a);P.delete(N),u(T=>(T.delete(N),T)),s(P)}},onChangePeople:N=>k=>{const w=new Map(a);k.length===0?(a==null||a.forEach((E,P)=>{var T;((T=P==null?void 0:P.split("_"))==null?void 0:T[1])===N&&w.delete(P)}),s(w)):k.forEach(E=>{p(N,{key:E==null?void 0:E.key,text:E==null?void 0:E.text,data:E==null?void 0:E.data,selected:!0,isDateComponent:!1,name:E==null?void 0:E.text})})}},JSX:{top:g,footer:m}}}function ju(){const{JSX:t,state:i,handlers:n}=$u(),{actualFilteredValues:e,panelTitle:r,isOpen:a,filterOptionsMatrix:s,availableFilters:l}=i,{top:c,footer:d}=t,{onClose:g,onCancel:m,getDefaultDropdownSelectedKeys:u,onAddOrRemoveToMap:f,getDefaultSelectedTag:p,getDefaultSelectedSlider:_}=n;return a?K.default.createElement(Si,{onRenderFooter:v=>K.default.createElement(K.default.Fragment,null,d||null,K.default.createElement("div",{style:{padding:20}},K.default.createElement(ne.PrimaryButton,{onClick:()=>n.onApply(e),styles:{root:{marginRight:8}}},"Aplicar"),K.default.createElement(ne.DefaultButton,{onClick:m},"Cancelar"))),isFooterAtBottom:!0,onDismiss:g,isOpen:a},c||null,K.default.createElement("h2",null,r),l==null?void 0:l.map((v,b)=>K.default.createElement(K.default.Fragment,null,v.renderAs==="Dropdown"?K.default.createElement(Ir,{defaultSelectedKeys:u(),key:(v==null?void 0:v.key)+"-"+b,options:s[b],multiSelect:v==null?void 0:v.enableMultiple,label:v==null?void 0:v.name,onChange:(y,C)=>f(v==null?void 0:v.key,C)}):v.renderAs==="SearchBox"?K.default.createElement("div",{key:(v==null?void 0:v.key)+"-"+(v==null?void 0:v.name)+"-"+b},K.default.createElement(ne.Label,null,v==null?void 0:v.name),K.default.createElement(Eu,{key:(v==null?void 0:v.key)+"-"+b,getTextFromItem:y=>y==null?void 0:y.name,defaultSelectedItems:p(v.key),pickerSuggestionsProps:{suggestionsHeaderText:"Sugest\xF5es",noResultsFoundText:"Nenhum resultado encontrado",loadingText:"Carregando..."},pickerCalloutProps:{doNotLayer:!0,style:{overflowY:"auto"},styles:{root:{position:"relative"}}},onChange:n.onChangeTags(s[b]),onItemSelected:n.onTagSelected(v==null?void 0:v.key),onResolveSuggestions:n.onResolveTagSuggestion(s[b])})):v.renderAs==="DateSlider"?K.default.createElement(Bu,{itemKey:v==null?void 0:v.key,defaultSliderValue:_(v==null?void 0:v.key),onRecordDateRange:n.onRecordDateChange(v==null?void 0:v.key),key:(v==null?void 0:v.key)+"-"+b,label:v==null?void 0:v.name}):(v==null?void 0:v.renderAs)==="PeoplePicker"?K.default.createElement("div",null,K.default.createElement(ne.Label,{key:(v==null?void 0:v.key)+"-"+(v==null?void 0:v.name)+"-"+b},v==null?void 0:v.name),K.default.createElement(Wu,{label:"",key:(v==null?void 0:v.key)+"-"+b,people:s[b],defaultSelectedItems:n.getDefaultSelectedPeople(v==null?void 0:v.key),onChangePeople:n.onChangePeople(v==null?void 0:v.key)})):null))):null}const Zu=$.memo(ju);function qu(){var g,m;const{isOpen:t,panelTitle:i,onApply:n,onCancel:e,onClose:r,options:a,selectedGroupKeys:s,setSelectedGroupKeys:l,top:c,footer:d}=$.useContext(pi);return t?K.default.createElement(Si,{isFooterAtBottom:!0,onDismiss:r,isOpen:t,onRenderFooter:u=>K.default.createElement(K.default.Fragment,null,d||null,K.default.createElement("div",{style:{padding:20}},K.default.createElement(ne.PrimaryButton,{onClick:()=>n(s),styles:{root:{marginRight:8}}},"Aplicar"),K.default.createElement(ne.DefaultButton,{onClick:e},"Cancelar")))},c||null,K.default.createElement("h2",null,i),K.default.createElement(td,{onChange:(u,f)=>{const p=`${f==null?void 0:f.key};${f==null?void 0:f.text}`;l(p)},defaultSelectedKey:(m=(g=s==null?void 0:s.split(";"))==null?void 0:g[0])!=null?m:void 0,options:[{key:"@NONE",text:"Nenhum"},...a]})):null}const Xu=$.memo(qu),Ju=()=>{const{customButtons:t,enableFilter:i,enableSearch:n,searchKeys:e,onSearchItemChange:r,setIsFilterPanelOpen:a,defaultButtonsOrder:s,searchBoxPlaceholder:l,enableGrouping:c,onClickSearchIcon:d,onFilterIconClick:g,onGroupIconClick:m,onSearchBoxClick:u,filterButtonProps:f,searchBoxProps:p,groupButtonProps:_,leftHeaderSpace:v}=$.useContext(To),{onOpen:b}=$.useContext(pi),y=$.useMemo(()=>(f==null||delete f.onClick,_==null||delete _.onClick,{filterButtonProps:f,groupButtonProps:_}),[f,f,_,p]),C=$.useMemo(()=>(p==null||delete p.placeholder,p==null||delete p.onKeyDown,p==null||delete p.onFocus,p==null||delete p.onBlur,p),[f,f,_,p]),x=$.useMemo(()=>({container:{display:"flex",flexDirection:"row",gap:4,justifyContent:"end",margin:"8px 0"}}),[]),R=(S,I)=>{const N={fontSize:14,...S==null?void 0:S.label},k={order:I!=null?I:"unset",...S==null?void 0:S.root};return{...S,label:N,root:k}},D=()=>{var k,w,E,P;const I={width:((w=(k=C==null?void 0:C.styles)==null?void 0:k.root)==null?void 0:w.width)||320,order:s==null?void 0:s.search,...(E=C==null?void 0:C.styles)==null?void 0:E.root},N={color:"[theme: themePrimary, default: #0078D4]",...(P=C==null?void 0:C.styles)==null?void 0:P.icon};return{...C,root:I,icon:N}};return K.default.createElement("div",{"data-class-name":"grid-view-header-container",style:x.container},!!v&&v,c&&K.default.createElement(ne.DefaultButton,{...y==null?void 0:y.groupButtonProps,onClick:S=>{m&&m(),b()},styles:R(y==null?void 0:y.groupButtonProps,s==null?void 0:s.group),iconProps:{iconName:"GroupList"}}),(t==null?void 0:t.length)>0&&(t==null?void 0:t.map((S,I)=>{var N,k,w;switch(S==null?void 0:S.renderAs){case"PrimaryButton":return K.default.createElement(ne.PrimaryButton,{key:(S==null?void 0:S.text)+"_"+I,className:S==null?void 0:S.className,styles:R((N=S==null?void 0:S.props)==null?void 0:N.styles,S==null?void 0:S.position),...S==null?void 0:S.props},S==null?void 0:S.text);case"DefaultButton":return K.default.createElement(ne.DefaultButton,{key:(S==null?void 0:S.text)+"_"+I,className:S==null?void 0:S.className,styles:R((k=S==null?void 0:S.props)==null?void 0:k.styles,S==null?void 0:S.position),...S==null?void 0:S.props},S==null?void 0:S.text);case"CustomButton":return(w=S==null?void 0:S.onRenderCustomButton(S==null?void 0:S.props))!=null?w:null;default:console.error("[TRS] - GridView - Invalid renderAs value for custom button")}})),n&&e&&K.default.createElement(ne.TextField,{placeholder:l,styles:D(),onKeyDown:S=>{var I;S.key==="Enter"&&d(Qt.ENTER,(I=S==null?void 0:S.currentTarget)==null?void 0:I.value,e)},onFocus:u,onBlur:S=>r(S.target.value,e),iconProps:{iconName:"Search",style:{pointerEvents:"auto",cursor:"pointer",position:"static",padding:8,backgroundColor:"#e2d7cab5"},onClick:S=>{var N,k,w;((w=(k=(N=S==null?void 0:S.currentTarget)==null?void 0:N.parentElement)==null?void 0:k.childNodes[0])==null?void 0:w.value)&&d(Qt.CLICK)}},...C}),i&&K.default.createElement(ne.DefaultButton,{onClick:S=>{g&&g(),a(!0)},styles:R(y==null?void 0:y.filterButtonProps,s==null?void 0:s.filter),iconProps:{iconName:"Filter"},...y==null?void 0:y.filterButtonProps}))};function Qu(t,i){var f,p,_,v,b;const{state:n,handlers:e}=qr(t,i),{actualRows:r,visibleCols:a,isFilterPanelOpen:s,filterPanelConfig:l,groupPanelConfig:c,listConfig:d,isGroupPanelOpen:g,groups:m}=n,{onItemClick:u}=e;return K.default.createElement(pi.Provider,{value:c},K.default.createElement(vi.Provider,{value:l},K.default.createElement(To.Provider,{value:d},K.default.createElement("div",{style:(p=(f=t==null?void 0:t.styles)==null?void 0:f.root)!=null?p:{}},K.default.createElement(Ju,null),K.default.createElement("div",{"data-is-scrollable":"true",style:{position:"relative",zIndex:0,...(_=t==null?void 0:t.styles)==null?void 0:_.contentContainer},id:"gridView-root"},t!=null&&t.onRenderCustomRow?r==null?void 0:r.map(y=>t==null?void 0:t.onRenderCustomRow(y)):K.default.createElement(ol,{...t==null?void 0:t.detailsListProps,onRenderItemColumn:t==null?void 0:t.onRenderItemColumn,onRenderRow:(y,C)=>K.default.createElement("div",{onClick:()=>u(y==null?void 0:y.item)},C({...y,styles:{root:{cursor:t!=null&&t.onItemClick?"pointer":"default"}}})),items:r,columns:a,groups:m,groupProps:{isAllGroupsCollapsed:!0,collapseAllVisibility:Lt.visible,onRenderHeader:(y,C)=>y.group.name?C(y):K.default.createElement(K.default.Fragment,null),showEmptyGroups:!1},layoutMode:zt.fixedColumns,isHeaderVisible:!0,onRenderDetailsHeader:(y,C)=>K.default.createElement(al,{key:y==null?void 0:y.key,stickyPosition:_t.Header,stickyBackgroundColor:"transparent"},K.default.createElement("div",{key:y==null?void 0:y.key},C(y))),checkboxVisibility:(b=(v=t==null?void 0:t.detailsListProps)==null?void 0:v.checkboxVisibility)!=null?b:Ke.hidden})),s&&K.default.createElement(Zu,null),g&&K.default.createElement(Xu,null)))))}const eg=$.forwardRef(Qu);exports.GridView=eg;
